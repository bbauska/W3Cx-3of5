<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~ index.html of W3Cx-3of5-HTML5.1x making W3Cx-3of5.bauska.org ~~~~~~~~~~~~~~~~-->
<head>
  <meta charset="UTF-8">
  <link rel="shortcut icon" type="image/jpg" href="./images/favicon.ico">
  <link rel="apple-touch-icon" sizes="57x57" href="./images/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="./images/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="./images/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="./images/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="./images/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="./images/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="./images/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="./images/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="./images/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="./images/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="./images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="./images/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="./images/favicon-16x16.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="./images/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <link rel="shortcut icon" type="image/jpg" href="./images/favicon.ico">
  <!-- viewport and seo -->
  <meta name="author" content="Brian Bauska">
  <meta name="title" content="W3Cx-3of5-HTML5.1x">
  <meta name="description" content="HTML5.1x - Coding Essentials &amp; Best Practices - 
    during this course, you will learn: Simplified HTML5 tags, and how to use microdata; 
    Play with audio and video tags; Use the Webcam; Draw and animate Web graphics; Discover 
    HTML5 form features; Test basic APIs; Practice coding techniques.">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="keywords" content="W3Cx-3of5-HTML5.1x,Silus Gaming World">
  <meta name=”robots” content="index, follow">

  <title>W3Cx-3of5-HTML5.1x</title>
  <link rel="canonical" href="https://w3cx-3of5.bauska.org">
  <link rel="stylesheet" href="/css/styles.css">
</head>

<body>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
  <button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ script function: scrollFunction() ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
  <script>
  <!-- get the button -->
  var mybutton = document.getElementById("myBtn");
  <!-- when the user scrolls down 10px from the top of the document, show the "Top" button -->
  window.onscroll = function() {scrollFunction()};
  function scrollFunction() {
    if (document.body.scrollTop > 10 || document.documentElement.scrollTop > 10) {
      mybutton.style.display = "block";
    } else {
      mybutton.style.display = "none";
    }
  }
  // when the user clicks on the button, scroll to the table of contents near top of document.
  function topFunction() {
    document.getElementById('table-of-contents').scrollIntoView();
  }
  </script>
<h1 style="text-align:center;">W3Cx Front-End Web Developer</h1>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ w3cx logo (01) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/w3c-logo.webp"
  title="W3C logo"
  alt="W3C logo."
  style="width:156px; height:64px;" />

<h2 style="text-align:center;">W3Cx-3of5-HTML5.1x - Coding Essentials and Best Practices</h2>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 01. W3Cx-3of5-HTML5.1x logo (01) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image001.webp"
  title="W3Cx HTML 5.1x logo"
  alt="W3Cx HTML 5.1x logo."
  style="width:45%;" />
<!--  style="width:370px; height:208px;" -->

<p id="table-of-contents"></p>
<h2><a href="#table-of-contents">Table of Contents - W3Cx-3of5-=HTML5.1x - Coding Essentials 
and Best Practices</a></h2>
<h2>Syllabus</h2>

<h2><strong>Course Information</strong></h2>

<h2><strong>Module 1: HTML5 Basics</strong></h2>

<blockquote>
<h3>1.1 <a href="#ch1-1-1"><strong>History of HTML: From HTML1.0 to HTML5.0</strong></a></h3>
<h3>1.2 <a href="#ch1-2-1"><strong>HTML5 Structural elements</strong></a></h3>
<h3>1.3 <a href="#ch1-3-1"><strong>A Blog example: Mixing All Elements Together</strong></a></h3>
<h3>1.4 <a href="#ch1-4-1"><strong>The Details and Summary elements</strong></a></h3>
<h3>1.5 <a href="#ch1-5-1"><strong>Microdata</strong></a></h3>
</blockquote>

<h2><strong>Module 2: HTML5 Multimedia</strong></h2>

<blockquote>
<h3>2.1 <a href="#ch2-1-1"><strong>HTML5 Multimedia: Streaming with Video and Audio Elements</strong></a></h3>
<h3>2.2 <a href="#ch2-2-1"><strong>Subtitles and closed captions</strong></a></h3>
<h3>2.3 <a href="#ch2-3-1"><strong>Enhanced HTML5 media players and frameworks</strong></a></h3>
<h3>2.4 <a href="#ch2-4-1"><strong>Webcam, microphone: the getUserMedia API</strong></a></h3>
</blockquote>

<h2><strong>Module 3: HTML5 Graphics</strong></h2>

<blockquote>
<h3>3.1 <a href="#ch3-1-1"><strong>Introduction - Module 3: HTML5 Graphics</strong></a></h3>
<h3>3.2 <a href="#ch3-2-1"><strong>Basics of HTML5 canvas</strong></a></h3>
<h3>3.3 <a href="#ch3-3-1"><strong>Immediate drawing mode: rectangles, text, images</strong></a></h3>
<h3>3.4 <a href="#ch3-4-1"><strong>Path drawing mode: lines, circles, arcs, curves 
  and other path drawing methods</strong></a></h3>
<h3>3.5 <a href="#ch3-5-1"><strong>Colors, gradients, patterns, shadows, etc.</strong></a></h3>
</blockquote>

<h2><strong>Module 4: HTML5 Animation</strong></h2>

<blockquote>
<h3>4.1 <a href="#ch4-1-1"><strong>Introduction - Module 4: Animations</strong></a></h3>
<h3>4.2 <a href="#ch4-2-1"><strong>Basic animation techniques</strong></a></h3>
<h3>4.3 <a href="#ch4-3-1"><strong>Canvas and user interaction (keyboard, mouse)</strong></a></h3>
<h3>4.4 <a href="#ch4-4-1"><strong>A glimpse of advanced canvas functionalities</strong></a></h3>
</blockquote>

<h2><strong>Module 5: HTML5 Forms</strong></h2>

<blockquote>
<h3>5.1 <a href="#ch5-1-1"><strong>Introduction - Module 5: Forms</strong></a></h3>
<h3>5.2 <a href="#ch5-2-1"><strong>Elements and Attributes</strong></a></h3>
<h3>5.3 <a href="#ch5-3-1"><strong>Accessible Forms</strong></a></h3>
<h3>5.4 <a href="#ch5-4-1"><strong>&lt;input&gt; Types</strong></a></h3>
<h3>5.5 <a href="#ch5-5-1"><strong>Forms Attributes</strong></a></h3>
<h3>5.6 <a href="#ch5-6-1"><strong>Forms Elements</strong></a></h3>
<h3>5.7 <a href="#ch5-7-1"><strong>Form Validation API</strong></a></h3>
</blockquote>

<h2><strong>Module 6: HTML5 Basic APIs</strong></h2>

<blockquote>
<h3>6.1 <a href="#ch6-1-1"><strong>Introduction - Module 6: HTML5 Basic APIs</strong></a></h3>
<h3>6.2 <a href="#ch6-2-1"><strong>The Web Storage API</strong></a></h3>
<h3>6.3 <a href="#ch6-3-1"><strong>The File API</strong></a></h3>
<h3>6.4 <a href="#ch6-4-1"><strong>The Geolocation API</strong></a></h3>
</blockquote>

<h2 id="cha-1">About W3C and the Web</h2>

<h2>Course Information</h2>

<h3>Welcome to “HTML5 Coding Essentials and Best Practices”</h3>

<ul>
  <li>Course outline (syllabus)</li>
  <li>Course forums</li>
  <li>Course tools</li>
  <li>About W3C and the Web</li>
</ul>

<p>W3C has designed a <a href="https://www.edx.org/professional-certificate/front-end-web-developer-9" 
  target="_blank" rel="noopener noreferrer">“Front-End Web Developer” (FEWD) Professional Certificate</a> 
  where you learn all of the necessary skills needed to build interactive and responsive user experiences 
  on the Web. This program deepens your knowledge of the 3 foundational languages that power the Web: 
  HTML5, CSS and JavaScript.
<br>The <b>W3C FEWD</b> program is composed of 5 courses:</p>

<ol type="1">
  <li>CSS Basics</li>
  <li>5.0x HTML5 and CSS Fundamentals</li>
  <li>This course: <b><i>5.1x HTML5 Coding Essentials and Best Practices</i></b></li>
  <li>5.2x HTML5 Apps and Games</li>
  <li>JavaScript Introduction</li>
</ol>

<p>This course is a natural follow up to the <a href="https://www.edx.org/course/css-basics" 
  target="_blank" rel="noopener noreferrer">CSS Basics</a> and 
  <a href="https://www.edx.org/course/html5-and-css-fundamentals" target="_blank" 
  rel="noopener noreferrer">HTML5 &amp; CSS Fundamentals</a> courses.</p>
  
<h4>As such, required prerequisites are:</h4>

<ul>
  <li>Be comfortable putting together an HTML document,</li>
  <li>Have minimal familiarity with CSS,</li>
  <li>Basic knowledge of JavaScript and DOM APIs is sufficient, and this course 
    will include a recap of basics. You are also more than welcome to follow the 
    <a href="https://www.edx.org/course/javascript-introduction" target="_blank" 
    rel="noopener noreferrer">JavaScript Introduction</a> course (introductory 
    level).</li>
</ul>

<h4>During this course, you will:</h4>

<ul>
  <li>Learn the simplified HTML5 tags, and how to use microdata,</li>
  <li>Play with the audio and video tags,</li>
  <li>Use the Webcam,</li>
  <li>Draw and animate fun Web graphics,</li>
  <li>Discover HTML5 form features,</li>
  <li>Test the basic APIs, such as Web storage and geolocation,</li>
  <li>And most of all, practice coding techniques thanks to multiple interactive examples.</li>
</ul>

<p>The HTML5 course team is thrilled to guide you in your learning experience. We are 
committed to teach you how to code Web pages, and how to do it the correct way. We 
encourage you to create Web pages and apps and share them in the discussion forums. 
Have fun!</p>

<h3 id="cha-3">a.3 W3C Tools - Online Code Editors:</h3>

<ul>
  <li><a href="https://jsbin.com" target="_blank" rel="noopener noreferrer">JS Bin</a></li>
  <li><a href="https://code.tutsplus.com/tutorials/javascript-tools-of-the-trade-jsbin--net-36843" 
    target="_blank" rel="noopener noreferrer">CodePen Tutorial</a></li>
  <li><a href="https://codepen.io" target="_blank" rel="noopener noreferrer">CodePen</a></li>
  <li><a href="https://css-tricks.com/video-screencasts/112-using-codepen/" target="_blank" 
  rel="noopener noreferrer">CodePen CSS Tutorial</a></li>
</ul>

<h4>Web Editors:</h4>

<p>While any text editor, like NotePad or TextEdit, can be used to create Web pages, 
they don’t necessarily offer a lot of help towards that end. Other options offer more 
facilities for error checking, syntax coloring and saving some typing by filling things 
out for you.</p>

<h4>Here are a few possibilities for Web editors:</h4>

<ul>
  <li><a href="https://notepad-plus-plus.org/" target="_blank" 
    rel="noopener noreferrer">Notepad</a> - on Windows PC's.</li>
  <li><a href="https://code.visualstudio.com/" target="_blank" 
    rel="noopener noreferrer">Visual Studio Code</a> - a free open source editor 
      that can run on any operating system. Many developers are already familiar 
      with Visual Studio Code. Many coding videos in this course are demonstrated 
      using Visual Studio Code.</li>
  <li><a href="https://developer.apple.com/xcode/" target="_blank" rel="noopener 
    noreferrer">XCode</a> - Mac developers may be familiar with XCode.</li>
  <li><a href="https://discussions.apple.com/message/5014514#5014514" 
    target="_blank" rel="noopener noreferrer">TextEdit - this is available on 
    Macs</a>, but be sure you're [saving as plain text, not as a “.rtf” or “.doc” 
    file.</li>
  <li><a href="https://www.sublimetext.com/" target="_blank" rel="noopener 
    noreferrer">Sublime Text</a> - it is quite popular with developers, 
    though there can be a bit of a learning curve to use its many features.</li>
  <li><a href="http://bluegriffon.org/" target="_blank" rel="noopener 
    noreferrer">BlueGriffon</a> - a WYSIWYG (“What You See Is What You Get”) 
    content editor for the World Wide Web. Powered by Gecko, the rendering 
    engine of Firefox, it’s a modern and robust solution to edit Web pages 
    in conformance to the latest Web Standards.</li>
  <li><a href="https://atom.io/" target="_blank" rel="noopener noreferrer">
    Atom</a> - another cross platform editor, created by <a href="https://github.com/" 
    target="_blank" rel="noopener noreferrer">GitHub</a>.</li>
  <li><a href="https://github.com/" target="_blank" rel="noopener 
    noreferrer">GitHub</a> itself - check 
    <a href="https://towardsdatascience.com/how-to-create-a-free-github-pages-website-53743d7524e1" 
    target="_blank" rel="noopener noreferrer">this resource that explains how to create a Web site 
    using GitHub</a>.</li>
  <li><a href="https://www.vim.org/" target="_blank" rel="noopener noreferrer">Vim</a> or 
    <a href="https://www.gnu.org/software/emacs/" target="_blank">Emacs</a> - great editors, 
    but if you're not already familiar with these, this isn't the time to try.</li>
</ul>

<h4>Online Editors:</h4>

<p>To help you practice during the whole duration of the course, we use the following 
interactive online editors. Pretty much all the course’s examples actually use these 
tools.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 02. jsbin logo (04) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image002.webp"
  loading="lazy"
  title="JSBin logo"
  alt="JSBin logo."
  style="width:15%;" /></a>

<ul>
  <li><a href="https://jsbin.com/" target="_blank" rel="noopener noreferrer">JS Bin</a></li>
</ul>

<p>JS Bin is an open source collaborative Web development debugging tool. Most 
of the examples that are in this course are on JSBin.</p>

<p>Tutorials can be found on the Web such as 
<a href="https://code.tutsplus.com/tutorials/javascript-tools-of-the-trade-jsbin--net-36843" 
target="_blank" rel="noopener noreferrer">this one</a> or on YouTube.</p>

<p>The tool is really simple, just open the link to the provided examples, look at the 
code, look at the result, etc.</p>

<p>And you can modify the examples as you like, you can also modify / clone / save / 
share them.</p>

<p>Keep in mind that it's always better to be logged in (it's free) if you do not want 
to lose your contributions/personal work.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 03. codepen logo (04) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://codepen.io/" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image003b.webp"
  loading="lazy"
  title="CodePen.io logo"
  alt="CodePen.io logo."
  style="width:15%;" />
  style="width:</a>

<ul>
  <li><a href="https://codepen.io/" target="_blank" rel="noopener noreferrer">CodePen</a></li>
</ul>

<p>CodePen is an HTML, CSS, and JavaScript code editor that previews/showcases your 
code bits in your browser. It helps with cross-device testing, real-time remote pair 
programming and teaching.</p>

<p>Here's an article of interest if you use CodePen: 
<a href="https://codepen.io/brentmiller/post/things-you-can-do-with-codepen" 
target="_blank" rel="noopener noreferrer">Things you can do with CodePen</a> 
[Brent Miller, February 6, 2019].</p>

<p>There are many other handy tools such as <a href="https://jsfiddle.net/" target="_blank" 
rel="noopener noreferrer">JSFiddle</a>, and <a href="https://dabblet.com/" target="_blank" 
rel="noopener noreferrer">Dabblet</a>. Please share your favorite tool on the discussion 
forum, and explain why! Share also your own code contributions, such as a nice canvas 
animation, a great looking HTML5 form, etc.</p>

<h4>Browser Compatibility:</h4>

<p>The term browser compatibility refers to the ability of a given Web site to appear 
fully functional on the browsers available in the market.</p>

<p>The most powerful aspect of the Web is what makes it so challenging to build for: 
its universality. When you create a Web site, you’re writing code that needs to be 
understood by many different browsers on different devices and operating systems!</p>

<p>To make the Web evolve in a sane and sustainable way for both users and developers, 
browser vendors work together to standardize newfeatures, whether it’s a new 
<a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element" target="_blank" 
rel="noopener noreferrer">HTML element</a>, 
<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Reference#Keyword_index" 
target="_blank" rel="noopener noreferrer">CSS
property</a>, or <a href="https://developer.mozilla.org/en-US/docs/Web/API" 
target="_blank" rel="noopener noreferrer">JavaScript API</a>. But different 
vendors have different priorities, resources, and release cycles — so it’s 
very unlikely that a new feature will land on all the major browsers at once. 
As a Web developer, this is something you must consider if you’re relying on 
a feature to build your site.</p>

<p>We are then providing references to the browser support of HTML5 features presented in 
this course using 2 resources: <a href="https://caniuse.com/" target="_blank" 
rel="noopener noreferrer">Can I Use</a> and <a href="https://developer.mozilla.org/en-US/" 
target="_blank" rel="noopener noreferrer">Mozilla Developer Network (MDN) Web Docs</a>.</p>

<h4>Can I use</h4>

<p><a href="https://caniuse.com/" target="_blank" rel="noopener noreferrer">Can I Use</a> 
provides up-to-date tables for support of front-end Web technologies on desktop and mobile 
Web browsers. Below is a snapshot of what information is given by CanIUse when searching 
for “CSS3 colors”.</p>

<p>Example of a <a href="./images/image004.webp" target="_blank" 
rel="noopener noreferrer">CanIUse browser</a> support table (using CSS3 colors);</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 04. caniuse example (05) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="/images/image004.webp"
  loading="lazy"
  title="Example CSS in CanIUse"
  alt="Example CSS in CanIUse."
  style="width:35%;" />

<h4>MDN Web Docs</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 05. mdn web docs logo (05) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="/images/image005.webp"
  loading="lazy"
  title="Logo of MDN Web Docs"
  alt="Logo of MDN Web Docs."
  style="width:25%;" />

<p>To help developers make these decisions consciously rather than accidentally, 
<a href="https://developer.mozilla.org/" target="_blank" rel="noopener noreferrer">
MDN Web Docs</a> provides browser compatibility tables in its documentation pages, 
so that when looking up a feature you’re considering for your project, you know 
exactly which browsers will support it.</p>

<h4>External resources:</h4>

<ul>
  <li><a href="https://hacks.mozilla.org/2018/02/mdn-browser-compatibility-data/" 
  target="_blank" rel="noopener noreferrer">MDN browser compatibility data: Taking 
  the guesswork out of web compatibility</a>.</li>
  <li><a href="https://hacks.mozilla.org/2019/09/caniuse-and-mdn-compat-data-collaboration/" 
  target="_blank" rel="noopener noreferrer">Caniuse and MDN compatibility data collaboration</a>.</li>
</ul>

<h3>W3C Validators:</h3>

<p>For over 15 years, the W3C has been developing and hosting 
<a href="https://w3c.github.io/developers/" target="_blank" rel="noopener noreferrer">
free and open source tools</a> used every day by millions of Web developers and Web 
designers.<br>All the tools listed below are Web-based, and are available as downloadable 
sources or as free services on the 
<a href="https://w3c.github.io/developers/tools/" target="_blank" rel="noopener noreferrer">
W3C Developers tools</a> site.</p>

<h4>W3C Validator</h4>

<p>The <a href="https://validator.w3.org/" target="_blank" rel="noopener noreferrer">
W3C validator</a> checks the 
<a href="https://validator.w3.org/docs/help.html#validation_basics" target="_blank">
markup validity</a> of various Web document formats, such as HTML. Note that you are 
automatically directed to the <a href="https://validator.w3.org/nu/" target="_blank" 
rel="noopener noreferrer">Nu Html Checker</a> when validating an HTML5 document.</p>

<h4>CSS Validator</h4>

<p>The <a href="https://jigsaw.w3.org/css-validator/" target="_blank" 
rel="noopener noreferrer">CSS validator</a> checks Cascading Style Sheets (CSS) and 
(X)HTML documents that use CSS stylesheets.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 06. laptop showing unicorn validator (06) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image006.webp"
  loading="lazy"
  title="Laptop showing unicorn validator"
  alt="Laptop showing unicorn validator."
  style="width:25%;" />

<h4>Unicorn</h4>

<p><a href="https://validator.w3.org/unicorn/" target="_blank" rel="noopener noreferrer">
Unicorn</a>is W3C’s unified validator, which helps people improve the quality of their 
Web pages by performing a variety of checks. Unicorn gathers the results of the popular 
HTML and CSS validators, as well as other useful services, such as Internationalization, 
RSS/Atom feeds and http headers.</p>

<h4>Internationalization Checker</h4>

<p>The <a href="https://validator.w3.org/i18n-checker/" target="_blank" rel="noopener noreferrer">
W3C Internationalization Checker</a> provides information about various internationalization-
related aspects of your page, including the HTTP headers that affect it. It will also report 
a number of issues and offer advice about how to resolve them.</p>

<h4>Link Checker</h4>

<p>The <a href="https://validator.w3.org/checklink" target="_blank" rel="noopener noreferrer">
W3C Link Checker</a> looks for issues in links, anchors and referenced objects in a Web 
page, CSS style sheet, or recursively on a whole Web site.</p>

<p>For best results, it is recommended to first ensure that the documents checked use 
valid <a href="https://validator.w3.org/" target="_blank">
(X)HTML Markup</a> and <a href="https://jigsaw.w3.org/css-validator/" target="_blank" 
rel="noopener noreferrer">CSS</a>.</p>

<h4>W3C Cheatsheet</h4>

<p>The <a href="https://www.w3.org/2009/cheatsheet/" target="_blank" rel="noopener noreferrer">
W3C cheatsheet</a> provides quick access to useful information from a variety of 
specifications published by W3C. It aims at giving in a very compact and mobile-friendly 
format a compilation of useful knowledge extracted from W3C specifications, completed by 
summaries of guidelines developed at W3C, in particular Web accessibility guidelines, the 
Mobile Web Best Practices, and a number of internationalization tips.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 07. w3c cheat sheet snapshot image (07) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image007.webp"
  loading="lazy"
  title="W3C Cheat Sheet snapshot image"
  alt="W3C Cheat Sheet snapshot image."
  style="width:25%;" />

<p>Its main feature is a lookup search box, where one can start typing a keyword and get 
a list of matching properties/elements/attributes/functions in the above-mentioned 
specifications, and further details on those when selecting the one of interest.</p>

<h4>The W3C cheatsheet is only available as a 
<a href="https://dev.w3.org/2009/cheatsheet/doc/" target="_blank" rel="noopener noreferrer">
pure Web application</a>.</h4>

<h4>Help Build the Web Platform</h4>

<p>Most of the technologies you use when developing Web applications and Web sites are 
designed and standardized in W3C in a completely open and transparent process.</p>

<p>In fact, all W3C specifications are developed in public <a href="https://github.com/w3c/" 
target="_blank" rel="noopener noreferrer">GitHub repositories</a>, so if you are familiar 
with GitHub, you already know how to contribute to W3C specifications! This is all about 
raising issues (with feedback and suggestions) and/or bringing pull requests to fix 
identified issues.</p>

<h4>Contribute</h4>

<p>Contributing to this standardization process might be a bit scary or hard to approach 
at first, but understanding at a deeper level how these technologies are built is a great 
way to build your expertise.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~ 08. github (the octocat) logo (07) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image008.webp"
  loading="lazy"
  title="Github (the octocat) logo"
  alt="Github (the octocat) logo."
  style="width:10%;" />

<p>If you’re looking to an easy way to dive into this standardization processes, check 
out which <a href="https://github.com/search?q=org%3Aw3c+label%3A%22good+first+issue%22+state%3Aopen&type=Issues" 
target="_blank" rel="noopener noreferrer">issues in the W3C GitHub repositories have been 
marked as “good first issue”</a> and see if you find anything where you think you would 
be ready to help.</p>

<h4>Shape the future</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~ 09. w3c web incubator community group logo (08) ~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image009.webp"
  loading="lazy"
  title="W3C Web Incubator Community Group logo"
  alt="W3C Web Incubator Community Group logo."
  style="width:15%;" />

<p>Another approach is to go and bring feedback ideas for future technologies: the 
<a href="https://wicg.io/" target="_blank" rel="noopener noreferrer">
W3C Web Platform Community Incubator Group</a> was built as an easy place to get started 
to provide feedback on new proposals or bring brand-new proposals for consideration.</p>

<p>Happy Web building!</p>

<h3>What is W3C?</h3>

<p>As steward of global Web standards, W3C’s mission is to safeguard the openness, 
accessibility, and freedom of the World Wide Web from a technical perspective.</p>

<p>W3C’s primary activity is to develop protocols and guidelines that ensure long-
term growth for the Web. The widely adopted Web standards define key parts of what 
actually makes the World Wide Web work.</p>

<h4>A few history bits</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 10. Tim Berners-Lee, WWW developer (08) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image010.webp"
  loading="lazy"
  title="Tim Berners-Lee at his desk in CERN, Switzerland, 1994"
  alt="Tim Berners-Lee at his desk in CERN, Switzerland, 1994."
  style="width:25%;" />

<h6 style="text-align: center;">Tim Berners-Lee at his desk in CERN, 1994</h6>

<p><a href="https://www.w3.org/People/Berners-Lee/" target="_blank" 
rel="noopener noreferrer">Tim Berners-Lee</a> wrote
a <a href="https://www.w3.org/History/1989/proposal.html" target="_blank" 
rel="noopener noreferrer">proposal</a> in 1989 for a system called the World 
Wide Web. He then created the first Web browser, server, and Web page. He 
wrote the first specifications for URLs, HTTP, and HTML.</p>

<p>In October 1994, Tim Berners-Lee founded the World Wide Web Consortium (W3C) at the 
Massachusetts Institute of Technology, Laboratory for Computer Science [MIT/LCS] in 
collaboration with <a href="https://home.cern/" target="_blank" rel="noopener noreferrer">
CERN</a>, where the Web originated (see information on the <a href="https://www.w3.org/Daemon/" 
target="_blank" rel="noopener noreferrer">original CERN Server</a>, with support from 
DARPA and the <a href="https://ec.europa.eu/index_en.htm" target="_blank" 
rel="noopener noreferrer">European Commission</a>.</p>

<p>In April 1995, <a href="https://www.inria.fr/" target="_blank" rel="noopener noreferrer">
Inria</a> became the first European W3C host, followed by <a href="https://www.keio.ac.jp/" 
target="_blank" rel="noopener noreferrer">Keio University of Japan</a> (Shonan Fujisawa 
Campus) in Asia in 1996. In 2003, <a href="https://www.ercim.eu/" target="_blank" 
rel="noopener noreferrer">ERCIM</a> took over the role of European W3C Host from Inria. 
In 2013, W3C announced <a href="https://ev.buaa.edu.cn/" target="_blank" 
rel="noopener noreferrer">Beihang University</a> as the fourth Host.</p>

<p>In addition to these four Host locations that employ W3C staff, there are 
<a href="https://www.w3.org/Consortium/Offices/staff" target="_blank" rel="noopener noreferrer">
W3C Offices</a> around the globe that support the developer communities in their regions 
and organize local events. Find the one next to your place!</p>

<h4>A few figures</h4>

<p>As of June 2020, W3C:</p>
<ul>
  <li>Is a <a href="https://www.w3.org/Consortium/Member/List)-driven" target="_blank" 
    rel="noopener noreferrer">member</a>-driven organization composed of nearly 430 
    companies, universities, start-ups, etc. from all over the world.</li>
  <li>Holds 44 <a href="https://www.w3.org/groups/" target="_blank" rel="noopener 
    noreferrer">technical groups</a>, including Working and Interest Groups where technical 
    specifications are discussed and developed.</li>
  <li>Published over 7,181 <a href="https://www.w3.org/TR/" target="_blank" 
    rel="noopener noreferrer">published technical reports</a>, including 430 
    Web standards (or W3C Recommendations) - since January 1st,1995.</li>
  <li>Runs a <a href="https://www.w3.org/Consortium/Translation/" target="_blank" 
    rel="noopener noreferrer">translation program</a> to foster the translation of 
    its specifications: see the <a href="https://www.w3.org/Consortium/Translation/matrix.html" 
    target="_blank" rel="noopener noreferrer">translation matrix</a> currently listing 304 
    available translations of W3C recommendations.</li>
  <li>Hosts 337 <a href="https://www.w3.org/community/groups/" target="_blank" rel="noopener 
    noreferrer">Community and Business Groups</a>, where developers, designers, and anyone 
    passionate about the Web have a place to hold discussions and publish ideas.</li>
  <li>Gathers over 12,912 active participants constituting the W3C community.</li>
  <li>Has a <a href="https://www.w3.org/People/" target="_blank" rel="noopener noreferrer">
    technical staff</a> composed of 64 people, spread on all five continents.</li>
</ul>

<h4>The Web is Amazing!</h4>

<p>People often use the words “Internet” and “Web” interchangeably, but this usage is 
technically incorrect.</p>

<p>The Web is an application of the Internet.</p>

<p>The Web is the most popular way of accessing the Internet, but other applications 
of the Internet are <a href="https://en.wikipedia.org/wiki/Email" target="_blank" 
rel="noopener noreferrer">e-mail</a> and <a href="https://en.wikipedia.org/wiki/File_Transfer_Protocol" 
target="_blank" rel="noopener noreferrer">ftp</a> for example.</p>

<p>One analogy equates the Internet to a road network where the Web is a car, the email 
is a bicycle, etc.<br>
Read <a href="https://www.lifewire.com/difference-between-the-internet-and-the-web-2483335" 
target="_blank" rel="noopener noreferrer">this article for more details about the 
difference between Internet and the Web</a>.</p>

<h4>Internet</h4>

<ul>
  <li>A global network of networks and computers.</li>
  <li>The network infrastructure.</li>
  <li>Information travels via network protocols.</li>
  <li>Can access through a variety of ways.</li>
</ul>

<h4>Web</h4>

<ul>
  <li>A collection of information accessed through the internet.</li>
  <li>Information travels primarily through HTTP.</li>
  <li>Uses browsers to access documents and web pages.</li>
  <li>Navigation to other pages occurs through hyperlinks.</li>
</ul>

<p>The internet is a global network of billions of servers, computers, and other 
<a href="https://www.lifewire.com/computer-hardware-2625895" target="_blank" 
rel="noopener noreferrer">hardware</a> devices. Each device can connect with 
any other device as long as both are connected to the internet using a valid 
<a href="https://www.lifewire.com/what-is-an-ip-address-2625920" target="_blank" 
rel="noopener noreferrer">IP address</a>. The internet makes the information 
sharing system known as the web possible.</p>
<p>The web, which is short for <a href="https://www.lifewire.com/around-the-web-4781469" 
target="_blank" rel="noopener noreferrer">World Wide Web</a>, is one of the ways 
information is shared on the internet (others include 
<a href="https://www.lifewire.com/electronic-mail-overview-1164107" target="_blank" 
rel="noopener noreferrer">email</a>, File Transfer Protocol 
<a href="https://www.thoughtco.com/ftp-defined-2654479" target="_blank" rel="noopener 
noreferrer">(FTP)</a>, and <a href="https://www.lifewire.com/what-is-instant-messaging-2483319" 
target="_blank" rel="noopener noreferrer">instant messaging</a> services. The web is composed 
of billions of connected
digital documents that are viewed in a web browser, such as Chrome, 
<a href="https://www.lifewire.com/what-is-safari-4173608" target="_blank" rel="noopener 
noreferrer">Safari</a>, Microsoft Edge, <a href="https://www.lifewire.com/the-history-of-firefox-446233" 
target="_blank" rel="noopener noreferrer">Firefox</a>, and others.</p>

<p>Think of the internet as a library. Think of the books, magazines, newspapers, DVDs, 
<a href="https://www.lifewire.com/what-are-audiobooks-2438535" target="_blank" rel="noopener 
noreferrer">audiobooks</a>, and other media it contains as websites.</p>

<p>Both the internet and the web serve unique purposes but work hand in hand to provide 
information, entertainment, and other services to the public.</p>

<p>The internet really is the information superhighway. It passes through various kinds 
of network traffic including, FTP, IRC, and the World Wide Web. Without it, we wouldn’t 
have our favorite and most common way to access websites.</p>

<p>The internet was born in the 1960s under the name ARPAnet. It was an experiment by 
the U.S. military to find ways to maintain communications in the case of a nuclear 
strike. With a decentralized network, communications could be maintained even if parts 
were taken offline. ARPAnet eventually became a civilian effort, connecting university
mainframe computers for academic purposes.</p>

<p>As personal computers became mainstream in the 1980s and 1990s and the internet was 
opened to commercial interests, it grew exponentially. More and more users plugged their 
computers into the massive network through dial-up connections, then through faster 
connections such as ISDN, cable, DSL, and other technologies. Today, the internet has 
grown into a public spiderweb of interconnected devices and networks.</p>

<p>No single entity owns the internet, and no single government has absolute authority 
over its operation. Some technical rules, and its hardware and software standards, 
are agreed upon by invested organizations, groups, businesses, and others. These 
groups help the internet remain functional and accessible. However, for the most 
part, the internet is a free and open broadcast medium of networked hardware with 
no single owner.</p>
<p>Most consumers are familiar with and comfortable with the World Wide Web. With 
its easy-to-use interface, it’s the best way to get information in a few clicks.</p>

<p>The World Wide Web was born in 1989. Interestingly enough, the web was built 
by research physicists so that they could share research findings with one 
another’s computers. Today, that idea has evolved into the greatest collection 
of human knowledge in history.</p>

<p>The credited inventor of the World Wide Web is Tim Berners-Lee.</p>

<p>You have to access the internet to view the World Wide Web and the web pages 
or other content it contains. The web is the collective name for all the pages, 
sites, documents, and other media that are served to visitors.</p>

<p>The web consists of digital documents, referred to as web pages, that
are viewable through <a href="https://www.lifewire.com/what-is-a-browser-446234" 
target="_blank" rel="noopener noreferrer">web browser</a> software on devices 
like smartphones, tablets, and computers. These pages contain many types of 
content, including static content like encyclopedia pages, but also dynamic 
content like <a href="https://www.lifewire.com/a-primer-to-ebay-basics-2483229" 
target="_blank" rel="noopener noreferrer">eBay</a> sales, stocks, weather, news, 
and traffic reports.</p>

<p>A collection of connected web pages that are publicly accessible and under a 
single domain name is referred to as a website.</p>

<p>Web pages are connected using 
<a href="https://www.lifewire.com/hypertext-transfer-protocol-817944" 
target="_blank" rel="noopener noreferrer">Hypertext Transfer Protocol</a> (HTTP), 
the coding language that allows you to visit any public web page. By clicking a 
<a href="https://www.lifewire.com/how-do-hyperlinks-work-2483287" target="_blank" 
rel="noopener noreferrer">hyperlink</a> or entering a 
<a href="https://www.lifewire.com/what-is-a-url-2626035" target="_blank" rel="noopener 
noreferrer">Uniform Resource Locator</a> (URL), the browser uses this unique address 
to find and access a web page. <a href="https://www.lifewire.com/best-search-engines-2483352" 
target="_blank" rel="noopener noreferrer">Search engines</a> like Google make it easy 
to filter the billions of web pages now populating the web by locating the articles, 
videos, and other media you want to find based on your search criteria.</p>

<h4>Final Verdict: You Can’t Have the Web Without the Internet</h4>

<p>Plain and simple, the internet allows access to the World Wide Web.  Without it, we 
have no way of accessing the thousands of websites out there. For most online needs, 
however, the web is the easiest to use.  Each serves an important purpose.</p>

<h3 id="cha-2">a.2 Why Accessibility is Important</h3>

<p><i>The power of the Web is in its universality.</i> <i>Access by everyone regardless 
of disability is an essential aspect.</i></p>

<h4>Tim Berners-Lee, W3C Director and inventor of the World Wide Web</h4>

<p>The Web has become an essential aspect of our daily lives, and everyone should have 
access to this technology. Web accessibility focuses on ensuring equivalent access for 
people with disabilities. It is increasingly important to many organizations and 
governments from around the world, and has many business benefits. Access to 
information, including on the Web, is also recognized by the UN Convention on 
the Rights of Persons with Disabilities (CRPD).</p>

<h4>Who is impacted?</h4>

<p>Web accessibility addresses all disabilities, including hearing, learning and 
cognitive, neurological, physical, speech, and visual disabilities. Some examples 
of Web accessibility features include:</p>

<ul>
  <li><i>Captions</i> on audio and multimedia content for people who are hard of hearing,</li>
  <li><i>Clear and consistent layout</i> for people with learning and cognitive disabilities,</li>
  <li><i>Keyboard support</i> for people with physical disabilities and who do not use a mouse,</li>
  <li><i>Text alternatives</i> for people with visual disabilities and who are using screen readers.</li>
</ul>

<h4>Web accessibility benefits people with and <i>without</i> disabilities</h4>

<p>Web accessibility features also benefit many more users, such as:</p>

<ul>
  <li>People with temporary situational limitations, such as a broken arm,</li>
  <li>People using mobile devices, televisions, and other access channels,</li>
  <li>People using older computers, with low bandwidth, and other limitations,</li>
  <li>People who are new to computers, to the Web, or to your own Web site,</li>
  <li>People who are not fluent in the language of your particular Web site.</li>
</ul>

<p>The Web is an increasingly important resource in many aspects of life: education, 
employment, government, commerce, health care, recreation, and more. When Web pages, 
Web technologies, Web tools, or Web applications are badly designed, they can create 
barriers that exclude people from using the Web. More information is available in the 
<a href="https://www.w3.org/standards/webdesign/accessibility" target="_blank" 
rel="noopener noreferrer">W3C Accessibility</a> overview.</p>

<h4>First Steps in Web Accessibility</h4>

<p>There are many simple Web accessibility improvements that you can implement and check 
right away, even when you are new to this topic.</p>

<p>Remember that when developing or redesigning a website or Web application, it is best 
to evaluate accessibility early and throughout the development process to identify 
accessibility problems early, when it is easier to address them.</p>

<p>Two examples are provided below but you can find more tips and information in 
these 2 resources:</p>

<ul>
  <li><a href="https://www.w3.org/WAI/gettingstarted/tips/" target="_blank" 
    rel="noopener noreferrer">Tips for Getting Started with Web Accessibility.</a></li>
  <li><a href="https://www.w3.org/WAI/test-evaluate/preliminary/" target="_blank" 
    rel="noopener noreferrer">Easy Checks - A First Review of Web Accessibility.</a></li>
</ul>

<h4>Example #1: page title</h4>

<p>Good page titles are particularly important for orientation — to help people know 
where they are and move between pages open in their browser.  The first thing screen 
readers say when the user goes to a different Web page is the page title. In the Web 
page markup, they are the words &lt;title&gt; within the &lt;head&gt;.</p>

<h5><i>Check #1</i>: There is a title that adequately and briefly describes the content 
of a page, and it distinguishes the page from other Web pages.</h5>

<p><i>Example</i>:</p>

<pre>&lt;head&gt;
  ...
  &lt;title&gt;Web Accessibility Initiative (WAI) - home page&lt;/title&gt;
  ...
&lt;/head&gt;</pre>

<h4>Example 2: image text alternatives (“alt text”)</h4>

<p>Text alternatives (“alt text”) are a primary way of making visual information accessible, 
because they can be rendered through any sensory modality (for example, visual, auditory or 
tactile) to match the needs of the user. Providing text alternatives allows the information 
to be rendered in a variety of ways by a variety of user agents. For example, a person who 
cannot see a picture can have the text alternative read aloud using synthesized speech.</p>

<h5><i>Check #2</i>: Every image has alt with appropriate alternative text.</h5>

<p><i>Example</i>: See the W3C logo below. It contains a link that points to the W3C Web 
site. The text alternative is going to be a brief description of the link target.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 11. W3C logo (13) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image011.webp"
  loading="lazy"
  title="W3C logo"
  alt="W3C logo."
  style="width:15%;" />

<p style="text-align: center;"><a href="https://www.w3.org/Icons/w3c_home" target="_blank" 
rel="noopener noreferrer">W3C Home</a></p>

<pre>&lt;a href=&quot;https://w3.org&quot;&gt;
  &lt;img src=&quot;https://w3.org/Icons/w3c_home.png&quot; width=&quot;72&quot; height=&quot;48&quot; 
    alt=&quot;World Wide Web Consortium&quot;&gt;
&lt;/a&gt;</pre>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 12. html5 logo (13) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image012.webp"
  loading="lazy"
  title="HTML5 logo"
  alt="HTML5 logo."
  style="width:7.5%;" />
<br>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Page Title&lt;/title&gt;
  &lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;
  &lt;script src=&quot;script.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  ... &lt;!-- The rest is content --&gt;</pre>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 13. new structural elements in html5 (13) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image013.webp"
  loading="lazy"
  title="Some of the new structural elements introduced by HTML5: section, article, etc"
  alt="Some of the new structural elements introduced by HTML5: section, article, etc."
  style="width:25%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch1-1-1">1.1.1 History of HTML: From HTML1.0 to HTML5.0</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>As Web site layouts evolve, HTML5 structural elements such as lists, paragraphs, 
tables, etc. show their limits.<br>
<br>Today, many Web sites offer navigation menus, tabbed panels, headers, footers, and so on.<br>
<br>The way these “parts”’ are implemented relies heavily on &lt;div&gt; 
and &lt;span&gt; elements with different id and class attributes, lots of 
CSS and lots of JavaScript code to apply custom styles and behaviors.</p>

<p>However, there are some issues with this approach:</p>

<ul>
  <li>id and class names differ from one developer to another, from one country to another, etc.</li>
  <li>Even with the same ids and class names, the css rules may be different.</li>
  <li>JavaScript libraries have become increasingly heavy over the years.</li>
  <li>Web pages have become increasingly heavy over the years!</li>
  <li>These elements can not be handled by the Web browser natively…</li>
</ul>

<p>Even if differences exist between ids, classes and css/js implementations, they also share 
common behaviors, layouts, and “ways of doing things” that could be guessed at first glance by a human.</p>

<p>So various studies have been conducted in order to identify the most popular ids, class names, 
widgets, etc. used on the Web:</p>

<p>Quoting from this <a href="https://dev.opera.com/articles/new-structural-elements-in-html5/" 
target="_blank" rel="noopener noreferrer">article: </a>“During the creation of HTML5, 
Ian Hickson used Google’s tools to mine data from over a billion Web pages, surveying 
what ids and class names are most commonly used on the real world Web. Opera did a 
similar study of 3.5 million URLs, calling it MAMA (”Metadata Analysis and Mining 
Application”). MAMA, as structural Web-paged search engine, had a smaller URL set, 
but looked at a larger and wider variety of Web page statistics”.</p>

<h3>New elements added to the HTML5 set</h3>

<p>The results of these surveys led to the addition of new structural elements in HTML5. 
For example, the very popular &lt;div class=“header”&gt; led to the creation of 
a &lt;header&gt; element, &lt;div class=“aside”&gt; to a &lt;aside&gt; element, etc.</p>

<p>Finally, the 20 most popular ids and class names found in Hickson’s and Opera’s 
surveys gave birth to these new elements (click on the element’s
name to go to the W3C specification about this element):</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch1-2-1">1.2.1 HTML5 structural elements with description</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<table>
  <tr>
    <th>HTML5 element</th>
    <th>Description</th>
  </tr>
  <tr>
    <td><a href="https://html.spec.whatwg.org/multipage/sections.html#the-header-element" 
      target="_blank" rel="noopener noreferrer">&lt;header&gt;</a></td>
    <td>Introduction of “sectioning elements”: an article, a section, the entire document (header page). 
    Typically the header of a Web site that appears on the top of each page, or a header of a long 
    &lt;article&gt; or of a long &lt;section&gt;.</td>
  </tr>
  <tr>
    <td><a href="https://html.spec.whatwg.org/multipage/sections.html#the-footer-element" 
      target="_blank" rel="noopener noreferrer">&lt;footer&gt;</a></td>
    <td>Contains the footer of a site, a long &lt;article&gt;, or a long &lt;section&gt;.</td>
  </tr>
  <tr>
    <td><a href="https://html.spec.whatwg.org/multipage/sections.html#the-nav-element" 
      target="_blank" rel="noopener noreferrer">&lt;nav&gt; </a></td>
    <td>Section that contains the main navigation links (within the document or to other pages).</td>
  </tr>
  <tr>
    <td><a href="https://html.spec.whatwg.org/multipage/sections.html#the-article-element" 
      target="_blank" rel="noopener noreferrer">&lt;article&gt;</a></td>
    <td>Independent content, which can be individually extracted from the document and 
    syndicated (RSS or equivalent) without penalizing its understanding. Typically a blog post.</td>
  </tr>
  <tr>
    <td><a href="https://html.spec.whatwg.org/multipage/sections.html#the-section-element" 
      target="_blank" rel="noopener noreferrer">&lt;section&gt;</a></td>
    <td>Generic section used to group different articles for different purposes 
      or subjects, or to define the different sections of a single article.  Generally used with a header.</td>
  </tr>
  <tr>
    <td><a href="https://html.spec.whatwg.org/multipage/sections.html#the-time-element" 
      target="_blank" rel="noopener noreferrer">&lt;time&gt;</a></td>
    <td>Used for marking up times and dates.</td>
  </tr>
  <tr>
    <td><a href="https://html.spec.whatwg.org/multipage/sections.html#the-aside-element" 
      target="_blank" rel="noopener noreferrer">&lt;aside&gt;</a></td>
    <td>Section whose content is not necessarily directly related to the main content 
      that surrounds it, but can provide additional information.</td>
  </tr>
  <tr>
    <td><a href="https://html.spec.whatwg.org/multipage/sections.html#the-figure-element" 
      target="_blank" rel="noopener noreferrer">&lt;figure&gt;</a> and 
      <a href="https://html.spec.whatwg.org/multipage/sections.html#the-figcaption-element" 
      target="_blank" rel="noopener noreferrer">&lt;figcaption&gt;</a></td>
    <td>Used to encapsulate a figure as a single item, and contains a caption for 
      the figure, respectively.</td>
  </tr>
  <tr>
    <td><a href="https://html.spec.whatwg.org/multipage/sections.html#the-main-element" 
      target="_blank" rel="noopener noreferrer">&lt;main&gt;</a></td>
    <td>The main element represents the main content of the body of a document 
      or application. The main content area consists of content that is directly 
      related to or expands upon the central topic of a document or central 
      functionality of an application. <b>There can be only one &lt;main&gt; 
      element in a document</b>.</td>
  </tr>
</table>

<p>And there is no &lt;content&gt; element even though the &lt;div class=“content”&gt; 
was very popular. Instead, the HTML5 group decided that anything not embedded in one of 
the elements from the above table is “default content”.</p>

<p>If the content is of a type that corresponds to one of the elements from the table, 
i.e. if the content is an article, it should be embedded between &lt;article&gt; and 
&lt;/article&gt;.</p>

<p>Read also at the end of this section about the new &lt;main&gt; element.
This element is <a href="https://www.w3.org/TR/html5/grouping-content.html#the-main-element" 
target="_blank" rel="noopener noreferrer">part of the HTML5 recommendation</a> 
and an integral part of the HTML document structure.</p>

<h4>External resources:</h4>

<ul>
  <li>A Smashing Magazine article: <a href="https://coding.smashingmagazine.com/2013/01/18/the-importance-of-sections/" 
    target="_blank" rel="noopener noreferrer">Structural Semantics: The 
    Importance Of HTML5 Sectioning Elements</a>.</li>
  <li>A Dev. Opera article: <a href="https://dev.opera.com/articles/new-structural-elements-in-html5/" 
    target="_blank" rel="noopener noreferrer">New Structural Elements 
    in HTML5</a>.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch1-3-1">1.3.1 A Blog Example: Mixing All Elements Together</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>A blog example that uses the structural elements</h4>

<p>Let’s study <a href="https://jsbin.com/bucokav/edit?html,output" 
target="_blank" rel="noopener noreferrer">an example we put on JSBin</a> 
(all examples we have cooked up are available on the jsbin.com Web site 
and can be modified freely: you can save your own version using the 
“Bins/create milestone” menu, share your version with others in the 
forums, etc. Don’t  hesitate to play with the source code, you will 
never break anything).</p>

<h4>Use a &lt;header&gt; at the top of the blog</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 14. image of 'simple html5 blog' header (35) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/bucokav/edit?html,output" 
target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image014.webp"
  loading="lazy"
  title="Image of the header element at the top of the blog"
  alt="Image of the header element at the top of the blog."
  style="width:35%;" /></a>

<p>This is an example of one way to organize a blog. Here, we have designed the 
HTML page using a &lt;header&gt; element that contains the “Simple HTML5 blog” 
text that appears on top of the page.</p>

<h4>HTML code:</h4>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;title&gt;Simple HTML5 blog&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;header&gt;
    &lt;h1&gt;Simple &lt;span&gt;HTML5&lt;/span&gt; blog&lt;/h1&gt;
  &lt;/header&gt;
...</pre>

<h4>The CSS rules we used:</h4>

<pre>header {
  color: #007e99;
  font-size: 2.5em;
  padding: 20px 50px
}
header span {
  color: #722
}</pre>

<h4>Use a &lt;nav&gt; for the navigation menu just below the header</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 15. image of the navigation menu (36) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image015.webp"
  loading="lazy"
  title="Image of the navigation menu"
  alt="Image of the navigation menu."
  style="width:35%;" />
  
<p>The navigation menu just below the header is a &lt;nav&gt; element. For the 
purpose of this example we haven’t provided any value for the hyperlinks…</p>

<br/>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;title&gt;Simple HTML5 blog&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;header&gt;
    &lt;h1&gt;Simple &lt;span&gt;HTML5&lt;/span&gt; blog&lt;/h1&gt;
  &lt;/header&gt;
  &lt;nav&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;span&gt;Blog&lt;/span&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;&quot;&gt;About&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;&quot;&gt;Contact&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
   &lt;/nav&gt;</pre>

</details>

<h4>And here is the CSS we used in this example for the &lt;nav&gt; element:</h4>

<details>
  <summary><b>CSS source code:</b></summary>

<pre>nav {
  font-size: 1.5em;
  margin: 5px 0;
  padding: 20px 50px
}
nav li {
  display: inline;
  margin: 0 15px
}
nav li:first-child {
  margin-left: 0
}
* html nav ul {
  margin-left: -15px
}
nav span, nav a {
  padding: 3px 15px 4px
}
nav span {
  background: #722;
  color: #fff
}</pre>

</details>

<h4>A &lt;section&gt; for each month and an &lt;article&gt; for each post in the blog</h4>

<p>Now, we have one big &lt;section&gt; element that contains a set of &lt;article&gt; elements…</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 16. image of sections that contain articles (37) ~~~~~~~~~~~~~~~~~~~~~~-->
<p>
<img class="displayed"
  src="./images/image018.webp"
  loading="lazy"
  title="Image of figure and figcaption that embed an img"
  alt="Image of figure and figcaption that embed an img."
  style="width:30%;" />
<img class="displayed"
  src="./images/image015.webp"
  loading="lazy"
  title="Image of the navigation menu"
  alt="Image of the navigation menu."
  style="width:30%;" />
<img class="displayed"
  src="./images/image016.webp"
  loading="lazy"
  title="Image of sections that contain articles"
  alt="Image of sections that contain articles."
  style="width:30%;" />
</p>

<h4>HTML code:</h4>

<pre>&lt;section&gt;
  &lt;article&gt;
    ...
  &lt;/article&gt;
  &lt;article&gt;
    ...
  &lt;/article&gt;
  &lt;article&gt;
    ...
  &lt;/article&gt;
&lt;/section&gt;</pre>

<br/>

<details>
  <summary><b>CSS source code:</b></summary>

<pre>section {
  float: left;
  padding: 35px 0;
  position: relative;
  width: 70%
}
section article {
 margin: 0 50px 40px;
 padding: 25px 0 0;
  position: relative
}
section header {
  font-size: 1em;
  padding: 0;
}
section h2 {
  font-size: 2.3em;
}</pre>

</details>

<p>Note that the H2, article, article header, etc. will be styled using these rules.</p>

<h4>Add a &lt;header&gt; at the beginning of each &lt;article&gt;</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~ 17. image of the header at the top of each article (37) ~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image017.webp"
  loading="lazy"
  title="Image of the header at the top of each article"
  alt="Image of the header at the top of each article."
  style="width:35%;" />
  
<p>Next, in each article in the section we have a header (to display the
article title), paragraphs (article content), and so on.</p>

<h4>Example for the first blog article:</h4>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;section&gt;
  &lt;article&gt;
    &lt;header&gt;
      &lt;h2&gt;&lt;a href=&quot;&quot;&gt;Information about this example&lt;/a&gt;&lt;/h2&gt;
    &lt;/header&gt;
    &lt;p&gt;Try to move the mouse on different elements. The structure will be
      highlighted and you will be able
      to see the different inclusions of elements one in each other. If you
      move the cursor to this sentence, it will be highlighted in dark grey,
      showing the presence of an &lt;article&gt; element, surrounded by a
      &lt;section&gt; element (light grey), etc. So we have some articles in
      a single section element. The page title at the top is a &lt;header&gt;
      element, while the tag cloud on the right is a &lt;aside&gt; element. The
      main menu on top (with Blog, About, Contact) is a &lt;nav&gt; element.&lt;/p&gt;
    &lt;figure&gt;
      &lt;img src=&quot;HTML5-tags.png&quot;
        alt=&quot;Example of HTML5 structural tags&quot; /&gt;
        &lt;figcaption&gt;
          Fig. 1 : an example of how new structural elements could
          be used. This page put a &lt;nav&gt; on top, and does not have
          headers and footer for each article, like in this figure,
          but it could... By the way this is a
        &lt;figcaption&gt; inside a &lt;figure&gt; element...
        &lt;/figcaption&gt;
    &lt;/figure&gt;
  &lt;/article&gt;
  ...
&lt;/section&gt;</pre>

</details>

<h4>Use &lt;figure&gt; and &lt;figcaption&gt; and embed &lt;img&gt; inside</h4>

<p>Also note the way we included a figure using the new “HTML5” method, using a &lt;figure&gt;..&lt;figure&gt; element that embedded a &lt;img src=…&gt; element together with a &lt;figcaption&gt; element.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~ 18. image of figure and figcaption that embed an img (38) ~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image018.webp"
  loading="lazy"
  title="Image of figure and figcaption that embed an img"
  alt="Image of figure and figcaption that embed an img."
  style="width:35%;" />
  
<p>Here is the CSS for the &lt;figcaption&gt; element we have used in the
example (we did not apply any style to the &lt;figure&gt; element):</p>

<h4>HTML code:</h4>

<pre>&lt;figure&gt;
  &lt;img src=&quot;HTML5-tags.png&quot;
  alt=&quot;Example of HTML5 structural tags&quot; /&gt;
  &lt;figcaption&gt;
    Fig. 1 : an example of how .....
  &lt;/figcaption&gt;
&lt;/figure&gt;</pre>

<h4>CSS code:</h4>

<pre>figcaption {
  font-style:italic;
  font-size: 0.8em;
  width: 100%
}</pre>

<h4>Use an &lt;aside&gt; element to display a tag cloud on the… side of the main content</h4>

<p>After the long &lt;section&gt; element that contains all the blog
articles displayed in the page, we added the HTML code for the tag cloud
that is displayed on the right of the page, “aside”! This is done using
- you already guessed it - an &lt;aside&gt; element:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~ 19. image of the tag cloud defined as an aside element (39) ~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image019.webp"
  loading="lazy"
  title="image of the tag cloud defined as an aside element"
  alt="image of the tag cloud defined as an aside element."
  style="width:25%;" />

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;section&gt;
  .... all &lt;article&gt;... &lt;/article&gt; here....
&lt;/section&gt;
&lt;aside&gt;
  &lt;h2&gt;Tag cloud&lt;/h2&gt;
  &lt;ul class=&quot;tag-cloud&quot;&gt;
    &lt;li&gt;&lt;a href=&quot;&quot; rel=&quot;tag&quot; class=&quot;w2&quot;&gt;ajax&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;&quot; rel=&quot;tag&quot; class=&quot;w8&quot;&gt;apple&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;&quot; rel=&quot;tag&quot; class=&quot;w3&quot;&gt;css&lt;/a&gt;&lt;/li&gt;
    ...
  &lt;/ul&gt;
&lt;/aside&gt;
...</pre>

</details>

<p>We are not going to show the complete CSS here as it uses some tricks to
display the list as a “real tag cloud” that uses JavaScript for handling
events, etc. Those who are curious can look at
<a href="https://jsbin.com/bucokav/edit?html,output" target="_blank" rel="noopener noreferrer">the
code of the online example</a>.</p>

<h4>Here is the CSS for the &lt;aside&gt; element:</h4>

<details>
  <summary><b>CSS source code:</b></summary>

<pre>aside {
  float: right;
  padding: 70px 0 30px;
  position: relative;
  width: 25%
}
aside h2 {
  color: #888;
  font-size: 1.8em
}
aside .tag-cloud {
  padding: 15px 35px 10px 0;
  text-align: center
}
...</pre>

</details>

<p>We used a float:right CSS rule to put the tag cloud on the right… In a
following section we will provide several examples that explain how to
make a nice layout with the new structural elements, using simple CSS
rules.</p>

<h4>Here is the result:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~ 19. image of the tag cloud defined as an aside element (40) ~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image019.webp"
  loading="lazy"
  title="The aside tag cloud on the right"
  alt="The aside tag cloud on the right."
  style="width:30%;" />

<h4>Add a &lt;footer&gt; at the end of the blog</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~ 20. image of the tag cloud defined as an aside element (40) ~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image020.webp"
  loading="lazy"
  title="Image of the blog footer"
  alt="Image of the blog footer."
  style="width:25%;" />

<h4>Finally, we added a &lt;footer&gt; element (<i>lines 12-14</i> below)
after the tag cloud definition, to display a page footer:</h4>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;html&gt;
...
&lt;body&gt;
  ...
  &lt;section&gt;
    ...
  &lt;/section&gt;
  &lt;aside&gt;
    ...
  &lt;/aside&gt;
  &lt;footer&gt;
    &lt;p&gt;&amp;copy; 2009 Some blog&lt;/p&gt;
  &lt;/footer&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>With this CSS rule:</h4>

<pre>footer {
  clear: both;
  color: #777;
  padding: 10px 50px
}</pre>

<h4><b>And here is the result at the bottom of the page:</b></h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~ 22. the resulting footer at the bottom of the page (41) ~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image022.webp"
  loading="lazy"
  title="The resulting footer at the bottom of the page"
  alt="The resulting footer at the bottom of the page."
  style="width:35%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3>1.3.4 More on &lt;article&gt; and &lt;section&gt;</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Can an &lt;article&gt; contain a &lt;section&gt;?</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~ 23. pictures of eisher hands (41) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image023.webp"
  loading="lazy"
  title="Picture of 'eisher' hands"
  alt="Picture of 'eisher' hands."
  style="width:25%;" />

<p>It may not be clear whether a &lt;section&gt; may contain one or several
&lt;article&gt; elements or if an &lt;article&gt; may contain one or
several &lt;section&gt; elements.</p>

<ul>
  <li>The &lt;article&gt; element was designed for stand-alone parts of a
    document that could eventually be syndicated in RSS streams.</li>
  <li>&lt;section&gt; elements are used to cut a logical part into subparts.</li>
</ul>

<h4>An &lt;article&gt; may be cut into different &lt;section&gt; elements!</h4>

<h4>Example of a blog post defined as a long &lt;article&gt;, that is in
turn cut into smaller &lt;section&gt; elements:</h4>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;article id=&quot;id1&quot;&gt;
  &lt;section id=&quot;id1part1&quot;&gt;
    &lt;h2&gt;Introduction&lt;/h2&gt;
  &lt;/section&gt;
  &lt;section id=&quot;id1part2&quot;&gt;
    &lt;h2&gt;My travel to India&lt;/h2&gt;
  &lt;/section&gt;
  &lt;section id=&quot;id1part3&quot;&gt;
    &lt;h2&gt;Return to France&lt;/h2&gt;
  &lt;/section&gt;
&lt;/article&gt;</pre>

</details>

<p>The blog example from the previous part of the course, on the other hand, uses 
a single &lt;section&gt; that contains several &lt;article&gt; elements. Indeed, 
we can also have a &lt;section&gt; that regroups all blog posts per month, each 
one being an &lt;article&gt; element.</p>

<h4>A &lt;section&gt; may be cut into different &lt;article&gt; elements, too!</h4>

<h4>Can you put a &lt;nav&gt; in an &lt;article&gt;?</h4>

<p>Yes, you can, in case you would like to propose some navigation links
with each blog post, for example:</p>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;article&gt;
  &lt;header&gt;
    &lt;h1&gt;Blog post title&lt;/h1&gt;
    &lt;p&gt;Author: Michel&lt;/p&gt;
  &lt;/header&gt;
  &lt;nav&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;...&quot;&gt;Next post&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;...&quot;&gt;Previous post&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;...&quot;&gt;Contact author&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/nav&gt;
  &lt;p&gt;Content...&lt;/p&gt;
  &lt;footer&gt;
    &lt;p&gt;Posted by Michel, the &lt;time datetime=&quot;2012-02-02&quot;&gt;February 2,
    2012&lt;/time&gt; &lt;/p&gt;
  &lt;/footer&gt;
&lt;/article&gt;</pre>

</details>

<p>In that case, the &lt;nav&gt; element proposes navigation links to
the next or previous blog post, as well as a link to contact the author
of the blog post.</p>
<p>Also note that we used in that example a &lt;footer&gt; element in the blog post.</p>

<h4>What about the &lt;div&gt; element? Is it still useful?</h4>
<p>The new elements have been primarily designed to better structure the
code of HTML pages such as those generated by blog or CMS software,
however do not forget that they add new semantics and will be taken into
account by:</p>

<ul>
  <li>Browsers natively or browsers’ extensions, i.e. for
    automatically generating a table of contents, an outline view of
    the document, for applying default CSS rules to these elements, etc. See
    for example the <a href="https://chrome.google.com/webstore/detail/table-of-contents-crx/eeknhipceeelbgdbcmchicoaoalfdnhi?hl=f" 
    target="_blank" rel="noopener noreferrer">
    table-of-contents-crx extension</a> (Chrome extension). More on that in the next section of the course.</li>
  <li>Text to speech: <a href="https://www.w3.org/WAI/perspective-videos/speech/" 
    target="_blank" rel="noopener noreferrer">
    Perspective Video Speech</a></li>
  <li>Web crawlers, etc.</li>
</ul>

<p>You can use &lt;div&gt; elements in all cases where the proposed
structural elements do not fit your needs: for defining some content
that should be styled, for example.</p>

<p>This chart from the <a href="https://html5doctor.com/" target="_blank" rel="noopener noreferrer">
HTML5 Doctor Web site</a> may help you decide whether or not to use a &lt;div&gt;:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 24. chart from html5 doctor web site (43) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image024.webp"
  loading="lazy"
  title="Flow chart about using header, H1, etc"
  alt="Flow chart about using header, H1, etc."
  style="width:35%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3>1.3.5 Headings and Structural Elements</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>We will now present some best practices for starting to
use &lt;section&gt;, &lt;article&gt;, &lt;nav&gt;, &lt;aside&gt;, in
particular concerning the use of headings (h1, h2, h3, h4, h5 and h6).</p>

<h4>Use &lt;h1&gt;…&lt;h6&gt; for the headings</h4>

<p>Since the very beginning, HTML has had heading
elements: &lt;h1&gt;…&lt;h6&gt;. These elements are used to display
headings with different sizes by default, when no CSS is used.  The
following example shows 6 sentences that are surrounded by &lt;h1&gt;,
&lt;h2&gt;, &lt;h3&gt;, &lt;h4&gt;, &lt;h5&gt; and &lt;h6&gt;:</p>

<h1>This is a H1 heading</h1>
<h2>This is a H2 heading</h2>
<h3>This is a H3 heading</h3>
<h4>This is a H4 heading</h4>
<h5>This is a H5 heading</h5>
<h6>This is a H6 heading</h6>

<p>These headings define a hierarchy, as shown by the default sizes given by the 
browser. This hierarchy can also be used to define an outline of the document. 
To illustrate this, we have used a browser extension. Here is the result for the 
previous example:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 25. headings 1 thru 6 (44) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image025.webp"
  loading="lazy"
  title="Outliner in action from the previous example"
  alt="Outliner in action from the previous example."
  style="width:35%;" />

<p>In the above outline, note that we have only used H1… H6 elements, without 
any new HTML5 structural elements such as &lt;section&gt; or &lt;article&gt;.</p>

<p>Here is a list of browser extensions you can try, for visualizing the
outline of a document: 
<a href="https://chrome.google.com/webstore/detail/table-of-contents-crx/eeknhipceeelbgdbcmchicoaoalfdnhi?hl=f" 
target="_blank" rel="noopener noreferrer">table-of-contents-crx</a> Chrome
extension
or <a href="https://addons.mozilla.org/fr/firefox/addon/outline-sidebar/?src=search" 
target="_blank" rel="noopener noreferrer">this Firefox extension</a>.</p>

<h4>Using headings and new sectioning elements (section, article, aside, nav)</h4>

<h4>Definition of heading content and sectioning content</h4>

<p>The &lt;section&gt;, &lt;article&gt;,
&lt;nav&gt; and &lt;aside&gt; elements are called “sectioning elements”.
They cut a document into slices we call “sections”.</p>

<p>The HTML5 specification says that “each sectioning element potentially
has a heading and has also an outline associated”.</p>

<p>&lt;h1&gt; … &lt;h6&gt;</p>

<p>are called <b>headings</b>, and define the header of a section
(whether explicitly marked up using sectioning content elements, or
implied by the heading content itself). This means that:</p>

<pre class="html5">&lt;body&gt;
  &lt;h1&gt;Title of my document&lt;/h1&gt;
  ...
&lt;/body&gt;</pre>

<h4>… defines the header of a section <i>implicitly</i>, while:</h4>

<pre class="html5">&lt;body&gt;
  ...
  &lt;section&gt;
    &lt;h1&gt;Title of my section&lt;/h1&gt;
    ...
  &lt;/section&gt;
&lt;/body&gt;</pre>

<h4>… defines the heading of <i>the explicit section</i> (its parent element &lt;section&gt;)</h4>

<h4>Use multiple headings of different rank with sectioning content</h4>

<p>The first element of a heading content in an element of sectioning
content represents the heading for that section
(the &lt;section&gt;&lt;h1&gt;…&lt;/h1&gt;&lt;/section&gt; in the above
example).</p>

<p>Subsequent headings of equal or higher rank start new (implied)
sections, headings of lower rank start implied subsections that are part
of the previous one. In both cases, the element represents the heading
of the implied section.</p>

<h4>Let’s clarify this by looking at some example code:</h4>

<details>
  <summary><b>HTML source code:</b></summary>

<pre class="html5">&lt;body&gt;
&lt;section&gt;
  &lt;h1&gt;This H1 is the heading of an explicit section&lt;/h1&gt;
  ...
  &lt;h2&gt;This H2 is a subheading, part of the same section
    (lower rank)&lt;/h2&gt;
  ....
  &lt;h1&gt;This H1 starts an implicit new section in the explicit
    section (equal or higher rank)&lt;/h1&gt;
  ...
  &lt;h2&gt;This is a H2 heading in the new section that has
    just started&lt;/h2&gt;
  ...
&lt;/section&gt;
&lt;/body&gt;</pre>

</details>

<h4>The corresponding outline is:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 26. outline of previous example (45) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image026.webp"
  loading="lazy"
  title="Outline of previous example"
  alt="Outline of previous example."
  style="width:35%;" />

<p>In the above example, please note two things:</p>

<ol type="1">
  <li>The outline shows an “Untitled body” at the root of the hierarchy,</li>
  <li>The default size for the H1 and H2 is the same (!). Indeed, when we
    start a &lt;h1&gt; inside a &lt;section&gt; the browser lowers
    its default size automatically, as if a new hierarchy level has been
    added artificially. We will discuss this further in the following
    sections, as we introduce some best practices.</li>
</ol>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3>1.3.6 Best Practices When Using Sectioning Elements</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Best practice #1: always add a heading to explicit sectioning content</h4>

<p>It’s always better - mainly for accessibility reasons - to include a
heading (a &lt;h1&gt;, &lt;h2&gt;…&lt;h6&gt;) in each sectioning element
(&lt;section&gt;, &lt;article&gt;, &lt;nav&gt;, &lt;aside&gt;), but also
after the &lt;body&gt; element (called a “sectioning root”).</p>

<h4>Here are some examples:</h4>

<h4>Good (heading in each explicit section):</h4>

<pre class="html5">&lt;section&gt;
  &lt;h1&gt;Blog post of April 2020&lt;/h1&gt;
  ...
&lt;/section&gt;</pre>

<h4>Good (heading in a &lt;header&gt; does not change anything):</h4>

<pre class="html5">&lt;section&gt;
  &lt;b&gt;&lt;header&gt;&lt;/b&gt;
  &lt;b&gt;&lt;h1&gt;Blog post of April 2020&lt;/h1&gt;&lt;/b&gt;
  &lt;b&gt;&lt;p&gt;Posted by Michel Buffa...&lt;/p&gt;&lt;/b&gt;
  &lt;b&gt;&lt;/header&gt;&lt;/b&gt;
...
&lt;/section&gt;</pre>

<h4>Bad (there is no Hx after the &lt;section&gt; - no heading):</h4>

<pre class="html5">&lt;section&gt;
  &lt;header&gt;
    &lt;p class=&quot;article title&quot;&gt;Blog post of April 2020&lt;/p&gt;
    &lt;p&gt;Posted by Michel Buffa...&lt;/p&gt;
  &lt;/header&gt;
  ...
&lt;/section&gt;</pre>

<p>The last example is bad for accessibility reasons. A screen reader
that vocalizes the page will just say “Entering section”, while in the
previous two good examples it would say “entering section with heading
Blog Posts of April 2020”. You can also check if your headings and
sectioning elements are ok by using a browser extension that displays
the outline of the document (just search for “html5 outliner” in your
browser’s extension search engine).</p>

<p><b>UPDATE:</b> For the course screenshots, we used the Google Chrome
HTML5 outliner extension that is no more available (it has been removed
by its developer), but you can use any other equivalent extension such
as <a href="https://chrome.google.com/webstore/detail/table-of-contents-crx/eeknhipceeelbgdbcmchicoaoalfdnhi?hl=f" 
target="_blank" rel="noopener noreferrer">table-of-contents-crx</a> for Chrome or 
<a href="https://addons.mozilla.org/fr/firefox/addon/outline-sidebar/?src=search" 
target="_blank" rel="noopener noreferrer">Outline sidebar</a> for Firefox.</p>

<h4>The outline of the last example looks like this;</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 27. outline of the last example (46) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image027.webp"
  loading="lazy"
  title="Outline of last example"
  alt="Outline of last example."
  style="width:35%;" />

<p>Notice that &lt;body&gt; is also a sectioning element. It’s called a
“sectioning root”, and would also need a heading.</p>

<h4>Final good version:</h4>

<pre class="html5">&lt;body&gt;
  &lt;b&gt;&lt;h1&gt;Example Blog&lt;/h1&gt;&lt;/b&gt;
  &lt;section&gt;
    &lt;header&gt;
      &lt;b&gt;&lt;h2&gt;Blog post of April 2020&lt;/h2&gt;&lt;/b&gt;
      &lt;p&gt;Posted by Michel Buffa...&lt;/p&gt;
    &lt;/header&gt;
    &lt;p&gt;Content of the blog post...&lt;/p&gt;
  &lt;/section&gt;
&lt;/body&gt;</pre>

<p>The sectioning root (&lt;body&gt;) and the sectioning elements
(&lt;section&gt; here…), each have a heading.</p>
<h4>To sum up:</h4>

<ul>
  <li>Always use a heading element after a sectioning element, for example 
    &lt;section&gt;&lt;Hx&gt;…&lt;Hx&gt;…&lt;section&gt;, and after &lt;body&gt;, 
    where x can be 1..6,</li>
  <li>Or, use a &lt;header&gt; element, like in &lt;section&gt;&lt;header&gt;&lt;Hx&gt; 
    …&lt;Hx&gt;…..&lt;header&gt;…&lt;section&gt;</li>
</ul>

<h4>More about the &lt;header&gt; element</h4>

<p>The &lt;header&gt; element is just a container. It is not taken into
account for defining new sections of a document nor does it affect the
hierarchy levels.</p>

<p>You can use heading elements &lt;h1&gt;…&lt;h6&gt; in
a &lt;header&gt; but be careful if you use more than one, as the rules
explained in the previous part of the course will apply and may generate
implicit “sections” in the header.</p>

<h4>This example has two headings in the &lt;header&gt;:</h4>

<pre class="html5">&lt;section&gt;
  &lt;header&gt;
    &lt;h1&gt;Some text in a h1 in a header of a section&lt;/h1&gt;
    &lt;h2&gt;This a h2 in the header...&lt;/h2&gt;
  &lt;/header&gt;
&lt;/section&gt;</pre>

<p>Here is the resulting table of contents, notice the two subsections that
appear, one for the H1, one for the H2:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 28. example structural elements (47) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image028.webp"
  loading="lazy"
  title="Example structural elements"
  alt="Example structural elements."
  style="width:35%;" />

<p>Indeed, HTML does not have a dedicated mechanism for marking up
subheadings, alternative titles or taglines. </p>

<p>If you do not want the subtitles to be included in the table of
contents, just use standard markup, for example &lt;p&gt; elements, as
shown in the next example. Of course, CSS rules can be applied to change
colors, sizes, etc.</p>

<pre class="html5">&lt;header&gt;
  &lt;h1&gt;HTML 5.1 Nightly&lt;/h1&gt;
  &lt;p&gt;A vocabulary and associated APIs for HTML and XHTML&lt;/p&gt;
  &lt;p&gt;Editor&#39;s Draft 9 May 2013&lt;/p&gt;
&lt;/header&gt;</pre>

<h4>Best practice #2: try not to rely on implicit sectioning,
use &lt;section&gt;, &lt;article&gt;, etc. instead of
just &lt;h1&gt;…&lt;h6&gt;</h4>

<p>The example below defines several implicit “sections” by
using &lt;Hx&gt; directly (at <i>lines 7 and 9</i>):</p>

<h4>Ok version (no explicit sections everywhere):</h4>

<details>
  <summary><b>HTML source code:</b></summary>

<pre class="html5">&lt;body&gt;
&lt;h4&gt;Apples&lt;/h4&gt;
&lt;p&gt;Apples are fruit.&lt;/p&gt;
&lt;section&gt;
  &lt;h2&gt;Taste&lt;/h2&gt;
  &lt;p&gt;They taste lovely.&lt;/p&gt;
  &lt;h6&gt;Sweet&lt;h6&gt;
  &lt;p&gt;Red apples are sweeter than green ones.&lt;/p&gt;
  &lt;h1&gt;Color&lt;/h1&gt;
  &lt;p&gt;Apples come in various colors.&lt;/p&gt;
&lt;/section&gt;
&lt;/body&gt;</pre>

</details>

<h4>Better version (best practice):</h4>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;body&gt;
&lt;h1&gt;Apples&lt;/h1&gt;
&lt;p&gt;Apples are fruit.&lt;/p&gt;
&lt;section&gt;
  &lt;h2&gt;Taste&lt;/h2&gt;
  &lt;p&gt;They taste lovely.&lt;/p&gt;
  &lt;section&gt;
    &lt;h3&gt;Sweet&lt;/h3&gt;
    &lt;p&gt;Red apples are sweeter than green ones.&lt;/p&gt;
  &lt;/section&gt;
&lt;/section&gt;
&lt;section&gt;
  &lt;h2&gt;Color&lt;/h2&gt;
  &lt;p&gt;Apples come in various colors.&lt;/p&gt;
&lt;/section&gt;
&lt;/body&gt;</pre>

</details>

<h5>Both of the examples above are semantically identical and produce the
same outline:</h5>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~ 29. best practice example of section (article) (48) ~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image029.webp"
  loading="lazy"
  title="Best Practice example of section"
  alt="Best Practice example of section."
  style="width:35%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3>1.3.7 Embedding a Table of Contents</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Here we propose a small piece of JavaScript code you can use in your
documents to display an embedded table of contents. </p>
<p>This example is a simple document, with a hyperlink that, once clicked,
displays the table of contents in an &lt;aside&gt; element in the
main &lt;section&gt;. Just look at the source code and copy/paste the
link into your own HTML documents.</p>

<p><a href="https://jsbin.com/tolagec/1/edit?html,css,js,output" target="_blank" 
rel="noopener noreferrer">Online example at JSBin</a>.</p>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;body&gt;
&lt;h1&gt;This is an example of embedded table of content&lt;/h1&gt;
&lt;section&gt;
  &lt;header&gt;
    &lt;h1&gt;First section of the document (this is a h1)&lt;/h1&gt;
      This is a subheading...
  &lt;/header&gt;
  &lt;h2&gt;First subsection of the first section (a h2)&lt;/h2&gt;
  &lt;p&gt;Blah Blah...&lt;/p&gt;
&lt;/section&gt;
&lt;section&gt;
  &lt;h1&gt;Second section of the document (a h1)&lt;/h1&gt;
  &lt;h2&gt;First subsection (a h2)&lt;/h2&gt;
&lt;/section&gt;
&lt;aside&gt;
  &lt;h3&gt;Table of contents&lt;/h3&gt;
  &lt;a href=&quot;javascript:(function(){...})();&quot;
    title=&quot;TableDeMatiere&quot;&gt;
      Click here to display the table of contents!
  &lt;/a&gt;
&lt;/aside&gt;
&lt;/body&gt;</pre>

</details>

<p><b>Best practice</b>: visualizing the table of contents is useful for debugging 
the structure of your page, and checking the presence of headings after sectioning content.</p>

<p>Indeed, tools that generate the table of contents are a good way to debug the 
structure of your page. Is the hierarchy correct? Is it what I wanted when I 
designed my page?</p>

<p>They are also useful for checking the presence of headings in each sectioning 
content. If some headings are missing, the table of contents will display some 
"untitled entries". Remember that having a heading after each sectioning content 
is a good practice in terms of accessibility.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3>1.3.8 The &lt;main&gt; Element</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 31. the main element (49) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image031.webp"
  loading="lazy"
  title="Main element, Earth, Water, Fire, Space &amp; Air"
  alt="Main element, Earth, Water, Fire, Space &amp; Air."
  style="width:25%;" />
  
<p>If you use &lt;nav&gt; / &lt;header&gt; / &lt;footer&gt; etc. to
structure your document, you can also use &lt;main&gt; to identify the
main content of the document. Doing so provides a navigable document
structure for assistive technology users as well as styling hooks for
devs.</p>

<p>We have seen the different sectioning elements of HTML5, so why didn’t we talk 
about the &lt;main&gt; element earlier in this part of the course? Shouldn’t 
&lt;main&gt;…&lt;/main&gt; be used in place of &lt;div class="main"&gt;…&lt;/div&gt;?</p>

<p>The &lt;main&gt; element is supported by major modern browsers (see the 
corresponding <a href="https://caniuse.com/#feat=mdn-html_elements_main" 
target="_blank" rel="noopener noreferrer">support
table</a> on CanIUse and <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/main#Browser_compatibility" 
target="_blank" rel="noopener noreferrer">MDN’s brower compatibility page</a>.</p>

<p>This element is subject to some constraints:</p>

<ul>
  <li>There must not be more than one &lt;main&gt; element in a document,</li>
  <li>It must not be a descendant of an &lt;article&gt;,&lt;aside&gt;,
    &lt;footer&gt;, &lt;header&gt;, or &lt;nav&gt; element.</li>
</ul>

<p>And finally, here are some examples 
(from <a href="https://www.w3.org/TR/html5/grouping-content.html#the-main-element" 
target="_blank" rel="noopener noreferrer">the HTML5 specification</a>) that mix 
the &lt;main&gt; element with the other sectioning elements already seen in the 
course:</p>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!-- other content --&gt;
  
&lt;main&gt;
  
  &lt;h1&gt;Skateboards&lt;/h1&gt;
  &lt;p&gt;The skateboard helps kids to get around.&lt;/p&gt;
  
  &lt;article&gt;
    &lt;h2&gt;Longboards&lt;/h2&gt;
    &lt;p&gt;Longboards are a type of skateboard with a longer
      wheelbase and larger, softer wheels.&lt;/p&gt;
    &lt;p&gt;... &lt;/p&gt;
    &lt;p&gt;... &lt;/p&gt;
  &lt;/article&gt;
 
  &lt;article&gt;
    &lt;h2&gt;Electric Skateboards&lt;/h2&gt;
    &lt;p&gt;These no longer require the propelling of the skateboard by means of the feet; rather an electric motor propels the board, fed by an electric battery.&lt;/p&gt;
    &lt;p&gt;... &lt;/p&gt;
    &lt;p&gt;... &lt;/p&gt;
  &lt;/article&gt;
 
&lt;/main&gt;
  
&lt;!-- other content --&gt;</pre>

</details>

<p>Here is another example (also from the specification). Here the &lt;main&gt; 
element contains a &lt;nav&gt; element consisting of links to subsections of the 
main content:</p>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
  &lt;html lang=&quot;en&quot;&gt;
    &lt;head&gt;
      &lt;meta charset=&quot;utf-8&quot;/&gt;
      &lt;title&gt;Graduation Ceremony Summer 2022&lt;/title&gt;
    &lt;/head&gt;
  &lt;body&gt;
    &lt;header&gt;The Lawson Academy:
      &lt;nav&gt;
        &lt;h2&gt;Click these links to navigate...&lt;/h2&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;courses.html&quot;&gt;Courses&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;fees.html&quot;&gt;Fees&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a&gt;Graduation&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/nav&gt;
    &lt;/header&gt;
    &lt;main&gt;
      &lt;h1&gt;Graduation&lt;/h1&gt;
      &lt;nav&gt;
        &lt;h2&gt;Please choose:&lt;/h2&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#ceremony&quot;&gt;Ceremony&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#graduates&quot;&gt;Graduates&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#awards&quot;&gt;Awards&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/nav&gt;
      &lt;h2 id=&quot;ceremony&quot;&gt;Ceremony&lt;/h2&gt;
        &lt;p&gt;Opening Procession&lt;/p&gt;
        &lt;p&gt;Speech by Valedictorian&lt;/p&gt;
        &lt;p&gt;Speech by Class President&lt;/p&gt;
        &lt;p&gt;Presentation of Diplomas&lt;/p&gt;
        &lt;p&gt;Closing Speech by Headmaster&lt;/p&gt;
      &lt;h2 id=&quot;graduates&quot;&gt;Graduates&lt;/h2&gt;
      &lt;ul&gt;
        &lt;li&gt;Eileen Williams&lt;/li&gt;
        &lt;li&gt;Andy Maseyk&lt;/li&gt;
        &lt;li&gt;Blanca Sainz Garcia&lt;/li&gt;
        &lt;li&gt;Clara Faulkner&lt;/li&gt;
        &lt;li&gt;Gez Lemon&lt;/li&gt;
        &lt;li&gt;Eloisa Faulkner&lt;/li&gt;
      &lt;/ul&gt;
      &lt;h2 id=&quot;awards&quot;&gt;Awards&lt;/h2&gt;
        &lt;ul&gt;
        &lt;li&gt;Clara Faulkner&lt;/li&gt;
        &lt;li&gt;Eloisa Faulkner&lt;/li&gt;
        &lt;li&gt;Blanca Sainz Garcia&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/main&gt;
    &lt;footer&gt;Copyright 2023 B.Bauska&lt;/footer&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Best practice</h4>

<p>For accessibility matters, a best practice is to split your page
content into “regions” defined by the five 5 elements
(aside, footer, header, main and nav) learned this week. </p>
<p>We recommend this article written by Steve Faulkner:
“<a href="https://www.paciellogroup.com/blog/2015/09/easy-content-organisation-with-html5/" 
target="_blank" rel="noopener noreferrer">Easy content organisation with HTML5</a>” (24 September 2015). Steve explains
in details how to organize an HTML document into “regions” based on the
semantic markup elements we have seen so far during Module 1 of this course.</p>

<h4>External resources:</h4>

<ul>
  <li>This <a href="https://www.w3.org/TR/html5/grouping-content.html#the-main-element" 
    target="_blank" rel="noopener noreferrer">document has been written by the W3C HTML5 Working Group</a>, 
    which details the different use-cases for this element.</li>
  <li><a href="https://www.w3.org/html/wg/wiki/User:Sfaulkne/main-usecases" target="_blank" rel="noopener noreferrer">
    Rationale and use cases for standardizing a ‘main content’ HTML feature</a>.</li>
  <li>On MDN’s Web Docs: the <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/main" 
    target="_blank" rel="noopener noreferrer">main element.</a></li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3>1.3.9 The Blog Example, Applying Best Practices</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Let’s go back to our blog example and see what can be improved:</p>
<ul>
  <li>Do we have a heading after each sectioning element?</li>
  <li>Did we use sectioning elements or implicit sections?</li>
  <li>Can we embed a table of contents?</li>
</ul>

<p><a href="https://jsbin.com/heboke/edit?html,output" target="_blank" rel="noopener noreferrer">The
blog example is online at JSBin</a>:  let’s see below what the Google
Chrome HTML5 Outliner extension showed.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~ 32. image of blog toc, with untitled nav entry (52) ~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/heboke/edit?html,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image032.webp"
  loading="lazy"
  title="Image of Blog Table of Contents, with untitled nav entry"
  alt="Image of Blog Table of Contents, with untitled nav entry."
  style="width:35%;" /></a>
  
<p>Also note that in this example, we used H1s after each sectioning element, 
and we still get a hierarchy, some H1s are inside an &lt;article&gt; that is 
in a &lt;section&gt; (this corresponds to the third example given in the 
"heading and sectioning elements" part of the course):</p>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;section&gt;
  &lt;header&gt;
    &lt;b&gt;&lt;h1&gt;Blog posts for April 2012&lt;/h1&gt;&lt;/b&gt;
  &lt;/header&gt;
  &lt;article&gt;
    &lt;header&gt;
      &lt;b&gt;&lt;h1&gt;&lt;a href=&quot;&quot;&gt;Information about this example&lt;/a&gt;&lt;/h1&gt;&lt;/b&gt;
        This example is a modified version
        of &lt;a href=&quot;https://example.com/blog/index.html&quot;&gt;https://example.com/blog/index.html&lt;/a&gt;
    &lt;/header&gt;
    ...
  &lt;/article&gt;
&lt;/section&gt;</pre>

</details>

<p>With this technique, parts of the document can be moved more easily,
or integrated inside an RSS stream, without the need to renumber the
headings.</p>
<p>Beware that this technique will require you to use some CSS styling, and
may confuse some screen readers that do not yet take into account this
way of computing the heading hierarchy. A simple fix is to use an H1
right after the &lt;body&gt; and use only H2…H6 inside &lt;section&gt;,
&lt;article&gt;, &lt;nav&gt; and &lt;aside&gt;.</p>

<h4>Let’s fix the missing heading</h4>

<p>We need to add a heading in the &lt;nav&gt; element. This will both fix the outline of the document by removing the untitled entry, and will also make 
screen readers happy as they will better vocalize the structure of the page (it will say “entering nav” followed by the vocalization of the heading content).</p>

<pre>&lt;nav&gt;
  &lt;header&gt;
    &lt;h1&gt;Navigation menu&lt;/h1&gt;
    &lt;b&gt;
  &lt;/header&gt;&lt;/b&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;span&gt;Blog&lt;/span&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;&quot;&gt;About&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;&quot;&gt;Contact&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/nav&gt;</pre>

<h4>Here is the fixed result:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 33. good outline without the untitled nav (53) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image033.webp"
  loading="lazy"
  title="Good outline without the untitled nav"
  alt="Good outline without the untitled nav."
  style="width:35%;" />

<p>A common remark from Web designers is: “we do not want a heading content 
displayed systematically after a &lt;nav&gt;, or an &lt;aside&gt; element…”</p>

<p><b>BEST PRACTICE #1:</b> In order to NOT display the heading content on 
screen the recommended technique is described in <a href="https://www.paciellogroup.com/blog/2012/05/html5-accessibility-chops-hidden-and-aria-hidden/" 
target="_blank" rel="noopener noreferrer">this article by Steve Faulkner</a>. 
Do not use display:none or visibility:hidden in your CSS stylesheet, as in that 
case the heading content will never be vocalized by screen readers, and more 
generally by assistive technologies.</p>

<p>As an illustration of the recommended technique, see 
<a href="https://jsbin.com/savabo/edit?html,output" 
target="_blank" rel="noopener noreferrer">this JSBin version of the blog example</a> 
that hides the &lt;h2&gt;Navigation menu&lt;/h2&gt; from the &lt;nav&gt;…&lt;/nav&gt; 
element, using the CSS technique explained in the above link.</p>

<p><b>BEST PRACTICE #2:</b> It is not advised to include interactive content 
(links, controls etc) that is hidden offscreen it is in fact a violation of
the <a href="https://www.w3.org/TR/WCAG20/)" target="_blank" rel="noopener noreferrer">
W3C WCAG 2.0 Guidelines</a>. All interactive content must have a visible focus 
indicator (and be on screen when focused).</p>

<h4>Embedding a table of contents and adding a &lt;main&gt; element</h4>

<p>In the previous section, we saw how to embed a table of contents using some 
JavaScript code borrowed from the Google Chrome HTML5 outliner extension.</p>

<p>Let’s add this piece of code (we removed the JS details from this extract):</p>

<pre>&lt;aside&gt;
  &lt;h1&gt;
    &lt;a href=&quot;javascript:(function(){...});&quot;
      title=&quot;TableOfContents&quot;&gt;
      Click here to display the table of contents!
    &lt;/a&gt;
  &lt;/h1&gt;
&lt;/aside&gt;</pre>

<h4>We also added a &lt;main&gt; element to identify the main content of the 
page composed of the big section with all blog posts:</h4>

<pre>&lt;main&gt;
  &lt;section&gt;
    &lt;header&gt;
      &lt;h2&gt;Blog posts for April 2012&lt;/h2&gt;
    &lt;/header&gt;
    ...
&lt;/main&gt;</pre>

<h4>Use H1 as top level headings only, use H2…H6 in sectioning content</h4>

<p>As explained in the article <a href="https://www.paciellogroup.com/blog/2013/10/html5-document-outline/" 
target="_blank" rel="noopener noreferrer">HTML5 Document Outline</a> and in 
<a href="https://www.w3.org/wiki/HTML/Usage/Headings" target="_blank" rel="noopener noreferrer">
the W3C HTML Wiki</a>, it is risky to use nested H1s, as browsers do not correctly 
implement the “outline algorithm”.</p>

<p>The blog example uses nested H1’s. If you check it with <a href="https://validator.w3.org/nu" 
target="_blank" rel="noopener noreferrer">the W3C conformance checker</a>, it issues a warning: 
"<i>Consider using the h1 element as a top-level heading only (all h1 elements 
are treated as top-level headings by many screen readers and other tools).</i>"</p>

<p>While this is just a warning, we do prefer to use H1s only as top level 
elements, and replace the H1s we had after &lt;section&gt;, &lt;article&gt;, 
&lt;nav&gt; and &lt;aside&gt; elements respectively by a H2s and H3s.</p>

<h4>Extract from source code:</h4>

<pre>&lt;nav&gt;
  &lt;header&gt;
    &lt;h2&gt;Navigation menu&lt;/h2&gt;
  &lt;/header&gt;
  ...
&lt;/nav&gt;</pre>

<h4>Finally, the fixed example</h4>

<ul>
  <li><a href="https://jsbin.com/heboke/edit?html,output" target="_blank" 
    rel="noopener noreferrer">Check it online with this JSBin</a>.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~ 34. blog with embedded table of contents (55) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/heboke/edit?html,output" target="_blank" 
    rel="noopener noreferrer">
<img class="displayed"
  src="./images/image034.webp"
  loading="lazy"
  title="Blog with embedded table of contents"
  alt="Blog with embedded table of contents."
  style="width:35%;" /></a>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3>1.3.10 Examples of Page Layouts</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>In this section, we show some "classic" CSS layout techniques for designing 
an HTML page that uses the new sectioning elements.</p>

<p>We embed examples from this <a href="https://learn.shayhowe.com/html-css/positioning-content/" 
target="_blank" rel="noopener noreferrer">very good post about "Positioning content"</a>. 
This is a recommended reading as it details how to use the CSS float property 
to layout a Web page.</p>

<p>The 4 examples below are given “as is” to give you some hints. There are lots 
of other possibilities on using CSS to position element.</p>

<h4>Example #1: a &lt;section&gt; on the left and an &lt;aside&gt; on the right, 
using the float and width CSS properties</h4>

<p>This example uses the following HTML structure (notice that we use the "HTML 
entity syntax" for displaying "&lt;" or "&gt;". For example, "&lt;" displays a 
"&lt;" character).</p>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;header&gt;
  &lt;code&gt;&lt;header&gt;&lt;/code&gt;
&lt;/header&gt;
&lt;section&gt;
  &lt;code&gt;&lt;section&gt; &lt;br&gt; float: left;&lt;/code&gt;
&lt;/section&gt;
&lt;aside&gt;
  &lt;code&gt; right;&lt;/code&gt;
&lt;/aside&gt;
&lt;footer&gt;
  &lt;code&gt;&lt;footer&gt;&lt;/code&gt;
&lt;/footer&gt;</pre>

</details>

<p>Here we use the CSS rule float:left for the &lt;section&gt; and the
CSS rule float:right for the &lt;aside&gt;. When an element floats, it
goes out of the normal flow of the HTML element. Then by default it
floats to the edge of its parent; and its size depends on the elements
it contains. In order to fill the whole horizontal space, we prefer
here to “force the width” by setting the CSS width property with a
percentage.  We took width: 63% for the &lt;section&gt; on the left
and width:30% for the &lt;aside&gt; on the right.</p>

<p>You can look at the complete CSS code in the interactive example below
(click on the CSS or HTML text in the menu bar below, or click “edit on
codepen” to change the code and see the results):</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~ 35. header with section float left and aside float right (56) ~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image035.webp"
  loading="lazy"
  title="Header with section float left and aside float right"
  alt="Header with section float left and aside float right."
  style="width:35%;" />

<p><a href="https://jsbin.com/dufapo/edit?html,css,output" 
target="_blank" rel="noopener noreferrer">Also available online at JSBin</a>.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~ 36. michel buffa home page - 3 sections centered (56) ~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/dufapo/edit?html,css,output" 
target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image036.webp"
  loading="lazy"
  title="Michel Buffa home page: 3 sections centered"
  alt="Michel Buffa home page: 3 sections centered."
  style="width:35%;" /></a>

<h4>Example #2: three sections centered, of equal size, also using the float and 
width CSS properties</h4>

<p>Here we show how to make a 3 column layout using the CSS float property.</p>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;header&gt;
  &lt;code&gt;&lt;header&gt;&lt;/code&gt;
&lt;/header&gt;
&lt;section&gt;
  &lt;code&gt;&lt;section&gt; &lt;br&gt; float: left;&lt;/code&gt;
&lt;/section&gt;
&lt;section&gt;
  &lt;code&gt;&lt;section&gt; &lt;br&gt; float: left;&lt;/code&gt;
&lt;/section&gt;
&lt;section&gt;
  &lt;code&gt;&lt;section&gt; &lt;br&gt; float: left;&lt;/code&gt;
&lt;/section&gt;
&lt;footer&gt;
  &lt;code&gt;&lt;footer&gt;&lt;/code&gt;
&lt;/footer&gt;</pre>

</details>

<p>Instead of having one element with a float:left and one element with a 
float:right property, we instead use float:left for all three of them, and 
we give a width:30% CSS property value to each &lt;section&gt;. We also set 
a small margin so that the colums have a gap between them.</p>

<h4>Look at the CSS code in the example below:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 37. header and three float sections (57) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image037.webp"
  loading="lazy"
  title="Header with three float sections"
  alt="Header with three float sections."
  style="width:35%;" />

<h4>Example #3: same result using the CSS flex property</h4>

<p>This example uses the CSS flex property to achieve a result similar to the 
one shown in Example 2. There are many articles on Flexbox and we recommend 
those from Rachel Andrew on Smashing Magazine: “
<a href="https://www.smashingmagazine.com/2018/10/flexbox-use-cases/" 
target="_blank" rel="noopener noreferrer">Use cases for Flexbox</a>”, 
“<a href="https://www.smashingmagazine.com/2018/09/flexbox-sizing-flexible-box/" 
target="_blank" rel="noopener noreferrer">Flexbox: how big is that flexible box</a>”, etc.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~ 38. same example using the css flex property (57) ~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image038.webp"
  loading="lazy"
  title="Same example using the CSS Flex property"
  alt="Same example using the CSS Flex property."
  style="width:35%;" />

<h4>Example #4: another example written by a student, that uses the flex property</h4>

<p>This example also uses all the structuring elements we saw: main, article, 
section, etc. It uses only the simplest parts of the FlexBox CSS module, so it 
should be easy to understand, even for CSS beginners:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 39. another example using the flex property (58) ~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image039.webp"
  loading="lazy"
  title="Another example using the flex property"
  alt="Another example using the flex property."
  style="width:35%;" />
  
<h4>External resources</h4>

<ul>
  <li>An article on CSS Tricks: <a href="https://css-tricks.com/all-about-floats/" 
    target="_blank" rel="noopener noreferrer">All about floats</a></li>
  <li>Old but good article on “A List Apart” (ALA): 
    <a href="https://alistapart.com/article/css-floats-101" 
    target="_blank" rel="noopener noreferrer">CSS Floats 101</a></li>
  <li>Another article on Lifewire:
    <a href="https://www.lifewire.com/understanding-css-float-3466205" 
    target="_blank" rel="noopener noreferrer"> Understanding CSS float</a></li>
  <li>On MDN’s Web Docs: the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/float" 
    target="_blank" rel="noopener noreferrer">float CSS property</a> and the 
    <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/clear" 
    target="_blank" rel="noopener noreferrer">clear CSS property</a></li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch1-4-1">1.4.1 The &lt;details&gt; and &lt;summary&gt; Elements</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>These elements have been introduced for displaying a foldable zone in an HTML document.</p>

<p>In the screenshot below, taken from the W3C specification page, the text next 
to the horizontal arrow is a &lt;summary&gt; element, and the text displayed when 
we click on the summary part, is the &lt;details&gt; element. This is a sort of 
“accordion” with foldable content.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~ 40. example of summary details elements from the w3c specs (59) ~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image040.webp"
  loading="lazy"
  title="Example of summary details elements from the W3C specification"
  alt="Example of summary details elements from the W3C specification."
  style="width:35%;" />

<p>The &lt;details&gt; element generates a simple widget to show/hide
element contents, optionally by clicking on its child &lt;summary&gt; element.</p>

<p>Here is an example of what can be done using these elements: see
the <a href="https://jsbin.com/yociyel/1/edit?html,css,js,output" target="_blank" rel="noopener noreferrer">online
version on JSBin</a>:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 41. example of folded summary details (59) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/yociyel/1/edit?html,css,js,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image041.webp"
  loading="lazy"
  title="Example of folded summary details"
  alt="Example of folded summary details."
  style="width:35%;" /></a>

<p>And here is what is displayed after clicking on the small arrow-shaped
icon to the left of the summary:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 42. Example of summary details unfolded (60) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image042.webp"
  loading="lazy"
  title="Example of summary details unfolded"
  alt="Example of summary details unfolded."
  style="width:35%;" />
  
<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt; ...
  &lt;body&gt;
    &lt;details&gt;
      &lt;summary&gt;
        How to beat the boss...spoiler alert !
      &lt;/summary&gt;
      &lt;p&gt; Just aim to the red spots near his eyes&lt;/p&gt;
      &lt;p&gt;Keep shooting at these spots until the eyes open, then hit quickly both eyes with your laser beam.&lt;/p&gt;
    &lt;/details&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>The &lt;summary&gt;…&lt;/summary&gt; is inside
a &lt;details&gt;…&lt;/details&gt; element. By clicking on the icon at
the left of the summary, the content of the &lt;details&gt; value is
displayed/hidden.</p>

<p>&lt;details&gt; blocks can be <a href="https://jsbin.com/dejagi/edit?html,css,output" 
target="_blank" rel="noopener noreferrer">bembedded inside one another, like in this example</a>:</p>

<h5>Step 1: all folded:</h5>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 43. all folded (60) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/dejagi/edit?html,css,output" 
target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image043.webp"
  loading="lazy"
  title="Other example, unfolded"
  alt="Other example, unfolded."
  style="width:35%;" /></a>

<h5>Step 2: click on top level summary icon, the first “hidden” part appears…</h5>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 44. click top level summary icon (60) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image044.webp"
  loading="lazy"
  title="The unfolded content contains in turn a summary details folded"
  alt="The unfolded content contains in turn a summary details folded."
  style="width:35%;" />

<h5>Step3: click on embedded summary icon inside the part that has been previously unfolded</h5>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 45. click on embedded summary icon (61) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image045.webp"
  loading="lazy"
  title="We unfolded the summary details inside the previous summary details. Recursive accordeons!"
  alt="We unfolded the summary details inside the previous summary details. Recursive accordeons!"
  style="width:35%;" />
  
<h5>Source code of this example, see the summary/details inside another one:</h5>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;details&gt;
  &lt;summary&gt;
    How to beat the boss...spoiler alert !
  &lt;/summary&gt;
  &lt;p&gt; Just aim to the red spots near his eyes&lt;/p&gt;
  &lt;p&gt;Keep shooting at these spots until the eyes open, then hit quickly both eyes with your laser beam.&lt;/p&gt;
  &lt;details&gt;
  &lt;summary&gt;
    Bonus and spoiler No 2: get a new weapon by cutting the tail of the boss.
    &lt;/summary&gt;
    &lt;p&gt;Before finishing him, try to cut his trail, you will get a new weapon&lt;/p&gt;
    &lt;p&gt;Just try to stay behind him as long as you can, hitting his tail with your melee weapon, 
      after a few hits the trail will fall and you will get a new bonus weapon, then finish the boss.&lt;/p&gt;
  &lt;/details&gt;
&lt;/details&gt;</pre>

</details>

<h4>CSS pseudo classes for styling summary icons</h4>

<p>There are CSS pseudo classes to style this icon when it is in the open or 
closed state. Support for these is still incomplete as of June 2020 (works on 
Google Chrome, Opera, Safari, not in FF).</p>

<h5>Example1 (see <a href="https://jsbin.com/tomehim/1/edit?html,css,output" 
target="_blank" rel="noopener noreferrer">online example</a>):</h5>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 46. pseudo classes for styling summary icons (61) ~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/tomehim/1/edit?html,css,output" 
target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image046.webp"
  loading="lazy"
  title="Styling the open/close icon"
  alt="Styling the open/close icon."
  style="width:35%;" /></a>

<p>The color and background of the icon on the left are specified by the following 
CSS rule, which uses the pseudo class ::-webkit-details-marker</p>

<p>In this example: red arrow, white background.</p>

<pre>summary::-webkit-details-marker {
  color:#FF0000;
  background:#FFFFFF;
}</pre>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 47. unfold and style (62) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image047.webp"
  loading="lazy"
  title="Styled summary details icon, unfolded state"
  alt="Styled summary details icon, unfolded state."
  style="width:35%;" />
  
<p>Once opened, the selector details [open] can style the icon when &lt;details&gt; 
is unfolded. In this example: blue arrow, turquoise background.</p>

<h4>Here is the corresponding CSS rule:</h4>

<pre>details[open] summary::-webkit-details-marker {
  color:#0000FF;
  background:#00FFFF;
}</pre>

<p>It is also possible to change the icon itself using the CSS pseudo class :after</p>

<h5>Example 2 (<a href="https://jsbin.com/sajusop/edit?html,css,output" 
target="_blank" rel="noopener noreferrer">see it online</a>):</h5>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 43. a '+' as a custom open icon for summary (62) ~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/sajusop/edit?html,css,output" 
target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image043.webp"
  loading="lazy"
  title="'A+' as a custom open icon for summary"
  alt="'A+' as a custom open icon for summary."
  style="width:35%;" /></a>
<p></p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 48. a '-' as a custom close icon (62) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image048.webp"
  loading="lazy"
  title="'A-' as a custom closed icon"
  alt="'A-' as a custom closed icon."
  style="width:35%;" />

<h5>CSS rules used in this example:</h5>

<p>Use a “+” shaped icon, pink, bold, etc… :</p>

<pre>summary:after {
  content: &quot;+&quot;;
  color: #FF00FF;
  float: left;
  font-size: 1.5em;
  font-weight: bold;
  margin: -5px 5px 0 0;
  padding: 0;
  text-align: center;
  width: 20px;
}</pre>

<p>Use a “-” shaped icon, white, when details are displayed:</p>

<pre>details[open] summary:after {
  content: &quot;-&quot;;
  color: #FFFFFF
}</pre>

<h4>Current browser support</h4>

<ul>
  <li>On CanIUse: <a href="https://caniuse.com/#feat=details" target="_blank" 
    rel="noopener noreferrer">compatibility table for details and summary elements</a>.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch1-4-2">1.4.2 The &lt;time&gt; and &lt;mark&gt; Elements</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 49. it's about time clock (63) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image049.webp"
  loading="lazy"
  title="Picture of a clock with the words 'it's about time'"
  alt="Picture of a clock with the words 'it's about time'."
  style="width:20%;" />

<h4>The &lt;time&gt; element</h4>

<p>The &lt;time&gt; element is useful for marking a time or a duration
in a document.</p>
<p>It provides both a human readable part (the part
between &lt;time&gt; and &lt;/time&gt;) and a machine readable part
contained within a datetime attribute. Dates are expressed
as YYYY-MM-DD.</p>
<p>The machine readable part adds semantics that can be used by search
engines for indexing, by browsers or by browser extensions, or by
JavaScript code. Useful scenarios include generating alerts for
birthdays, automatically adding dates or events that
contain &lt;time&gt; elements in a calendar, etc.</p>

<h4>Examples:</h4>

<pre>We open at &lt;time&gt;10:00&lt;/time&gt; every morning.
I have a meeting the &lt;time datetime=&quot;2020-02-14&quot;&gt;Monday 14/02/2020.&lt;/time&gt;.
Blog posts from the year &lt;time datetime=&quot;2020&quot;&gt;2020&lt;/time&gt;.
Archives, blog posts for &lt;time datetime=&quot;2020-04&quot;&gt;April 2020&lt;/time&gt;
This recipe was published by Michel the &lt;time datetime=&quot;2020-04-16&quot;&gt;April 16, 2020&lt;/time&gt;.</pre>

<h4>The datetime attribute</h4>

<p>The datetime attribute can be used for indicating a date/time or a duration.</p>

<h5>Date/time values</h5>

<p>Supports different specifications of time such as “a year”, “a month in
a year”, “a week in a year”, “a time”, etc… </p>

<h4>Here are some examples:</h4>

<h4>Different syntaxes of the datetime attribute</h4>

<!-- <div style="text-align:left"> -->

<div style="width: 100%; text-align: left;">
<table>
  <colgroup>
    <col style="width: 35%" />
    <col style="width: 64%" />
  </colgroup>
  <thead>
    <tr class="header">
      <th>datetime attribute values</th>
      <th>Interpretation</th>
    </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td>&lt;time datetime=“2020”&gt;</td>
      <td>The year 2020</td>
    </tr>
    <tr class="even">
      <td>&lt;time datetime=“2020-11”&gt;</td>
      <td>November 2020</td>
    </tr>
    <tr class="odd">
      <td>&lt;time datetime=“11-13”&gt;</td>
      <td>November 13th (any year)</td>
    </tr>
    <tr class="even">
      <td>&lt;time datetime=“2020-W21”&gt;</td>
      <td>Week 21 from year 2020</td>
    </tr>
    <tr class="odd">
      <td>&lt;time datetime=“2020-11-13 09:00”&gt;</td>
      <td>November 13th year 2020, time = 9:00</td>
    </tr>
    <tr class="even">
      <td>&lt;time datetime=“2020-11-13TO9:00”&gt;</td>
      <td>Same as prev ex, both syntaxes are supported, with and without the
        “T” between date and time</td>
    </tr>
    <tr class="odd">
      <td>&lt;time datetime=“09:00%”&gt;</td>
      <td>9:00 in the morning, GMT</td>
    </tr>
    <tr class="even">
      <td>&lt;time datetime=“09:00-05”&gt;</td>
      <td>9:00 in the morning, GMT minus 5 hours</td>
    </tr>
    <tr class="odd">
      <td>&lt;time datetime=“09:00+05:45”&gt;</td>
      <td>9:00 in the morning, GMT plus 5 hours 45 mins, (for example, Nepal is 5:45 ahead of GMT</td>
    </tr>
  </tbody>
</table>
</div>

<h4>Duration values</h4>

<p>Duration values use the prefix “P” for “period” as in &lt;time
datetime=“P4D”&gt; (period = four days)…</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 50. duration values (64) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image050.webp"
  loading="lazy"
  title="Funny picture duration values"
  alt="Funny picture duration values."
  style="width:20%;" />

<p>So you start the attribute string value with a “P”, followed by a
duration value that ends with another letter indicating the unit
used: “D” for “days”,  “H” for hours, “M” for minutes and “S” for
seconds. </p>
<p>You can separate the different elements “P”, value and unit with
spaces, but this is optional. So &lt;time datetime="P4D"&gt; is a duration of
4 days, as is &lt;time datetime="P 4 D"&gt;.</p>
<p>Using a “T” after the “P” marker allows you to indicate a more
accurate duration time: &lt;time datetime=“PT4H 6M 12.55S”&gt; is a
duration of 4 hours, 6 minutes and 12.55 seconds.</p>
<p>Alternatively, you could use also a duration time component.</p>
<p>From Bruce Lawson’s article : <i>“Whichever you choose, it’s
represented internally as a number of seconds. Because of this, you
can’t specify a duration in terms of months, because a month isn’t a
precise number of seconds; a month can last from 28 to 31 days.
Similarly, a year isn’t a precise number of seconds; it’s 12 months and
February sometimes has an extra day.</i></p>
<p><i>You still can’t represent dates before the Christian era, as years
can’t be negative. Neither can you indicate date ranges. To mark up From
“21/02/2012 to 25/02/2012″, use two separate &lt;time&gt; elements.”</i></p>

<h4>Examples:</h4>

<pre class="html5">&lt;h2&gt;Recipe:&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt; Preparation time: &lt;time datetime=&quot;PT30M&quot;&gt;30 minutes&lt;/time&gt; &lt;/li&gt;
  &lt;li&gt; Cooking time:     &lt;time datetime=&quot;PT10M&quot;&gt;10 minutes&lt;/time&gt; &lt;/li&gt;
&lt;/ul&gt;</pre>

<h4>The &lt;time&gt; element with no attributes</h4>

<p>Used without attributes, the value between the opening &lt;time&gt; and
closing &lt;time&gt; should follow the syntax given by the specification
so that machines can understand it (same syntax as the one presented for
the datetime attribute in the previous section). However it is
recommended to use a datetime attribute, as it gives more freedom in the
way you can display the date/time/duration in a human-readable form.</p>

<h4>External resources:</h4>

<ul>
  <li><a href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-time-element" 
    target="_blank" rel="noopener noreferrer">From the specification</a>:</li>
  <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/time" target="_blank" 
    rel="noopener noreferrer">On MDN’s Web Docs</a>:&gt;</li>
  <li>MDN’s browser compatibility <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/time#Browser_compatibility" 
    target="_blank" rel="noopener noreferrer">table</a> for &lt;time&gt;</li>
  <li><a href="https://www.brucelawson.co.uk/2012/best-of-time" target="_blank" rel="noopener 
    noreferrer">Old but interesting article by Bruce Lawson:</a></li>
  <li>A CSS Tricks’ article: “<a href="https://css-tricks.com/time-element/" target="_blank" 
    rel="noopener noreferrer">The ‘time’ element</a>”</li>
</ul>

<h4>The &lt;mark&gt; element</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 51. yellow highlighter pen (65) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image051.webp"
  loading="lazy"
  title="Picture of a yellow hightlighter pen"
  alt="Picture of a yellow hightlighter pen."
  style="width:35%;" />

<p>The HTML &lt;mark&gt; tag is used for indicating text as marked or highlighted for reference purposes, 
due to its relevance in another context.</p>

<h4>Some use cases:</h4>

<ul>
  <li>Display search results with search strings highlighted in the results.</li>
  <li>Highlight important parts of a text, such as "quoting parts", etc.</li>
  <li>Replace &lt;strong&gt; and &lt;em&gt; with &lt;mark&gt; when suitable.</li>
</ul>

<h4>Example 1:</h4>
<!-- &lt;https://jsbin.com/tafelic/edit?html,output&gt;</h4> -->

<h4>Source code:</h4>

<pre class="html5">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=utf-8 /&gt;
    &lt;title&gt;JS Bin&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;p&gt;Project is due in &lt;b&gt;&lt;mark&gt;.zip format&lt;/mark&gt;&lt;/b&gt; next monday.&lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

<h4>Example 2:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 52. another example for marking code (66) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image052.webp"
  loading="lazy"
  title="Another example for marking code, yellow hightlighted background"
  alt="Another example for marking code, yellow hightlighted background."
  style="width:35%;" />

<h4>Source code:</h4>

<pre class="html5">&lt;body&gt;
  &lt;pre&gt;
    &lt;code&gt;&lt;mark&gt;var&lt;/mark&gt; i = 3;&lt;/code&gt;
  &lt;/pre&gt;
  &lt;p&gt;The var keyword is used to declare a variable in JavaScript.&lt;/p&gt;
&lt;/body&gt;</pre>

<h4>Change the default style of the &lt;mark&gt; element</h4>

<p>If you don’t like the default yellow background, you may use CSS to change the style of the &lt;mark&gt; element:</p>

<h4>For example:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 53. style the mark element with CSS (66) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image053.webp"
  loading="lazy"
  title="Style the mark element with CSS, highlighted green background"
  alt="Style the mark element with CSS, highlighted green background."
  style="width:35%;" />

<h4>… comes with this CSS rule:</h4>

<pre>mark {
  background-color: green;
  color: yellow;
}</pre>

<h4>External resources:</h4>

<ul>
  <li>From the specification: On MDN’s Web Docs: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/mark" target="_blank" 
    rel="noopener noreferrer">The 'mark' element</a></li>
  <li>MDN’s browser compatibility <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/mark#Browser_compatibility" 
    target="_blank" rel="noopener noreferrer">table</a> for &lt;time&gt;</li>
  <li>An article on Web Platform News: <a href="https://webplatform.news/issues/2019-02-28">
    The &lt;mark&gt; element could help make your text more scannable</a></li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch1-4-3">1.4.3 The Download and Translate Attributes</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>The old way to download files using HTML and HTTP</h4>

<p>Everyone knows the classic way to make hyperlinks,
using &lt;a href="..."&gt;some text. What happens when you click on the
hyperlink depends on the MIME type received by the browser. If you link
to a file the browser knows how to render (an html page, a gif, jpg, or
png image, etc.) there is a good chance that the MIME type received by
the browser will be something like this:</p>

<pre>Content-type: text/html, text/plain, image/gif, image/jpg, etc.</pre>

<h4>For example, HTML code such as this:</h4>

<pre>&lt;a href=&quot;toto.jpg&quot;&gt;
  please right click this link to download
  the toto.jpg picture&lt;/a&gt;</pre>

<p>…will ask the remote HTTP server to send back the toto.jpg file. The
browser will receive in the response HTTP header from the server (and by
default the browser will display the image in a new tab):</p>

<pre>...
Content-type: image/jpg
...</pre>

<p>However, if the link points to some PHP code,  Java servlet code, or
any kind of script/application on the server side, this remote server
code can send in its HTTP response a Content-type that may force the
browser to download the image instead of rendering it.</p>
<p>It may also propose a name for the file to be downloaded that may be
different from the one that appears in the URL of the href attribute.
This can be done by generating, in addition to the Content-type line in
the response HTTP header, a Content-Disposition line that looks like
this:</p>

<pre>Content-Disposition: attachment; filename=&quot;MyImage.png&quot;;</pre>

<p>Here are some extracts from a Java Servlet that generate a zip file and forces 
the browser to propose downloading it using a specified name:</p>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>protected void doGet(HttpServletRequest request, HttpServletResponse response)
throws ServletException, IOException {
  try {
    // Build the zip file
    String path = getServletContext().getRealPath(&quot;data&quot;);
    File directory = new File(path);
    String[] files = directory.list();
    if (files != null &amp;&amp; files.length &gt; 0) {
      byte[] zip = zipFiles(directory, files);
      ServletOutputStream sos = response.getOutputStream();
 
      // generate a HTTP response that forces the download
      [response.setContentType(&quot;application/zip&quot;);]
      [response.setHeader(&quot;Content-Disposition&quot;,]
      [&quot;attachment; filename=&quot;DATA.ZIP&quot;&quot;);]
        sos.write(zip); sos.flush();
    }
  } catch (Exception e) {
    e.printStackTrace();
  }
}</pre>

</details>

<p>The above example will cause the browser that invoked this server-side code to start the 
download of a file named “DATA.ZIP”.</p>

<h4>To download a file using an arbitrary name: the download attribute</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~ 54. picture of a road sign with the words 'new way' (68) ~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image054.webp"
  loading="lazy"
  title="Picture of a road sign with the words 'New Way'"
  alt="Picture of a road sign with the words 'New Way'."
  style="width:15%;" />

<p>HTML5 proposes the use of a new attribute named download to download
resources rather than navigating to them. The example below shows how to
trigger the download of an image by the browser (instead of rendering
it, which is the default behavior) with a name different from the name
of the resource.</p>

<pre>&lt;a href=&quot;normal.gif&quot; [download]=[&quot;MichelBuffa.gif&quot;]&gt;
  download a picture of Michel Buffa
&lt;/a&gt;</pre>

<p>This will indeed force the download of an image with a filename
different from its original filename on the server side. Here is a
screen capture of the Web browser while downloading the picture. We can
see in the status bar the name of the link (the image is “normal.gif”)
and the downloaded file is “MichelBuffa.gif”:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~ 55. image saved with another names thanks to the download attribute (68) ~~~~~~~~-->
<img class="displayed"
  src="./images/image055.webp"
  loading="lazy"
  title="Image saved with another 'new' name, thanks to the download attribute"
  alt="Image saved with another 'new' name, thanks to the download attribute."
  style="width:25%;" />
  
<p><b>WARNING</b>: since 2015, and for security reasons, <b>the image
should be located on the same domain as the HTML page that contains the
link</b> (using a relative URL works well, for example, but linking a
page on another domain will not work - it will keep its original
name).</p>

<h4>Interesting applications: serverless download</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 56. no servers picture (68) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image056.webp"
  loading="lazy"
  title="No server picture"
  alt="No server picture."
  style="width:35%;" />

<h4>Serverless download demo (by E.Bilderman)</h4>

<p>This demo shows the use of the download attribute together with the HTML5 File, 
FileSystem and FileWriter APIs (to be studied later in this course) for generating 
on-the-fly content from JavaScript code, and proposing downloading it to a file.</p>
<p>We won’t detail this demo here, but take a look if you are curious to see what 
can be done with this new download attribute. As the FileWriter and FileSystem 
APIs are still supported only by Google Chrome (other browsers need polyfills), 
you will need Google Chrome to try it.</p>
<p>We have also put the simplified <a href="https://jsbin.com/muluwey/1/edit?html,css,js,output" 
target="_blank" rel="noopener noreferrer">source code of this demo on JSBin.com</a> for you to 
play with.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 57. serverless download demo (69) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/muluwey/1/edit?html,css,js,output" 
target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image057.webp"
  loading="lazy"
  title="Serverless download demo: type text in a text area, press download, enter 
    a filename and voilà! you can download the textarea content into a file, 
    without any server"
  alt="Serverless download demo: type text in a text area, press download, enter 
    a filename and voilà! you can download the textarea content into a file, 
    without any server."
  style="width:35%;" /></a>

<h4>External resources:</h4>

<ul>
  <li>From the specification: <a href="https://www.w3.org/TR/2014/REC-html5-20141028/links.html#downloading-resources" 
    target="_blank" rel="noopener noreferrer">downloading resources</a>.</li>
  <li>From CanIUse: the <a href="https://caniuse.com/#feat=download" target="_blank" rel="noopener noreferrer">
    browser support of the download attribute</a>.</li>
</ul>

<h4>The HTML5 translate attribute</h4>

<p>HTML5 gives us a new translate attribute. This attribute is used to limit the impact 
of  translation tools such as <a href="https://translate.google.com/" target="_blank" 
rel="noopener noreferrer">Google Translate</a> by prohibiting the translation of 
certain content. In many cases some parts of a document should not be translated.</p>

<h4>Use cases include:</h4>

<ul>
  <li>HTML pages that contain source code: you would certainly not like to see the Java 
    or PHP or whatever programming language parts of your page translated into another 
    spoken language!</li>
  <li>Video game Web sites that propose cheat codes; the codes do not have to be translated,</li>
  <li>Street names, author names in an “about” page must not be translated,</li>
  <li>etc.</li>
</ul>

<p>Both <a href="https://translate.google.com/" target="_blank" rel="noopener noreferrer">
Google translate</a> and <a href="https://www.microsofttranslator.com/" target="_blank" 
rel="noopener noreferrer">Microsoft online translation services</a> already offer the 
ability to prevent translation of content by adding markup to your content, although 
they do it in (multiple) different ways. Hopefully, the new attribute will help 
significantly by providing a standard approach.</p>

<h4>Principle: give hints to translating tools</h4>

<p><a href="https://www.w3.org/TR/html5/dom.html#the-translate-attribute" 
target="_blank" rel="noopener noreferrer">The specification about the translate 
attribute</a> tells us that <i>“The translate attribute is an enumerated attribute 
that is used to specify whether an element’s attribute values and the values of its
Text node children are to be translated when the page is localized, or whether to 
leave them unchanged.</i></p>
<p><i>The attribute’s keywords are the empty string, yes, and no. The
empty string and the yes keyword map to the yes state. The no keyword
maps to the no state. In addition, there is a third state, the inherit
state, which is the missing value default (and the invalid value
default).”</i></p>

<h4>Example illustrating how to specify parts of an HTML element that should
not be translated:</h4>

<pre>&lt;span &lt;b&gt;[translate=&quot;no&quot;]&lt;/b&gt; class=&quot;author&quot;&gt;[Michel Ham]&lt;/span&gt;</pre>

<p>In the above example, a &lt;span&gt; element defines an author (of a blog,
for example) who is named Michel Ham. However, his family name is the
same as pork and would be translated to “Michel Jambon” in French, or
Michel Jamón in Spanish…</p>
<p>Using the translate=“no” attribute should prevent this behavior…</p>

<pre>&lt;span &lt;b&gt;[translate=&quot;no&quot;]&lt;/b&gt; class=&quot;author&quot;&gt;[Michel Ham]&lt;/span&gt; is a professor from the University of Nice, France.</pre>

<p>Will be correctly translated into French by:</p>

<pre>&quot;[Michel Ham] est un professeur de l&#39;Université de Nice, France.&quot;</pre>

<p>…where all of the end of the sentence has been translated except the
author’s name.</p>

<h4>Inheritance between elements</h4>

<p>When you define an element as not being translatable, its children
inherit this behavior and are themselves not translatable. The reverse
is also true.</p>

<pre>&lt;p translate=&quot;no&quot;&gt;This is a text in a paragraph element, that should not be translated: the p element has a translate=&quot;no&quot; attribute.&lt;span&gt; 
  This part that is in a span element embedded within the paragraph. 
  It does not have a translate attribute but inherits the translation-mode of the p and will not be translated
too&lt;/span&gt;. This is the end of the paragraph...&lt;/p&gt;</pre>

<h4>External resources:</h4>

<ul>
  <li>From the specification: <a href="https://html.spec.whatwg.org/multipage/dom.html#the-translate-attribute" 
    target="_blank" rel="noopener noreferrer">the translate attribute</a></li>
  <li>From MDN’s Web Docs: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/translate" 
    target="_blank" rel="noopener noreferrer">Gobal Attributes</a>.
    <ul>
      <li>Its corresponding <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/translate#Browser_compatibility" 
        target="_blank" rel="noopener noreferrer">browser compatibility table</a></li>
    </ul></li>
  <li>An article from W3C’s Internationalization Activity: 
    <a href="https://www.w3.org/International/questions/qa-translate-flag" 
    target="_blank" rel="noopener noreferrer">“Using HTML’s translate attribute”</a></li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch1-5-1">1.5.1 Microdata</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>There are several ways to provide machine-readable content embedded 
in a classical Web document: <a href="https://www.w3.org/TR/html-rdfa/" 
target="_blank" rel="noopener noreferrer">HTML+RDFa</a>, <a href="http://microformats.org/" 
target="_blank" rel="noopener noreferrer">microformats</a>, <a href="https://json-ld.org/" 
target="_blank" rel="noopener noreferrer">JSON-LD</a>,
HTML5 microdata. In this section, we focus on microdata.</p>

<p>Adding microdata to Web pages helps search engines to better
understand the pages’ content, their topics, etc. The main purpose of
microdata is <a href="https://en.wikipedia.org/wiki/Search_engine_optimization" 
target="_blank" rel="noopener noreferrer">Search Engine Optimization</a>(SEO).</p>

<p>This information is not visible to humans: it is pure <i>semantic
information</i>. Popular kinds of microdata are events, a person’s
profile, the description of an organization, the details of a recipe, a
product description, a geographical location, etc.</p>

<h4>Quick example of microdata that describes a person</h4>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>
&lt;section [itemscope itemtype=&quot;https://schema.org/Person&quot;]&gt;
  &lt;h1&gt;Contact Information&lt;/h1&gt;
    &lt;dl&gt;
      &lt;dt&gt;Name&lt;/dt&gt;
      &lt;dd [itemprop=&quot;name&quot;]&gt;Michel Buffa&lt;/dd&gt;
      &lt;dt&gt;Position&lt;/dt&gt;
      &lt;dd&gt;&lt;span [itemprop=&quot;jobTitle&quot;]&gt;
        Professor/Researcher/Scientist&lt;/span&gt; for
        &lt;span [itemprop=&quot;affiliation&quot;]&gt;
          University of Côte d&#39;Azur, France
        &lt;/span&gt;
      &lt;/dd&gt;
    &lt;/dl&gt;
    &lt;!-- SURFACE ADDRESS GOES HERE --&gt;
  &lt;h1&gt;My different online public accounts&lt;/h1&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;https://www.twitter.com/micbuffa&quot;
      [itemprop=&quot;url&quot;]&gt;Twitter profile&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://www.blogger.com/micbuffa&quot;
      [itemprop=&quot;url&quot;]&gt;Michel Buffa&#39;s blog&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/section&gt;</pre>

</details>

<p>We can also add another embedded data item in the middle, such as the
person’s address:</p>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>...
&lt;/dl&gt;
&lt;!-- SURFACE ADDRESS GOES HERE --&gt;
&lt;dd [itemprop=]&quot;address&quot;[ itemscope]
  itemtype=&quot;https://schema.org/PostalAddress&quot;&gt;
    &lt;span [itemprop=]&quot;streetAddress&quot;&gt;10 promenade des anglais&lt;/span&gt;&lt;br&gt;
    &lt;span [itemprop=]&quot;addressLocality&quot;&gt;Nice&lt;/span&gt;,
    &lt;span [itemprop=]&quot;addressRegion&quot;&gt;Alpes maritimes, France&lt;/span&gt;
    &lt;span [itemprop=]&quot;postalCode&quot;&gt;06410&lt;/span&gt;&lt;br&gt;
    &lt;span [itemprop=]&quot;addressCountry&quot;[ itemscope]
  [itemtype=]&quot;https://schema.org/Country&quot;&gt;
    &lt;span [itemprop=]&quot;name&quot;&gt;France&lt;/span&gt;
  &lt;/span&gt;
&lt;/dd&gt;
&lt;h1&gt;My different online public accounts&lt;/h1&gt;
...</pre>

</details>

<p>In the following sections, we look more closely
at the itemprop, itemscope and itemtype attributes.</p>

<h4>Data that can be processed, organized, structured, or presented in a given context</h4>

<h4>Different use cases:</h4>

<ul>
  <li>The browser, or a browser extension, may interpret the last example as an address 
    and may propose to send it to a map application,</li>
  <li>A Web crawler may interpret this as an address and display it in its responses 
    using a dedicated presentation layout,</li>
  <li>Some JavaScript code in the page can access this data,</li>
  <li>With other types of microdata, for events, for example, the browser may pop up 
    a calendar application, etc.</li>
</ul>

<p><b>Note</b>: For advanced users, Microdata is very similar
to <a href="http://microformats.org/" target="_blank" rel="noopener noreferrer">microformats</a>, 
which use HTML classes, or to <a href="https://www.w3.org/TR/xhtml-rdfa-primer/" target="_blank" 
rel="noopener noreferrer">RDFa</a>, which doesn’t validate in HTML4 or HTML5. Because RDFa was 
considered to be too hard for authors to write, microdata is HTML5’s answer to help embed 
semantics into html documents.</p>

<h4>External resources</h4>

<ul>
  <li><a href="https://www.w3.org/TR/microdata/" target="_blank" rel="noopener noreferrer">
    W3C’s HTML Microdata Working Draft</a>,</li>
  <li>MDN’s Web Docs: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Microdata" 
    target="_blank" rel="noopener noreferrer">Microdata</a>,</li>
  <li>Very good <a href="https://journal.code4lib.org/articles/6400" target="_blank" 
    rel="noopener noreferrer">Microdata</a> paper from code{4}lib journal,</li>
  <li><a href="https://dev.opera.com/articles/microdata-and-the-microdata-dom-api/" 
    target="_blank" rel="noopener noreferrer">Microdata and the microdata DOM API</a>, 
    old article from dev.opera.com,</li>
  <li><a href="https://diveinto.html5doctor.com/extensibility.html" target="_blank" 
    rel="noopener noreferrer">Chapter from Mark Pilgrim’s book about microdata</a>, 
    very detailed introduction about semantic metadata in general, contains full 
    examples with explanations about how to describe a Person, etc.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch1-5-2">1.5.2 Testing Tools</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Introduction</h4>
<p>After seeing the principle of embedding microdata in an HTML page, we
now present some structured data test tools you can use to check if your
data are correct.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 58. picture of diverse tools used by workers (72) ~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image058.webp"
  loading="lazy"
  title="Picture of diverse tools used by workers"
  alt="Picture of diverse tools used by workers."
  style="width:20%;" />
  
<p>One of the most popular resources for testing microdata (as well as
microformats and RDFa) is
this <a href="https://developers.google.com/search/docs/guides/intro-structured-data" 
target="_blank" rel="noopener noreferrer">Google page about understanding how structured 
data works</a>. This page contains a link to a structured data testing tool that you can 
use to see how Google recognizes the semantic data you embed in your HTML code.</p>

<h4>Testing a real interactive example with an “about page” for Michel Buffa</h4>

<p>Let’s have a look now at a (small) example of an about page. It
renders as a very simple paragraph that explains who Michel Buffa is…
But we embedded Microdata, so it’s interesting to see how a search
engine sees it, and how it may produce “augmented search results”.</p>
<p><a href="https://jsbin.com/gunuzus/1/edit?html,output" target="_blank" rel="noopener noreferrer">Online example
at JSBin</a></p>

<h4>Source code:</h4>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=utf-8 /&gt;
  &lt;title&gt;Michel Buffa&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div [itemscope itemtype=&quot;https://schema.org/Person&quot;]&gt;
    My name is &lt;span itemprop=&quot;name&quot;&gt;Michel Buffa&lt;/span&gt;,
    And I&#39;m a &lt;span itemprop=&quot;jobTitle&quot;&gt;professor/researcher&lt;/span&gt; at
    &lt;a href=&quot;https://www.i3s.unice.fr/&quot; itemprop=&quot;affiliation&quot;&gt;I3S
    Laboratory&lt;/a&gt; in the south of France, near the city of Nice. My
    email
    is : &lt;span itemprop=&quot;email&quot;&gt;micbuffa@gmail.com&lt;/span&gt;.
    I live in the city of
    &lt;span itemprop=&quot;address&quot; itemscope
      [itemtype=&quot;https://schema.org/PostalAddress&quot;]&gt;
      &lt;span itemprop=&quot;addressLocality&quot;&gt;Biot&lt;/span&gt;, in a region named
      &lt;span itemprop=&quot;addressRegion&quot;&gt;Alpes Maritimes&lt;/span&gt;
    &lt;/span&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Rendering of the page in a browser:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 59. rendering of michel buffa home page (73) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image059.webp"
  loading="lazy"
  title="Rendering of Michael Buffa's home page"
  alt="Rendering of Michael Buffa's home page."
  style="width:35%;" />

<p>Here is what Google sees of the page. We just entered its 
<a href="https://output.jsbin.com/gunuzus/1" target="_blank" rel="noopener noreferrer">
URL</a> in the <a href="https://developers.google.com/search/docs/guides/intro-structured-data" 
target="_blank" rel="noopener noreferrer">Google page about rich snippets and structured data</a>:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~ 60. microdata of the example, as seen by google (74) ~~~~~~~~~~~~~~~~~~~~-->
<a href="https://output.jsbin.com/gunuzus/1" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image060.webp"
  loading="lazy"
  title="Microdata of the example, as seen by Google"
  alt="Microdata of the example, as seen by Google."
  style="width:35%;" /></a>

<p>Note that the address is a fully featured embedded object in the Person’s description.</p>

<h4>Live Microdata</h4>

<p>The <a href="https://foolip.org/microdatajs/live/" 
target="_blank" rel="noopener noreferrer">Live Microdata Web site</a> is a bit 
similar to the previous one except that it shows the extracted metadata as JSON 
objects:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 61. example live microdata (74) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image061.webp"
  loading="lazy"
  title="Example of live microdata from the previous example. Microdata are 
    displayed as json objects"
  alt="Example of live microdata from the previous example. Microdata are 
    displayed as json objects."
  style="width:35%;" />
  
<h4>And the JSON view of the microdata:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 62. json view of the microdata (74) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image062.webp"
  loading="lazy"
  title="JSON view of the microdata"
  alt="JSON view of the microdata."
  style="width:35%;" />

<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~ Chapter 1-5-3. adding microdata to an html page (75) ~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch1-5-3">1.5.3 Adding Microdata to an HTML Page</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Basic steps</h4>

<p>Adding microdata to an HTML page is a really simple task and requires only three 
attributes: <b>itemscope, itemtype</b> and <b>itemprop</b>.</p>

<h4>1 - Define a container element by adding an itemscope attribute</h4>

<p>First, you need to add an itemscope attribute to an HTML element. This
will define the “global object” for which we will define properties.
This element can be of different types that we will describe later, but
for now let us keep looking at the same example we used in previous
sections:</p>

<pre>&lt;section itemscope itemtype=&quot;https://schema.org/Person&quot;&gt;
  ...
&lt;/section&gt;</pre>

<p>We will look at the itemtype attribute later. Now that we have defined a global 
wrapper object/element (a Person in this case), we can add properties inside this 
element to define the first name, last name, etc.</p>

<h4>2 - Specify the vocabulary used for your microdata with the itemtype attribute of 
the container element</h4>

<p>HTML5 proposes semantic elements for representing sections, articles, headers, etc, 
but it does not propose any specific elements or attributes to describe an address, a 
product, a person, etc.</p>
<p>We need a special vocabulary to represent a person or a physical address. With 
microdata you can define your own vocabulary or better, reuse one of the existing 
popular vocabularies, such as <a href="https://schema.org/" target="_blank" 
rel="noopener noreferrer">schema.org</a>.</p>
<p>Microdata works with properties defined as name/value pairs. The names are 
defined in the corresponding vocabulary. For example, the vocabulary for 
representing a <a href="https://schema.org/Person" target="_blank" 
rel="noopener noreferrer">Person</a> defines a set of property names.</p>
<p>As you can see in this small extract from the vocabulary (also called
a “schema”), a Person can have a name (some text), an Address (the type
is defined by another vocabulary named PostalAddress), an affiliation
(defined by another vocabulary named Organization) and so on.</p>
<p>We notice that one property, such as the address of a Person, may use
another vocabulary. Yes, a vocabulary may link to another vocabulary!
There is also inheritance between vocabularies! The above screenshot
shows that the Person vocabulary inherits from a Thing vocabulary, and
the five first properties of the table come from this vocabulary that
describes things.</p>
<p>If you are a developer and if you are familiar with object oriented
programming, think of properties as class attributes and think of
vocabularies as classes.</p>

<h4>Vocabularies are meant to be shared</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 63. picture of 'time to share' (76) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image063.webp"
  loading="lazy"
  title="Picture with words 'time to share'"
  alt="Picture with words 'time to share'."
  style="width:25%;" />
  
<p>If one of the existing vocabularies available at the schema.org Web
site fits your needs, you should reuse it, as the most popular
vocabularies are becoming de facto standards and will be taken into
account by Web crawlers, browsers, and browser extensions.</p>
<p>However, if you do not find a vocabulary corresponding to your needs,
keep in mind that anyone can define a microdata vocabulary and start
embedding custom properties in their own Web pages. You need to define a
namespace and put a description of your vocabulary in a Web page that
has the name of your vocabulary.</p>

<h4>3 - Add properties using the itemprop attribute in HTML elements inside the container</h4>

<h4>Basics:</h4>

<p>Now that you have defined a container element, you may add properties to the HTML inside:</p>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;section itemscope itemtype=&quot;https://schema.org/Person&quot;&gt;
  &lt;h1&gt;Contact Information&lt;/h1&gt;
  &lt;dl&gt;
    &lt;dt&gt;Name&lt;/dt&gt;
    &lt;dd [itemprop=&quot;name&quot;]&gt;Michel Buffa&lt;/dd&gt;
      &lt;dt&gt;Position&lt;/dt&gt;
      &lt;dd&gt;&lt;span [itemprop=&quot;jobTitle&quot;]&gt;
        Professor/Researcher/Scientist
      &lt;/span&gt; for
      &lt;span [itemprop=&quot;affiliation&quot;]&gt;University of Nice,
         France
      &lt;/span&gt;
    &lt;/dd&gt;
  &lt;/dl&gt;
  &lt;h1&gt;My different online public accounts&lt;/h1&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;https://www.twitter.com/micbuffa&quot;
      [itemprop=&quot;url&quot;]&gt;Twitter profile&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://www.blogger.com/micbuffa&quot;
      [itemprop=&quot;url&quot;]&gt;Michel Buffa&#39;s blog&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/section&gt;</pre>

</details>

<p>In this example, the container is a &lt;section&gt; that corresponds to
a Person (we have one clue here: the name of the vocabulary given by
the itemtype attribute), and each property defined inside this section
is identified by the value of the itemprop attribute of sub-elements.</p>

<h4>The line:</h4>

<pre>&lt;dd itemprop=&quot;name&quot;Michel Buffa&lt;/dd&gt;</pre>

<p>…defines a property called “name” that has a value of “Michel Buffa” 
(the text value between the opening and closing tags of the &lt;dd&gt; element).</p>

<h4>Nesting microdata items</h4>

<p>As we saw with the Person/Address example at the beginning of this
chapter, it is possible to nest microdata items inside one another.<br>
Give an element inside a microdata container its own itemscope attribute
with the recommended itemtype attribute for indicating the name of the
vocabulary used by the nested microdata.</p>

<h4>Again, look at the Person/Address example:</h4>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>...
&lt;/dl&gt;
  &lt;!-- SURFACE ADDRESS GOES HERE --&gt;
  &lt;dd itemprop=&quot;address&quot;[ itemscope]
    [itemtype=&quot;https://schema.org/PostalAddress&quot;]&gt;
    &lt;span itemprop=&quot;streetAddress&quot;&gt;10 promenade des anglais&lt;/span&gt;&lt;br&gt;
    &lt;span itemprop=&quot;addressLocality&quot;&gt;Nice&lt;/span&gt;,
    &lt;span itemprop=&quot;addressRegion&quot;&gt;Alpes maritimes, France&lt;/span&gt;
    &lt;span itemprop=&quot;postalCode&quot;&gt;06410&lt;/span&gt;&lt;br&gt;
    &lt;span itemprop=&quot;addressCountry&quot; itemscope
    [itemtype=&quot;https://schema.org/Country&quot;]&gt;
    &lt;span itemprop=&quot;name&quot;&gt;France&lt;/span&gt;
    &lt;/span&gt;
  &lt;/dd&gt;
&lt;h1&gt;My different online public accounts&lt;/h1&gt;
...</pre>

</details>

<p>The properties at <i>lines 8-12</i> refer to the address nested microdata (they are 
defined in the Address vocabulary, not the Person vocabulary), and “France” 
(<i>line 14</i>) is a property that refers to the Country vocabulary.</p>

<h4>Several properties with the same name but different values</h4>

<p>It is possible to use the same property name several times in one microdata 
object, but with different values: </p>

<pre>...
&lt;h1&gt;My different online public accounts&lt;/h1&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.twitter.com/micbuffa&quot;[ itemprop=&quot;url&quot;]&gt;Twitter
    profile&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.blogger.com/micbuffa&quot;[ itemprop=&quot;url&quot;]&gt;Michel
    Buffa&#39;s blog&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</pre>

<p>This defines the fact that Michel Buffa has two online accounts, and
the two properties have the name url, each with its own value.</p>

<h4>It is possible to set more than one property at once, with the same value</h4>

<p>Here are some microdata that represent a song. In this example, at line 5 we set two 
different properties: genre and keywords with the same value (see the 
<a href="https://schema.org/MusicRecording" target="_blank" rel="noopener noreferrer">
MusicRecording schema definition</a>):</p>

<pre>&lt;div itemscope itemtype=&quot;https://schema.org/MusicRecording&quot;&gt;
  &lt;h2&gt;The song I just published&lt;/h2&gt;
  &lt;ul&gt;
    &lt;li&gt;Name: &lt;span itemprop=&quot;name&quot;&gt;Please buy me on itunes, 
      I need money!&lt;/span&gt;&lt;/li&gt;
    &lt;li&gt;Band: &lt;span [itemprop=&quot;genre keywords&quot;]&gt;[Punk, Ska]&lt;/span&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;</pre>

<p>And so on…<br>
Now, let’s see what elements are compatible with the itemprop attribute and where the 
values of the properties are located, depending on each element type.</p>

<h4>The HTML elements compatible with the itemprop attribute</h4>

<p>If the itemprop attribute appears on a:</p>

<h4>Elements that can be associated with microdata</h4>

<div>
  <table>
    <colgroup>
      <col style="width: 35%" />
      <col style="width: 64%" />
    </colgroup>
    <thead>
      <tr class="header">
        <th>HTML5 elements</th>
        <th>microdata value associated</th>
      </tr>
    </thead>
    <tbody>
      <tr class="odd">
        <td>&lt;a&gt;, &lt;area&gt;, &lt;audio&gt;, &lt;embed&gt;, &lt;iframe&gt;, 
		  &lt;img&gt;, &lt;link&gt;, &lt;object&gt;, &lt;source&gt;, or &lt;video&gt; 
		  element</td>
        <td>The data is the url in the element’s href, src, or data attribute, as 
		  appropriate. For example, an image element inside a container of personal 
		  contact information can be recognized as that person’s photo and downloaded 
          accordingly.</td>
      </tr>
      <tr class="even">
        <td>&lt;time&gt; element</td>
        <td>The data is the time in the element’s datetime attribute. This lets you, for 
		  example, just say “last week” in your text content but still indicate exact 
		  date and time.</td>
      </tr>
      <tr class="odd">
        <td>&lt;meta&gt; element</td>
        <td>The data is whatever appears in the content attribute of the &lt;meta&gt; 
		  element. This is used when you need to include some data that isn’t actually 
		  in the text of your page.</td>
      </tr>
      <tr class="even">
        <td>anything else</td>
        <td>The data is whatever is in the text of the element.</td>
      </tr>
    </tbody>
  </table>
</div>

<p>For example, the value of a property defined in an &lt;img&gt; element will be the value of the src attribute:</p>

<pre>&lt;img itemprop=&quot;image&quot; src=&quot;MichelBuffa.png&quot; alt=&quot;A great professor&quot;&gt;</pre>

<p>Or, for a &lt;time&gt;, it will be the value of the datetime attribute:</p>

<pre>&lt;time itemprop=&quot;birthday&quot; datetime=&quot;1965-04-16&quot;&gt;April 16, 1965&lt;/time&gt;</pre>

<p>Or, for an &lt;a&gt; element, the value will be the value of the href attribute:</p>

<pre>&lt;a href=&quot;https://www.twitter.com/micbuffa&quot; itemprop=&quot;url&quot;&gt;profile&lt;/a&gt;</pre>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch1-5-4">1.5.4 Microdata Tools</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>There are many tools available (most are free) that you can use for generating, 
visualizing and debugging microdata. We list some of them in this page, but feel 
free to share the tools you find / like in the forums.</p>

<h4>Microdata generators</h4>

<p>To automatically generate microdata for describing persons, restaurants, movies, 
products, organizations, etc., there is a wide variety of microdata generators such 
as these listed below (but do not hesitate to search for “microdata generators” 
using your favorite search engine, and you will find lots!):</p>

<ul>
  <li>The <a href="https://webcode.tools/microdata-generator" target="_blank" rel="noopener
    noreferrer">Ultimate Microdata Generator</a></li>
  <li>The <a href="https://microdatagenerator.org/" target="_blank" rel="noopener 
    noreferrer">MicroData Generator</a></li>
  <li>The <a href="https://technicalseo.com/tools/schema-markup-generator/" 
    target="_blank" rel="noopener noreferrer">Schema Markup Generator (JSON-LD)</a></li>
</ul>

<h4>Example:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 64. microdata person generator (80) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://webcode.tools/microdata-generator" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image064.webp"
  loading="lazy"
  alt="Example of generator. I entered my name, job, city in a form and a text area 
  next to it shows the corresponding HTML microdata."
  style="width:35%;" /></a>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch1-5-5">1.5.5 Examples of Well Structured Documents with Microdata</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Here, we propose a few links to Web pages that were created by students of previous 
editions of this course).</p>
<p>The students had to create a Web page to introduce themselves, with some information 
including: name, job, employer, location, etc., and of course enrich the page with 
microdata. They also had to follow the best practices concerning the new structural 
elements, headings, etc.</p>
<p>Click on these pages and look at the source code…</p>

<h4>Example #1</h4>

<p>Visit the <a href="https://jsbin.com/cuzipa/edit?html,css,output" target="_blank" 
rel="noopener noreferrer">example #1 online</a>.</p>

<h4>Structure:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 65. microdata example #1 (80) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/cuzipa/edit?html,css,output" target="_blank" 
rel="noopener noreferrer">
<img class="displayed"
  src="./images/image065.webp"
  loading="lazy"
  title="Picture of the first 'about me' page example. Shows the table of contents"
  alt="Picture of the first 'about me' page example. Shows the table of contents."
  style="width:35%;" /></a>

<h4>Microdata:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~ 66. schema type/properties from microdata  (81) ~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image066.webp"
  loading="lazy"
  title="Microdata from the example page"
  alt="Microdata from the example page."
  style="width:35%;" />

<h4>Example #2:</h4>

<p>View the <a href="https://jsbin.com/karemi/1/edit?html,output" target="_blank" 
rel="noopener noreferrer">example #2 online</a>.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 67. example #2 page - shows microdata (81) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/karemi/1/edit?html,output" target="_blank" 
rel="noopener noreferrer">
<img class="displayed"
  src="./images/image067.webp"
  loading="lazy"
  title="Example page, shows table of contents"
  alt="Example page, shows table of contents."
  style="width:35%;" /></a>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h2>Module 2: HTML5 Multimedia - An Introduction</h2>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-1-1">2.1.1 HTML5 Multimedia - Streaming with &lt;video&gt; &amp; &lt;audio&gt; Elements</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Until 2012, it was only possible to integrate an audio or video player
using the proprietary Flash technology, marketed by the company
Macromedia (later acquired by Adobe). The &lt;video&gt; element of HTML5
is one of the three “Flash killers” (the others being &lt;audio&gt; for
the sound and &lt;canvas&gt; for drawing and animation). <i>(Note that
Adobe <a href="https://www.adobe.com/products/flashplayer/end-of-life.html" 
target="_blank" rel="noopener noreferrer">no longer supports Flash Player</a> 
since December 31, 2020)</i></p>

<h4>Check the HTML code of the following CodePen:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~ 68. codepen snapshot: simple html5 video player (82) ~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image068.webp"
  loading="lazy"
  title="Codepen snapshot: simple HTML5 video player"
  alt="Codepen snapshot: simple HTML5 video player."
  style="width:35%;" />

<h4>Please note that:</h4>

<ul>
  <li>The controls attribute indicates that a control panel with play/stop/volume/progress 
    widgets should be displayed;</li>
  <li>Usually the browser  will use the first format it recognizes  (in this case, the 
    browser checks whether mp4 is supported, and if not, it will check for the ogg format, 
    and so on). Some browsers may use a different heuristic and choose a “preferred” 
    format;</li>
  <li>The &lt;video&gt; element is a DOM member, so  CSS styling can be applied, as 
    well as manipulation using the DOM API.</li>
</ul>

<p>You will learn more about the different attributes of the &lt;video&gt; element 
later on in the course.</p>

<h4>Current browser support for the &lt;video&gt; element</h4>

<p>The &lt;video&gt; element is supported by all major browsers. See
the <a href="https://caniuse.com/video" target="_blank" rel="noopener noreferrer">
support table from CanIUse.</a></p>

<h4>Restriction: you cannot embed a YouTube or DailyMotion video using the 
&lt;video&gt; element</h4>

<p>Help! &lt;video src=“my youtube video URL”&gt;&lt;/video&gt; does not
work! </p>
<p><b>BEWARE</b>: you cannot directly embed videos from most of the
popular Web sites such as YouTube, Dailymotion, Vimeo, etc. For
commercial reasons, and because advertising is automatically added to
the videos, these Web sites do not allow “regular” embedding of their
videos.</p>
<p>While they use HTML5 to render their videos, these
hosting sites (YouTube, etc.) use rather complex techniques in order to
prevent you from using them with the &lt;video&gt;element. Instead, you
often need to embed an &lt;iframe&gt; that will render the HTML5 videos
in your Web site, and of course, the advertising that comes along with
them.</p>
<p>Usually you have an “embed” button close to the videos that prompts you
with some HTML code that you can copy and paste for embedding.</p>

<h4>An example using YouTube:</h4>

<h4>Here is the HTML code you need to copy and paste in order to embed avideo:</h4>

<pre>&lt;iframe width=&quot;560&quot; height=&quot;315&quot; 
  src=&quot;https://www.youtube.com/embed/WMFXg-kni0U&quot; title=&quot;YouTube video player&quot;
  frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope;
  picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;</pre>

<p>The YouTube video embedded in this page by the above code: it’s HTML5 but it’s not a 
&lt;video&gt; element directly inserted in the HTML of this page, it’s an &lt;iframe&gt;.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~ 69. web of things (wot) explainer video snapshot (83) ~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image069.webp"
  loading="lazy"
  title="Web of things (WoT) explainer video snapshot"
  alt="Web of things (WoT) explainer video snapshot."
  style="width:35%;" />

<h4>Support for different video CODECS (mp4, ogG, avi, etc.)</h4>

<p>This is one of the main problems encountered in recent years: codec support was not 
the same from one browser to another, for commercial/economic reasons. For example, 
between 2010 and 2013, Firefox only supported the ogg/oggm format. It did not support 
mp3/mp4 encoding for audio/video, while Internet Explorer only supported H.264 encoding. 
Since 2012, things have changed with browser updates and today most popular formats are 
supported.</p>
<p><i>The recommended CODEC, which works in all popular browsers: H264/mp4.</i></p>

<h4>External resources</h4>

<ul>
  <li>From W3C’s specification: <a href="https://www.w3.org/TR/html52/semantics-embedded-content.html#the-video-element" 
    target="_blank" rel="noopener noreferrer">The video element</a></li>
  <li>MDN’s Web Docs: <a href="(https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video" 
    target="_blank" rel="noopener noreferrer">&lt;video&amp;g;: The Video Embed element</a>)</li>
  <li>From Apple’s developer site: 
    <a href="https://developer.apple.com/library/archive/documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/ControllingMediaWithJavaScript/ControllingMediaWithJavaScript.html" 
      target="_blank" rel="noopener noreferrer">Safari HTML5 audio and video guide</a>.</li>
  <li>Article from HTML5 Rocks: <a href="https://www.html5rocks.com/en/tutorials/video/basics/" 
    target="_blank" rel="noopener noreferrer">Media</a></li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-1-2">2.1.2 The &lt;audio&gt; Element</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>HTML5 audio is composed of several layers:</h4>

<ul>
  <li>The &lt;audio&gt; element is useful for embedding an audio player into a Web page. 
    It is dedicated for <b>streamed audio</b>. It is very similar to the &lt;video&gt; 
    element, both in its use and in its API.</li>
  <li>The Web Audio API is designed for musical applications and for adding sound effects 
    to games. This pure JavaScript API supports manipulation of sound samples (loops, etc.), 
    music synthesis and sound generation (oscillators, etc.). It also comes with a set of 
    predefined sound processing modules (reverb, delay, etc.)</li>
</ul>

<p>This course will focus on the &lt;audio&gt; element. We present the 
<a href="https://www.w3.org/TR/webaudio/" target="_blank" rel="noopener noreferrer">Web Audio
API</a> and other advanced HTML5 features in the 
<a href="https://www.edx.org/course/html5-apps-and-games" target="_blank" 
rel="noopener noreferrer">W3Cx HTML5 Apps and Games course</a>.</p>

<p>The attributes, event set and JavaScript API of the &lt;audio&gt; element 
are just a “reduced” version of the ones from the &lt;video&gt; element, and 
here we will only address the differences and peculiarities.</p>

<h4>The &lt;audio&gt; element, basic usage</h4>

<p>Here is a simple example (also available <a href="https://jsbin.com/yogojis/edit?html,output" 
target="_blank" rel="noopener noreferrer">online example from JSBin</a>):</p>

<p>Press play to stream the neigh of a horse: (does not work in git)</p>

<h4>As you can see, the code is very similar to the basic &lt;video&gt; element usage.</h4>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
  &lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;/&gt;
    &lt;title&gt;horse song&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;audio controls=&quot;controls&quot;&gt;
      &lt;source src=&quot;https://mainline.i3s.unice.fr/mooc/horse.ogg&quot; 
        type=&quot;audio/ogg&quot; /&gt;
      &lt;source src=&quot;https://mainline.i3s.unice.fr/mooc/horse.mp3&quot; 
        type=&quot;audio/mp3&quot; /&gt;
      Your browser does not support the audio element.
      Download the audio/video in
      &lt;a href=&quot;https://mainline.i3s.unice.fr/mooc/horse.ogg&quot;&gt;OGG&lt;/a&gt;
      or &lt;a href=&quot;https://mainline.i3s.unice.fr/mooc/horse.mp3&quot;&gt;MP3&lt;/a&gt;
        format.
    &lt;/audio&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>In this example, just as for the &lt;video&gt; element, we used
the controls attribute in order to render the play/stop, time, volume
and progress widgets.</p>
<p>Notice the other similarities: between the &lt;audio&gt;…&lt;audio&gt; tags, we 
added a text message that is displayed if the Web browser doesn’t support the 
&lt;audio&gt; element,
and we used several &lt;source&gt;…&lt;/source&gt; elements that link to different 
audio formats for the same file. The browser will use the first format it recognizes.</p>

<h4>External resources</h4>

<ul>
  <li>From W3C’s specification: <a href="https://www.w3.org/TR/html52/semantics-embedded-content.html#the-audio-element" 
    target="_blank" rel="noopener noreferrer">The audio element</a></li>
  <li>From MDN’s Web Docs: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/audio" 
    target="_blank" rel="noopener noreferrer">&lt;audio&gt;: The Embed Audio element</a></li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-1-3">2.1.3 Attributes of &lt;video&gt; and &lt;audio&gt;</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Most useful attributes of the &lt;video&gt; element</h4>

<p>Here are the most common attributes you can use with the &lt;video&gt; element. They are self explanatory… </p>

<ul>
  <li>src: source of the video.</li>
  <li>width and height: size of the video. If unspecified, the default width and height 
    of the video will be used. If you specify one dimension but not the other, the 
    browser will adjust the size of the unspecified dimension to preserve the aspect 
    ratio of the video.</li>
  <li>controls: If this boolean attribute is present, the browser displays its own 
    controls for video playback and volume</li>
  <li>poster: This attribute allows you to specify an image that the browser will 
    use while video is being downloaded, or until the user starts playing the video. 
    If this attribute is not specified, the first frame of the video will be used 
    instead.</li>
  <li>autoplay: This attribute asks the browser to start playing the video 
    automatically as soon as the page is ready.</li>
  <li>preload:  The preload attribute is used when autoplay is not used. It 
    tells the browser what to do before a user plays a video. This attribute is a hint 
    - the browser may ignore it. While autoplay and preload are mutually exclusive, 
    if both are present, then preload is ignored. Possible values:
    <ul>
      <li>none: do nothing. This saves bandwidth, no video will be downloaded in background 
        before a user or a call to the play() method starts playing the video.</li>
      <li>metadata: download metadata, such as length of the video or its format.</li>
      <li>auto (default value): the browser will decide. This will depend on the 
        implementation, and on the kind of connection: wifi, 3G, data roaming etc.</li>
    </ul>
  </li>
  <li>loop: Another boolean attribute that indicates to play the video in loop mode (and 
    it starts again when finished).</li>
</ul>

<h4>Be careful if you target mobile applications or if you have multiple videos 
on the same page</h4>

<p>The autoplay attribute is not recommended if your Web site targets mobile 
applications (actually, it is often ignored by mobile browsers), as it may 
consume bandwidth even if the user is not interested in watching the proposed 
video. If you target mobile devices, we recommend using preload=none as well, 
as the default value for this attribute is auto.</p>
<p><b>Best practice</b>: do not use autoplay and add preload=“none” if you 
target mobile devices or if you have multiple audio/video files on the same 
page.  For example, 
<a href="https://thepaciellogroup.github.io/AT-browser-tests/test-files/audio.html" 
target="_blank" rel="noopener noreferrer">this page contains many audio elements</a> 
and it does not make sense to have them preload or autoplay.</p>

<h4>About the poster attribute</h4>

<p>If the poster attribute is missing, usually the first non-blank frame of the video 
will be used as the image that is shown when the video is not playing.</p>

<h4>About the autoplay attribute for general use</h4>

<p>Do not abuse of the autoplay attribute. We talked earlier about mobile applications, 
but even on desktop applications it’s usually a bad idea to use it (except for WebCams 
and for some animations with small video loops, without sound, or for sites like 
YouTube, with just videos).</p>
<p><b>Best practice</b>: think twice before using the autoplay attribute, even 
for desktop applications.</p>

<h4>Attributes of the &lt;audio&gt; element</h4>

<p>The attributes you can use with the &lt;audio&gt; element are a subset of 
those available for the &lt;video&gt; element. Except for the poster attribute, 
they are all recognized and have the
expected meanings:</p>

<ul>
  <li>src: source of an audio stream.</li>
  <li>controls: if this attribute is present, the browser displays its own controls 
    for audio playback and volume.</li>
  <li>autoplay: tells the browser to start playing the audio stream automatically as 
    soon as the page is ready - please read details in the above table.</li>
  <li>preload: tells the browser what to do before a user plays a sound - please read 
    details in the above table.</li>
  <li>loop:  indicates to play the audio stream in loop mode (start again when finished).</li>
</ul>

<p>As with the &lt;video&gt; element, the same best practice in regard to preload and autoplay 
attributes should be followed.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-1-4">2.1.4 Styling Media Players with CSS</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The &lt;video&gt; and &lt;audio&gt; elements are just like other HTML elements, so CSS 
can be used for styling, including CSS transitions, animations, etc.</p>

<h4>An example of an audio player with some style</h4>

<p>You can try this example <a href="https://jsbin.com/zoquru/2/edit?html,css,output" 
target="_blank" rel="noopener noreferrer">online at JSBin</a>.</p>

<p>To add some styling to the basic example we saw when we introduced the &lt;audio&gt; 
element, we just add a &lt;figure&gt; with two children: an &lt;img&gt; and a 
&lt;figcaption&gt;. Inside the &lt;figcaption&gt; we add the &lt;audio&gt; element 
from the previous example.</p>

<p>Please move the mouse pointer over this player’s elements: (does not work in git)</p>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;figure id=&quot;figaudio1&quot;&gt;
  &lt;img id=&quot;imghorse&quot; width=&quot;200&quot;
    src=&quot;https://upload.wikimedia.org/wikipedia/commons/d/d4/Nokota_Horses.jpg&quot;
      alt = &quot;a horse&quot;/&gt;
  &lt;figcaption id=&quot;figcptionaudio1&quot;&gt; Press Play to hear the horse!
    &lt;audio controls=&quot;controls&quot;&gt;
      &lt;source src=&quot;https://mainline.i3s.unice.fr/mooc/horse.ogg&quot;
        type=&quot;audio/ogg&quot; /&gt;
      &lt;source src=&quot;https://mainline.i3s.unice.fr/mooc/horse.mp3&quot;
        type=&quot;audio/mp3&quot; /&gt;
      Your browser does not support the audio element.
      Download the audio/video in
      &lt;a href=&quot;https://mainline.i3s.unice.fr/mooc/horse.ogg&quot;&gt;OGG&lt;/a&gt;
      or &lt;a href=&quot;https://mainline.i3s.unice.fr/mooc/horse.mp3&quot;&gt;MP3&lt;/a&gt;
        format.
    &lt;/audio&gt;
  &lt;/figcaption&gt;
&lt;/figure&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 70. two gery-black horses in a field (87) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image070.webp"
  loading="lazy"
  title="Two gery-black horses in a field"
  alt="Two gery-black horses in a field."
  style="width:20%;" />

<p>Press Play to hear the horse! (<i><b>does not work</b></i> in git)</p>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;figure id=&quot;figaudio1&quot;&gt;
  &lt;img id=&quot;imghorse&quot; width=&quot;200&quot;
    src=&quot;https://upload.wikimedia.org/wikipedia/commons/d/d4/Nokota_Horses.jpg&quot;
    alt = &quot;a horse&quot;/&gt;
  &lt;figcaption id=&quot;figcptionaudio1&quot;&gt; Press Play to hear the horse!
    &lt;audio controls=&quot;controls&quot;&gt;
      &lt;source src=&quot;https://mainline.i3s.unice.fr/mooc/horse.ogg&quot;
        type=&quot;audio/ogg&quot; /&gt;
      &lt;source src=&quot;https://mainline.i3s.unice.fr/mooc/horse.mp3&quot;
        type=&quot;audio/mp3&quot; /&gt;
        Your browser does not support the audio element.
        Download the audio/video in
      &lt;a href=&quot;https://mainline.i3s.unice.fr/mooc/horse.ogg&quot;&gt;OGG&lt;/a&gt;
        or &lt;a href=&quot;https://mainline.i3s.unice.fr/mooc/horse.mp3&quot;&gt;MP3&lt;/a&gt;
        format.
    &lt;/audio&gt;
  &lt;/figcaption&gt;
&lt;/figure&gt;</pre>

</details>

<br/>

<details>
  <summary><b>CSS source code:</b></summary>
  
<pre>#figaudio1 {
  width : 420px;;
  text-align:center;
  padding : 6px;
  background : white;
  margin : 0 11px 0px 0;
  border :solid 1px #888888;
  border-radius : 8px ;
}
#figcptionaudio1 {
  font-size : .8em;
  padding : 6px 8px;
  background : #dddddd;
  display :block;
  text-align :center;
  font-family : georgia, serif;
  font-style : italic;
  border-radius : 7px ;
}
#figaudio1 &gt; img {
  background : #eeeeee;
  padding : 5px;
  border : solid 1px #444444;
}
/* For audio and img transitions/animation */
audio, #figaudio1 &gt; img {
  transition:all 0.5s;
}
#figaudio1 &gt; img:hover {
  box-shadow: 15px 15px 20px rgba(0,0, 0, 0.4);
  transform: scale(1.05);
}
audio:hover, audio:focus, audio:active {
  box-shadow: 15px 15px 20px rgba(0,0, 0, 0.4);
  transform: scale(1.05);
}</pre>

</details>

<h4>Changing the size of a video on the fly using CSS transforms</h4>

<h4>Resizing and rotating a video as the mouse pointer comes over it</h4>

<p>See this <a href="https://jsbin.com/zoquru/4/edit?html,css,output" target="_blank" 
rel="noopener noreferrer">example online</a> (where you can modify the code on the fly) 
or just play the following video, and move the mouse pointer in and out of the video 
while it’s playing.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 71. pseudo css class: hover (88) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/zoquru/4/edit?html,css,output" target="_blank" 
rel="noopener noreferrer">
<img class="displayed"
  src="./images/image071.webp"
  loading="lazy"
  style="width:35%"
  title="Tilted screen example using pseudo css class: hover"
  alt="Tilted screen example using pseudo css class: hover." /></a>

<p>This example uses the pseudo CSS class :hover in order to track the mouseover event. 
On mouseover, it uses a CSS transition property that interpolates the changes in the 
scale and orientation of the video element (done using a transform CSS property).</p>

<h4>The corresponding HTML source code is:</h4>

<pre>&lt;video &lt;b&gt;id=&quot;w3devCampusVideo&quot;&lt;/b&gt; autoplay controls&gt;
  &lt;source src=https://mainline.i3s.unice.fr/mooc/samuraiPizzacat.webm
    type=video/webm&gt;
  &lt;source src=https://mainline.i3s.unice.fr/mooc/samuraiPizzacat.ogg
    type=video/ogg&gt;
  &lt;source src=https://mainline.i3s.unice.fr/mooc/samuraiPizzacat.mp4
    type=video/mp4&gt;
&lt;/video&gt;</pre>

<h4>… and the CSS source code is as follows:</h4>

<pre>#w3devCampusVideo {
  width: 300px;
  &lt;b&gt;transition: all 0.5s ease-in-out;&lt;/b&gt;
}
#w3devCampusVideo&lt;/b&gt;:hover&lt;/b&gt; {
  width:400px;
  transform:rotate(-5deg);
}</pre>

<h4>Fullscreen video that resizes and maintains ratios</h4>

<p>This is a trendy way of displaying videos.</p>
<p>Below you will find two examples that show how to do this trick. The first is for a 
“regular” video, using the &lt;video&gt; and &lt;source&gt; elements. This technique 
can also be used on any YouTube embedded videos (see Example #2 below).</p>
<p>The interesting part is that we use a 100% standard (and really small and simple) 
JavaScript code here to handle the window resize events and we just set regular CSS 
properties width and height of the video element, to resize the video.</p>

<h4>Example #1: with a regular video</h4>

<p>Full width, resizable, borderless video, just using plain CSS and JS DOM events.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 72. full width video like paypal site (89) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image072.webp"
  loading="lazy"
  style="width:40%"
  title="Full width video like paypal site"
  alt="Full width video like paypal site." />

<h4>Here is the HTML code. It’s really simple, just notice the &lt;body onload="init();"&gt; 
which calls the JavaScript init() function right after the page is loaded.</h4>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
  &lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;Full width video like PayPal site&lt;/title&gt;
  &lt;/head&gt;
  &lt;body onload=&quot;init();&quot;&gt;
    &lt;video id=&quot;myVideo&quot; autoplay&gt;
      &lt;source
      src=https://mainline.i3s.unice.fr/mooc/samuraiPizzacat.webm
      type=video/webm&gt;
    &lt;source
      src=https://mainline.i3s.unice.fr/mooc/samuraiPizzacat.ogg
      type=video/ogg&gt;
    &lt;source
      src=https://mainline.i3s.unice.fr/mooc/samuraiPizzacat.mp4
      type=video/mp4&gt;
  &lt;/video&gt;
&lt;/body&gt;</pre>

</details>

<h4>Here is the CSS (remove margins, remove padding, hide parts that could overflow from the &lt;body&gt;):</h4>

<pre>body {
  margin:0;
  padding:0;
  overflow:hidden;
}</pre>

<h4>And now the JavaScript code:</h4>

<pre>var video;
function init() {
  // function called when the page is loaded
  video = document.querySelector(&quot;#myVideo&quot;);
  // For initial value
  video.width = window.innerWidth;
  video.height = window.innerHeight;
  // For dealing with window resize
  window.onresize = function() {
    video.width = window.innerWidth;
    video.height = window.innerHeight;
  };
}</pre>

<h4>Example #2: with a YouTube video</h4>

<p>Full width, resizable, borderless YouTube video. To do this: just 100%
standard CSS + DOM manipulation using JavaScript.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 73. example video cropping (90) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image073.webp"
  loading="lazy"
  style="width:40%"
  title="Example video cropping"
  alt="Example video cropping." />

<p>The CSS and JavaScript codes for this example are exactly the same as in
Example #1.</p>

<h4>Full screen video, pure CSS approaches</h4>

<ol type="1">
  <li>Let’s use the video from the PayPal Web site, played full screen using only very simple CSS.</li>
</ol>

<p>In this example, the video does not rescale; it’s just cropped if the
browser window is resized. Enlarge your browser and you’ll see a man
with a phone on the right. Resize your browser and you’ll see only part
of the video.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 74. full screen video (90) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image074.webp"
  loading="lazy"
  style="width:40%"
  title="Full screen video"
  alt="Full screen video." />

<h4>CSS code:</h4>

<pre>body {
  margin:0;
  padding:0;
  overflow:hidden;
}
 
video {
  width:100%;
  height:auto;
}</pre>

<ol start="2" type="1">
  <li>Full screen video with CSS effects</li>
</ol>

<p>This time the video is zoomed in so that it’s much bigger than the browser’s 
window. When we resize the browser, the part of the video that is visible adapts 
itself. It’s not “real resize” of the video. Try this 
<a href="https://thenewcode.com/777/Create-Fullscreen-HTML5-Page-Background-Video" 
target="_blank" rel="noopener noreferrer">example and read the explanation in this 
article by Dudley Storey</a>.</p>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Full screen video with CSS effects &lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;header&gt;
    &lt;video autoplay loop=&quot;&quot;
      poster=&quot;https://mainline.i3s.unice.fr/mooc/polina.jpg&quot;
      id=&quot;bgvid&quot;&gt;
      &lt;source src=&quot;https://mainline.i3s.unice.fr/mooc/polina.webm&quot;
        type=&quot;video/webm&quot;&gt;
      &lt;source src=&quot;https://mainline.i3s.unice.fr/mooc/polina.mp4&quot;
        type=&quot;video/mp4&quot;&gt;
    &lt;/video&gt;
  &lt;/header&gt;
  &lt;section&gt;
    &lt;h1&gt;Full screen video with CSS effects&lt;/h1&gt;
  &lt;/section&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<br/>

<details>
  <summary><b>CSS source code:</b></summary>

<pre>html, body {
  color:white;
  height: 100%;
}
header {
  height: 100%;
  background-image: url(&#39;https://mainline.i3s.unice.fr/mooc/dots.png&#39;), url(&#39;#&#39;);
  background-repeat: repeat, no-repeat;
  background-size: auto, cover;
  background-position: center center, top left;
  font-family: sans-serif;
  color: #051a00;
}
header video {
  position:fixed;
  top:50%;
  left:50%;
  min-width:100%;
  min-height:100%;
  width:auto;
  height:auto;
  z-index:-100;
  transform:translateX(-50%) translateY(-50%);
}</pre>

</details>

<h4>The trick here is that:</h4>

<p>the video is in the header, and the header has a plotted transparent
background image (“dots.png”) that is repeated in X and Y (see <i>lines
8</i> and <i>9</i>).</p>

<ol start="2" type="1">
  <li>The video is positioned so that it’s origin (top left corner) is away from the 
    visible surface (<i>line 25</i>), while it is set to take 100% of the surface 
    (<i>lines 20</i> and <i>21</i>).</li>
</ol>

<p>Full screen video that resizes and keeps its ratio, using the viewport units.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 75. full screen using viweport units (88) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image075.webp"
  loading="lazy"
  style="width:40%"
  title="Full screen video that resized and keeps its ratio using viewport units"
  alt="Full screen video that resized and keeps its ratio using viewport units." />

<p>This time we obtain the same result as with the first example that used
JavaScript and a resize event. The video resizes correctly and keeps its
ratio.</p>

<details>
  <summary><b>CSS source code:</b></summary>

<pre>body {
  margin: 0;
}
video {
  position: absolute;
  width: 100vw;
  height: 100vh;
  object-fit: cover;
  object-position: center center;
}</pre>

</details>

<h4>Discussion: why can’t we achieve perfect resizing with only CSS and the
use of properties width=100% and height=100%?</h4>
<p>Let’s use the same video to compare the different approaches again:</p>

<ol>
  <li><a href="https://jsbin.com/zowuqey/edit?html,css,js,output" target="_blank" 
    rel="noopener noreferrer">Original approach</a>, using JavaScript. This solution 
    works on any browser, so we will focus on the two following methods, based on pure 
    CSS.</li>
  <li><a href="https://jsbin.com/sakujuv/1/edit?html,css,output" target="_blank" 
    rel="noopener noreferrer">Using CSS 100%</a> width and height properties (no 
    JavaScript).</li>
  <li><a href="https://jsbin.com/xureyu/3/edit?html,css,output" target="_blank" 
  rel="noopener noreferrer">Using CSS viewport</a> units for width and height 
  (no JavaScript).</li>
</ol>

<p>Resizing the browser window shows that #1 (JavaScript) and #3
(viewport units) behave in the same way: the width or height of the
video always fills the window (whichever is smaller), and we always see
the whole video.</p>
<p><b>Conclusion</b>: we can get full size video without JavaScript by
using viewport units (vw and vh), unless we need to support some old
browsers (see
their <a href="https://caniuse.com/#feat=viewport-units" target="_blank" rel="noopener noreferrer">current support on CanIUse</a>).</p>
<p>Setting the video to 100% width and height results in different behavior:</p>

<ul>
  <li>100% means 100% of the size of the &lt;body&gt; tag.</li>
  <li>The body tag’s width is 100% of the browser window width, so the video is always full width.</li>
  <li>The body tag’s height, however, is determined by the size of its children: the body tag’s height grows and shrinks to accommodate the size of the children.</li>
  <li>If the browser window is made wide and short, the video is full width, the height is taller than the window, and part of the video is not visible. It seems that just using % does not get us the same effect.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-1-5">2.1.5 Control Players From JavaScript</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The &lt;video&gt; and &lt;audio&gt; elements have methods,
properties/attributes and events that can be manipulated with
JavaScript. Using the DOM API, it’s possible to manipulate an audio or
video element as a JavaScript object that has:</p>
<ul>
  <li><b>Methods</b> for controlling the behavior, such as play(), pause(), etc.</li>
  <li><b>Properties</b> (duration, current position, etc.), either in read/write mode (such as volume), or in read-only mode (such as encoding, duration, etc.)</li>
  <li><b>Events</b> generated during the life cycle of the element that can be processed using JavaScript callbacks. It is also possible to send events to control the video player.</li>
</ul>

<p>The set of properties/attributes/methods of the &lt;audio&gt; and
&lt;video&gt; elements is called an “API” (Application Programming
Interface). For example, we will speak here of the “media API” to talk
about the associated API.</p>
<p>Like any HTML element, the &lt;video&gt; element can be manipulated/created using the DOM JavaScript API. Here is an example of programmatically creating a &lt;video&gt; element:</p>

<pre>var video = document.createElement(&#39;video&#39;);
video.src = &#39;video.mp4&#39;;
video.controls = true;
document.body.appendChild(video);</pre>

<p>This will create a complete video player for the file “video.mp4”, with
control buttons, and will add it to the &lt;body&gt; element of the page.</p>

<h4>Example that shows how to call play/pause or rewind a video</h4>

<p>Please look at this interesting example:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 76. how to call play/pause/rewind functions (94) ~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image076.webp"
  loading="lazy"
  style="width:40%"
  title="How to call the play/pause/rewind functions"
  alt="How to call the play/pause/rewind functions." />

<p>Note that in order to play the video, you must click on the “vid.play()”
text. To pause it, you click on the “vid.pause()” text, and so
on. <i>Notice the text at the top of the video, as well as the
transparency.</i> The text can be selected, since all the elements
displayed are pure DOM objects. You can zoom the page in and out, etc.
This was not possible with the Flash technology.</p>
<p><b>Conclusion</b>:  you can very easily change the look and feel of
the standard video player by using custom CSS and designing your own
control widgets. We can find many examples of such video players that
offer extended functionalities on the Web. We will present some of them
later in the course, but before that, let’s see a little more of what we
can do using the JavaScript API of the &lt;video&gt; element (it will be
an identical approach for the &lt;audio&gt; element, since it shares the
same API by a very small margin).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-1-6">2.1.6 The JavaScript API</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Methods, properties, and events</h4>

<p>The JavaScript API gives you powerful tools to manipulate
the &lt;video&gt; element, as the video object provides many properties,
methods and events.</p>
<p>The complete list of events can be found in the <a href="https://html.spec.whatwg.org/multipage/embedded-content.html#event-definitions" 
target="_blank" rel="noopener noreferrer">HTML5 living standard specification</a>.</p>
<p>The list of properties can be found at the <a href="https://www.w3.org/2010/05/video/mediaevents.html" 
target="_blank" rel="noopener noreferrer">W3C HTML5 Video Events and API</a> page. 
This page is interesting for Web developers because it shows an interactive view of the 
different values and events changing over time while the video is playing within the page.</p>
<p>Try the <a href="https://www.w3.org/2010/05/video/mediaevents.html" target="_blank" 
rel="noopener noreferrer">direct link</a>, and play with the different buttons and look 
at the table of events and properties that will change in real time. The displayed names
show the properties, events, and methods from the API.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~ 77. html5 video events and api (95) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image077.webp"
  loading="lazy"
  style="width:40%"
  title="HTML5 video events and API"
  alt="HTML5 video events and API." />

<h4>Here is a table that shows the most interesting methods, properties, and events provided by the &lt;video&gt; element API</h4>

<p>We provide this as a quick reminder - keep in mind that the 
<a href="https://html.spec.whatwg.org/multipage/media.html#mediaevents" 
target="_blank" rel="noopener noreferrer">complete list</a> is much longer!</p>

<div>
<table>
  <thead>
    <tr class="header">
      <th><b>Methods</b></th>
      <th><b>Properties</b></th>
      <th><b>Events</b></th>
    </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td><b>play()</b></td>
      <td><b>currentSrc</b></td>
      <td><b>play</b></td>
    </tr>
    <tr class="even">
      <td><b>pause()</b></td>
      <td><b>currentTime</b></td>
      <td><b>pause</b></td>
    </tr>
    <tr class="odd">
      <td>load()</td>
      <td>startTime (readonly)</td>
      <td>progress</td>
    </tr>
    <tr class="even">
      <td>canPlayType()</td>
      <td>videoWidth</td>
      <td>error</td>
    </tr>
    <tr class="odd">
      <td></td>
      <td>videoHeight</td>
      <td>timeupdate</td>
    </tr>
    <tr class="even">
      <td></td>
      <td>duration (readonly)</td>
      <td>ended</td>
    </tr>
    <tr class="odd">
      <td></td>
      <td>ended (readonly)</td>
      <td>abort</td>
    </tr>
    <tr class="even">
      <td></td>
      <td>error</td>
      <td>empty</td>
    </tr>
    <tr class="odd">
      <td></td>
      <td>paused (readonly)</td>
      <td>emptied</td>
    </tr>
    <tr class="even">
      <td></td>
      <td>muted</td>
      <td>waiting</td>
    </tr>
    <tr class="odd">
      <td></td>
      <td>seeking</td>
      <td>loadedmetadata</td>
    </tr>
    <tr class="even">
      <td></td>
      <td>volume</td>
      <td></td>
    </tr>
    <tr class="odd">
      <td></td>
      <td><b>height</b></td>
      <td></td>
    </tr>
    <tr class="even">
      <td></td>
      <td><b>width</b></td>
      <td></td>
    </tr>
    <tr class="odd">
      <td></td>
      <td><b>seekable (readonly)</b></td>
      <td></td>
    </tr>
    <tr class="even">
      <td></td>
      <td><b>played (readonly)</b></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>

<br>
<p></p>
<p>In the next pages, let’s see, through a set of examples, how to use
these most important properties, methods, and events…</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-1-7">2.1.7 The &lt;video&gt; Element JavaScript API</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The JavaScript API is useful for implementing playlists, making custom
user interfaces and many other interesting things. The “enhanced HTML5
multimedia players” lesson presented further on the course relies
heavily on this API.</p>

<h4>Example #1: how to use external buttons to control the player’s behavior</h4>
<p>This example gives the first steps towards writing a custom video
player. It shows basic usage of the JavaScript API for adding custom
buttons to play/pause the video or to go back to the beginning by
setting the currentTime property to zero.</p>

<h4>Try it online:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 78. example video player (97) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image078.webp"
  loading="lazy"
  style="width:40%"
  title="This example gives the first steps towards writing a custom video player"
  alt="This example gives the first steps towards writing a custom video player." />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 79. cartoon image, custom controls (97) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image079.webp"
  loading="lazy"
  style="width:35%"
  title="Example of custom controls"
  alt="Example of custom controls." />

<h4>Source code extract:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;video id=&quot;vid&quot; controls&gt;
  &lt;source src=https://mainline.i3s.unice.fr/mooc/samuraiPizzacat.webm
    type=video/webm&gt;
&lt;/video&gt;
&lt;p&gt;Example of custom controls:&lt;/p&gt;
&lt;button onclick=&quot;playVideo();&quot; style=&quot;cursor: pointer;&quot;&gt;Play&lt;/button&gt;
&lt;button onclick=&quot;pauseVideo();&quot; style=&quot;cursor: pointer;&quot;&gt;Pause&lt;/button&gt;
&lt;button onclick=&quot;rewindVideo();&quot; style=&quot;cursor: pointer;&quot;&gt;
  Back to beginning&lt;/button&gt;
&lt;script&gt;
  vid = document.querySelector(&quot;#vid&quot;);
  function playVideo() {
    vid.play();
  }
  function pauseVideo() {
    vid.pause();
  }
  function rewindVideo() {
    vid.currentTime = 0;
  }
&lt;/script&gt;</pre>

</details>

<h4>Explanations:</h4>

<ul>
  <li><i>Lines 6, 7 and 8</i>: we add a click listener to each button, in order to call a JavaScript function when each button is clicked.</li>
  <li><i>Line 11</i>: using the DOM API, we get the JavaScript object that corresponds to the video element we inserted in the HTML document. This line is outside a function, it will be executed when the page loads.</li>
  <li><i>Lines 12 and 15</i>: we call methods from the API for playing/pausing the video.</li>
  <li><i>Line 19</i>: we modify the currentTime property in order to rewind the video. Note that vid.load() also rewinds the video, shows the poster image again, but also pauses the video. By using currentTime=0, the playback does not stop.</li>
</ul>

<h4>Example #2: how to detect the end of a video and start another one</h4>

<p>This example listens to the ended event, and calls a callback function
when the video is ended.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~ 80. example calls a callback function when video ends (98) ~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image080.webp"
  loading="lazy"
  style="width:40%"
  title="This example listens to the ended event, and calls a callback function when the video is ended"
  alt="This example listens to the ended event, and calls a callback function when the video is ended." />

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;video src=&quot;video.ogv&quot; id=&quot;myVideo&quot;&gt;
  video not supported
&lt;/video&gt;
&lt;script type=&#39;text/javascript&#39;&gt;
  var vid = document.querySelector(&#39;#myVideo&#39;);
  vid.addEventListener(&#39;ended&#39;, playNextVideo, false);
  function playNextVideo(e) {
    // Whatever you want to do after the event, change the src attribute
    // of the video element, for example, in order to play another video
  }
&lt;/script&gt;</pre>

</details>

<h4>Example #3: how to manage playlists - sequential movies</h4>

<p>This example detects the end of a video, then loads the next video,
changes the src attribute of the video element and plays the video.</p>

<p>Check the online example below: use the progress cursor to go near the
end of the first video that is being played, and see how it
continues with the next video.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 81. manage playlists (99) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image081.webp"
  loading="lazy"
  style="width:40%"
  title="Manage playlists"
  alt="Manage playlists." />

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;/&gt;
    &lt;title&gt;Sequential Movies&lt;/title&gt;
    &lt;script&gt;
      var myVideo;
      var currentVideo = 0;
      var sources = [
        &quot;https://mainline.i3s.unice.fr/mooc/samuraiPizzacat.mp4&quot;,
        &quot;https://www.archive.org/download/AnimatedMechanicalArtPiecesAtMit/P1120973_512kb.mp4&quot;
      ];
      // Set the src of the video to the next URL in the playlist
      // If at the end we start again from beginning (the modulo
      // source.length does that)
      function loadNextVideo() {
        myVideo.src = sources[currentVideo % sources.length]
        myVideo.load();
        currentVideo++;
      }
      // listener plays the video
      function loadAndplayNextVideo() {
        console.log(&quot;playing &quot; + sources[currentVideo % sources.length])
        loadNextVideo();
        myVideo.play();
      }
      // Called when the page is loaded
      function init(){
        // get the video element using the DOM api
        myVideo = document.querySelector(&quot;#myVideo&quot;);
        // Defines a callback function called each time a video ended
        myVideo.addEventListener(&#39;ended&#39;, loadAndplayNextVideo, false);
        // Loads the first video when the page is loaded
        loadNextVideo();
      }
    &lt;/script&gt;
  &lt;/head&gt;
&lt;body onload=&quot;init()&quot;&gt;
  &lt;video id=&quot;myVideo&quot;
    controls&gt;
  &lt;/video&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Explanations:</h4>

<ul>
  <li><i>Line 9</i>: the JavaScript array that contains the URLs of the videos in the playlist. In this example, we’ve got only two of them, but if the array is larger the example still works.</li>
  <li><i>Line 44</i>: when the page is loaded, an init() function is called.</li>
  <li><i>Lines 34-40</i>: we use the DOM to get the JavaScript object corresponding to the video element, then define a listener for the ended event. Each time a video ends, the loadAndplayNextVideo() callback is called. As the video element has no src attribute by default, we also preload the first video (call to loadNextVideo() at <i>line 38</i>).</li>
  <li><i>Lines 17-21</i>: the loadNextVideo() function uses a variable called currentVideo that corresponds to the index of the current video. By setting myVideo.src = sources [currentVideo % sources.length], we set the src of the video element to sources[0], then to sources[1], and, as we increment the currentVideo index each time (line 19), if it becomes greater than 1, the modulo (the “%” symbol is the modulo in JavaScript) will make it “loop” between 0 and the number of videos in the playlist. In other words, when the last video ends, it starts back to the first one.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-1-8">2.1.8 <b>Advanced</b> Extended Examples</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>In this section, we propose five extended examples that use more
JavaScript and more complex CSS manipulation. They might be a little
hard to understand if you are a JavaScript beginner, but don’t be afraid
to try and test them, look at the code, etc.</p>

<p>Some examples are given “as is”, such as the custom video player that
uses SVG (at the end of the page); if you are interested, you may view
the code.</p>

<h4>Example #1: a player showing the use of every type of CSS3 transformation</h4>

<p>Please see this example online, originally written by <a href="https://christianheilmann.com/" 
target="_blank" rel="noopener noreferrer">Chris Heilmann</a>, and tuned by us ;).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~ 82. 2d transformations: scale, translate  rotate (100) ~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image082.webp"
  loading="lazy"
  style="width:40%"
  title="2d transformations: scale, translate & rotate"
  alt="2d transformations: scale, translate & rotate." />

<p>Don’t forget to click the JavaScript and CSS tabs of the CodePen in order to display the 
JavaScript code that creates the buttons on the right of the video, and the CSS that 
processes the different clicks and applies CSS3 transforms.</p>

<h4>This example shows a lot:</h4>

<ul>
  <li>It uses the HTML5 elements &lt;nav&gt;, &lt;footer&gt;, &lt;header&gt;.</li>
  <li>It shows the use of CSS3 2D transformations (scale, translate, and rotate).</li>
  <li>It shows how to handle DOM events using JavaScript and how to modify CSS 
    properties of the &lt;video&gt; element from JavaScript.</li>
</ul>

<h4>Example #2: how to track all possible events and manipulate many properties</h4>

<p>This example also shows how to handle failures. See the code and play with this example below:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 83. how to track all possible events (101) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image083.webp"
  loading="lazy"
  style="width:40%"
  title="Example #2. How to track all possible events"
  alt="Example #2. How to track all possible events." />

<p>Below is a piece of code for handling errors during video playback:</p>

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>...
vid.addEventListener(&#39;error&#39;, function(evt) {
  logEvent(evt,&#39;red&#39;);
}, false);
...
function logEvent(evt, color) {
  switch (evt.type) {
    ...
      case &#39;error&#39;:
      var error = document.querySelector(&#39;video&#39;).error;
      switch (error.code) {
        case error.MEDIA_ERR_ABORTED:
          note.innerHTML = &quot;fetching aborted at the user&#39;s request&quot;;
          break;
        case error.MEDIA_ERR_NETWORK:
          note.innerHTML = &quot;a network error caused the browser to stop fetching the media&quot;;
          break;
        case error.MEDIA_ERR_DECODE:
          note.innerHTML = &quot;an error occurred while decoding the media&quot;;
          break;
        case error.MEDIA_ERR_SRC_NOT_SUPPORTED:
          note.innerHTML = &quot;the media indicated by the src
            attribute was not suitable&quot;;
          break;
        default:
          note.innerHTML = &quot;an error occurred&quot;;
          break;
      }
    break;
  }
  ...
}</pre>

</details>

<h4>Example #3: how to display a percentage of buffering when using a slow connection</h4>

<p>See the <a href="https://jsbin.com/xororol/3/edit?html,output" target="_blank" rel="noopener noreferrer">
JSBin example online</a> here too.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 84. display percentage of buffering (102) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/xororol/3/edit?html,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image084.webp"
  loading="lazy"
  style="width:40%"
  title="Example #3. How to display a percentage of buffering"
  alt="Example #3. How to display a percentage of buffering." /></a>

<p>Note that on mobile phones, the video does not start until the user presses 
the play control or clicks on the video picture. Using the "canplaythrough" event 
is a trick to call a function that starts the video player as soon as the page 
is loaded on desktop. This event is not supported by mobile devices, so if you 
try this example on a mobile, the video will not start automatically.</p>

<p>As explained by the <a href="https://developer.apple.com/" target="_blank" 
rel="noopener noreferrer">Apple Developer Web site</a>: "The buffered property 
is a TimeRanges object: an array of start and stop times, not a single value. 
Consider what happens if the person watching the media uses the time scrubber 
to jump forward to a point in the movie that hasn’t loaded yet—the movie stops
loading and jumps forward to the new point in time, then starts buffering again 
from there. So the buffered property can contain an array of discontinuous ranges. 
The example simply seeks the end of the array and reads the last value, so it 
actually shows the percentage into the movie duration for which there is data."</p>

<br/>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;title&gt;JavaScript Progress Monitor&lt;/title&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;script&gt;
    function getPercentProg() {
      var myVideo = document.getElementsByTagName(&#39;video&#39;)[0];
      var endBuf = myVideo.buffered.end(0);
      var soFar = parseInt(((endBuf / myVideo.duration) * 100));
      document.getElementById(&quot;loadStatus&quot;).innerHTML = soFar + &#39;%&#39;;
    }
    // Will be called as soon as the page is ready on desktop computer,
    // Only when a user clicks on play control or image on mobile
    function myAutoPlay() {
      var myVideo = document.getElementsByTagName(&#39;video&#39;)[0];
      myVideo.play();
    }
    function addMyListeners(){
      var myVideo = document.getElementsByTagName(&#39;video&#39;)[0];
      myVideo.addEventListener(&#39;progress&#39;, getPercentProg, false);
      // Calls autoplay only if the device is adapted
      myVideo.addEventListener(&#39;canplaythrough&#39;, myAutoPlay, false);
    }
  &lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;addMyListeners()&quot;&gt;
  &lt;h1&gt;Check progression of buffering before playing a movie. Useful withy
    slow connexion (3G, etc.)&lt;/h1&gt;
  &lt;div&gt;
    &lt;video controls&gt;
      &lt;source src=https://html5doctor.com/demos/video-canvas-magic/video.webm
        type=video/webm&gt;
      &lt;source src=https://html5doctor.com/demos/video-canvas-magic/video.ogg  
        type=video/ogg&gt;
      &lt;source src=https://html5doctor.com/demos/video-canvas-magic/video.mp4
        type=video/mp4&gt;
    &lt;/video&gt;
    &lt;p id=&quot;loadStatus&quot;&gt;Buffering...&lt;/p&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Example #4: how to use SVG elements as external controllers</h4>

<p>This is the ultimate way of doing a real custom player: redesign your own controls using SVG shapes! 
This example  <a href="https://www.w3.org/2010/Talks/0430-www2010-plh/video-player.xhtml" 
target="_blank" rel="noopener noreferrer">(try it online) is given “as is” for those of you who may be curious</a>.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 85. cup on table xhtml5 and svg player (103) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image085.webp"
  loading="lazy"
  style="width:25%"
  title="Example #4. Snapshot of the Online Example of a Custom XHTML5/SVG Video 
    Player.  Image Shows a Cup of Coffee on a Table"
  alt="Example #4. Snapshot of the Online Example of a Custom XHTML5/SVG Video 
    Player.  Image Shows a Cup of Coffee on a Table." />

<h4>Example #5: a custom video player written by a previous student</h4>

<p>This is more an example than a tutorial. Maurice, a student who
followed the precursor version of this MOOC, had the assignment to write
a custom video player with playlist, video thumbnails, custom
play/pause/next/previous/volume controls, and present it in a Web page
that used a nice layout based on the HTML5 structuring elements studied
previously.</p>
<p>Here is the online example. We recommend that you look at the source
code:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-3-1">2.3.1 Enhanced HTML5 Media Players and Frameworks</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>This section introduces the HTML5 &lt;track&gt; element, useful for
adding closed captions, subtitles, descriptions, and metadata to your
videos. It comes with a new JavaScript API.</p>
<p>The WebVTT format used for describing a track file is also presented in
this chapter.</p>

<h4>Most of the major desktop browsers support HTML5 captioning</h4>

<p>Please check the <a href="https://caniuse.com/mdn-html_elements_track" target="_blank" rel="noopener noreferrer">
browser support</a> related to the &lt;track&gt; element support by browsers.</p>

<h4>Some definitions</h4>

<ul>
  <li><b>closed captions</b> describe all relevant audio present in the video (fire, rain, birds, gun fights, etc.).</li>
  <li><b>subtitles</b> are only for spoken words.</li>
</ul>

<br>
<p>The accessibility features of TV programs often propose both options for people with hearing deficiencies.</p>

<h4>Typical use: add a subtitle/caption track to a &lt;video&gt; element</h4>

<h4>Important warning!!</h4>

<p>The &lt;track&gt; element cannot be used with a file:// URL. Please use https:// and a Web server. 
Your server must use a special MIME format for the .vtt files: text/vtt;charset=utf-8 (set by default on most servers now).</p>

<h4>Examples of the lines to add to an Apache Web server:</h4>

<pre>&lt;Files mysubtitle.vtt&gt;
  ForceType text/vtt;charset=utf-8
&lt;/Files&gt;</pre>

<p>It is worth mentioning that most browsers work well with WebVTT, even
if the MIME type is not defined.</p>

<p>Here is an example of a video element that includes a &lt;track&gt; element 
in the .vtt (WebVTT) format (<i>line 9</i> in the source code shown below):</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 86. example snapshot (104) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image086.webp"
  loading="lazy"
  title="Example using a track element in the .vtt format"
  alt="Example using a track element in the .vtt format."
  style="width:40%;" />
  
<p>The example uses a &lt;track&gt; element to insert basic captions to the video: 
sounds and music are described, in addition to standard subtitles that correspond 
to what the different movie characters say.</p>

<pre>&lt;video height=&quot;272&quot; width=&quot;640&quot;
  poster=&quot;https://mainline.i3s.unice.fr/mooc/q1fx20VZ-640.jpg&quot;
  crossorigin=&quot;anonymous&quot;
  controls&gt;
&lt;source src=&quot;https://mainline.i3s.unice.fr/mooc/sintel.mp4&quot;
  type=&quot;video/mp4&quot;&gt;
&lt;source src=&quot;https://mainline.i3s.unice.fr/mooc/sintel.webm&quot;
  type=&quot;video/webm&quot;&gt;
&lt;track src=&quot;https://mainline.i3s.unice.fr/mooc/sintel-captions.vtt&quot;
  kind=&quot;captions&quot; label=&quot;Closed Captions&quot; default&gt;
&lt;/video&gt;</pre>

<h4>Notes:</h4>

<ul>
  <li>The &lt;track&gt; element at <i>line 9</i> has an attribute named kind that 
    indicates the type of the track that is included. Possible values are: subtitles, 
    captions, descriptions, chapters or metadata.</li>
  <li>The &lt;track&gt; element also has an attribute default that indicates that 
    we want this track to be displayed by default when reading the video.</li>
  <li>We also used an attribute named crossorigin that is necessary just to run this 
    demo, as it is required by the server that hosts the video from this example 
    (server = codepen.io, but as the video and .vtt files come from another origin 
    -another server-, this attribute is necessary).</li>
</ul>

<h4>Multiple tracks may be included in a video element</h4>

<p>Multiple tracks are needed to support different langages, video captions for the hearing-impaired, subtitles, etc.</p>

<p>Below is an example (<a href="https://html.spec.whatwg.org/multipage/media.html#the-track-element" 
target="_blank" rel="noopener noreferrer">from the specification</a>) that includes multiple &lt;track&gt; 
elements (subtitles for three languages and captions only for English):</p>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;video src=&quot;brave.webm&quot;&gt;
  &lt;track kind=subtitles src=brave.en.vtt
    srclang=en
    label=&quot;English&quot;&gt;
  &lt;track kind=captions src=brave.en.hoh.vtt
    srclang=en
    label=&quot;English for the Hard of Hearing&quot;&gt;
  &lt;track kind=subtitles src=brave.fr.vtt
    srclang=fr
    lang=fr 
    label=&quot;Français&quot;&gt;
  &lt;track kind=subtitles src=brave.de.vtt
    srclang=de
    lang=de
    label=&quot;Deutsch&quot;&gt;
&lt;/video&gt;</pre>

</details>

<p>Note the use of some new attributes in the &lt;track&gt; element:</p>

<ul>
  <li>label: the label value will be displayed in the GUI control that is included in the default HTML5 video player.</li>
  <li>srclang:  gives the language for the text track data. The value must be a valid 
    <a href="https://tools.ietf.org/html/bcp47" target="_blank" rel="noopener noreferrer">BCP 47 language tag</a>. 
    This attribute must be present if <a href="https://www.w3.org/TR/html5/embedded-content-0.html#attr-track-kind" 
    target="_blank" rel="noopener noreferrer">the element’s kind attribute</a> is in the 
    <a href="https://www.w3.org/TR/html5/embedded-content-0.html#attr-track-kind-subtitles" 
    target="_blank" rel="noopener noreferrer">subtitles state</a>.</li>
</ul>

<h4>External resources</h4>

<ul>
  <li>From the HTML specification: <a href="https://html.spec.whatwg.org/multipage/media.html#the-track-element" 
    target="_blank" rel="noopener noreferrer">The track element</a></li>
  <li>From the W3C specification: <a href="https://www.w3.org/TR/webvtt1/" 
    target="_blank" rel="noopener noreferrer">WebVTT: The Web Video Text Tracks Format</a></li>
  <li>From MDN’s Web Docs: <a href="https://www.3playmedia.com/2017/06/30/how-to-create-a-webvtt-file/" 
    target="_blank" rel="noopener noreferrer">WebVTT</a> and 
    <a href="https://developer.mozilla.org/en-US/docs/Web/Guide/Audio_and_video_delivery/Adding_captions_and_subtitles_to_HTML5_video" 
    target="_blank" rel="noopener noreferrer">Adding captions and subtitles to HTML5 video</a></li>
  <li>An article from 3playmedia: <a href="https://www.3playmedia.com/2017/06/30/how-to-create-a-webvtt-file/" 
    target="_blank" rel="noopener noreferrer">How to create a WebVTT file</a></li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-3-2">2.3.2 The WebVTT Format</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The "<a href="http://dev.w3.org/html5/webvtt/" target="_blank" rel="noopener noreferrer">
;WebVTT: The Web Video Text Tracks Format </a>" defines files that contain text for captions 
and subtitles, and much more… The WebVTT files are used with the src attribute of the &lt;track&gt; 
element, that can be used inside a &lt;video&gt;…&lt;/video&gt;.</p>
<p>In the interactive example presented before, we used a file called sintel-captions.vtt:</p>

<pre>&lt;video height=&quot;272&quot; width=&quot;640&quot;
  poster=&quot;https://mainline.i3s.unice.fr/mooc/q1fx20VZ-640.jpg&quot;
  crossorigin=&quot;anonymous&quot;
  controls&gt;
  ...
&lt;track src=&quot;https://mainline.i3s.unice.fr/mooc/sintel-captions.vtt&quot;
  kind=&quot;captions&quot; label=&quot;Closed Captions&quot; default&gt;
&lt;/video&gt;</pre>

<p>And here is an extract of the corresponding <a href="https://mainline.i3s.unice.fr/mooc/sintel-captions.vtt" 
target="_blank" rel="noopener noreferrer">sintel-captions.vtt</a> file:</p>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>WEBVTT
00:00:01.000 --&gt; 00:00:02.042
(drumbeat)
00:00:07.167 --&gt; 00:00:12.025
(plaintive violin solo playing)
00:00:15.000 --&gt; 00:00:18.183
(wind whistling)
00:00:24.167 --&gt; 00:00:27.025
(orchestra music swells)
00:00:43.033 --&gt; 00:00:43.192
(weapons clash)
00:00:44.000 --&gt; 00:00:44.175
(gasps)
00:00:44.183 --&gt; 00:00:45.158
(grunts)
00:00:45.167 --&gt; 00:00:47.058
(groaning)
00:00:54.192 --&gt; 00:00:55.150
(blade rings)
00:00:55.158 --&gt; 00:00:57.008
(bellowing)
00:00:57.017 --&gt; 00:00:58.067
(grunting)
00:00:59.075 --&gt; 00:01:00.133
(panting)
00:01:05.108 --&gt; 00:01:06.125
(cries out in agony)
00:01:08.050 --&gt; 00:01:09.058
(panting)
00:01:12.092 --&gt; 00:01:13.142
(panting)
00:01:14.017 --&gt; 00:01:18.125
(orchestra plays ominous low notes)
00:01:31.058 --&gt; 00:01:35.133
(plaintive violin solo returns)
00:01:46.158 --&gt; 00:01:49.058
This blade has a dark past.
00:01:51.092 --&gt; 00:01:54.108
It has shed much innocent blood.
00:01:57.083 --&gt; 00:02:00.000
You&#39;re a fool for traveling alone
so completely unprepared.
00:02:01.100 --&gt; 00:02:03.033
You&#39;re lucky your blood&#39;s still flowing.
00:02:04.183 --&gt; 00:02:06.075
Thank you.</pre>

</details>

<p>This format is rather simple, but we still recommend reading 
<a href="https://developer.mozilla.org/fr/docs/Web/API/WebVTT_API" target="_blank" rel="noopener noreferrer">
this excellent article from Mozilla Developer Network</a> that explains in detail all the different options.</p>
<p>Each “element” in this file has a starting and ending time, plus a value (the text that will be displayed), 
followed by a blank line (blanklines are separators between elements).</p>
<p><b>Each element is called “a cue”</b>, and may optionally have an ID that will be useful when using the 
track element JavaScript API, inparticular the getCueById() method of TextTrack objects.</p>

<h4>Example of a .vtt file with numeric IDs:</h4>

<pre>9
00:00:21.000 --&gt; 00:00:22.000
to hear from you
10
00:00:22.500 --&gt; 00:00:25.000
We want to hear what inspires you as a developer</pre>

<h4>IDs may also be defined as strings, and values can use HTML as well:</h4>

<pre>Opening
00:00:00.000 --&gt; 00:00:30.000
Welcome to our &lt;i&gt;nice film&lt;/i&gt;</pre>

<p>The displayed text can span multiple lines, but blank lines are not
allowed, as they would be interpreted as a separator:</p>

<pre>00:01:57.083 --&gt; 00:02:00.000
&lt;p&gt;You&#39;re a fool for traveling alone&lt;/p&gt;
&lt;p&gt;so completely unprepared.&lt;/p&gt;</pre>

<h4>External resource:</h4>

<ul>
  <li>An unofficial <a href="https://quuz.org/webvtt/" target="_blank" rel="noopener noreferrer">Live WebbVTT format</a></li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-3-3">2.3.3 Adding Subtitles to a Video</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Let’s look at a simple example. First, you need a video on one of the
formats/codecs supported by the browsers you target. A recommended
codec is mp4/H264, but other formats, such as webm, may have some
advantages if the browser supports them. For example, webm allows the
video to start playing after a much shorter buffering time. In other
words, try if possible to provide the video encoded with more than one
codec.</p>

<p>For this, use any sort of open source, free or commercial video encoding software, such
as <a href="https://handbrake.fr/" target="_blank" rel="noopener noreferrer">Handbrake</a> (free, open source) or 
<a href="https://www.erightsoft.com/SUPER.html" target="_blank" rel="noopener noreferrer">
Super</a> (free). There are also online video encoding services, and you can even upload
your video to YouTube, let it encode your video in several resolutions and codecs, and use 
a browser extension such as <a href="https://addons.mozilla.org/fr/firefox/addon/video-downloadhelper/" 
target="_blank" rel="noopener noreferrer">Video DownloadHelper</a> (for Firefox)
or <a href="https://jdownloader.org/" target="_blank" rel="noopener noreferrer">
JDownloader</a>, to download the video in your chosen formats.</p>

<p>So, let’s suppose you have a video like the one below (we included it on
YouTube for practical reasons). This video has subtitles (you can
activate them in the YouTube player), but the goal of this lesson is to
explain how we made them without using the YouTube embedded tools, which
do not allow export the subtitle file to be exported in the webVTT
format.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 87. picture guitar picking (108) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image087.webp"
  loading="lazy"
  title="Picture guitar picking"
  alt="Picture guitar picking."
  style="width:45%;" />

<p>And if you’ve also got it in mp4/H264 and in webm formats, here is how you can embed it in your page using the video element:</p>

<pre>&lt;video id=&quot;myVideo&quot; width=500 controls&gt;
  &lt;source
    src=&quot;videos/SameOldSongAndDanceRogerLathaudPart1MidRes.mp4&quot;
    type=&quot;video/mp4&quot;&gt;
  &lt;source
    src=&quot;videos/SameOldSongAndDanceRogerLathaudPart1MidRes.webm&quot;
    type=&quot;video/webm&quot;&gt;
  &lt;track src=&quot;videos/subtitles.vtt&quot;
    kind=&quot;subtitles&quot; srclang=&quot;en&quot; default&gt;
&lt;/video&gt;</pre>

<p>At <i>line 9</i>, we added a &lt;track&gt; element to add English subtitles, as the 
guitar teacher there is speaking in French. We will now explain how we created this 
subtitle track.</p>

<h4>Adding subtitles to the video</h4>

<p>Now, we need to create a WebVTT file for this video. How can we synchronize an English 
translation of what the guitar teacher says in French?</p>
<p>Many tools - both free and commercial - are available to add subtitles to a video. Most 
are native applications you need to install on your 
computer. However, a free and very practical tool is available for doing this 100% in a Web 
browser: <a href="https://amara.org/en/" 
target="_blank" rel="noopener noreferrer">amara</a>.</p>
<p>Go to the above Web site, click on the “subtitle a video” link, then follow the different 
tutorials/instructions. It will ask for a YouTube URL, so it’s better to first upload your 
video to YouTube (even in private mode). Once you have entered the URL of your video, you 
will have an online subtitles/caption editor. Enter your subtitles and sync them until you 
are happy with the results.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 88. example subtitles and captions (109) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image088.webp"
  loading="lazy"
  title="Example subtitles and captions"
  alt="Example subtitles and captions."
  style="width:40%;" />

<p>Once your subtitles/captions are ok, you will be able to upload them to YouTube, or -this 
is what we wanted first- download them as WebVTT format:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 89. youtube make subtitles (110) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image089.webp"
  loading="lazy"
  title="Youtube make subtitles"
  alt="Youtube make subtitles."
  style="width:35%;" />

<p>Note that YouTube can also help you “make subtitles” with its speech recognition tool, but 
you will only be able to export in .srt format afterwards. You will have to convert this format 
afterwards to .vtt.</p>

<h4>Try your subtitled/captioned video</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~ 90. example guitar picking subtitle captions (110) ~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image090.webp"
  loading="lazy"
  title="Example guitar picking subtitle captions"
  alt="Example guitar picking subtitle captions."
  style="width:40%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-3-4">2.3.4 Styling Captions</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>In this section, we will look at different possibilities for styling
and positioning  the text displayed as captions/subtitles while playing
a video.</p>
<p>The example below shows how we can do that (play the video for 40s, look
at the positions and styles of the subtitles and captions, look at the
HTML):</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 91. blank codepen (111) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image091.webp"
  loading="lazy"
  title="Blank CodePen"
  alt="Blank CodePen."
  style="width:35%;" />
   
<p>The WebVTT file is shown below. Notice the new attributes that have been added 
on the right end of the duration values:</p>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>WEBVTT
00:00:01.000 --&gt; 00:00:05.000
These captions test some features of the WebVTT formats
00:00:06.000 --&gt; 00:00:10.000 line:5%
This cue is positioned at the top of the video
00:00:11.000 --&gt; 00:00:15.000 position:5% align:start
This cue is positioned at the left side of the video.
00:00:16.000 --&gt; 00:00:20.000 position:95% align:end
And this one ate the right side.
00:00:21.000 --&gt; 00:00:25.000 size:33%
This cue is only a third of the width of the video, hence the multiple line breaks.
00:00:26.000 --&gt; 00:00:30.000
This cue contains &lt;b&gt;bold&lt;/b&gt; text.
00:00:31.000 --&gt; 00:00:35.000
This cue contains &lt;i&gt;italic&lt;/i&gt; text.
00:00:36.000 --&gt; 00:00:40.000
This cue contains &lt;u&gt; &lt;/u&gt; text.
00:00:41.000 --&gt; 00:00:45.000
This cue contains &lt;b&gt;&lt;i&gt;&lt;u&gt;bold, italic, 
underlined&lt;/u&gt;&lt;/i&gt;&lt;/b&gt; text.
00:00:46.000 --&gt; 00:00:50.000
&lt;c.myclass&gt;This cue contains the class &quot;myclass&quot;.
Browsers that support ::cue CSS should make it red.&lt;/c&gt;
00:00:51.000 --&gt; 00:00:55.000
The following cue contains two voices.
Tarzan should be blue and Jane green.
00:00:56.000 --&gt; 00:01:00.000
&lt;v Tarzan&gt;Me Tarzan...
&lt;v Jane&gt;That would make me Jane!
bigtext
00:01:01.000 --&gt; 00:01:05.000
This cue has a unique id.
Using CSS, its font size should be 150%.
00:01:06.000 --&gt; 00:01:10.000
The &lt;00:01:06.333&gt;text &lt;00:01:06.666&gt;in &lt;00:01:07.000&gt;this 
&lt;00:01:07.333&gt;cue &lt;00:01:07.666&gt;should &lt;00:01:08.000&gt;grow
&lt;00:01:08.333&gt;one &lt;00:01:08.666&gt;word &lt;00:01:09.000&gt;at 
&lt;00:01:09.333&gt;a &lt;00:01:09.666&gt;time
00:01:11.000 --&gt; 00:01:15.000
That&#39;s it! For now...</pre>

</details>

<h4>How to position the subtitles</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~ 92. example video: positioning subtitles (112) ~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image092.webp"
  loading="lazy"
  title="Example video: positioning subtitles"
  alt="Example video: positioning subtitles."
  style="width:40%;" />

<p>The video example tests nearly all the possibilities for positioning subtitles/captions, styling (using HTML element wrapping with &lt;b&gt;, &lt;i&gt;,  etc.), voicing (subtitles corresponding to different characters will be displayed in different colors) and CSS styling.</p>
<p>It is possible to locate the cues in the video viewport using absolute or relative values. The attributes that position the text are located on the same line as the cue definition, like at <i>line 9</i> of the previous WebVTT example file:</p>

<pre>00:00:11.000 --&gt; 00:00:15.000&lt;b&gt; position:5% align:start&lt;/b&gt;
This cue is positioned at the left side of the video.</pre>

<h4>There are several possible values:</h4>
<ul>
  <li><b>line:5%</b> means “vertical position at a line 5% of the height of the video viewport (it will be located at the top of the video”, proportional to its vertical size). </li>
  <li><b>position:5% align:start</b> means “regular location at the bottom of the video, the start of the sentence will be located at 5% of the width of the video”, i.e., near the left side.</li>
  <li><b>position:95% align:end</b> means “regular location at the bottom of the video, the end of the sentence will be at 95% of the horizontal width of the video”.</li>
  <li><b>size:33%</b> The size of each line will be one third of the size of the video. Since the sentence won’t fit, it will be displayed in multiple lines.</li>
</ul>

<p>And so on. Please look at the video as it is self-explanatory.</p>

<h4>Use of &lt;b&gt;, &lt;i&gt;, &lt;u&gt; for styling subtitles / captions</h4>
<p>One can use the HTML elements  &lt;b&gt;, &lt;i&gt;, &lt;u&gt; to modify the rendering of subtitles and captions, as illustrated in the example below:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~ 93. This cue contains bold, italic and underline text (113) ~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image093.webp"
  loading="lazy"
  title="This cue contains bold, italic and underline text"
  alt="This cue contains bold, italic and underline text."
  style="width:40%;" />
   
<h4>Using CSS classes for styling</h4>
<p>It is possible to style using CSS classes as part of a cue value,
using the &lt;c&gt; element. You can specify the CSS class that should be
applied by adding “.” followed by the name of your CSS class. Here is an
example:</p>

<pre>&lt;c.myclass&gt;This cue contains the class &quot;myclass&quot;.
Browsers that support ::cue CSS should make it red.&lt;/c&gt;</pre>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~ 94. video frame showing ::cue containing 'myclass' (113) ~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image094.webp"
  loading="lazy"
  title="Image of a video frame showing cue containing the class 'myclass'"
  alt="Image of a video frame showing cue containing the class 'myclass'."
  style="width:40%;" />

<h4>CSS rules used in this example:</h4>

<pre>&lt;style type=&quot;text/css&quot;&gt;
  ::cue(.myclass) { color: red; }
  ::cue(v[voice=&quot;Tarzan&quot;]) { color: blue; }
  ::cue(v[voice=&quot;Jane&quot;]) { color: green; }
  ::cue(#bigtext) { font-size: 150%; }
&lt;/style&gt;</pre>

<p>The ::cue pseudo element selector is used to match “cues” in the webVTT file. You add 
parenthesis and a secondary CSS selector to match cues that have a particular id, or a 
particular CSS class, etc. Look at the CSS above and at the extract from the webVTT file, 
play the video, you will understand how the above CSS classes affect the rendering of the 
subtitles for Jane and Tarzan’s voices.</p>
<p>Support differs from one browser to another, see <a href="https://caniuse.com/#feat=webvtt" 
target="_blank" rel="noopener noreferrer">this compatibility table</a> (from CanIuse). 
Note however that most of the enhanced players presented further on in the course provide full support.</p>

<h4>Using voicing for styling: the &lt;v&gt; element</h4>
<p>Here is an example that shows the voices of the different characters displayed with different colors:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 95. v tag example (114) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image095.webp"
  loading="lazy"
  title="v tag example. Tarzan and Jane"
  alt="v tag example. Tarzan and Jane."
  style="width:40%;" />

<p>Using the &lt;v&gt; tag, you will distinguish different voices that should be displayed in 
different colors (depending on the HTML5 video player implementation). See the CSS presented 
in the previous section to see how to specify the colors for the different voices.</p>

<h4>Example source code:</h4>

<pre>00:00:56.000 --&gt; 00:01:04.000
&lt;v Tarzan&gt;Me Tarzan...
&lt;v Jane&gt;That would make me Jane!</pre>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-3-5">2.3.5 Chapter</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>When you play a movie in DVD or Blu-Ray format, a menu appears on the
screen: play a movie, choose subtitles, etc. Usually there is also a
“chapters” menu that allows you to quickly access a part of the movie.
With videos on the Web, one can also indicate the chapter breakdown,
using WebVTT files and a &lt;track&gt; element/tag.</p>
<p>Adding chapters is very similar to adding subtitles/captions. Look
at <i>line 5</i> in the code below, where we use an
extra &lt;track&gt; element with a kind=“chapters” attribute.
</p>

<pre>&lt;video poster=&quot;webvtt_talk.png&quot; style=&quot;width:100%&quot; preload=&quot;metadata&quot;&gt;
  &lt;source src=&quot;webvtt_talk.webm&quot;&gt;
  &lt;source src=&quot;webvtt_talk.mp4&quot;&gt;
  &lt;source src=&quot;webvtt_talk.ogv&quot;&gt;
  &lt;track id=&quot;nav&quot; src=&quot;webvtt_talk_navigation.vtt&quot; 
    &lt;b&gt;kind=&quot;chapters&quot;&lt;b&gt; srclang=&quot;en&quot;&gt;
  &lt;track id=&quot;cc&quot; src=&quot;webvtt_talk_captions.vtt&quot; kind=&quot;captions&quot;
    label=&quot;captions&quot; srclang=&quot;en&quot; default&gt;
&lt;/video&gt;</pre>

<p>Here is an example of WebVTT files with defined chapters. Each "CUE" at 
<i>lines 3, 7, 11</i>, … can bear any name. We use "Chapter 1, Chapter 2, 
Ending, etc." but you are free to name them as you wish.</p>

<p>What makes them special is that the track has an attribute kind="chapters".
Often, the &lt;video&gt; elements rendered in standard browsers ignore chapters, 
but enhanced HTML5 players take them into account, and it’s not much of a stretch 
to make your own enhanced player with a nice chapter presentation, as we’ll see 
in a more advanced chapter of this course.  For example, we’ll generate a custom 
navigation menu, using the &lt;track&gt; JavaScript API (explained later in this 
section).</p>

<h4>Example of a WebVTT file that defines chapters:</h4>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>WEBVTT FILE
Chapter 1
00:00:00.000 --&gt; 00:00:10.700
Title Slide
Chapter 2
00:00:10.700 --&gt; 00:00:47.600
Introduction by Naomi Black
Chapter 3
00:00:47.600 --&gt; 00:01:50.100
Impact of Captions on the Web
Chapter 4
00:01:50.100 --&gt; 00:03:33.000
Requirements of a Video text format
Ending
00:03:33.000 --&gt; 00:04:57.766
Simple WebVTT file
Greetings 6
00:04:57.766 --&gt; 00:06:16.666
Styled WebVTT file</pre>

</details>

<p>An example of what you can achieve using chapters, using the 
<a href="https://www.jwplayer.com/" target="_blank" rel="noopener noreferrer">JW Player</a></p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 96. using the jw player (115) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image096.webp"
  loading="lazy"
  title="Using the JW player"
  alt="Using the JW player."
  style="width:40%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-3-6">2.3.6 Tools for Creating WebVTT Files</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Many tools are available to make and edit HTML5 video and caption/subtitles:</p>

<ul>
  <li>Tools for converting existing file formats to WebVTT files, such as 
    <a href="https://atelier.u-sub.net/srt2vtt/" target="_blank" rel="noopener noreferrer">
    Simple SubRip to WebVTT</a> converter, which is popular in the DivX/AVI/Mkv/mp4 scene. 
    Do a quick Web search and you will get plenty of other results.</li>
  <li>Tools for creating subtitles/captions from scratch. Use these to generate a 
    WebVTT file. You can embed the &lt;track&gt; element in your own videos, on your 
    own Web pages, or upload the WebVTT file to YouTube.  We recommend 
    <a href="https://amara.org/en/" target="_blank" rel="noopener noreferrer">
    amara</a>. It’s a free online tool that is very easy to use. There are also 
    apps such as <a href="https://www.macupdate.com/app/mac/25826/subs-factory" 
    target="_blank" rel="noopener noreferrer">Subs Factory</a> (Mac OS), 
    <a href="https://jubler.org/" target="_blank" rel="noopener noreferrer">
    Jubler</a> or <a href="https://nikse.dk/SubtitleEdit" target="_blank" 
    rel="noopener noreferrer">Subtitle Edit</a>) (Windows).</li>
  <li>Enhanced HTML5 video players that use the &lt;video&gt;, &lt;source&gt; and 
    &lt;track&gt; elements under the hood. They also provide many extra features, 
    including support for subtitle/caption formats other than WebVTT (by converting 
    on the fly).</li>
</ul>

<p>We do not claim that these are the best tools, so feel free to share your 
discoveries in the discussion forum!</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-3-7">2.3.7 The &lt;track&gt; JavaScript API</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Most “complex” HTML elements like forms, audio or video players, come with a 
JavaScript API that allows you to control them programmatically, customize them, etc.</p>

<h4>The &lt;track&gt; element comes with a powerful API that is used to develop 
many interesting features such as:</h4>
<ul>
  <li>Dynamically building a navigation menu that shows the different chapters of 
    the video.</li>
  <li>Synchronizing page content with timestamps in the WebVTT file (for example: 
    show a map next to the video, that shows the location corresponding to the 
    video content).</li>
  <li>Displaying all the subtitles/captions at once as HTML in the page.</li>
  <li>Making an app for creating on the fly subtitles/captions.</li>
  <li>Etc.</li>
</ul>

<h3>Examples of use</h3>

<h4>Example #1: add a navigation menu to start playing the video at given 
chapters</h4>

<p>This example shows a video with an enhanced progress bar that displays the 
different chapters as small "clickable" squares. Furthermore, using the JavaScript 
API of the &lt;track&gt; element, this Web site builds a navigation menu (on the 
right of the video):</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~ 97. navigation menu using the track javascript api (117) ~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image097.webp"
  loading="lazy"
  title="Navigation menu using the track JavaScript API"
  alt="Navigation menu using the track JavaScript API."
  style="width:40%;" />

<h4>Example #2: sync video with Google Map and Google Street View</h4>

<p>Check <a href="https://simpl.info/track/map/index.html" target="_blank" 
rel="noopener noreferrer">this demo (only on Chrome)</a> by 
<a href="https://samdutton.com/" target="_blank" rel="noopener noreferrer">
Sam Dutton</a>: it shows a video that comes with a WebVTT file that contains 
longitudes and latitudes. When the video plays, JavaScript functions are called 
at given times and get the longitude and latitude. A Google Map and a Google 
Street views are updated in real time.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~ 98. video sync with map and street views (117) ~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image098.webp"
  loading="lazy"
  title="Video sync with map and street views"
  alt="Video sync with map and street views."
  style="width:40%;" />

<h4>Example #3: sync guitar tablatures and music score with a video</h4>
<p>This example shows how we manage to render music scores in real time as the 
video plays. Some JavaScript code listens to the ontimeupdate event while the 
video is playing. We use the currentTime property of the video to know exactly 
where we are in the video. Finally, we also rely on an external library to render 
in an HTML5 canvas the bars corresponding to the current video explanations. We 
render in real time guitar pro tablatures using the alphatab.net library.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~ 99. we render in real time guitar pro tablatures using the alphatab.net library (118) ~~~-->
<img class="displayed"
  src="./images/image099.webp"
  loading="lazy"
  title="We render in real time guitar pro tablatures using the alphatab.net library"
  alt="We render in real time guitar pro tablatures using the alphatab.net library."
  style="width:40%;" />

<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-3-8">2.3.8 Enhanced HTML5 Video Players</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>There are numerous "enhanced" video players; most are free and open source, 
some are commercial. They offer lots of features, which are listed below. Not 
all of these features are available in every player, this list just illustrates 
what can be added to the standard &lt;video&gt; element.</p>

<p>We call them "HTML5 enhanced video players" because on top of being based on 
the &lt;video&gt; element, they come with custom features, custom look’n’feel, 
chapters, etc., based on a JavaScript API that makes such customization possible.</p>

<h4>Accessible players</h4>

<p>For those of you interested in this particular topic, here is a very good 
resource that compares most of the players presented in this section, in terms 
of accessibility. This resource has links to players designed especially for 
people with disabilities: <a href="https://www.digitala11y.com/accessible-jquery-html5-media-players/" 
target="_blank" rel="noopener noreferrer">accessible media players and resources</a>.</p>

<h4>Advantages and disadvantages of using a custom player</h4>

<h4>Advantages of enhanced video players:</h4>
<ul>
  <li>Support for all kinds of subtitle formats.</li>
  <li>Customizable look’n’feel (add your logo, custom themes, etc.)</li>
  <li>Full screen mode without borders on old browsers (today’s implementations 
    of the &lt;video&gt; element support full screen mode)</li>
  <li>Consistent look’n’feel across browsers (menus for subtitles, etc.)</li>
  <li>1.5x, 2x, 3x speeds for fast playback.</li>
  <li>Social buttons for sharing on Facebook, Twitter, etc.</li>
  <li>Support for chapters.</li>
  <li>Support for scrub bar thumbnails.</li>
  <li>Extra features for better accessibility.</li>
  <li>And so on…</li>
</ul>

<h4>Advantages of relying only on the &lt;video&gt; element rather than onan enhanced player:</h4>

<ul>
  <li>Total control!</li>
  <li>No need for external dependencies.</li>
  <li>Lightweight: no need to download lots of JavaScript and CSS code.</li>
</ul>

<h4>Video.js: a framework for building your own custom video player</h4>
<p>Open source, and made for developers, <a href="https://videojs.com/" 
target="_blank" rel="noopener noreferrer">video.js</a> comes with many 
plugins (chapters, thumbnails etc.).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 100. make your player yours (119) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image100.webp"
  loading="lazy"
  title="Video JS Examples: Make your player yours"
  alt="Video JS Examples: Make your player yours."
  style="width:40%;" />

<h4>Which should I use? the &lt;video&gt; element and my own customization or 
an out of the box enhanced player?</h4>

<p>Either solution (basic player or enhanced player) is good and HTML5 compliant.</p>
<p>Popular players such as <a href="https://www.jwplayer.com/" target="_blank" 
rel="noopener noreferrer">JWPlayer</a> have many explanations and examples on 
their Web sites, and are either free of charge or come with free versions.</p>

<h4>Interesting comparisons and reviews are available on the following Web sites:</h4>

<ul>
  <li>Comparison matrix of most of <a href="https://videosws.praegnanz.de/" 
    target="_blank" rel="noopener noreferrer">existing HTML5 video players.</a></li>
  <li><a href="https://toppersworld.com/10-html5-video-players-as-alternatives-to-flash-player/" 
    target="_blank" rel="noopener noreferrer">10 HTML5 video players compared.</a></li>
</ul>

<h4>Example screenshots</h4>
<p>Scrub Bar thumbnails (JWPlayer)</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 101. scrub bar thumbnails (120) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image101.webp"
  loading="lazy"
  title="Scrub bar thumbnails"
  alt="Scrub bar thumbnails."
  style="width:45%;" />

<p>Custom look’n’feel and logo (Sublime video player):</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 102. custom look and feel and logo (120) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image102.webp"
  loading="lazy"
  title="Custom look and feel with logo"
  alt="Custom look and feel with logo."
  style="width:40%;" />

<p>Chapters and chapter thumbnails (JWPlayer):</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 103. chapters and chapter thumbnails (120) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image103.webp"
  loading="lazy"
  title="Chapters and chapter thumbnails"
  alt="Chapters and chapter thumbnails."
  style="width:40%;" />

<p>PayPal accessible player:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~ 104. paypal accessible player (121) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image104.webp"
  loading="lazy"
  title="Paypal accessible player"
  alt="Paypal accessible player."
  style="width:40%;" />

<p>LeanBack (says "free for non-commercial use", licensing is not very clear…):</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 105. leanback player (121) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image105.webp"
  loading="lazy"
  title="Leanback player"
  alt="Leanback player."
  style="width:35%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-4-1">2.4.1 Webcam, microphone: the getUserMediaAPI</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Introduction</h4>

<p>HTML5 has introduced, with the getUserMedia and MediaDevices APIs, a
way to control webcams and microphones programmatically. This allows,
for example, to create an identification form where one can simply click
on a button to capture his portrait from the Webcam of his computer or
smartphone. It will also allow to record a video or audio extract (for
example for a "telephone answering machine" type application), to create
video conference applications running in the Web browser, or even
musical applications if you plug a guitar into a sound card. The
possibilities are numerous.</p>

<p>We will therefore study together how to access the audio and video
streams of the hardware on which a Web application is going to run, and
how to parameterize them (choice of camera, resolution, etc.).</p>

<h4>The getUserMedia API</h4>

<p>The <a href="https://www.w3.org/TR/mediacapture-streams/" target="_blank" 
rel="noopener noreferrer">getUserMedia API</a> is useful for controlling a 
Webcam video stream.</p>

<p>This API is one component of
the <a href="https://www.w3.org/TR/webrtc/" target="_blank" rel="noopener 
noreferrer">WebRTC specification</a>. When using getUserMedia, to manage a 
webcam with its video stream, we will always use it in conjunction with the 
&lt;video&gt; element. We could also use it with the &lt;audio&gt; element if 
we are only interested in using a microphone (i.e. from a computer), or any sound
input .</p>

<p>The getUserMedia API, when dealing with video streams, is always used in 
conjunction with the &lt;video&gt; element.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 106. simple web camera display (122) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image106.webp"
  loading="lazy"
  style="width:30%"
  title="Screenshot of a simple Web camera webcam display in a Web page"
  alt="Screenshot of a simple Web camera webcam display in a Web page." />

<h4>Typical use of the getUserMedia API with a Webcam</h4>

<p>The main idea is to set the srcObject attribute of a &lt;video&gt; element 
to the live video stream object coming out of the Webcam. To get this stream, 
you’ll have to call the navigator.getUserMedia(params) method from the getUserMedia 
API, that returns an ES6 promise (ES stands for "ECMAScript" and is the scripting 
language that forms the basis of JavaScript). Do not panic if you do not know 
ES6’s promises! The syntax is very simple, and you’ll learn what you need from 
the provided examples.</p>

<p>The stream is passed as a parameter to the then() method returned by the promise, 
as in this typical example (you can run it and see the result by clicking on the 
"CodePen" logo at the top right):</p>

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>&lt;video id=&quot;myVideo&quot; autoplay&gt;Fallback msg here.&lt;/video&gt;
&lt;script&gt;
  if (navigator.mediaDevices.getUserMedia) {
    // request video and audio stream from the user&#39;s webcam
    navigator.mediaDevices.getUserMedia({
      audio: true,
     video: true
   }).then((stream) =&gt; {
     let video = document.querySelector(&#39;#myVideo&#39;);
      video.srcObject = stream;
      video.play();
    }).catch((error) =&gt; {
      console.log(&#39;navigator.getUserMedia error: &#39;, error);
    });
  }
&lt;/script&gt;
We can also simplify the code by using a writing with async/await of JavaScript:
&lt;video id=&quot;myVideo&quot; autoplay&gt;Fallback msg here.&lt;/video&gt;
&lt;script&gt;
  async function startWebCam() {
    // request video and audio stream from the user&#39;s webcam
    let stream = await navigator.mediaDevices.getUserMedia({
      audio: true,
      video: true
    });
    let video = document.querySelector(&#39;#myVideo&#39;);
    video.srcObject = stream;
    video.play();
  }
  startWebCam();
&lt;/script&gt;</pre>

</details>

<p><b>HTTPS is mandatory:</b> for getUserMedia to work, it is mandatory to access 
the page that contains the JavaScript code through https://, for security reasons.</p>
<p>Support of getUserMedia/stream is <a href="https://caniuse.com/stream" 
target="_blank" rel="noopener noreferrer">very good in all modern browsers</a>, 
including mobile ones. All the video conferencing applications you use that 
run in a Web browser are based on this API (Google Meet, Jitsi, Bigblue Button), 
and even Microsoft Teams is a web application in disguise.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-4-2">2.4.2 More On getUserMedia</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Let’s see some more examples of what we can do with the getUserMedia API: 
start/stop the Webcam, take a screenshot from the current video stream from 
the Webcam, and apply CSS effects in real time. Below, we give links to some 
cool examples available on the Web.</p>

<h4>How to stop/release the Webcam</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~ 107. resulting image of michel buffa using webcam (125) ~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image107.webp"
  loading="lazy"
  style="width:35%"
  title="Resulting image of Michel Buffa using his WebCam, drinking from a ladle 
    with two custom controls below"
  alt="Resulting image of Michel Buffa using his WebCam, drinking from a ladle 
    with two custom controls below." />

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Webcam start/stop&lt;/title&gt;
  &lt;script&gt;
    let webcamStream;
    function startWebcam() {
      // request video and audio stream from the user&#39;s webcam
      navigator.mediaDevices.getUserMedia({
        audio: true,
        video: true
      }).then((stream) =&gt; {
        let video = document.querySelector(&#39;#video&#39;);
        video.srcObject = stream;
        video.play();
        webcamStream = stream;
      }).catch((error) =&gt; {
        console.log(&#39;navigator.getUserMedia error: &#39;, error);
      });
    }
    function stopWebcam() {
      webcamStream.getTracks()[0].stop(); // audio
      webcamStream.getTracks()[1].stop(); // video
    }
  &lt;/script&gt;
&lt;/head&gt;
&lt;body &gt;
  &lt;video width=400 height=400 id=&quot;video&quot; controls&gt;&lt;/video&gt;
  &lt;p&gt;
    &lt;button onclick=&quot;startWebcam();&quot;&gt;Start WebCam&lt;/button&gt;
    &lt;button onclick=&quot;stopWebcam();&quot;&gt;Stop WebCam&lt;/button&gt;
  &lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>In order to stop the Webcam and make the hardware "unlock it", you need to 
call the stop() method of the video stream.</p>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;title&gt;Webcam start/stop&lt;/title&gt;
&lt;script&gt;
  let webcamStream;
  
  function startWebcam() {
    // request video and audio stream from the user&#39;s webcam
    navigator.mediaDevices.getUserMedia({
      audio: true,
      video: true
    }).then((stream) =&gt; {
      let video = document.querySelector(&#39;#video&#39;);
      video.srcObject = stream;
      video.play();
 
      webcamStream = stream;
    }).catch((error) =&gt; {
        console.log(&#39;navigator.getUserMedia error: &#39;, error);
    });
  }
 
  function stopWebcam() {
    webcamStream.getTracks()[0].stop(); // audio
    webcamStream.getTracks()[1].stop(); // video
  }
&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;video width=400 height=400 id=&quot;video&quot; controls&gt;&lt;/video&gt;
  &lt;p&gt;
    &lt;button onclick=&quot;startWebcam();&quot;&gt;Start WebCam&lt;/button&gt;
    &lt;button onclick=&quot;stopWebcam();&quot;&gt;Stop WebCam&lt;/button&gt;
  &lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Explanations:</h4>

<ul>
  <li><i>Lines 11-13</i>: we call navigator.getUserMedia. The parameters indicate that we want to capture the video and the audio from the current device (default Webcam). The call to getUserMedia returns an ES6 promise: the then(stream) method that follows.</li>
  <li><i>Line 14</i>: the then(stream) method is called in case of success and gets the current audio/video stream as parameter. This is passed by the browser to your JavaScript code.</li>
  <li><i>Lines 15-19</i>: The <i>line 16 </i>sets the audio/video stream of the default Webcam to the srcObject attribute of the video element, while <i>line 18</i> starts displaying it in the video player (there can be more than one Webcam, we’ll see how to select one in particular next). <i>Line 19</i> stores the stream in a global variable so that we can use it from another function (for stopping/starting the Webcam…)</li>
  <li><i>Lines 19-23</i> define the catch method called in case of error (it could be that the Webcam cannot be accessed, or authorizations have not been granted).</li>
  <li><i>Lines 25-27</i>: a function for stopping the Webcam. We use the global variable webcamStream here, that has been initialized when we started using the Webcam in <i>line 19</i>. We have to stop separately the audio and the video streams.</li>
</ul>

<h4>Other examples that mix what we’ve seen in previous chapters, but this time with a live video stream</h4>

<h4>Applying CSS effects on a video element with a live webcam</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 108. example: css filter effects (128) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image108.webp"
  loading="lazy"
  style="width:30%"
  title="Resulting image of Michel Buffa using his WebCam with css filter effects on live stream"
  alt="Resulting image of Michel Buffa using his WebCam with css filter effects on live stream." />

<p>Try this example that shows how to use the getUserMedia API. Note the CSS 
effects (click on the video to cycle from one effect to another):</p>

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>//~~~~~~~~~~~~~~~~~~~~
// GET USER MEDIA CODE
//~~~~~~~~~~~~~~~~~~~~
let video;
let webcamStream;
function startWebcam() {
  // request video and audio stream from the user&#39;s webcam
    navigator.mediaDevices.getUserMedia({
      audio: true,
      video: true
    }).then((stream) =&gt; {
      let video = document.querySelector(&#39;#video&#39;);
      video.srcObject = stream;
      video.play();
      webcamStream = stream;
    }).catch((error) =&gt; {
      console.log(&#39;navigator.getUserMedia error: &#39;, error);
    });
  }
function stopWebcam() {
    webcamStream.getTracks()[0].stop(); // audio
    webcamStream.getTracks()[1].stop(); // video
  }
  //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  // CODE FOR CHANGING CSS FILTERS
  //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  let idx = 0;
  let filters = [
    &#39;grayscale&#39;,
    &#39;sepia&#39;,
    &#39;blur&#39;,
    &#39;brightness&#39;,
    &#39;contrast&#39;,
    &#39;hue-rotate&#39;, &#39;hue-rotate2&#39;, &#39;hue-rotate3&#39;,
    &#39;saturate&#39;,
    &#39;invert&#39;
  ];
function changeFilter(el) {
  // Remove all CSS classes for element el
  el.className = &#39;&#39;;
  // Choose a CSS class name
  console.log(&quot;toggling effect: &quot; + filters[idx  filters.length]);
  let effect = filters[idx++ % filters.length];
  el.classList.add(effect);
}</pre>

</details>

<br/>

<details>
  <summary><b>CSS source code:</b></summary>

<pre>#output {
  width: 307px;
  height: 250px;
  background: rgba(255,255,255,0.5);
  border: 1px solid #ccc;
}
#screenshot-stream {
  width: initial;
  height: initial;
}
#screenshot {
  vertical-align: top;
}
.blur {
  filter: blur(3px);
}
.brightness {
  filter: brightness(5);
}
.contrast {
  filter: contrast(8);
}
.hue-rotate {
  filter: hue-rotate(90deg);
}
.hue-rotate2 {
  filter: hue-rotate(180deg);
}
.hue-rotate3 {
  filter: hue-rotate(270deg);
}
.saturate {
  filter: saturate(10);
}
.grayscale {
  filter: grayscale(1);
}
.sepia {
  filter: sepia(1);
}
.invert {
  filter: invert(1)
}</pre>

</details>

<br/>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Webcam and CSS effects&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h1&gt;Example of CSS effects on a live video stream&lt;/h1&gt;
  &lt;p&gt;
    Click the button &quot;start webcam at the end of this page, then click on the video to toggle the 
    different effects.&lt;/p&gt;
  &lt;/p&gt;
  &lt;video onclick=&quot;changeFilter(this);&quot; width=400 height=400 id=&quot;video&quot; controls autoplay&gt;&lt;/video&gt;
  &lt;p&gt;
    &lt;button onclick=&quot;startWebcam();&quot;&gt;Start WebCam&lt;/button&gt;
    &lt;button onclick=&quot;stopWebcam();&quot;&gt;Stop WebCam&lt;/button&gt;
  &lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Taking a snapshot from the live Webcam stream</h4>

<p>The trick is to copy and paste the current image from the video
stream into a &lt;canvas&gt; element.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~ 109. take a snapshot from live webcam stream (130) ~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image109.webp"
  loading="lazy"
  style="width:40%"
  title="Take a snapshot from the live Webcam stream"
  alt="Take a snapshot from the live Webcam stream." />

<details>
  <summary><b>JavaScript source code:</b></summary>
  
<pre>//~~~~~~~~~~~~~~~~~~~~
// GET USER MEDIA CODE
//~~~~~~~~~~~~~~~~~~~~
let video;
let webcamStream;
function startWebcam() {
  // request video and audio stream from the user&#39;s webcam
  navigator.mediaDevices.getUserMedia({
    audio: true,
    video: true
  &gt;
  }).then((stream) =&gt; {
    video = document.querySelector(&#39;#video&#39;);
    video.srcObject = stream;
    video.play();
    webcamStream = stream;
  }).catch((error) =&gt; {
    console.log(&#39;navigator.getUserMedia error: &#39;, error);
  });
}

function stopWebcam() {
  webcamStream.getTracks()[0].stop(); // audio
  webcamStream.getTracks()[1].stop(); // video
}
  //~~~~~~~~~~~~~~~~~~~~~
  // TAKE A SNAPSHOT CODE
  //~~~~~~~~~~~~~~~~~~~~~
  var canvas, ctx;

function init() {
  // Get the canvas and obtain a context for
  // drawing in it
  canvas = document.getElementById(&quot;myCanvas&quot;);
  ctx = canvas.getContext(&#39;2d&#39;);
}
  
function snapshot() {
  // Draws current image from the video element into the canvas
  ctx.drawImage(video, 0,0, canvas.width, canvas.height);
}</pre>

</details>

<h4>CSS</h4>

<pre>canvas {
  border:1px solid black;
}</pre>

<br/>

<h4>HTML</h4>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;title&gt;WebCam screenshot&lt;/title&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;h1&gt;Take a snapshot of the current video stream&lt;/h1&gt;
    Check the CSS and JavaScript tabs. Click on the Start WebCam button.
  &lt;p&gt;
    &lt;button onclick=&quot;startWebcam();&quot;&gt;Start WebCam&lt;/button&gt;
    &lt;button onclick=&quot;stopWebcam();&quot;&gt;Stop WebCam&lt;/button&gt;
    &lt;button onclick=&quot;snapshot();&quot;&gt;Prendre un screenshot&lt;/button&gt;
  &lt;/p&gt;
  &lt;video onclick=&quot;snapshot(this);&quot; width=200 height=200 id=&quot;video&quot; controls autoplay&gt;&lt;/video&gt;
  &lt;p&gt;
    Screenshots : &lt;/p&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;200&quot; height=&quot;150&quot;&gt;&lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>We will look at this example in greater detail in the next course
section (related to the &lt;canvas&gt; element).</p>

<h4>Impressive demonstrations available on the Web</h4>

<ul>
  <li><a href="https://codepen.io/dlueth/pen/zBhwv" target="_blank" rel="noopener noreferrer">
    WebCam pixelization! Fun!</a></li>
  <li><a href="https://webcamtoy.com/" target="_blank" rel="noopener noreferrer">Webcam Toy</a>
    : video effects on Paul Neave’s webcam (using WebGL)</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-4-3">2.4.3 Using the Microphone</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Instead of using the getUserMedia API
with: navigator.getUserMedia({video:true}, onSuccess, onError), it is
also possible to use {audio:true} for the first parameter. In this case,
only the microphone input will be captured. Notice that {video:true,
audio:true} is also accepted, if you write a video conferencing system
and need to capture both the audio and the video (this is often the case
when writing WebRTC applications).</p>
<p>Apart from videoconferencing, microphone input will be used for music
Web apps, from the <a href="https://www.w3.org/TR/webaudio/" target="_blank" rel="noopener noreferrer">WebAudio
API</a>. This API focuses on real time sound processing and music
synthesis. This API is covered in the advanced W3Cx HTML5 course
(<a href="https://www.edx.org/course/html5-apps-and-games" target="_blank" rel="noopener noreferrer">HTML5 Apps
and Games</a>).</p>
<p>Check out the <a href="https://webaudiodemos.appspot.com/" target="_blank" rel="noopener noreferrer">WebAudio
demonstrations</a> written by Chris Wilson, esp. the one called “Input
effects”.</p>
<p>The image below is taken
from <a href="https://webaudiodemos.appspot.com/input/index.html" 
target="_blank" rel="noopener noreferrer">one of the demonstrations</a>, 
where the sound captured by the microphone is processed in real time. 
We get visualizations of the signal in real time as an animated waveform, 
animated frequencies or animated audiogram. If we connect an electric guitar 
to the sound card input, then this demonstration shows that we can recreate 
with WebAudio most of the classic effects used by guitarists (delay, reverb, 
distortion, chorus, etc.).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~ 110. webaudio live processing (132) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image110.webp"
  loading="lazy"
  style="width:40%"
  title="WebAudio Live Processing"
  alt="WebAudio Live Processing." />

<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-4-4">2.4.4 Webcam Resolution</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>It is possible to set “hints” for the preferred cam/resolution during
video capture. This is done by using a <a href="https://tools.ietf.org/html/draft-alvestrand-constraints-resolution-00#page-4" 
target="_blank" rel="noopener noreferrer">"constraint" object</a> that is passed as a parameter to the 
getUserMedia(…) method. It’s just the same object we passed in the basic example: navigator.getUserMedia({video:true}, success, error) 
except that this time this object is a little more complex by including new properties in addition to video:true or audio:true.</p>
<p>For more information, this <a href="https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia" 
target="_blank" rel="noopener noreferrer">article on MDN about the getUserMedia API</a> gives great examples on 
how to set the camera resolution and/or to choose the front or back camera when using a mobile phone.</p>

<h4>Typical use:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 111. set camera resolution (127) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image111.webp"
  loading="lazy"
  style="width:40%"
  title="How to set camera resolution on mobile phone"
  alt="How to set camera resolution on mobile phone." />

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>var vgaButton, qvgaButton, hdButton, dimensions, video, stream;
function init() {
  vgaButton = document.querySelector(&#39;button#vga&#39;);
  qvgaButton = document.querySelector(&#39;button#qvga&#39;);
  hdButton = document.querySelector(&#39;button#hd&#39;);
  dimensions = document.querySelector(&#39;p#dimensions&#39;);
  video = document.querySelector(&#39;video&#39;);
    // Defines event listeners for the buttons that set the resolution
    qvgaButton.onclick = function() {
      getMedia(qvgaConstraints);
    };
    vgaButton.onclick = function() {
      getMedia(vgaConstraints);
    };
    hdButton.onclick = function() {
      getMedia(hdConstraints);
    };
    // Trick: check regularly the size of the video element and display it
    // When getUserMedia is called the video element changes it sizes but for
    // a while its size is zero pixels... o we check every half a second
    video.addEventListener(&#39;play&#39;, function() {
    setTimeout(function() {
      displayVideoDimensions();
    }, 500);
  });
}
  // The different values for the constraints on resolution
  var qvgaConstraints = {
    video: {
      width: { max: 320 },
      height: { max: 180 }
    }
  };
  var vgaConstraints = {
    video: {
      width: { max: 640 },
      height: { max: 360 }
    }
  };
  var hdConstraints = {
    video: {
      width: { min: 1280 },
      height: { min: 720 }
    }
  };
  // The function that is called when a button has been clicked: starts the video
  // with the preferred resolution

function getMedia(constraints) {
  if (!!stream) {
    video.srcObject = null;
    stream.getTracks()[0].stop();
  }
  navigator.mediaDevices.getUserMedia(constraints)
  .then((stream) =&gt; {
    video.srcObject = stream;
    video.play();
    window.stream = stream;
  })
  .catch((error) =&gt;{
    console.log(&#39;navigator.getUserMedia error: &#39;, error);
  });
}
  // util function that is called by the setInterval(...) every 0.5s, for
  // displaying the video dimensions
  function displayVideoDimensions() {
  dimensions.innerHTML = &#39;Actual video dimensions: &#39; + video.videoWidth +
  &#39;x&#39; + video.videoHeight + &#39;px.&#39;;
  }</pre>

</details>

<h4>CSS</h4>

<pre>video {
  border:1px solid;
}</pre>

<br/>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;title&gt;getUserMedia constraints for Webcam resolutions&lt;/title&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;h1&gt;Set the camera resolution&lt;/h1&gt;
  Example adapted from:
  &lt;a href=&quot;https://www.simpl.info/getusermedia/constraints/&quot;&gt;
    https://www.simpl.info/getusermedia/constraints/
  &lt;/a&gt;
  &lt;br&gt;
  &lt;p&gt;Click a button to call &lt;code&gt;getUserMedia()&lt;/code&gt; with appropriate resolution. &lt;/p&gt;
  &lt;div id=&quot;buttons&quot;&gt;
    &lt;button id=&quot;qvga&quot;&gt;QVGA&lt;/button&gt;
    &lt;button id=&quot;vga&quot;&gt;VGA&lt;/button&gt;
    &lt;button id=&quot;hd&quot;&gt;HD&lt;/button&gt;
  &lt;/div&gt;
  &lt;p id=&quot;dimensions&quot;&gt;&lt;/p&gt;
  &lt;video autoplay&gt;&lt;/video&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 112. function getusermedia (130) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image112.webp"
  loading="lazy"
  style="width:45%"
  title="Call getUserMedia() function for appropriate resolution"
  alt="Call getUserMedia() function for appropriate resolution." />

<h4>Code source extract related to the "constraint" object which specifies the 
desired resolutions:</h4>

<details>
  <summary><b>JavaScript source code:</b></summary>
  
<pre>var vgaConstraints = {
  video: {
    width: { max: 640 },
    height: { max: 360 }
  }
};
var hdConstraints = {
  video: {
    width: { min: 1280 },
    height: { min: 720 }
  }
};
let constraints = hdConstraints;
navigator.mediaDevices.getUserMedia(constraints)
  .then((stream) =&gt; {...}</pre>

</details>

<h4>How to check which resolutions are supported by a browser?</h4>

<p>Use this <a href="https://webrtchacks.github.io/WebRTC-Camera-Resolution/" 
target="_blank" rel="noopener noreferrer">Web app that</a> systematically tests 
a set of "preferred resolutions" and compared them to the actual resolutions 
returned by the browser. Remember that the requested resolution is a hint, and 
there is no real guarantee that your configuration will allow it.</p>

<h4>Selecting the front or rear camera on smartphones</h4>

<p>Here are some other constraints you can set. In particular, look at
the ones for selecting the front or rear camera (smartphones):</p>

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>// more on video resolution
constraints = {
  video: {
    width: { min: 1024, ideal: 1280, max: 1920 },
    height: { min: 776, ideal: 720, max: 1080 }
  }
}
// Framerate
constraints = { video: { frameRate: { ideal: 10, max: 15 } } };
// front and back camera (mobile), some examples
var front = false;
document.getElementById(&#39;flip-button&#39;).onclick = function() {
  front = !front;
};
// toggle front and back camera (mobile) by clicking a button
constraints = { video: { facingMode: (front? &quot;user&quot; : &quot;environment&quot;) } };
// prefer front camera
constraints = { audio: true, video: { facingMode: &quot;user&quot; } }
// require rear camera
constraints = { audio: true, video: { facingMode: { exact: &quot;environment&quot; } } }</pre>

</details>

<h4>Select input/output for audio and video streams</h4>

<ul>
  <li>Resource: <a href="https://webrtc.github.io/samples/src/content/devices/input-output/" 
    target="_blank" rel="noopener noreferrer">WebRTC samples: Select sources &amp; outputs</a></li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~ 113. webapp for selecting audio and video input/output (131) ~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image113.webp"
  loading="lazy"
  style="width:45%"
  title="Webapp for selecting audio and video input/output"
  alt="Webapp for selecting audio and video input/output." />

<details>
  <summary><b>JavaScript source code:</b></summary>
  
<pre>function gotDevices(deviceInfos) {
  for (var i = 0; i !== deviceInfos.length; ++i) {
    var deviceInfo = deviceInfos[i];
    console.log(&quot;device with id: &quot; + deviceInfo.deviceId);
    // possible values: audioinput, audiooutput, videoinput
    console.log(&quot;device with kind: &quot; + deviceInfo.kind);
    // &#39;speaker&#39; or &#39;camera&#39; for example
    console.log(&quot;device with label: &quot; + deviceInfo.label);
    //... should build a menu, test kind/label and set
    // audioSource and videoSource variables
  }
}
// ...
var constraints = {
  audio: {deviceId: audioSource ? {exact: audioSource} : undefined},
  video: {deviceId: videoSource ? {exact: videoSource} : undefined}
};
navigator.mediaDevices.getUserMedia(constraints).
then(gotStream).then(gotDevices).catch(handleError)</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch2-4-5">2.4.5 The MediaRecorder API</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>This MediaRecoredr API allows to record / capture the audio or video
stream. There are many sources for audio or video streams, but we will
only consider here the streams coming from a WebCam or a sound input
(i.e. microphone).</p>
<p>For example, the MediaRecorder API is used to record the video stream
from a WebCam as a file saved on the hard disk. Below is a screenshot of
an application allowing to record the WebCam. You will be able to run
this example a little further, but for security reasons, it cannot run
directly in this Web page.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 114. webrtc samples mediarecorder (132) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image114.webp"
  loading="lazy"
  style="width:40%"
  title="Screenshot showing on the left the webcam video stream, and on the right 
    the same stream recorded and playable in a HTML video element"
  alt="Screenshot showing on the left the webcam video stream, and on the right 
    the same stream recorded and playable in a HTML video element." />

<p>Let’s record, replay and download the video stream captured using a Webcam. 
You can test it below by clicking on "CodePen" at the top right:</p>

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>var mediaRecorder;
var recordedBlobs;
var gumVideo = document.querySelector('video#gum');
var recordedVideo = document.querySelector('video#recorded');
var recordButton = document.querySelector('button#record');
var playButton = document.querySelector('button#play');
var downloadButton = document.querySelector('button#download');
recordButton.onclick = toggleRecording;
playButton.onclick = play;
downloadButton.onclick = download;
// get stream using getUserMedia
navigator.mediaDevices.getUserMedia({ audio: true,video: true})
  .then((stream) => {
    recordButton.disabled = false;
    console.log('getUserMedia() got stream: ', stream);
    window.stream = stream;
    gumVideo.srcObject = stream;
  })
  .catch((error) => {
    console.log('navigator.getUserMedia error: ', error);
  });
function handleDataAvailable(event) {
  if (event.data && event.data.size > 0) {
    recordedBlobs.push(event.data);
  }
}
function handleStop(event) {
  console.log('Recorder stopped: ', event);
}
function toggleRecording() {
  if (recordButton.textContent === 'Start Recording') {
    startRecording();
  } else {
    stopRecording();
    recordButton.textContent = 'Start Recording';
    playButton.disabled = false;
    downloadButton.disabled = false;
  }
}
// create the media recorder
function startRecording() {
  recordedBlobs = [];
    
  try {
    mediaRecorder = new MediaRecorder(window.stream);
  } catch (e) {
    console.error('Exception while creating MediaRecorder: ' + e);
    return;
  }
  console.log('Created MediaRecorder', mediaRecorder);
  recordButton.textContent = 'Stop Recording';
  playButton.disabled = true;
  downloadButton.disabled = true;
  mediaRecorder.onstop = handleStop;
  mediaRecorder.ondataavailable = handleDataAvailable;
  mediaRecorder.start(10); // collect 10ms of data
  console.log('MediaRecorder started', mediaRecorder);
}
function stopRecording() {
  mediaRecorder.stop();
  console.log('Recorded Blobs: ', recordedBlobs);
  recordedVideo.controls = true;
}
function play() {
  var superBuffer = new Blob(recordedBlobs, {type: 'video/webm'});
  recordedVideo.src = window.URL.createObjectURL(superBuffer);
}
function download() {
  var blob = new Blob(recordedBlobs, {type: 'video/webm'});
  var url = window.URL.createObjectURL(blob);
  var a = document.createElement('a');
  a.style.display = 'none';
  a.href = url;
  a.download = 'test.webm';
  document.body.appendChild(a);
  a.click();
  setTimeout(function() {
    document.body.removeChild(a);
    window.URL.revokeObjectURL(url);
  }, 100);
}</pre>

</details>

<br/>

<details>
  <summary><b>CSS source code:</b></summary>
  
<pre>/*
* Copyright (c) 2015 The WebRTC project authors. All Rights Reserved.
*
* Use of this source code is governed by a BSD-style license
* that can be found in the LICENSE file in the root of the source
* tree.
*/
button {
  margin: 0 3px 10px 0;
  padding-left: 2px;
  padding-right: 2px;
  width: 99px;
}
button:last-of-type {
  margin: 0;
}
p.borderBelow {
  margin: 0 0 20px 0;
  padding: 0 0 20px 0;
}
video {
  height: 232px;
  margin: 0 12px 20px 0;
  vertical-align: top;
  width: calc(20em - 10px);
}
video:last-of-type {
  margin: 0 0 20px 0;
}
video#gumVideo {
  &gt; margin: 0 20px 20px 0;
}
@media screen and (max-width: 500px) {
  button {
    font-size: 0.8em;
    width: calc(33% - 5px);
  }
}
@media screen and (max-width: 720px) {
  video {
    height: calc((50vw - 48px) * 3 / 4);
    margin: 0 10px 10px 0;
    width: calc(50vw - 48px);
  }
  video#gumVideo {
    margin: 0 10px 10px 0;
  }
}</pre>

</details>

<br/>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;&gt;
  &lt;title&gt;MediaRecorder API usage&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id=&quot;container&quot;&gt;
    &lt;h1&gt;&lt;a href=&quot;//webrtc.github.io/samples/&quot; title=&quot;WebRTC samples homepage&quot;&gt;WebRTC example:&lt;/a&gt; &lt;span&gt;MediaRecorder&lt;/span&gt;&lt;/h1&gt;
    &lt;p&gt;For more info, see the &lt;a href=&quot;https://w3c.github.io/mediacapture-record/MediaRecorder.html&quot; 
      title=&quot;W3C MediaStream Recording API - Editor&#39;s Draft&quot;&gt;MediaStream Recording API Editor&#39;s Draft&lt;/a&gt;.&lt;/p&gt;
      &lt;video id=&quot;gum&quot; autoplay muted&gt;&lt;/video&gt;
      &lt;video id=&quot;recorded&quot; loop controls&gt;&lt;/video&gt;
    &lt;div&gt;
      &lt;button id=&quot;record&quot; disabled&gt;Start Recording&lt;/button&gt;
      &lt;button id=&quot;play&quot; disabled&gt;Play&lt;/button&gt;
      &lt;button id=&quot;download&quot; disabled&gt;Download&lt;/button&gt;
    &lt;/div&gt;
    &lt;a href=&quot;https://github.com/webrtc/samples/tree/gh-pages/src/content/getusermedia/record&quot; title=&quot;View source for this page on GitHub&quot; id=&quot;viewSource&quot;&gt;View source on GitHub&lt;/a&gt;
  &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>Click “start recording”, then press the play button on the video
element on the right of the app. You can also click the “download”
button to download a .webm file, playable offline with a media player
such as <a href="https://www.videolan.org/" target="_blank" 
rel="noopener noreferrer">VLC</a> or online in a Web page with the &lt;video&gt; element.</p>

<h4>Five steps are needed to use the mediaRecorder object</h4>

<h4>1 - Create a mediaRecorder from a stream</h4>

<h4>Source code extract:</h4>

<pre>var options = {mimeType: &#39;video/webm; codecs=vp9&#39;};
mediaRecorder = new MediaRecorder(stream, options);</pre>

<p>… where stream is typically the object returned by the call to getUserMedia (see previous examples).</p>

<h4>2 - Add a “data handler” and call the start() method of the mediaRecorder object</h4>

<h4>Source code extract:</h4>

<pre>var recordedChunks = []; // will hold the recorded stream
mediaRecorder.ondataavailable = handleDataAvailable;
mediaRecorder.start();
function handleDataAvailable(event) {
  if (event.data.size &gt; 0) {
    recordedChunks.push(event.data);
  } else {
  // ...
}</pre>

<h4>Explanations:</h4>

<ul>
  <li><i>Line 1</i>: we declare an array of bytes that will hold the recorded stream.</li>
  <li><i>Line 2</i>: we declare the callback function that will be called while the 
    stream is being captured. While the Webcam will be used, every xxx seconds, chunks 
    of data will be passed to the handleDataAvailable function.</li>
  <li><i>Lines 5-10</i>: this function collects the chunk of data that corresponds to a 
    few seconds of video, and stores it in the recordedChunks byte array.</li>
</ul>

<h4>3 - When you’ve finished recording, tell the mediaRecorder to stop</h4>

<p>When you’re done, you need to call the stop() method of the mediaRecorder 
object. This will end the periodic execution of the handleDataAvailable method, 
and stop the data capture.</p>

<pre>mediaRecorder.stop();</pre>

<h4>4 - Create a BLOB (Binary Large Object) with the collected data, and use it 
to set the src attribute of an HTML5 video player</h4>

<p>This piece of code creates a blob with the recordedChunks array. Use the 
URL.createObjectURL(recordedChunks) standard method to create another object 
that can be used as a value to set the src attribute of an HTML5 video element.</p>

<p>Like that, the recorded stream can be played using a standard HTML5 &lt;video&gt; element.</p>

<pre>function play() {
  var superBuffer = new Blob(recordedChunks);
  videoElement.src =
  window.URL.createObjectURL(superBuffer);
}</pre>

<h4>5 - Download the captured stream</h4>

<p>A trick consists in creating, on the fly, an invisible link with a download 
attribute (see Module 1) and a href attribute that points to the blob object 
containing the recorded stream encoded using a given codec, then generate 
programmatically a click event on the link. This will force the browser to 
download a file of type video/webm to the hard disk.</p>

<details>
  <summary><b>JavaScript source code:</b></summary>
  
<pre>function download() {
  var blob = new Blob(recordedChunks, {
    type: &#39;video/webm&#39;
  });
  var url = URL.createObjectURL(blob);
  var a = document.createElement(&#39;a&#39;);
   document.body.appendChild(a);
     a.style = &#39;display: none&#39;;
     a.href = url;
     a.download = &#39;test.webm&#39;;
     a.click();
  window.URL.revokeObjectURL(url);
}</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-1-1">3.1.1 HTML5 Graphics - Introduction</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-2-1">3.2.1 About JavaScript and HTML5</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 115. javascript logo (136) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image115.webp"
  loading="lazy"
  style="width:10%"
  title="JavaScript logo"
  alt="JavaScript logo." />

<p>HTML5 is composed of new elements, but it also comes with many
JavaScript APIs for controlling video and sound, drawing and animating
things in the new &lt;canvas&gt; element, for offline applications,
persistence, geolocation, orientation, etc.</p>

<p>So yes, during this course, in particular in Modules 3 and 4, you
will have to do a bit of JavaScript. <b>But, DON’T PANIC!</b></p>

<p>Here we provide a basic introduction to JavaScript. If you want to
learn more, many resources are available on the Web; this document is
simply here to give you a head start. Remember that one great thing
about these MOOCs courses is that everybody can help each other.
Some students are very good in JavaScript and are usually very happy to
help others when they encounter difficulties.</p>

<p><b>You will learn a lot by looking at examples, tweaking them, cloning
and modifying them, etc.</b> Many previous students who were real
JavaScript beginners managed to do [all] the assignments (drawing and
animating a monster with keyboard/mouse interaction)! And they did
this by just studying the provided examples.</p>

<h4>External resources</h4>

<ul>
  <li>The <a href="https://www.edx.org/course/javascript-introduction" target="_blank" 
    rel="noopener noreferrer">JavaScript Introduction</a> course on W3Cx!</li>
  <li>Mozilla Developer Network <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide" 
    target="_blank" rel="noopener noreferrer">has a JavaScript guide</a></li>
</ul>

<h4>What do you need? How to debug? How to catch errors?</h4>

<p>We will not look at the JavaScript syntax here, but more at "JavaScript in 
the browser", how it works, how to start writing code, etc.</p>

<p>First of all, you need to find a way to debug your code and see errors. If 
your work does not produce any results, you must know why! For that you will 
use <b>the dev. tools of your browser</b>. Press <i>F12</i> in Windows or 
<i>cmd-alt-i</i> in Mac to open the dev. tools, then go to the console tab: 
this is where errors will be displayed, or messages of your own (use the 
console.log(string) JavaScript function in the JavaScript code embedded in your 
html page). In the console, you will be able to type any JavaScript command.</p>

<p>Let’s look at <a href="https://jsbin.com/visariz/1/edit?html,output" 
target="_blank" rel="noopener noreferrer">this example on JS Bin</a>:</p>

<pre>&lt;div&gt;
  &lt;table&gt;
    &lt;colgroup&gt;
      &lt;col style="width: 1%" /&gt;
      &lt;col style="width: 98%" /&gt;
    &lt;/colgroup&gt;
    &lt;thead&gt;
    &lt;tr class="header"&gt;
      &lt;th&gt;#&lt;/th&gt;
      &lt;th&gt;HTML code&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr class="odd"&gt;
    &lt;td&gt;1&lt;/td&gt;
    &lt;td&gt;&lt;!DOCTYPE html&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr class="even"&gt;
    &lt;td&gt;2&lt;/td&gt;
    &lt;td&gt;&lt;&lt;a href="https://december.com/html/4/element/html.html" target="_blank" 
      rel="noopener noreferrer"&gt;&lt;b&gt;html lang=“en”&lt;/b&gt;&lt;/a&gt;&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr class="odd"&gt;
    &lt;td&gt;3&lt;/td&gt;
    &lt;td&gt;&lt;&lt;a href="https://december.com/html/4/element/head.html" target="_blank" 
      rel="noopener noreferrer"&gt;&lt;b&gt;head&lt;/b&gt;&lt;/a&gt;&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr class="even"&gt;
    &lt;td&gt;4&lt;/td&gt;
    &lt;td&gt;&lt;&lt;a href="https://december.com/html/4/element/meta.html" target="_blank" 
      rel="noopener noreferrer"&gt;&lt;b&gt;meta&lt;/b&gt;&lt;/a&gt; charset=utf-8 /&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr class="odd"&gt;
    &lt;td&gt;5&lt;/td&gt;
    &lt;td&gt;&lt;&lt;a href="https://december.com/html/4/element/title.html" 
      target="_blank" rel="noopener noreferrer"&gt;&lt;b&gt;title&lt;/b&gt;&lt;/a&gt;&gt;
      Web Audio API&lt;/&lt;a href="https://december.com/html/4/element/title.html" 
      target="_blank" rel="noopener noreferrer"&gt;&lt;b&gt;title&lt;/b&gt;&lt;/a&gt;&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr class="even"&gt;
    &lt;td&gt;6&lt;/td&gt;
    &lt;td&gt;&lt;&lt;a href="https://december.com/html/4/element/script.html" 
      target="_blank" rel="noopener noreferrer"&gt;&lt;b&gt;script&lt;/b&gt;&lt;/a&gt;&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr class="odd"&gt;
    &lt;td&gt;7&lt;/td&gt;
    &lt;td&gt;console.log("Some JavaScript code has been executed");&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr class="even"&gt;
    &lt;td&gt;8&lt;/td&gt;
    &lt;td&gt;&lt;/&lt;a href="https://december.com/html/4/element/script.html" 
      target="_blank" rel="noopener noreferrer"&gt;&lt;b&gt;script&lt;/b&gt;&lt;/a&gt;&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr class="odd"&gt;
    &lt;td&gt;9&lt;/td&gt;
    &lt;td&gt;&lt;/&lt;a href="https://december.com/html/4/element/head.html" target="_blank" 
      rel="noopener noreferrer"&gt;&lt;b&gt;head&lt;/b&gt;&lt;/a&gt;&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr class="even"&gt;
    &lt;td&gt;10&lt;/td&gt;
    &lt;td&gt;&lt;&lt;a href="https://december.com/html/4/element/body.html" target="_blank" rel="noopener noreferrer"&gt;&lt;b&gt;body&lt;/b&gt;&lt;/a&gt;&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr class="odd"&gt;
    &lt;td&gt;11&lt;/td&gt;
    &lt;td&gt;&lt;&lt;a href="https://december.com/html/4/element/h1.html" target="_blank" rel="noopener noreferrer"&gt;&lt;b&gt;h1&lt;/b&gt;&lt;/a&gt;&gt;JavaScript debugging using the dev tool console&lt;/&lt;a href="https://december.com/html/4/element/h1.html" target="_blank" rel="noopener noreferrer"&gt;&lt;b&gt;h1&lt;/b&gt;&lt;/a&gt;&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr class="even"&gt;
    &lt;td&gt;12&lt;/td&gt;
    &lt;td&gt;&lt;/&lt;a href="https://december.com/html/4/element/body.html" target="_blank" rel="noopener noreferrer"&gt;&lt;b&gt;body&lt;/b&gt;&lt;/a&gt;&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr class="odd"&gt;
    &lt;td&gt;13&lt;/td&gt;
    &lt;td&gt;&lt;/&lt;a href="https://december.com/html/4/element/html.html" 
      target="_blank" rel="noopener noreferrer"&gt;&lt;b&gt;html&lt;/b&gt;&lt;/a&gt;&gt;&lt;/td&gt;
  &lt;/tr&gt;
    &lt;/tbody&gt;
  &lt;/table&gt;
&lt;/div&gt;</pre>

<p>The simplest way to add JavaScript code in an HTML page, is by using
the &lt;script&gt;…&lt;/script&gt; element.</p>

<p><b>The code in this example is executed sequentially when the page is
loaded</b>: the JavaScript code is executed before the browser could see
the rest of the page (as the &lt;script&gt;&lt;/script&gt; is located
before the &lt;body&gt;).</p>

<p>The H1 element, for example, does not exist in the Document Object
Model, and has not yet been displayed when the JavaScript code is
executed. If we move the &lt;script&gt;&lt;/script&gt; at the end of the
document, then the H1 would have been built before the JavaScript code
is executed.</p>

<p>The only line of code we have is console.log(“Some JavaScript code
has been executed”);</p>

<p>This means “display in the JavaScript console the message…”. If we open
the console tab provided by jsbin.com in a dedicated tab (that redirects
all console.log() messages), and re-execute the page (just type a space
at the end of a line, this will re-render the page and display the
message in the console), we see the message in the console tab, as well
as in the dev. tools console. This is illustrated by the image below:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~ 116. javascript debugging console view (138) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image116.webp"
  loading="lazy"
  style="width:40%"
  title="JavaScript debugging using the dev tool console"
  alt="JavaScript debugging using the dev tool console." />

<p>It is also possible to use the “real dev. tool console”, and for this
I recommend running the application in a single window, not in the JS
Bin editor. Press the black arrow on the top right of the output window
- this will render the page as a standalone Web page, then
press <i>F12</i>. You should see:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~ 117. view of the javascript debug devtool console (139) ~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  loading="lazy"
  src="./images/image117.webp"
  style="width:40%"
  title="View of the JavaScript Debug Devtool console"
  alt="View of the JavaScript Debug Devtool console." />

<p>Ok, now, let’s make an error:
change console.log() into conso<b>lll</b>e.log(). Let’s see what
happens:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 118. view of the javascript console (139) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image118.webp"
  loading="lazy"
  style="width:40%"
  title="View of the JavaScript console"
  alt="View of the JavaScript console." />

<p>And if we run it standalone and use the dev. tool console:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 119. dev tool for error inspection (139) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image119.webp"
  loading="lazy"
  style="width:40%"
  title="Dev tool for error inspection"
  alt="Dev tool for error inspection." />

<p>And if we click on the line number in the right, the dev. tool shows
the source code centered on the line that caused the error:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 120. view of the javascript console (140) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image120.webp"
  loading="lazy"
  style="width:40%"
  title="View of the JavaScript console. We can see an extract of the source code with 
  different tools for watching variable values over execution etc"
  alt="View of the JavaScript console. We can see an extract of the source code with 
  different tools for watching variable values over execution etc." />

<p>Without such tools, debugging JavaScript code is impossible. So you
need to look at some basic tutorials on how to use the dev. tools of
your browsers, since they differ from one another in the way they work
- although the principles remain the same.</p>

<h4>About the asynchronous nature of JavaScript</h4>

<p>Some of you may not be used to “asynchronous programming”, “callbacks” etc. We 
recommend to read <a href="https://en.wikipedia.org/wiki/Callback_%28computer_programming%29" 
target="_blank" rel="noopener noreferrer">this article on WikiPedia</a> and 
<a href="https://stackoverflow.com/questions/8736378/what-is-a-callback-in-java" 
target="_blank" rel="noopener noreferrer">this thread on StackOverflow</a>.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-2-2">3.2.2 The &lt;canvas&gt; Element</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 121. canvas element logo (139) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image121.webp"
  loading="lazy"
  style="width:10%"
  title="Canvas element logo"
  alt="Canvas element logo." />

<p>The &lt;canvas&gt; tag was introduced into the HTML specification
around 2010 as a “Flash killer.” At the time, popular video games used
this proprietary technology and only a few browsers supported it. The
HTML canvas allows drawing and animation at 60 frames per second, in 2D
or 3D.</p>
<p><b>The canvas has been designed for pixel-based graphics</b>, while
SVG (Scalable Vector Graphics, another W3C standard) is for vector-based
graphics.</p>
<p>Indeed, the canvas JavaScript drawing API supports different kind of
shapes: lines, rectangles, ellipses, arcs, curves, text, images. Some
drawing styles need to be specified that will affect the way shapes are
drawn (color, drawing width, shadows, etc.). An alpha channel for
drawing in transparent mode is also supported, as well as many advanced
drawing modes and global filters (blur, etc.).</p>
<p>The canvas is also used to do animations at 60 frames per second (useful
for games), to display videos with special effects, to display a webcam
stream, and so on.</p>

<h4>Examples</h4>

<p>Here are some fun examples that show the interest of the HTML5
canvas.</p>

<h4>Example #1</h4>

<p><a href="https://www.ravalmatic.com/portfolio/footchinko/" target="_blank" rel="noopener noreferrer">Foot
Chinko</a> is one popular free HTML5 games:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~ 122. foot chinko one of the best html5 2D game of 2015 (141) ~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image122.webp"
  loading="lazy"
  style="width:40%"
  title="Foot chinko one of the best html5 2D game of 2015"
  alt="Foot chinko one of the best html5 2D game of 2015." />

<h4>Example #2</h4>

<p>Lots of data visualization tools and JavaScript libraries use the HTML5 canvas element for <a
href="http://www.creativebloq.com/design-tools/data-visualization-712402" target="_blank" 
rel="noopener noreferrer">Data visualization</a>:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 123. html5 data visualization (142) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image123.webp"
  loading="lazy"
  style="width:40%"
  title="html5 data visualization, bar graphs"
  alt="html5 data visualization, bar graphs." />

<h4>Example #3</h4>

<p>A version of the <a href="https://intersoft.itch.io/galaxian" target="_blank" 
rel="noopener noreferrer">arcade game Galaxian</a>, that runs at 60 frames per 
second in an HTML5 canvas element:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~ 124. A version of the game Galaxian that runs at 60 frames/s in a canvas. (142) ~~~~~~-->
<img class="displayed"
  src="./images/image124.webp"
  loading="lazy"
  style="width:40%"
  title="A version of the game Galaxian that runs at 60 frames/s in a canvas"
  alt="A version of the game Galaxian that runs at 60 frames/s in a canvas." />

<p>Performance is  good and animation is generally very smooth, since most Web browsers 
(mobile and desktop) support hardware acceleration.</p>
<p><b>Note</b>: 3D drawing using the WebGL API is also possible in a &lt;canvas&gt;, 
but will not be covered in this course. For the most curious among you, please have 
a look at the two popular libraries for doing 3D drawing/animation in a &lt;canvas&gt;: 
<a href="https://www.babylonjs.com/" target="_blank" rel="noopener noreferrer">BabylonJS</a> 
and <a href="https://threejs.org/" target="_blank" rel="noopener noreferrer">ThreeJS</a>.</p>

<h4>External resources</h4>

<ul>
  <li>Comprehensive <a href="https://www.html5canvastutorials.com/" target="_blank" 
    rel="noopener noreferrer">HTML5 canvas tutorials</a></li>
  <li>An <a href="https://joshondesign.com/p/books/canvasdeepdive/title.html" 
    target="_blank" rel="noopener noreferrer">HTML Canvas Deep Dive</a></li>
  <li>MDN’s Web docs: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/canvas" 
    target="_blank" rel="noopener noreferrer">&lt;canvas&gt;: The Graphics Canvas element</a></li>
  <li>The &lt;canvas&gt; element is well supported by browsers:<br>
  <ul>
    <li>CanIUse: <a href="https://caniuse.com/canvas" target="_blank" rel="noopener noreferrer">
      browser support table</a></li>
    <li>MDN’s <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/canvas#Browser_compatibility" 
      target="_blank" rel="noopener noreferrer">compatibility table of &lt;canvas&gt;</a></li>
  </ul>
  </li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-2-3">3.2.3 Canvas and Accessibility</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The dynamic nature of the &lt;canvas&gt; element has made it difficult to use in 
applications that need to be accessible to people with disabilities. To be accessible, 
it must meet the following principles:</p>

<ul>
  <li>Providing alternative content for what is drawn on the &lt;canvas&gt;,</li>
  <li>Exposing the location of shapes, paths, images drawn on the &lt;canvas&gt; to assistive technologies,</li>
  <li>Visually indicating whether or not a shape in the canvas had keyboard focus.</li>
</ul>

<h4>Read more on this topic:</h4>

<ul>
  <li>An article on <a href="https://www.creativebloq.com/web-design/canvas-element-accessibility-41514740" 
    target="_blank" rel="noopener noreferrer">What the canvas element means for accessibility</a></li>
  <li>From the W3C wiki: <a href="https://www.w3.org/html/wg/wiki/AddedElementCanvas" target="_blank" 
    rel="noopener noreferrer">Canvas Element Accessibility Issues</a></li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-2-4">3.2.4 HTML Canvas Cheatsheet</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>We recommend these 2 quick references (or <a
href="https://en.wikipedia.org/wiki/Cheat_sheet" target="_blank" rel="noopener noreferrer">cheatsheets</a>) below.
Do not hesitate to keep your favorite one open in a separate browser
ta</p>

<ol type="1">
  <li>As a <a href="https://courses.edx.org/assets/courseware/v1/4b7360cab7f3bf439c26782ec47cf7a8/asset-v1:W3Cx+HTML5.1x+2T2020+type@asset+block/Infopgraphic-CanvasCheatSheet-Final2.pdf" 
    target="_blank" rel="noopener noreferrer">PDF file</a>, this canvas cheatsheet:</li>
</ol>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~ 125. snapshot of a canvas cheatsheet from skilled.com (143) ~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image125.webp"
  loading="lazy"
  style="width:40%;"
  title="Snapshot of an Canvas cheatsheet from skilled.com"
  alt="Snapshot of an Canvas cheatsheet from skilled.com." />

<ol start="2" type="1">
  <li>Another resource, as an <a href="https://simon.html5.org/dump/html5-canvas-cheat-sheet.html" 
    target="_blank" rel="noopener noreferrer">HTML file</a>:</li>
</ol>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~ 126. snapshot of a html5 canvas cheatsheet api (144) ~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image126.webp"
  loading="lazy"
  style="width:40%;"
  title="Snapshot of HTML5 Canvas cheatsheet API"
  alt="Snapshot of HTML5 Canvas cheatsheet API." />

<!--  style="width:1388px;height;1087px;" -->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-2-5">3.2.5 Coordinate System</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The coordinate system used for drawing in canvases is similar to the one used by many 
drawing APIs like Java2D: the (0 , 0) is in the top left corner while the X axis is going 
to the right and the Y axis to the bottom, as  shown in the following picture:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 127. coordinate system (144) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image127.webp"
  loading="lazy"
  style="width:40%"
  title="Coordinate system"
  alt="Coordinate system." />

<ul>
  <li><b>X</b> axis is horizontal, directed to the right,</li>
  <li><b>Y</b> axis is vertical, directed downwards.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-2-6">3.2.6 Drawing Rectangles in a Canvas</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Small errata about what I said in the above video: “So let’s get the canvas using the 
DOM API method document.getElementById() or better, use document.querySelector() that is 
a more recent method from the DOM API”..</p>

<p>The part is bold is not correct: querySelector, technically, comes from 
<a href="https://www.w3.org/TR/selectors-api/" target="_blank" rel="noopener noreferrer">
Selectors API</a>. Just in case some people would like to check the specification.</p>

<h4>Detailed explanation of the example shown in the above video</h4>

<p>Here are the different steps, in a little more detail, of the example demonstrated in 
the above video:</p>

<h4>1 - Add the &lt;canvas&gt; element into an HTML page</h4>

<pre>&lt;canvas id=&quot;myCanvas&quot; width=&quot;300&quot; height=&quot;225&quot;&gt;
  Fallback content that will be displayed in case the web browser
  does not support the canvas tag or in case scripting
  is disabled.
&lt;/canvas&gt;</pre>

<p>Place code similar to the above somewhere in an HTML page. This example defines an 
area of 300 by 225 pixels on which content can be rendered with JavaScript.</p>

<p>Normally you should see nothing as a result; by default canvases are “transparent”. 
<b>Make it visible using CSS!</b> For example, you can add a border to the canvas (or 
change the background color, or put an image in the background).</p>

<h4>The three lines of CSS will create a border around the canvas with id=“myCanvas”, 
of 1 pixel width, in black:</h4>

<pre>&lt;style&gt;
  #myCanvas {
    border:1px solid black;
  }
&lt;/style&gt;</pre>

<h4>2 - Select the &lt;canvas&gt; element for use from JavaScript</h4>

<p>We can have more than one &lt;canvas&gt; in a single page, and canvases will be 
manipulated with JavaScript like other elements in the DOM.</p>

<h4>For example with:</h4>

<pre>var canvas = document.getElementById(&quot;myCanvas&quot;);</pre>

<h4>… or with the querySelector() method introduced by HTML5, that use the CSS selector 
syntax for selecting elements:</h4>

<pre>var canvas = document.querySelector(&quot;#myCanvas&quot;);</pre>

<h4>3 - Get a “2D context” associated with the canvas</h4>

<p>This step is useful for drawing and setting drawing properties (color, etc.)</p>

<p>Once we have a pointer to the &lt;canvas&gt;, we can get a “context”. This particular 
object is the core of the canvas JavaScript API. It provides methods for drawing, like 
fillRect(x, y, width, height) for example, that draws a filled rectangle, and properties 
for setting the color, shadows, gradients, etc.</p>

<h4>Let’s first get the context (do this only once):</h4>

<pre>var ctx=canvas.getContext(&#39;2d&#39;);</pre>

<h4>… then, set the color for drawing filled shapes:</h4>

<pre>ctx.fillStyle=&#39;red&#39;;</pre>

<h4>… and draw a filled rectangle:</h4>

<pre>ctx.fillRect(0,0,80,100);</pre>

<h4>Complete example that draws a filled rectangle in red:</h4>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;style&gt;
    #myCanvas {
    border: 1px solid black;
    }
  &lt;/style&gt;
&lt;title&gt;Canvas&lt;/title&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;script&gt;
    var canvas, ctx;
    function init() {
    // This function is called after the page is loaded
    // 1 - Get the canvas
    canvas = document.getElementById(&#39;myCanvas&#39;);
    // 2 - Get the context
    ctx=canvas.getContext(&#39;2d&#39;);
    // 3 - we can draw
    drawSomething();
    }
    function drawSomething() {
    // draw a red rectangle
    ctx.fillStyle=&#39;#FF0000&#39;;
    ctx.fillRect(0,0,80,100);
    }
  &lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;200&quot; height=&quot;200&quot;&gt;
    Your browser does not support the canvas tag.
  &lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<br/>

<h4>Explanations</h4>

<p><b>Only access elements when the DOM is ready:</b></p>

<p>Notice that we wrote an “init” function (<i>line 13</i>) that is called only when 
the page has been entirely loaded (we say “when the DOM is ready”). There are several 
ways to do this. In this example we used the &lt;body onload=“init();”&gt; method, at 
<i>line 29</i>.</p>

<p>It’s good practice to have such a function, as we cannot access the elements of the 
page before the page has been loaded entirely and before the DOM is ready.</p>

<p>Another way is to put the JavaScript code at the end of the document (between 
&lt;script&gt;…&lt;/script&gt;), right before the &lt;/body&gt;. In this case 
when the JavaScript code is executed,
the DOM has already been constructed.</p>

<p><b>Start by getting the canvas and the context:</b></p>

<p>Before drawing or doing anything interesting with the canvas, we must first 
get its drawing “context”. The drawing context defines the drawing methods and 
properties we can use.</p>

<p>Good practice is to get the canvas, the context, the width and height of the 
canvas and other global objects in this “init” function.</p>

<p><b>After the context is set, we can draw, but first let’s set the current color 
for filled shapes:</b></p>

<p>The example shows the use of the fillStyle property at <i>line 24</i> - useful 
for specifying the way shapes will be filled. In our case this line indicates the 
color of all the filled shapes we are going to draw:</p>

<pre>ctx.fillStyle=&#39;#FF0000&#39;;</pre>

<p>The context property named fillStyle is used here. This property can be set with a 
color, a gradient, or a pattern. We will see examples of these later on in the course.</p>

<p>The example says that all filled shapes will use the color “#FF0000”, which 
corresponds to a pure red color using the CSS RGB hexadecimal encoding (we could 
also have used ctx.fillStyle=‘red’);</p>

<p><b>Then we can draw:</b></p>

<pre>ctx.fillRect(0,0,80,100);</pre>

<p>This line is a call to the method fillRect(top left X coordinate, top left Y 
coordinate, width, height), which draws a filled rectangle.</p>
<p>The way the rectangle will be filled depends on the current value of several 
properties of the context, in particular the value of the fillStyle property. 
In our case, the rectangle will be red.</p>

<h4>Summary of the different steps:</h4>

<ol type="1">
  <li><b>Declare the canvas,</b> remembering to add an id attribute, and fallback content:</li>
</ol>

<pre>&lt;canvas id=&quot;myCanvas&quot; width=&quot;200&quot; height=&quot;200&quot;&gt;
  ...fallback content...
&lt;/canvas&gt;</pre>

<ol start="2" type="1">
  <li><b>Get a reference to the canvas in a JavaScript variable</b> using the DOM API:</li>
</ol>

<pre>var canvas=document.getElementById(&#39;myCanvas&#39;);</pre>

<ol start="3" type="1">
  <li><b>Get the context for drawing in that canvas</b>:</li>
</ol>

<pre>var ctx=canvas.getContext(&#39;2d&#39;);</pre>

<ol start="4" type="1">
  <li><b>Specify some drawing properties</b> (optional):  </li>
</ol>

<pre>ctx.fillStyle=&#39;#FF0000&#39;;</pre>

<ol start="5" type="1">
  <li><b>Draw some shapes</b>:</li>
</ol>

<pre>ctx.fillRect(0,0,80,100)</pre>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-2-7">3.2.7 Drawing Principles</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>More about the “context” object</h4>

<p>Before we go on, we should take some time to clarify the way we draw
on HTML5 canvases. We already mentioned that we use a graphic context
for all the main operations. Whenever a shape, a text, or an image is
drawn, the current values of the different properties of the graphic
context are taken into account. Some are relevant only for certain kinds
of shapes or drawing modes, but you must be aware that it is always the
current values of these drawing properties that are used.</p>
<p>Later on we’ll see that there are ways to save and restore this whole
set of values, but for now, let’s examine in greater detail some of the
properties and methods we’ve already encountered, and introduce new
ones.</p>

<h4>More about properties and methods of the context object</h4>

<ul>
  <li><b>fillStyle</b> is a property of the context, similar in a way to a CSS property</li>
</ul>

<h4>Its value can be one of the following:</h4>

<ul>
  <li>a color,</li>
  <li>a pattern (texture), or</li>
  <li>a gradient.</li>
</ul>

<p>The default value is the color black. Any kind of drawing in “fill
mode” will use the value of this property to determine how to render the
“filled part” of the drawing: any filled rectangle will be filled black
by default, any filled circle will be filled in black, and so on.</p>
<p>As long as we don’t modify the value of this property, all drawing
commands for filled shapes will use the current value.</p>
<p>Note that we will study in detail how to use colors, gradients and
patterns later, but for now we introduce some properties and values so
that you can understand the principles of canvas drawing.</p>
<p>fillStyle and the other context properties can be considered to be
“global variables” of the context.</p>

<ul>
  <li>fillRect(x, y, width, height):  a call to this method draws a filled rectangle</li>
</ul>

<p>The two first parameters are the coordinates of the top left corner
of the rectangle. This method uses the current value of
the fillStyle property to determine how to fill the rectangle.</p>

<pre>ctx.fillStyle=&#39;pink&#39;;
ctx.fillRect(10,10,200,200);</pre>

<p>Produces this result:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 128. filled rectangle with pink color (149) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image128.webp"
  loading="lazy"
  style="width:25%"
  title="Filled rectangle with pink color"
  alt="Filled rectangle with pink color." />

<ul>
  <li>strokeStyle is a property of the context similar to fillStyle, but this time for indicating how the shape’s outline should be rendered</li>
</ul>

<p>The possible values are the same as those for the fillStyle property:
a color, a pattern, or a gradient. This property will be taken into
account when wireframe shapes are drawn.</p>

<ul>
  <li>strokeRect(x, y, width, height): like fillRect(…), but instead of drawing a filled rectangle the rectangle is drawn in wireframe mode </li>
</ul>

<pre>ctx.strokeStyle=&#39;blue&#39;;
ctx.strokeRect(10,10,200,200);</pre>

<p>… gives this result:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 129. stroked rectangle - border is in blue (150) ~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image129.webp"
  loading="lazy"
  style="width:25%"
  title="Stroked rectangle - border is in blue"
  alt="Stroked rectangle - border is in blue." />

<p>Only the outline of the rectangle will be drawn, and it will be drawn
using the value of the strokeStyle property.</p>

<ul>
  <li><h4>clearRect(x, y, width, height): a call to this method erases the specified rectangle</h4></li>
</ul>

<p>Actually it draws it in a color called “transparent black” (!) that
corresponds to the initial state of the rectangle as if no drawing had
occurred.</p>

<pre>ctx.fillStyle=&#39;pink&#39;;
ctx.fillRect(10,10,200,200);
ctx.clearRect(50, 50, 20, 20);</pre>

<h4>The result is:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~ 130. the use of clearrrect draws a white rectangle against the pink background (151) ~~~-->
<img class="displayed"
  src="./images/image130.webp"
  loading="lazy"
  style="width:25%"
  title="The use of ClearRect draws a white rectangle against the pink background"
  alt="The use of ClearRect draws a white rectangle against the pink background." />

<h4>Let’s see some simple examples</h4>

<h4>Example #1: draw a wireframe red rectangle, width lineWidth = 3 pixels</h4>

<h4>Extract from the source code (the part that draws the rectangle):</h4>

<pre>function drawSomething() {
  // draw a red rectangle, line width=3 pixels
  ctx.lineWidth=3;
  ctx.strokeStyle=&#39;red&#39;;
  ctx.strokeRect(10,10,80,100);
}</pre>

<p>Here, we used "stroke" instead of "fill" in the property and method names 
(<i>lines 4 and 5</i>): strokeStyle instead of fillStyle, strokeRect(…) instead 
of fillRect(…).</p>

<p>We also introduced a new property of the context, that applies only when 
drawing in "stroke" mode, the lineWidth property (<i>line 3</i>), that is used 
for setting the width of the shape outline. The value is in pixels.</p>

<h4>Example #2: draw two filled red rectangles with a blue outline of 5 pixels and some text</h4>

<p>Let’s continue with another example. This time we will draw several shapes 
that share the same colors - they will be filled in red, with a blue outline. 
We also show how to draw a text message with a given font.</p>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;title&gt;Drawing with outline&lt;/title&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;style&gt;
    #myCanvas {
      border: 1px solid black;
    }
  &lt;/style&gt;
  &lt;script&gt;
    var canvas, ctx;
    function init() {
      // This function is called after the page is loaded
      // 1 - Get the canvas
      canvas = document.getElementById(&#39;myCanvas&#39;);
      // 2 - Get the context
      ctx=canvas.getContext(&#39;2d&#39;);
      // 3 - we can draw
      drawSomething();
    }
    function drawSomething() {
    // set the global context values
      ctx.lineWidth=5;
      ctx.fillStyle=&#39;red&#39;;
      ctx.strokeStyle=&#39;blue&#39;
      // font for all text drawing
      ctx.font = &#39;italic 20pt Calibri&#39;;
      // Draw the two filled red rectangles
      ctx.fillRect(10, 30, 70, 150);
      ctx.fillRect(110, 30, 70, 150);
      // Draw the two blue wireframe rectangles
      ctx.strokeRect(10, 30, 70, 150);
      ctx.strokeRect(110, 30, 70, 150);
      // Draw a message above the rectangles
      ctx.fillText(&quot;hello&quot;, 70, 22);
    }
  &lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;200&quot; height=&quot;200&quot;&gt;
    Your browser does not support the canvas tag.
  &lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<br/>

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>function drawSomething() {
  // set the global context values
  ctx.lineWidth=5;
  ctx.fillStyle=&#39;red&#39;;
  ctx.strokeStyle=&#39;blue&#39;
  // font for all text drawing
  ctx.font = &#39;italic 20pt Calibri&#39;;

  // Draw the two filled red rectangles
  ctx.fillRect(10, 30, 70, 150);
  ctx.fillRect(110, 30, 70, 150);
 
  // Draw the two blue wireframe rectangles
  ctx.strokeRect(10, 30, 70, 150);
  ctx.strokeRect(110, 30, 70, 150);

  // Draw a message above the rectangles
  ctx.fillText(&quot;hello&quot;, 70, 22);
}</pre>

</details>

<p>This example shows the “global” nature of the context properties.
Once you set the filled color to red, any shapes you draw in filled mode
will be red. This is true for all the context properties. We set some of
these properties in <i>lines 3-7</i>, and all following calls to context
methods for drawing rectangles or text will depend on them. The two
filled rectangles at <i>lines 10-11</i> will be red, the two wireframe
rectangles drawn at <i>lines 14-15</i> will be blue, etc.</p>

<p><i>Line 18</i> shows how to draw a text message at an X position of
70 and a Y position of 22. The font is set at <i>line 7</i> using
the font property of the context.  The syntax is the same we use in CSS
for using “system fonts”.</p>

<p>If you would like to draw the filled text message in green, for example,
you should set the ctx.fillStyle property to “green” after you draw the
rectangles and before you draw the text (i.e just before <i>line 18</i>).</p>

<h4>Summary of what we’ve learned</h4>

<ul>
  <li>“stroke” means “wireframe” or “outlined”. It is a prefix for setting properties or calling methods that will affect wireframe shapes.</li>
  <li>“fill” is a prefix for filled shapes.</li>
  <li>To set the properties of wireframe shapes use ctx.<b>stroke</b>Style= …, for filled shapes use ctx.<b>fill</b>Style=… So far the values we have used are colors, expressed as strings. Example: ctx.strokeStyle  = ‘blue’;</li>
  <li>To draw a wireframe rectangle use ctx.strokeRect(x, y, width, height), to draw a filled rectangle use ctx.fillRect(x, y, width, height);</li>
  <li>To set the line width of wireframe shapes, use the ctx.lineWidth property. Example ctx.lineWidth = 10; ctx.strokeRect(0, 0, 100, 100);  will draw a 100x100 rectangle in wireframe mode, with an outline width of 10 pixels.</li>
  <li>To draw a text message use ctx.strokeText(message, x, y) or ctx.fillText(message, x, y), for wireframe text or filled text respectively.</li>
  <li>To set the character font use the ctx.font property; the value is a font in CSS syntax, for example:  ctx.font = ‘italic 20pt Calibri’; </li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-2-8">3.2.8 Transformations</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>We now introduce the basics of 2D transformations, a powerful tool that
will make things easier as soon as you have to:</p>

<ul>
  <li>Draw complex shapes at given positions, with given orientations and sizes,</li>
  <li>Draw shapes relative to one another.</li>
</ul>

<p>Let’s start with some simple examples before looking at how we use 2D transforms.</p>

<h4>Examples</h4>

<ul>
  <li>Let’s draw three rectangles!</li>
</ul>

<p>If we draw three rectangles of size 100x200 in a 400x400 canvas, one at (0, 0) and 
another at (150, 0), and a third at (300, 0), here is the result and the corresponding 
code:</p>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;title&gt;Let&#39;s draw three rectangles!&lt;/title&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;style&gt;
    #myCanvas {
      border: 1px solid black;
    }
  &lt;/style&gt;
  &lt;script&gt;
    var canvas, ctx;
    function init() {
      // This function is called after the page is loaded
      // 1 - Get the canvas
      canvas = document.getElementById(&#39;myCanvas&#39;);
      // 2 - Get the context
      ctx=canvas.getContext(&#39;2d&#39;);
      // 3 - we can draw
      drawSomething();
    }
    function drawSomething() {
      // draw a red rectangle
      ctx.fillStyle=&#39;lightgreen&#39;;
      ctx.fillRect(0,0,100,200);
      ctx.fillRect(150,0,100,200);
      ctx.fillRect(300,0,100,200);
    }
  &lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;400&quot; height=&quot;400&quot;&gt;
    Your browser does not support the canvas tag.
  &lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>JavaScript code extract:</p>

<pre>function drawSomething() {
  ctx.fillStyle=&#39;lightgreen&#39;;
  ctx.fillRect(0,0,100,200);
  ctx.fillRect(150,0,100,200);
  ctx.fillRect(300,0,100,200);
}</pre>

<ul>
  <li>Let’s modify the code so that we can draw these rectangles at any X and Y position</li>
</ul>

<p>What if we wanted to draw these 3 rectangles at another position, as
a group? We would like to draw all of them a little closer to the
bottom, for example… Let’s add some parameters to the function:  the X
and Y position of the rectangles.</p>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head lang=&quot;en&quot;&gt;
  &lt;title&gt;Draw 3 rectangles at any X and Y position&lt;/title&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;style&gt;
    #myCanvas {
      border: 1px solid black;
    }
  &lt;/style&gt;
  &lt;script&gt;
    var canvas, ctx;
    function init() {
      // This function is called after the page is loaded
      // 1 - Get the canvas
      canvas = document.getElementById(&#39;myCanvas&#39;);
      // 2 - Get the context
      ctx=canvas.getContext(&#39;2d&#39;);
      // 3 - we can draw
      drawSomething(0, 100);
    }
    function drawSomething(x, y) {
       // draw a red rectangle
       ctx.fillStyle=&#39;lightgreen&#39;;
       ctx.fillRect(x,y,100,200);
       ctx.fillRect(x+150,y,100,200);
       ctx.fillRect(x+300,y,100,200);
    }
  &lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;400&quot; height=&quot;400&quot;&gt;
    Your browser does not support the canvas tag.
  &lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<br/>

<details>
  <summary><b>JavaScript source code:</b></summary>
  
<pre>var canvas, ctx;
 
function init() {
  // This function is called after the page is loaded
  // 1 - Get the canvas
  canvas = document.getElementById(&#39;myCanvas&#39;);
  // 2 - Get the context
  ctx=canvas.getContext(&#39;2d&#39;);
  // 3 - we can draw
  drawSomething(0, 100);
}

function drawSomething(x, y) {
  // draw 3 rectangles
  ctx.fillStyle=&#39;lightgreen&#39;;
  ctx.fillRect(x,y,100,200);
  ctx.fillRect(x+150,y,100,200);
  ctx.fillRect(x+300,y,100,200);
}</pre>

</details>

<p>At <i>line 10</i>, we called the drawSomething(…) function with 0 and
100 as parameters, meaning “please add an offset of 0 in X and 100 in Y
directions to what is drawn by the function…</p>
<p>If you look at the code of the modified function, you will see
that each call to fillRect(…) uses the x and y parameters instead of
hard coded values. In this way, if we call it with parameters (0, 100),
then all rectangles will be drawn 100 pixels to the bottom (offset in
y). Here is the result:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~ 131. Rectangles are drawn 100 pixels towards the bottom (156) ~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image131.webp"
  loading="lazy"
  style="width:30%"
  title="Rectangles are drawn 100 pixels towards the bottom"
  alt="Rectangles are drawn 100 pixels towards the bottom." />
  
<ul>
  <li>Now, let’s draw a small monster’s head with rectangles</li>
</ul>

<p>Now we can start having some fun… let’s draw a monster’s head using only rectangles:</p>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;title&gt;Monster&#39;s head with rectangles&lt;/title&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;style&gt;
#myCanvas {
border: 1px solid black;
}
&lt;/style&gt;
&lt;script&gt;
var canvas, ctx;
function init() {
// This function is called after the page is loaded
// 1 - Get the canvas
canvas = document.getElementById(&#39;myCanvas&#39;);
// 2 - Get the context
ctx=canvas.getContext(&#39;2d&#39;);
// 3 - we can draw
drawMonster(0, 0);
}
function drawMonster(x, y) {
// draw a red rectangle
// head
ctx.fillStyle=&#39;lightgreen&#39;;
ctx.fillRect(x,y,200,200);
// eyes
ctx.fillStyle=&#39;red&#39;;
ctx.fillRect(x+35,y+30,20,20);
ctx.fillRect(x+140,y+30,20,20);
// interior of eye
ctx.fillStyle=&#39;yellow&#39;;
ctx.fillRect(x+43,y+37,10,10);
ctx.fillRect(x+143,y+37,10,10);
// Nose
ctx.fillStyle=&#39;black&#39;;
ctx.fillRect(x+90,y+70,20,80);
// Mouth
ctx.fillStyle=&#39;purple&#39;;
ctx.fillRect(x+60,y+165,80,20);
}
&lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
&lt;canvas id=&quot;myCanvas&quot; width=&quot;400&quot; height=&quot;400&quot;&gt;
Your browser does not support the canvas tag.
&lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<br/>

<details>
  <summary><b>JavaScript source code:</b></summary>
  
<pre>function drawMonster(x, y) {
  // head
  ctx.fillStyle=&#39;lightgreen&#39;;
  ctx.fillRect(x,y,200,200);

  // eyes
  ctx.fillStyle=&#39;red&#39;;
  ctx.fillRect(x+35,y+30,20,20);
  ctx.fillRect(x+140,y+30,20,20);

  // interior of eye
  ctx.fillStyle=&#39;yellow&#39;;
  ctx.fillRect(x+43,y+37,10,10);
  ctx.fillRect(x+143,y+37,10,10);

  // Nose
  ctx.fillStyle=&#39;black&#39;;
  ctx.fillRect(x+90,y+70,20,80);

  // Mouth
  ctx.fillStyle=&#39;purple&#39;;
  ctx.fillRect(x+60,y+165,80,20);
}</pre>

</details>

<p>As you can see, the code uses the same technique, becomes less and less readable. 
The Xs and Ys at the beginning of each call makes understanding the code harder, etc.
However, there is a way to simplify this =&gt; 2D geometric transformations!</p>

<h4>Geometric transformations: changing the coordinate system</h4>

<p>The idea behind 2D transformations is that instead of modifying all the 
coordinates passed as parameters to each call to drawing methods like fillRect(…), 
we will keep all the drawing code "as is". For example, if the monster of our 
previous example was drawn at (0, 0), we could just translate (or rotate, or 
scale) the original coordinate system.</p>

<p>Let’s take a piece of code that draws something corresponding to the original 
coordinate system, located at the top left corner of the canvas:</p>

<details>
  <summary><b>CSS source code:</b></summary>
  
<pre>function drawMonster(x, y) {
  // head
  ctx.fillStyle=&#39;lightgreen&#39;;
  ctx.fillRect(0,0,200,200);
 
  // eyes
  ctx.fillStyle=&#39;red&#39;;
  ctx.fillRect(35,30,20,20);
  ctx.fillRect(140,30,20,20);

  // interior of eye
  ctx.fillStyle=&#39;yellow&#39;;
  ctx.fillRect(43,37,10,10);
  ctx.fillRect(143,37,10,10);

  // Nose
  ctx.fillStyle=&#39;black&#39;;
  ctx.fillRect(90,70,20,80);

  // Mouth
  ctx.fillStyle=&#39;purple&#39;;
  ctx.fillRect(60,165,80,20);

  // coordinate system at (0, 0)
  drawArrow(ctx, 0, 0, 100, 0, 10, &#39;red&#39;);
  drawArrow(ctx, 0, 0, 0, 100, 10, &#39;red&#39;);
}</pre>

</details>

<p>This code is the just the same as in the previous example except that
we removed all Xs and Yx in the code. We also added at the end (<i>lines
25-26</i>) two lines of code that draw the coordinate system.
The drawArrow(startX, startY, endX, endY, width, color) function is a
utility function that we will present later. You can see it in the
JavaScript source code of the pen below:</p>

<details>
  <summary><b>JavaScript source code:</b></summary>
  
<pre>// Borrowed and adapted from : http://stackoverflow.com/questions/808826/draw-arrow-on-canvas-tag
function drawArrow(ctx, fromx, fromy, tox, toy, arrowWidth, color){
//variables to be used when creating the arrow
var headlen = 10;
var angle = Math.atan2(toy-fromy,tox-fromx);
ctx.save();
ctx.strokeStyle = color;
//starting path of the arrow from the start square to the end square and drawing the stroke
ctx.beginPath();
ctx.moveTo(fromx, fromy);
ctx.lineTo(tox, toy);
ctx.lineWidth = arrowWidth;
ctx.stroke();
//starting a new path from the head of the arrow to one of the sides of the point
ctx.beginPath();
ctx.moveTo(tox, toy);
ctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/7),toy-headlen*Math.sin(angle-Math.PI/7));
//path from the side point of the arrow, to the other side point
ctx.lineTo(tox-headlen*Math.cos(angle+Math.PI/7),toy-headlen*Math.sin(angle+Math.PI/7));
//path from the side point back to the tip of the arrow, and then again to the opposite side point
ctx.lineTo(tox, toy);
ctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/7),toy-headlen*Math.sin(angle-Math.PI/7));
//draws the paths created above
ctx.stroke();
ctx.restore();
}</pre>

</details>

<br/>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;title&gt;Monster&#39;s head drawn with 2D transformations&lt;/title&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;style&gt;
#myCanvas {
border: 1px solid black;
}
&lt;/style&gt;
&lt;script&gt;
var canvas, ctx;
function init() {
// This function is called after the page is loaded
// 1 - Get the canvas
canvas = document.getElementById(&#39;myCanvas&#39;);
// 2 - Get the context
ctx=canvas.getContext(&#39;2d&#39;);
// 3 - we can draw, try to change these values
drawMonster(0, 0);
}
function drawMonster(x, y) {
// head
ctx.fillStyle=&#39;lightgreen&#39;;
ctx.fillRect(0,0,200,200);
// eyes
ctx.fillStyle=&#39;red&#39;;
ctx.fillRect(35,30,20,20);
ctx.fillRect(140,30,20,20);
// interior of eye
ctx.fillStyle=&#39;yellow&#39;;
ctx.fillRect(43,37,10,10);
ctx.fillRect(143,37,10,10);
// Nose
ctx.fillStyle=&#39;black&#39;;
ctx.fillRect(90,70,20,80);
// Mouth
ctx.fillStyle=&#39;purple&#39;;
ctx.fillRect(60,165,80,20);
// coordinate system at (0, 0)
drawArrow(ctx, 0, 0, 100, 0, 10, &#39;red&#39;);
drawArrow(ctx, 0, 0, 0, 100, 10, &#39;red&#39;);
}
&lt;/script&gt;</pre>

</details>

<p>Note that the X and Y parameters are useless for now…</p>

<pre>Translation using ctx.translate(offsetX, offsetY)</pre>

<p>Now, instead of simply calling drawMonster(0, 0), we will call
first ctx.translate(100, 100), and look at the result below:</p>

<details>
  <summary><b>JavaScript source code:</b></summary>
  
<pre>// Borrowed and adapted from : http://stackoverflow.com/questions/808826/draw-arrow-on-canvas-tag
function drawArrow(ctx, fromx, fromy, tox, toy, arrowWidth, color){
  //variables to be used when creating the arrow
  var headlen = 10;
  var angle = Math.atan2(toy-fromy,tox-fromx);
  ctx.save();
  ctx.strokeStyle = color;
  //starting path of the arrow from the start square to the end square and drawing the stroke
  ctx.beginPath();
  ctx.moveTo(fromx, fromy);
  ctx.lineTo(tox, toy);
  ctx.lineWidth = arrowWidth;
  ctx.stroke();
  //starting a new path from the head of the arrow to one of the sides of the point
  ctx.beginPath();
  ctx.moveTo(tox, toy);
  ctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/7),toy-headlen*Math.sin(angle-Math.PI/7));
  //path from the side point of the arrow, to the other side point
  ctx.lineTo(tox-headlen*Math.cos(angle+Math.PI/7),toy-headlen*Math.sin(angle+Math.PI/7));
  //path from the side point back to the tip of the arrow, and then again to the opposite side point
  ctx.lineTo(tox, toy);
  ctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/7),toy-headlen*Math.sin(angle-Math.PI/7));
  //draws the paths created above
  ctx.stroke();
  ctx.restore();
}</pre>

</details>

<br/>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;title&gt;Translated monster&#39;s head&lt;/title&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;style&gt;
  #myCanvas {
    border: 1px solid black;
  }
&lt;/style&gt;
&lt;script&gt;
  var canvas, ctx;
  function init() {
    // This function is called after the page is loaded
    // 1 - Get the canvas
    canvas = document.getElementById(&#39;myCanvas&#39;);
    // 2 - Get the context
    ctx=canvas.getContext(&#39;2d&#39;);
    // 3 - we can draw, try to change these values
    ctx.translate(100, 100);
    drawMonster(0, 0);
  }

  function drawMonster(x, y) {
    // head
    ctx.fillStyle=&#39;lightgreen&#39;;
    ctx.fillRect(0,0,200,200);
    // eyes
    ctx.fillStyle=&#39;red&#39;;
    ctx.fillRect(35,30,20,20);
    ctx.fillRect(140,30,20,20);
    // interior of eye
    ctx.fillStyle=&#39;yellow&#39;;
    ctx.fillRect(43,37,10,10);
    ctx.fillRect(143,37,10,10);
    // Nose
    ctx.fillStyle=&#39;black&#39;;
    ctx.fillRect(90,70,20,80);
    // Mouth
    ctx.fillStyle=&#39;purple&#39;;
    ctx.fillRect(60,165,80,20);
    // coordinate system at (0, 0)
    drawArrow(ctx, 0, 0, 100, 0, 10, &#39;red&#39;);
    drawArrow(ctx, 0, 0, 0, 100, 10, &#39;red&#39;);
  }
&lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;400&quot; height=&quot;400&quot;&gt;
    Your browser does not support the canvas tag.
  &lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>JavaScript code extract:</h4>

<pre>ctx.translate(100, 100);
drawMonster(0, 0);</pre>

<p><i>Line 1</i> changes the position of the coordinate system, <i>line
2</i> draws a monster in the new translated coordinate system. All
subsequent calls to drawing methods will be affected and will work in
this new system too.</p>

<ul>
  <li><h4>Other transformations: rotate, scale</h4></li>
</ul>

<h5>There are other transformations available:</h5>

<ul>
  <li>ctx.rotate(angle), with angle in radians. Note that the order of transformations is important: usually we translate, then rotate, then scale… If you change this order, you need to know what you are doing…</li>
  <li>ctx.scale (sx, sy), where scale(1, 1) corresponds to “no zoom”, scale(2, 2) corresponds to “zooming 2x” and scale(0.5, 0.5) corresponds to zooming out to see the drawings half as big as before. If you do not use the same values for sx and sy, you do “asymmetric scaling”, you can distort a shape horizontally or vertically. Try changing the values in the source code of the next online examples.</li>
</ul>

<p>Here is the previous example, but this time we translated the coordinate system, then rotated it with an angle equal to PI/4 , then we scaled it so that units are half as big:</p>

<details>
  <summary><b>JavaScript source code:</b></summary>
  
<pre>// Borrowed and adapted from : http://stackoverflow.com/questions/808826/draw-arrow-on-canvas-tag
function drawArrow(ctx, fromx, fromy, tox, toy, arrowWidth, color){
  //variables to be used when creating the arrow
  var headlen = 10;
  var angle = Math.atan2(toy-fromy,tox-fromx);
  ctx.save();
  ctx.strokeStyle = color;
  //starting path of the arrow from the start square to the end square and drawing the stroke
  ctx.beginPath();
  ctx.moveTo(fromx, fromy);
  ctx.lineTo(tox, toy);
  ctx.lineWidth = arrowWidth;
  ctx.stroke();
  //starting a new path from the head of the arrow to one of the sides of the point
  ctx.beginPath();
  ctx.moveTo(tox, toy);
  ctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/7),toy-headlen*Math.sin(angle-Math.PI/7));
  //path from the side point of the arrow, to the other side point
  ctx.lineTo(tox-headlen*Math.cos(angle+Math.PI/7),toy-headlen*Math.sin(angle+Math.PI/7));
  //path from the side point back to the tip of the arrow, and then again to the opposite side point
  ctx.lineTo(tox, toy);
  ctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/7),toy-headlen*Math.sin(angle-Math.PI/7));
  //draws the paths created above
  ctx.stroke();
  ctx.restore();
}</pre>

</details>

<br/>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;title&gt;Translated, rotated, and scaled monster&#39;s head&lt;/title&gt;
&lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;style&gt;
#myCanvas {
border: 1px solid black;
}
&lt;/style&gt;
&lt;script&gt;
  var canvas, ctx;
  function init() {
    // This function is called after the page is loaded
    // 1 - Get the canvas
    canvas = document.getElementById(&#39;myCanvas&#39;);
    // 2 - Get the context
    ctx=canvas.getContext(&#39;2d&#39;);
    // 3 - we can draw, try to change these values
    ctx.translate(100, 100);
    ctx.rotate(Math.PI/4);
    ctx.scale(0.5, 0.5);
    drawMonster(0, 0);
  }

  function drawMonster(x, y) {
    // head
    ctx.fillStyle=&#39;lightgreen&#39;;
    ctx.fillRect(0,0,200,200);
    // eyes
    ctx.fillStyle=&#39;red&#39;;
    ctx.fillRect(35,30,20,20);
    ctx.fillRect(140,30,20,20);
    // interior of eye
    ctx.fillStyle=&#39;yellow&#39;;
    ctx.fillRect(43,37,10,10);
    ctx.fillRect(143,37,10,10);
    // Nose
    ctx.fillStyle=&#39;black&#39;;
    ctx.fillRect(90,70,20,80);
    // Mouth
    ctx.fillStyle=&#39;purple&#39;;
    ctx.fillRect(60,165,80,20);
    // coordinate system at (0, 0)
    drawArrow(ctx, 0, 0, 100, 0, 10, &#39;red&#39;);
    drawArrow(ctx, 0, 0, 0, 100, 10, &#39;red&#39;);
  }
&lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;400&quot; height=&quot;400&quot;&gt;
    Your browser does not support the canvas tag.
  &lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>And here is the code of the transformations we used, followed by the call to the function that draws the monster:</h4>

<pre>ctx.translate(100, 100);
ctx.rotate(Math.PI/4);
ctx.scale(0.5, 0.5);
 
drawMonster(0, 0);</pre>

<ul>
  <li><h4>BEWARE: all drawings to come will be in that modified coordinate system!</h4></li>
</ul>

<p>If we draw two shapes at two different positions, they will be relative to this new coordinate system.</p>

<details>
  <summary><b>JavaScript source code:</b></summary>
  
<pre>// Borrowed and adapted from : http://stackoverflow.com/questions/808826/draw-arrow-on-canvas-tag
function drawArrow(ctx, fromx, fromy, tox, toy, arrowWidth, color){
//variables to be used when creating the arrow
var headlen = 10;
var angle = Math.atan2(toy-fromy,tox-fromx);
  ctx.save();
  ctx.strokeStyle = color;
  //starting path of the arrow from the start square to the end square and drawing the stroke
  ctx.beginPath();
  ctx.moveTo(fromx, fromy);
  ctx.lineTo(tox, toy);
  ctx.lineWidth = arrowWidth;
  ctx.stroke();
  //starting a new path from the head of the arrow to one of the sides of the point
  ctx.beginPath();
  ctx.moveTo(tox, toy);
  ctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/7),toy-headlen*Math.sin(angle-Math.PI/7));
  //path from the side point of the arrow, to the other side point
  ctx.lineTo(tox-headlen*Math.cos(angle+Math.PI/7),toy-headlen*Math.sin(angle+Math.PI/7));
  //path from the side point back to the tip of the arrow, and then again to the opposite side point
  ctx.lineTo(tox, toy);
  ctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/7),toy-headlen*Math.sin(angle-Math.PI/7));
  //draws the paths created above
  ctx.stroke();
  ctx.restore();
}</pre>

</details>

<br/>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;title&gt;2D transformation&lt;/title&gt;
    &lt;meta charset=&quot;utf-8&quot;/&gt;
    &lt;style&gt;
      #myCanvas {
        border: 1px solid black;
      }
    &lt;/style&gt;
    &lt;script&gt;
      var canvas, ctx;
      function init() {
        // This function is called after the page is loaded
        // 1 - Get the canvas
        canvas = document.getElementById(&#39;myCanvas&#39;);
        // 2 - Get the context
        ctx=canvas.getContext(&#39;2d&#39;);
        // 3 - we can draw, try to change these values
        ctx.translate(100, 100);
        ctx.rotate(Math.PI/4);
        ctx.scale(0.5, 0.5);
        // Draw the monster at (0, 0)
        drawMonster(0, 0);
        // draw a filled rectagle at (250, 0)
        ctx.fillRect(250, 0, 100, 100);
        drawCoordinateSystem(&#39;red&#39;, 10);
      }
      function drawMonster(x, y) {
        // head
        ctx.fillStyle=&#39;lightgreen&#39;;
        ctx.fillRect(0,0,200,200);
        // eyes
        ctx.fillStyle=&#39;red&#39;;
        ctx.fillRect(35,30,20,20);
        ctx.fillRect(140,30,20,20);
        // interior of eye
        ctx.fillStyle=&#39;yellow&#39;;
        ctx.fillRect(43,37,10,10);
        ctx.fillRect(143,37,10,10);
        // Nose
        ctx.fillStyle=&#39;black&#39;;
        ctx.fillRect(90,70,20,80);
        // Mouth
        ctx.fillStyle=&#39;purple&#39;;
        ctx.fillRect(60,165,80,20);
      }
      function drawCoordinateSystem(color, width) {
        // coordinate system at (0, 0)
        drawArrow(ctx, 0, 0, 100, 0, width, color);
        drawArrow(ctx, 0, 0, 0, 100, width, color);
      }
    &lt;/script&gt;
  &lt;/head&gt;
  &lt;body onload=&quot;init();&quot;&gt;
    &lt;canvas id=&quot;myCanvas&quot; width=&quot;400&quot; height=&quot;400&quot;&gt;
      Your browser does not support the canvas tag.
    &lt;/canvas&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<pre>ctx.translate(100, 100);
ctx.rotate(Math.PI/4);
ctx.scale(0.5, 0.5);
// Draw the monster at (0, 0)
drawMonster(0, 0);
// Draw a filled rectagle at (250, 0)
ctx.fillRect(250, 0, 100, 100);</pre>

<h4>How can we reset the coordinate system, how can we go back to the previous one?</h4>

<p>Aha, this is a very interesting question… the answer is in the next
page!</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-2-9">3.2.9 Saving and Restoring the Context</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>There are two methods for saving and restoring the context
properties: ctx.save() and ctx.restore().</p>
<p>What will be saved: fillStyle and strokeStyle, lineWidth, the
previous coordinate system, etc. <b>Meaning that ALL properties that
affect drawing!</b></p>
<p>A call to ctx.save() will probably save the context property values
in a hardware register on your graphics card. Multiple contexts can be
saved consecutively and restored.</p>
<p>Multiple contexts can be backed up consecutively and restored.
Contexts saved will be stacked, the last one that has been saved will be
restored by the next call to restore(), so it is very important to have
one restore for each save.</p>
<p><b>Best practice</b>: save the context at the beginning of any
function <i>that changes the context, restore it at the end of the
function!</i></p>

<h4>Example of a function that changes the context and restores it after execution</h4>

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>// Borrowed and adapted from : http://stackoverflow.com/questions/808826/draw-arrow-on-canvas-tag
function drawArrow(ctx, fromx, fromy, tox, toy, arrowWidth, color){
  //variables to be used when creating the arrow
  var headlen = 10;
  var angle = Math.atan2(toy-fromy,tox-fromx);
  ctx.save();
  ctx.strokeStyle = color;
  //starting path of the arrow from the start square to the end square and drawing the stroke
  ctx.beginPath();
  ctx.moveTo(fromx, fromy);
  ctx.lineTo(tox, toy);
  ctx.lineWidth = arrowWidth;
  ctx.stroke();
  //starting a new path from the head of the arrow to one of the sides of the point
  ctx.beginPath();
  ctx.moveTo(tox, toy);
  ctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/7),toy-headlen*Math.sin(angle-Math.PI/7));
  //path from the side point of the arrow, to the other side point
  ctx.lineTo(tox-headlen*Math.cos(angle+Math.PI/7),toy-headlen*Math.sin(angle+Math.PI/7));
  //path from the side point back to the tip of the arrow, and then again to the opposite side point
  ctx.lineTo(tox, toy);
  ctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/7),toy-headlen*Math.sin(angle-Math.PI/7));
  //draws the paths created above
  ctx.stroke();
  ctx.restore();
}</pre>

</details>

<br/>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;title&gt;Saving and restoring the context&lt;/title&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;style&gt;
    #myCanvas {
      border: 1px solid black;
    }
  &lt;/style&gt;
  &lt;script&gt;
    var canvas, ctx;
    function init() {
    // This function is called after the page is loaded
    // 1 - Get the canvas
    canvas = document.getElementById(&#39;myCanvas&#39;);
    // 2 - Get the context
    ctx=canvas.getContext(&#39;2d&#39;);
    // 3 - we can draw, try to change these values
    drawMonster(200, 100, Math.PI/4, &#39;lightGreen&#39;, &#39;yellow&#39;);
    // draw another rectangle at (0, 0), you will see it&#39;s black
    // (default color), and at the top left corner of the canvas
    // (original position of the coordinate system)
    ctx.fillRect(0, 0, 80, 80);
    }  /* function init() */
  function drawMonster(x, y, angle, headColor, eyeColor) {
    // GOOD PRACTICE : SAVE CONTEXT AND RESTORE IT AT THE END
    ctx.save();
    // Moves the coordinate system so that the monster is drawn
    // at position (x, y)
    ctx.translate(x, y);
    ctx.rotate(angle)
    // head
    ctx.fillStyle=headColor;
    ctx.fillRect(0,0,200,200);
    // eyes
    ctx.fillStyle=&#39;red&#39;;
    ctx.fillRect(35,30,20,20);
    ctx.fillRect(140,30,20,20);
    // interior of eye
    ctx.fillStyle=eyeColor;
    ctx.fillRect(43,37,10,10);
    ctx.fillRect(143,37,10,10);
    // Nose
    ctx.fillStyle=&#39;black&#39;;
    ctx.fillRect(90,70,20,80);
    // Mouth
    ctx.fillStyle=&#39;purple&#39;;
    ctx.fillRect(60,165,80,20);
    // coordinate system at (0, 0)
    drawArrow(ctx, 0, 0, 100, 0, 10, &#39;red&#39;);
    drawArrow(ctx, 0, 0, 0, 100, 10, &#39;red&#39;);
    // GOOD PRACTICE !
    ctx.restore();
    }  /* function drawMonster () */
  &lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;400&quot; height=&quot;400&quot;&gt;
    Your browser does not support the canvas tag.
  &lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>We slightly modified the function that draws the monster:</p>

<ul>
  <li>We added parameters for setting the position and orientation of the monster, and 
    added calls to ctx.translate(x, y) and ctx.rotate(angle) in the function.</li>
  <li>We added parameters for the head color and eye color.</li>
  <li>We saved the context at the beginning of the function (BEST PRACTICE),</li>
  <li>We restored it at the end (BEST PRACTICE).</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 132. monster head example (167) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image132.webp"
  loading="lazy"
  style="width:40%"
  title="Example of context save-restore: a monster drawn by a function that saves 
    and restored the context, then a rectangle is drawn, with context as it was previously"
  alt="Example of context save-restore: a monster drawn by a function that saves 
    and restored the context, then a rectangle is drawn, with context as it was previously." />

<p>Source code extract of this function: notice at <i>lines 3</i> and <i>26</i> 
how we save/restore the context at the beginning/end. Right after saving the 
context, we modify the coordinate system (<i>lines 7-8</i>). The rest of the 
code is nearly the same as in the last version of the monster example.</p>

<h4>function drawMonster</h4>

<details>
  <summary><b>JavaScript source code:</b></summary>
  
<pre>function drawMonster(x, y, angle, headColor, eyeColor) {
  // BEST PRACTICE: SAVE CONTEXT AND RESTORE IT AT THE END
  ctx.save();
  // Moves the coordinate system so that the monster is drawn
  // at position (x, y)
  ctx.translate(x, y);
  ctx.rotate(angle);
  // head
  ctx.fillStyle=headColor;
  ctx.fillRect(0,0,200,200);
  // eyes
  ctx.fillStyle=&#39;red&#39;;
  ctx.fillRect(35,30,20,20);
  ctx.fillRect(140,30,20,20);
  // interior of eye
  ctx.fillStyle=eyeColor;
  ctx.fillRect(43,37,10,10);
  ctx.fillRect(143,37,10,10);
  ...
  // BEST PRACTICE!
  ctx.restore();
}</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-3-1">3.3.1 Immediate Mode</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>In the previous sections, we learned how to draw filled or wireframe rectangles.</p>
<p>As soon as the ctx.strokeRect(x, y, width, height) or the ctx.fillRect(x, y, width, height) 
method is called, a rectangle is indeed drawn <i>immediately</i> in the canvas.</p>
<p>While drawing rectangles with strokeRect or fillRect, drawing text or drawing 
images, all these shapes will be drawn in <i>immediate mode</i>.</p>
<p>Another mode called “path mode” or “buffered mode” will be seen later in this 
course, which will be useful for drawing lines, curves, arcs, and also rectangles. 
Rectangles are the only shapes that have methods for drawing them <i>immediately</i> 
and also other methods for drawing them in “<i>path/buffered mode</i>”.</p>

<h4>Example: drawing rectangles in immediate mode using best practices</h4>

<p>Let’s give an example that draws several rectangles, filled or wireframe, with 
different colors and line widths:</p>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;title&gt;Immediate mode&lt;/title&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;style&gt;
    #myCanvas {
      border: 1px solid black;
    }
  &lt;/style&gt;
  &lt;script&gt;
    var canvas, ctx;
    window.onload = function () {
      canvas = document.getElementById(&#39;myCanvas&#39;);
      ctx = canvas.getContext(&#39;2d&#39;);
      // black rectangle, default color (black)
      ctx.fillRect(10, 10, 100, 100);
      // outlined rectangle, default color
      ctx.strokeRect(150, 10, 100, 100);
      // outlined rectangle filled in red, outline blue
      ctx.fillStyle = &#39;red&#39;;
      ctx.strokeStyle = &#39;lightBlue&#39;;
      ctx.lineWidth = 10;
      ctx.fillRect(100, 150, 150, 150);
      ctx.strokeRect(100, 150, 150, 150);
      // A function to automatize previous drawing
      var angle = Math.PI / 10;
      drawFilledRectangle(300, 150, 150, 150, &#39;pink&#39;, &#39;green&#39;, 10, angle);
      drawFilledRectangle(300, 150, 150, 150, &#39;yellow&#39;, &#39;purple&#39;, 10, angle + 0.5);
    };
    function drawFilledRectangle(x, y, w, h, fillColor, strokeColor, lw, angle) {
      // GOOD PRACTICE : save if the function change the context or coordinate
      // system
      ctx.save();
      // position coordinate system
      ctx.translate(x, y);
      ctx.rotate(angle);
      // set colors, line width...
      ctx.lineWidth = lw;
      ctx.fillStyle = fillColor;
      ctx.strokeStyle = strokeColor;
      // draw at 0, 0 as we translated the coordinate
      // system already
      ctx.fillRect(0, 0, w, h);
      ctx.strokeRect(0, 0, w, h);
      // GOOD PRACTICE : a restore for a save!
      ctx.restore();
      }
  &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;578&quot; height=&quot;400&quot;&gt;
  &lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-3-2">3.3.2 Drawing Text</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The canvas API provides two main methods for drawing text: ctx.strokeText(message, x, y) and 
ctx.fillText(message, x, y). It also provides a set of context properties for setting the 
character font and style, for laying out the text, etc.</p>

<h4>Typical use</h4>

<p>Look at the example below, and change the position where the text is drawn, change 
font attributes, etc.:</p>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Drawing text&lt;/title&gt;
    &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;canvas id=&quot;myCanvas&quot; width=500 height=300&gt;Your browser 
      does not support the canvas tag.&lt;/canvas&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
      var canvas=document.getElementById(&#39;myCanvas&#39;);
      var context=canvas.getContext(&#39;2d&#39;);
      context.font = &quot;60pt Calibri&quot;;
      context.lineWidth = 3;
      context.strokeStyle = &quot;blue&quot;;
      context.fillStyle = &quot;red&quot;;
      context.fillText(&quot;Hello World!&quot;, 10, 100);
      context.strokeText(&quot;Hello World!&quot;, 10, 100);
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Source code extract:</h4>

<pre>context.font = &quot;60pt Calibri&quot;;
// .. set color, lineWidth, shadow etc.
// 10, 10 is the start of the baseline, bottom of left leg of the &quot;H&quot; in the
// &quot;Hello World&quot; example.
context.fillText(&quot;Hello World!&quot;, 10, 10);
// Or
context.strokeText(&quot;Hello World!&quot;, 10, 10);</pre>

<h4>Properties and methods useful for drawing text</h4>

<h4>Choosing the font: the context.font property</h4>

<p>It is possible to draw text in a canvas using the font property of
the context to specify the font style (plain, bold, italic), the size,
and the font name. Other properties such as strokeStyle or fillStyle, as
well as other properties that are detailed in the next pages, are also
going to be taken into account.</p>

<p>The font property accepts values like: font-style,  font-weight, font-size, font-face.</p>

<h4>Accepted values are:</h4>

<ul>
  <li>font-style: normal, italic, oblique, </li>
  <li>font-weight: normal, bold, bolder, lighter,</li>
  <li>font-size: a size in pixels or in points, such as 60pt, 20px, 36px, etc.,</li>
  <li>font-face:  Arial, Calibri, Times, Courier, etc. Some font faces may not work in all browsers.</li>
</ul>

<h4>Examples:</h4>

<ul>
  <li>context.font = “60pt Calibri”;</li>
  <li>context.font = “normal normal 20px Verdana”;</li>
  <li>context.font = “normal 36px Arial”;</li>
  <li>context.font = “italic bold 36px Arial”;</li>
</ul>

<h4>Drawing text in solid or wireframe: the fillText() or strokeText() methods</h4>

<p>The fillText(message, x, y) or strokeText(message, x, y) methods from
the context will actually draw a text message at the origin of the
baseline position. In the “Hello World” example, this is located at the
bottom of the left leg of the “H”.</p>
<p>There is a fourth optional parameter maxWidth that forces the text to
fit into a given width, distorting it if necessary:</p>

<pre>context.strokeText(&quot;Hello World!&quot;, x, y [, maxWidth]);
context.fillText(&quot;Hello World!&quot;, x, y [, maxWidth]);</pre>

<h4>Forcing a text not to exceed a certain width: the maxWidth property</h4>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;Drawing text: the maxWidth property&lt;/title&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=500 height=300&gt;Your browser 
    does not support the canvas tag.&lt;/canvas&gt;
  &lt;script type=&quot;text/javascript&quot;&gt;
    var canvas=document.getElementById(&#39;myCanvas&#39;);
    var context=canvas.getContext(&#39;2d&#39;);
    context.font = &quot;60pt Calibri&quot;;
    context.lineWidth = 3;
    context.strokeStyle = &quot;blue&quot;;
    context.fillStyle = &quot;red&quot;;
    context.fillText(&quot;Hello World!&quot;, 10, 100);
    context.strokeText(&quot;Hello World!&quot;, 10, 100);
    // Draw text with constrained width
    context.fillText(&quot;Hello World!&quot;, 10, 160, 250);
    context.strokeText(&quot;Hello World!&quot;, 10, 160, 250);
    context.fillText(&quot;Hello World!&quot;, 10, 220, 150);
    context.strokeText(&quot;Hello World!&quot;, 10, 220, 150);
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<br/>

<details>
  <summary><b>JavaScript source code:</b></summary>
  
<pre>...
context.font = &quot;60pt Calibri&quot;;
context.lineWidth = 3;
context.strokeStyle = &quot;blue&quot;;
context.fillStyle = &quot;red&quot;;

context.fillText(&quot;Hello World!&quot;, 10, 100);
context.strokeText(&quot;Hello World!&quot;, 10, 100);

// Draw text with constrained width of 250 pixels
context.fillText(&quot;Hello World!&quot;, 10, 160, 250);
context.strokeText(&quot;Hello World!&quot;, 10, 160, 250);

// Constrain width to 150 pixels
context.fillText(&quot;Hello World!&quot;, 10, 220, 150);
context.strokeText(&quot;Hello World!&quot;, 10, 220, 150);</pre>

</details>

<h4>Measuring the width of a given text (bounding box) with the ctx.measureText()method</h4>

<p>The ctx.measureText() method can be used to get the current width in
pixels of a given text, taking into account the diverse properties
involved such as font, size, shadow, lineWidth, etc.</p>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;Drawing text: the ctx.measureText() method&lt;/title&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=500 height=300&gt;Your browser 
    does not support the canvas tag.&lt;/canvas&gt;
  &lt;script type=&quot;text/javascript&quot;&gt;
    var canvas=document.getElementById(&#39;myCanvas&#39;);
    var context=canvas.getContext(&#39;2d&#39;);
    context.font = &quot;60pt Calibri&quot;;
    context.lineWidth = 3;
    context.strokeStyle = &quot;blue&quot;;
    context.fillStyle = &quot;red&quot;;
    context.fillText(&quot;Hello World!&quot;, 10, 100);
    context.strokeText(&quot;Hello World!&quot;, 10, 100);
    var textMetrics = context.measureText(&quot;Hello World!&quot;);
    var width = textMetrics.width;
    context.font = &quot;20pt Arial&quot;;
    context.fillText(&quot;Width of previous text: &quot; + width 
  + &quot;pixels&quot;, 10, 150);
    // Draw the baseline of the given width
    context.moveTo(10, 100);
    context.lineTo(width+10, 100);
    context.stroke();
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<br/>

<details>
  <summary><b>JavaScript source code:</b></summary>
  
<pre>context.font = &quot;60pt Calibri&quot;;
context.lineWidth = 3;
context.strokeStyle = &quot;blue&quot;;
context.fillStyle = &quot;red&quot;;
context.fillText(&quot;Hello World!&quot;, 10, 100);
context.strokeText(&quot;Hello World!&quot;, 10, 100);
var textMetrics = context.measureText(&quot;Hello World!&quot;);
var width = textMetrics.width;
// Draw a text that displays the width of the previous drawn text
context.font = &quot;20pt Arial&quot;;
context.fillText(&quot;Width of previous text: &quot; 
  + width + &quot;pixels&quot;, 10, 150);
// Draw the baseline of the given width
context.moveTo(10, 100);
context.lineTo(width+10, 100);
context.stroke();</pre>

</details>

<h4>Changing the way the text is horizontally drawn: the ctx.textbaseline property</h4>

<p>The textBaseline property of the context is used to specify the
different ways one can position the baseline of a given text:</p>

<details>
  <summary><b>HTML source code:</b></summary>
  
<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;Drawing text: the ctx.textbaseline property&lt;/title&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=500 height=300&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
  &lt;script type=&quot;text/javascript&quot;&gt;
    var canvas=document.getElementById(&#39;myCanvas&#39;);
    var context=canvas.getContext(&#39;2d&#39;);
    context.strokeStyle = &quot;#000000&quot;;
    context.lineWidth = 1;
    context.beginPath();
    context.moveTo( 0, 75);
    context.lineTo(500, 75);
    context.stroke();
    context.closePath();
    context.font = &quot;16px Verdana&quot;;
    context.fillStyle = &quot;#000000&quot;;
    context.textBaseline = &quot;top&quot;;
    context.fillText(&quot;top&quot;, 0, 75);
    context.textBaseline = &quot;hanging&quot;;
    context.fillText(&quot;hanging&quot;, 40, 75);
    context.textBaseline = &quot;middle&quot;;
    context.fillText(&quot;middle&quot;, 120, 75);
    context.textBaseline = &quot;alphabetic&quot;;
    context.fillText(&quot;alphabetic&quot;, 200, 75);
    context.textBaseline = &quot;ideographic&quot;;
    context.fillText(&quot;ideographic&quot;, 300, 75);
    context.textBaseline = &quot;bottom&quot;;
    context.fillText(&quot;bottom-glyph&quot;, 400, 75);
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>The example above shows the different possible values for this property and 
the corresponding results. The default value is "alphabetic" and corresponds to 
what has been used in the previous "Hello World" example.</p>

<h3>Possible values for the textbaseline property:</h3>

<pre>&lt;div data-align="center"&gt;
&lt;table&gt;
  &lt;colgroup&gt;
    &lt;col style="width: 30%" /&gt;
    &lt;col style="width: 69%" /&gt;
  &lt;/colgroup&gt;
&lt;thead&gt;
  &lt;tr class="header"&gt;
    &lt;th&gt;textBaseline property&lt;/th&gt;
    &lt;th&gt;Description&lt;/th&gt;
  &lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr class="odd"&gt;
    &lt;td&gt;top&lt;/td&gt;
    &lt;td&gt;The text is aligned based on the top of the tallest glyph in the text.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr class="even"&gt;
    &lt;td&gt;hanging&lt;/td&gt;
    &lt;td&gt;The text is aligned based on the line the text seems to hang from.  This 
      is almost identical to top, and in many cases, you cannot see the difference.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr class="odd"&gt;
    &lt;td&gt;middle&lt;/td&gt;
    &lt;td&gt;The text is aligned according to the middle of the text.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr class="even"&gt;
    &lt;td&gt;alphabetic&lt;/td&gt;
    &lt;td&gt;The bottom of vertically oriented glyphs, e.g. western alphabet like the Latin.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr class="odd"&gt;
    &lt;td&gt;ideographic&lt;/td&gt;
    &lt;td&gt;The bottom of horizontally oriented glyphs.&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr class="even"&gt;
    &lt;td&gt;bottom&lt;/td&gt;
    &lt;td&gt;The text is aligned based on the bottom of the glyph in the text, that 
      extends furthest down in the text.&lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;</pre>

<p>Typical use (taken from the example above):</p>

<pre>context.textBaseline = &quot;top&quot;;
context.fillText(&quot;top&quot;, 0, 75);
context.textBaseline = &quot;hanging&quot;;
context.fillText(&quot;hanging&quot;, 40, 75);
context.textBaseline = &quot;middle&quot;;
context.fillText(&quot;middle&quot;, 120, 75);</pre>

<h4>Setting the horizontal justification of a text with the textAlign property</h4>

<p>The textAlign property of the context tells how the x parameter will be used when 
calling strokeText("some text", x, y) and fillText("some text", x, y). For example, 
with textAlign=“center”, the x parameter gives the position of the vertical center 
of the text, while in textAlign=“right”, x corresponds to the rightmost position 
of the text.</p>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;Drawing text: the textAlign property&lt;/title&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=500 height=120&gt;Your browser 
    does not support the canvas tag.&lt;/canvas&gt;
  &lt;script type=&quot;text/javascript&quot;&gt;
    var canvas=document.getElementById(&#39;myCanvas&#39;);
    var context=canvas.getContext(&#39;2d&#39;);
    context.stokeStyle = &quot;#000000&quot;;
    context.lineWidth = 1;
    context.beginPath();
    context.moveTo( 250, 0);
    context.lineTo( 250, 130);
    context.stroke();
    context.closePath();
    context.font = &quot;16px Verdana&quot;;
    context.fillStyle = &quot;#000000&quot;;
    context.textAlign = &quot;center&quot;;
    context.fillText(&quot;center&quot;, 250, 20);
    context.textAlign = &quot;start&quot;;
    context.fillText(&quot;start&quot;, 250, 40);
    context.textAlign = &quot;end&quot;;
    context.fillText(&quot;end&quot;, 250, 60);
    context.textAlign = &quot;left&quot;;
    context.fillText(&quot;left&quot;, 250, 80);
    context.textAlign = &quot;right&quot;;
    context.fillText(&quot;right&quot;, 250, 100);
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Typical use (source code taken from the above example):</h4>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>context.textAlign = &quot;center&quot;;
context.fillText(&quot;center&quot;, 250, 20);
context.textAlign = &quot;start&quot;;
context.fillText(&quot;start&quot;, 250, 40);
context.textAlign = &quot;end&quot;;
context.fillText(&quot;end&quot;, 250, 60);
context.textAlign = &quot;left&quot;;
context.fillText(&quot;left&quot;, 250, 80);
context.textAlign = &quot;right&quot;;
context.fillText(&quot;right&quot;, 250, 100);</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-3-3">3.3.3 Drawing Images</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Working with images is rather simple, except that we need the images to be 
fully loaded into memory before drawing them. Loading images is an 
<i>asynchronous</i> process we need to take care of. Working with multiple 
images might also be difficult for beginners. We present a multiple image loader 
later on in this course.</p>

<p><b>Let’s say it once again</b>: To use an image in a canvas, make sure that 
the image has been loaded by the Web browser before drawing it!</p>

<p>It is also possible to draw images from a video stream, images corresponding to 
another canvas content, or images that are defined by &lt;img&gt; HTML elements in 
the page. We will see that as well in the following parts of this chapter.</p>

<p>But let’s start with a basic example!</p>

<h4>Example #1: drawing an image in a canvas</h4>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE HTML&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;/&gt;
    &lt;title&gt;Simple image drawing in a canvas&lt;/title&gt;
    &lt;script&gt;
      window.onload = function () {
      // Necessity to run this code only after the web page has been loaded.
      var canvas = document.getElementById(&quot;myCanvas&quot;);
      var context = canvas.getContext(&quot;2d&quot;);
      var imageObj = new Image();
      // Callback function called by the imageObj.src = .... line
      //located after this function
      imageObj.onload = function () {
      // Draw the image only when we have the guarantee
      // that it has been loaded
      context.drawImage(imageObj, 0, 0);
    };
    // Calls the imageObj.onload function asynchronously
    imageObj.src =
      &quot;https://www.w3.org/html/logo/downloads/HTML5_Logo_512.png&quot;;
    };
    &lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;canvas id=&quot;myCanvas&quot; width=&quot;512&quot; height=&quot;512&quot;&gt;&lt;/canvas&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Explanations:</h4>

<ol type="1">
  <li>We have to create a JavaScript Image object (<i>line 10</i>),</li>
  <li>When we set the src attribute of this object with the URL of the image file, 
    then an asynchronous request is sent in the background by the browser. Loading 
    a big image may take some time, so the rest of the Ja vaScript code continues 
    running. This is why we call it “asynchronous”.</li>
  <li>When the image file has been loaded, the browser calls the onload callback 
    associated with the image (<i>line 14</i>).</li>
  <li>We draw the image only from inside this callback, otherwise we have no 
    guarantee that the image has been loaded and can be usable. The actual 
    drawing here is done <i>line 1</i>.</li>
  <li>There are numerous variants of the drawImage(…) context method at <i>line 17</i></li>
</ol>

<ul>
  <li>drawImage(img, x, y): draws the image at position x, y, keeping the original 
    image size.</li>
  <li>drawImage(img, x, y, sizeX, sizeY): same as before except that the image 
    drawn is resized.</li>
  <li>drawImage(img, sx, sy, sw, sh, dx, dy, dw, dh): for drawing sub-images, 
    (sx, sy, sw, sh) define the source rectangle, while dx, dy, dw, sh define 
    the target rectangle. If these rectangles don’t have the same size, the 
    source sub-image is resized.</li>
</ul>

<h4>See picture below:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 133. simple image drawing in a canvas (182) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image133.webp"
  loading="lazy"
  title="Drawing Images with Subimages. Source image within a Destination Canvas"
  alt="Drawing Images with Subimages. Source image within a Destination Canvas."
  style="width:45%;" />

<h4>Example #2: different variants of drawImage(…)</h4>

<p>This example illustrates the use of the different variants of the drawImage method:</p>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE HTML&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;title&gt;Drawing images: drawImage variants&lt;/title&gt;
  &lt;script&gt;
    window.onload = function() {
    var canvas = document.getElementById(&quot;myCanvas&quot;);
    var context = canvas.getContext(&quot;2d&quot;);
    var imageObj = new Image();
    imageObj.onload = function() {
    // Try commenting/uncommenting the following lines to see the
    // effect of the different drawImage variants
    // Original, big image
    // context.drawImage(imageObj, 0, 10);
    // Original image drawn with size = 100x100 pixels
    context.drawImage(imageObj, 0, 10, 100, 100);
    // with size = 150x150
    context.drawImage(imageObj, 80, 10, 150, 150);
    // with size = 200x200
    context.drawImage(imageObj, 210, 10, 200, 200);
    // draw the sub image at 0, 0, width = 512, height = 100
    // at position 100, 250, with a width of 256 and a height of 50 
    context.drawImage(imageObj, 0, 0, 512, 100, 100, 250, 256, 50);
    };
    imageObj.src = &quot;https://www.w3.org/html/logo/downloads/HTML5_Logo_512.png&quot;;
    };
  &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;512&quot; height=&quot;512&quot;&gt;&lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>CSS source code:</h4>

<pre>#myCanvas {
  border:1px solid black;
}</pre>

<br/>

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>var imageObj = new Image();
imageObj.onload = function() {
  // try commenting/uncommenting the following lines to see the
  // effect of the different drawImage variants
  // original, big image
  // context.drawImage(imageObj, 0, 10);
  // original image drawn with size = 100x100 pixels
  context.drawImage(imageObj, 0, 10, 100, 100);
  // with size = 150x150
  context.drawImage(imageObj, 80, 10, 150, 150);
  // with size = 200x200
  context.drawImage(imageObj, 210, 10, 200, 200);
  // draw the sub image at 0, 0, width = 512, height = 100
  // at position 100, 250, with a width of 256 and a height of 50
  context.drawImage(imageObj, 0, 0, 512, 100, 100, 250, 256, 50);
};
imageObj.src = &quot;https://www.w3.org/html/logo/downloads/HTML5_Logo_512.png&quot;;
};</pre>

</details>

<h4>Example #3: draw an image defined in the page by an &lt;img src="…"&gt; element</h4>

<p>Sometimes, you may want to draw an image that is already declared in the HTML 
document as an &lt;img src="..."&gt; element. Remember that when you add an &lt;img&gt; 
in the document, the browser starts downloading it in background.</p>

<h4>You could try drawing it using some code like this:</h4>

<pre>&lt;body&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;512&quot; height=&quot;512&quot;&gt;&lt;/canvas&gt;
  &lt;p&gt;Original image as an &lt;img&gt; element:&lt;/p&gt;
  &lt;b&gt;&lt;img id=&quot;logo&quot;&lt;/b&gt;
  &lt;b&gt;src=&quot;https://fc07.deviantart.net/fs70/f/2013/149/b/8/texture_85_by_voyager168-d670m68.jpg&quot;&gt;&lt;/b&gt;
  &lt;script&gt;
    canvas = document.getElementById(&quot;myCanvas&quot;);
    var ctx = canvas.getContext(&quot;2d&quot;);
    var logo = document.querySelector(&quot;#logo&quot;);
    &lt;b&gt;ctx.drawImage(logo, 0, 0, 100, 100);&lt;/b&gt;
  &lt;/script&gt;
&lt;/body&gt;</pre>

<p>Although you will find many examples on the Web that do it this way, they will 
only work most of the time with small images, or with images that are in the browser’s 
cache. Remember that you cannot draw an image that has not been fully loaded!</p>

<p>If you try to draw an image that is not loaded or partially loaded, you will have 
unexpected results!</p>

<p><b>Best practice:</b> only draw an image that is fully loaded, use the onload 
callback! The right way to do this is shown in this online example, that starts 
drawing only from the onload callback function:</p>

<h4>CSS source code:</h4>

<pre>#myCanvas {
  border:1px solid black;
}</pre>

<br/>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE HTML&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;title&gt;Drawing an image with &lt;img&gt;&lt;/title&gt;
  &lt;script&gt;
    var canvas, context, imageObj;
    window.onload = function() {
    canvas = document.getElementById(&quot;myCanvas&quot;);
    context = canvas.getContext(&quot;2d&quot;);
    imageObj = document.querySelector(&quot;#logo&quot;);
    drawAllImages();
    };
    
    function drawAllImages() {
      console.log(&quot;image is already loaded, we draw it!&quot;);
      // Original image drawn with size = 100x100 pixels
      context.drawImage(imageObj, 0, 10, 100, 100);
      // with size = 150x150
      context.drawImage(imageObj, 80, 10, 150, 150);
      // with size = 200x200
      context.drawImage(imageObj, 210, 10, 200, 200);
      // draw the sub image at 0, 0, width = 512, height = 100
      // at position 100, 250, with a width of 256 and a height of 50
      context.drawImage(imageObj, 0, 0, 512, 100, 100, 250, 256, 50);
    }
  &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;p&gt;A canvas with an image that is further in the page, loaded by the 
    &lt;img src=...&gt; tag. This is not the recommended way to load images, 
      except if the image is already in your page. Use the onload callback to be sure that the 
      image is in the page. &lt;/p&gt;
    &lt;canvas id=&quot;myCanvas&quot; width=&quot;512&quot; height=&quot;512&quot;&gt;&lt;/canvas&gt;
    &lt;p&gt;Original image is an &amp;lt;img&gt; element:
  &lt;/p&gt;
  &lt;img id=&quot;logo&quot; src=&quot;https://www.w3.org/html/logo/downloads/HTML5_Logo_512.png&quot; 
    alt=&quot;html5 logo&quot;&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>With large image files, this will not break nor produce unexpected results:</p>

<h4>CSS source code:</h4>

<pre>#myCanvas {
  border:1px solid black;
}</pre>

<br/>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE HTML&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;title&gt;Using a large image&lt;/title&gt;
  &lt;script&gt;
    let canvas, context;
    window.onload = () =&gt; {
    canvas = document.getElementById(&quot;myCanvas&quot;);
    context = canvas.getContext(&quot;2d&quot;);
    draw();
    };

    function draw() {
      var imageObj = document.querySelector(&quot;#logo&quot;);
      console.log(&quot;Image has been loaded, let&#39;s draw it!&quot;);
      // Original image drawn with size = 100x100 pixels
      context.drawImage(imageObj, 0, 10, 100, 100);
      // with size = 150x150
      context.drawImage(imageObj, 80, 10, 150, 150);
      // with size = 200x200
      context.drawImage(imageObj, 210, 10, 200, 200);
      // draw the sub image at 0, 0, width = 512, height = 100
      // at position 100, 250, with a width of 256 and a height of 50
      context.drawImage(imageObj, 0, 0, 512, 100, 100, 250, 256, 50);
    }
  &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;p&gt;It is possible that the drawing in the canvas below appears only after a few seconds, 
    because the image is very large!&lt;/p&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;512&quot; 
    height=&quot;512&quot;&gt;&lt;/canvas&gt;
  &lt;p&gt;Very large original image, declared as an &amp;lt;img&gt; element:
  &lt;/p&gt;
  &lt;img id=&quot;logo&quot; alt=&quot;logo&quot; src=&quot;https://mainline.i3s.unice.fr/mooc/texture_85_by_voyager168-d670m68.jpg&quot; 
    width=&quot;512&quot; height=&quot;512&quot;&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>The <a href="https://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-eventgroupings-htmlevents" 
target="_blank" rel="noopener noreferrer">DOM Level 2 Events specification</a> 
says: "<i>The load event occurs when the DOM implementation finishes loading all 
content within a document, all frames within a FRAMESET, or an OBJECT element.</i>"</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-3-4">3.3.4 Drawing Images from a Video Stream</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The drawImage(…) function can take a video element as its first parameter. 
The image that will be drawn is the one currently played by the video stream. 
This can be done at video frequency on most modern computers or mobile devices.</p>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE HTML&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;title&gt;Drawing images from a video stream&lt;/title&gt;
  &lt;style&gt;
    body {
      margin: 10px;
      padding: 0px;
    }
    #myCanvas {
      border: 10px solid red;
    }
  &lt;/style&gt;
  &lt;script&gt;
    var video;
    var canvas, ctx;
    var angle = 0;
    
    function init() {
      video = document.getElementById(&#39;sourcevid&#39;);
      canvas = document.getElementById(&#39;myCanvas&#39;);
      ctx = canvas.getContext(&#39;2d&#39;);
      setInterval(&quot;processFrame()&quot;, 25);
    }
  
    function processFrame() {
      // Uncomment next line for drawing 100% copy of the video content
      //ctx.drawImage(video, 0, 0);
      // Comment these 4 lines if you uncommented the previous one
      ctx.drawImage(video, 0, 0, 320, 180);
      drawRotatingVideo(480, 90);
      ctx.drawImage(video, 0, 180, 320, 180);
      ctx.drawImage(video, 320, 180, 320, 180);
    }

    function drawRotatingVideo(x, y) {
      // Clear thze zone at the top right quarter of the canvas
      ctx.clearRect(320, 0, 320, 180);
      // We are going to change the coordinate system, save the context !
      ctx.save();
      // translate, rotate and recenter the image at its &quot;real&quot; center,
      //not the top left corner
      ctx.translate(x, y);
      ctx.rotate(angle += 0.01);
      ctx.translate(-80, -45);
      ctx.drawImage(video, 0, 0, 160, 90);
      // restore the context
      ctx.restore();
    }
  &lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;init()&quot; &gt;
  &lt;p&gt;This is a &lt;code&gt;&amp;lt;video&gt;&lt;/code&gt; element: &lt;/p&gt;
  &lt;video id=&quot;sourcevid&quot; autoplay loop&gt;
  &lt;source src=&quot;https://mainline.i3s.unice.fr/mooc/BigBuckBunny_640x360.mp4&quot; 
    type=&quot;video/mp4&quot; /&gt;
  &lt;source src=&quot;https://mainline.i3s.unice.fr/mooc/BigBuckBunny_640x360.ogv&quot; 
    type=&quot;video/ogg&quot;/&gt;
  &lt;/video&gt;
  &lt;p&gt;This is a &lt;code&gt;&amp;lt;canvas&gt;&lt;/code&gt; element: &lt;/p&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;620&quot; height=&quot;360&quot;&gt;&lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>This example shows:</p>

<ul>
  <li>a &lt;video&gt; element on top, and four images drawn in a canvas below.</li>
  <li>The images are drawn every XXX milliseconds using the setInterval(function, delay) method.</li>
</ul>

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>&lt;script&gt;
  var video;
  var canvas, ctx;
  var angle = 0;
function init() {
  video = document.getElementById(&#39;sourcevid&#39;);
  canvas = document.getElementById(&#39;myCanvas&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  setInterval(&quot;processFrame()&quot;, 25); // call processFrame each 25ms
}
function processFrame() {
  ctx.drawImage(video, 0, 0, 320, 180);
  drawRotatingVideo(480, 90);
  ctx.drawImage(video, 0, 180, 320, 180);
  ctx.drawImage(video, 320, 180, 320, 180);
}
function drawRotatingVideo(x, y) {
  // Clear the zone at the top right quarter of the canvas
  ctx.clearRect(320, 0, 320, 180);
  // We are going to change the coordinate system, save the context!
  ctx.save();
  // translate, rotate and recenter the image at its &quot;real&quot; center,
  //not the top left corner
  ctx.translate(x, y);
  ctx.rotate(angle += 0.01); // rotate and increment the current angle
  ctx.translate(-80, -45);
  ctx.drawImage(video, 0, 0, 160, 90);
  // restore the context
  ctx.restore();
}
&lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;init()&quot; &gt;
  &lt;p&gt;This is a &lt;video&gt;&lt;video&gt; element: &lt;/p&gt;
  &lt;video id=&quot;sourcevid&quot; autoplay=&quot;true&quot; loop=&quot;true&quot;&gt;
  &lt;source src=&quot;https://mainline.i3s.unice.fr/mooc/BigBuckBunny_640x360.mp4&quot;
         type=&quot;video/mp4&quot; /&gt;
  &lt;source src=&quot;https://mainline.i3s.unice.fr/mooc/BigBuckBunny_640x360.ogv&quot;
         type=&quot;video/ogg&quot;/&gt;
  &lt;/video&gt;
  &lt;p&gt;This is a &lt;canvas&gt; element: &lt;/p&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;620&quot; height=&quot;360&quot;&gt;&lt;/canvas&gt;
&lt;/body&gt;</pre>

</details>

<h4>Explanations:</h4>
<ul>
  <li><i>Line 11</i>: the call to setInterval will make the browser execute  the 
    processFrame function each 25ms.</li>
  <li><i>Lines 15, 17 and 18</i>: in processFrame, drawImage(…) is called 3 times 
    with the video element passed as first parameter.</li>
  <li><i>Line 43</i>: the video element declared at <i>line 43</i> has autoplay=true 
    and loop=true, it starts playing the video as soon as possible and will loop it.</li>
  <li><i>Line 21</i>: We implemented a rotating video effect in the drawRotatingVideo. 
    The use of context save/restore is primordial as this function changes the coordinate 
    system at each call, translating and rotating it. Notice the extra translation at 
    <i>line 31</i> that translates the coordinate system backwards with half of the 
    size of the image that is drawn. We did this in order to make the image rotate 
    around the center of the rectangle, instead of around the top left corner at 
    (0, 0) by default. Try commenting out this line in the running example and 
    you will see what we mean.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-4-1">3.4.1 Immediate Mode vs. Path Mode</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Immediate mode</h4>

<p>As a reminder: an immediate mode means “executing a call to a drawing
method means <i>immediately</i> drawing in the canvas”. The drawing
appears as soon as the design instruction is executed.</p>

<ul>
  <li>In the previous examples, we saw how to draw rectangles using the 
    fillRect(x, y, width, height) and strokeRect(x, y, width, height) 
    methods of the context.</li>
  <li>We also learned how to draw a text message using the 
    fillText(message, x, y) and strokeText(message, x, y) methods that 
    draws a text in filled and wireframe mode, respectively.</li>
</ul>

<ul>
  <li>These methods, along with the drawImage(…) method already seen in 
    section 3.3.3, are <i>"immediate methods"</i>: as soon as they are 
    executed, the results are displayed on screen, the drawings are 
    performed, pixels on the canvas area change their colors, etc.</li>
</ul>

<p>Here is an example that draws 1000 random rectangles in a canvas, using 
immediate mode rectangle drawing calls:</p>

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>var canvas, ctx, w, h;
function init() {
  canvas = document.getElementById(&#39;myCanvas&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  w = canvas.width;
  h = canvas.height;
  console.time(&quot;time to draw&quot;);
  for(var i=0; i &lt; 1000; i++) {
    var x = Math.random() * w;
    var y = Math.random() * h;
    var width = Math.random() * w;
    var height = Math.random() * h;
    ctx.strokeRect(x, y, width, height);
  }
  console.timeEnd(&quot;time to draw&quot;);
}</pre>

</details>

<h4>HTML source code:</h4>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;title&gt;Canvas&lt;/title&gt;
&lt;/head&gt;
&lt;body onload = init();&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;400&quot; height =400&gt;
    Your browser does not support the canvas tag.&lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

<br/>

<details>
  <summary><b>CSS source code:</b></summary>

<pre>var canvas, ctx, w, h;
function init() {
  canvas = document.getElementById(&#39;myCanvas&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  w = canvas.width;
  h = canvas.height;
  console.time(&quot;time to draw&quot;);
  for(var i=0; i &lt; 1000; i++) {
    var x = Math.random() * w;
    var y = Math.random() * h;
    var width = Math.random() * w;
    var height = Math.random() * h;
    ctx.strokeRect(x, y, width, height);
  }
  console.timeEnd(&quot;time to draw&quot;);
}</pre>

</details>

<p><i>Lines 12-18</i> draw 1000 rectangles of random sizes in immediate mode. 
We also measure the time using the usual console.time(name_of_timer) and 
console.timeEnd(name_of_timer) that will write in the browser console the 
time elapsed. Note that console.time(…) and console.timeEnd(…) display 
results only in the
browser’s console, not in the JSBin console.</p>
<p>On a Mac Book Pro from 2015, the result is an average time of 4.034ms 
for drawing all these rectangles:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~ 134. image of the devtool console clocking time to draw rectangles (189) ~~~~~~~~-->
<img class="displayed"
  src="./images/image134.webp"
  loading="lazy"
  title="Image of the devtool console measuring average time to draw rectangles"
  alt="Image of the devtool console measuring average time to draw rectangles."
  style="width:40%;" />

<h4>Path mode</h4>

<p>There is another drawing mode called “path drawing mode” where you
first send drawing orders to the graphics processor, and these orders
are stored in a buffer. Then you call methods to draw the whole buffer
at once. There are also methods to erase the buffer’s content.</p>
<p>Path drawing mode allows parallelism: if you need to draw 10,000
rectangles, it’s better to store the orders in the graphics card, then
execute the drawing all at once, rather than doing 10,000 immediate
calls to strokeRect(…) for example. With the buffered mode, the Graphic
Processing Unit (GPU) of the graphics card hardware will be able to
parallelize the computations (modern graphics cards can execute
hundreds/thousands of things in parallel).</p>
<p>Same example as before, this time using the buffered mode for drawing
rectangles:</p>

<h4>JavaScript source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas, ctx, w, h;
function init() {
  canvas = document.getElementById(&#39;myCanvas&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  w = canvas.width;
  h = canvas.height;
  console.time(&quot;time to draw&quot;);
  for(var i=0; i &lt; 1000; i++) {
    var x = Math.random() * w;
    var y = Math.random() * h;
    var width = Math.random() * w;
    var height = Math.random() * h;
    ctx.rect(x, y, width, height);
  }
  ctx.stroke();
  console.timeEnd(&quot;time to draw&quot;);
}</pre>

</details>

<h4>HTML source code:</h4>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;title&gt;Canvas&lt;/title&gt;
&lt;/head&gt;
&lt;body onload = init();&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;400&quot; height =400&gt;
    Your browser does not support the canvas tag.&lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>

<p>Extract from source code (the part that draws the rectangles):</p>

<pre>for(var i=0; i &lt; 1000; i++) {
  var x = Math.random() * w;
  var y = Math.random() * h;
  var width = Math.random() * w;
  var height = Math.random() * h;
  ctx.rect(x, y, width, height); // store a rectangle in path/buffer
}
ctx.stroke(); // draws the whole buffer (the 1000 rectangles) at once
</pre>
<p>Instead of calling strokeRect(…) or fillRect(…), we just call
the rect(…) method of the context (<i>line 7</i>). This is how we can
delay the drawing of the rectangles. The 1000 rectangles are stored in a
buffer in the hardware.</p>
<p>The call to ctx.stroke() (<i>line 9</i>) or to its sister
method ctx.fill() will draw the entire buffer contents in fill or stroke
mode.</p>
<p>And here is what the timer gives: a slightly faster execution time.
Changing 1000 to 100,000 will give even larger differences.</p>
<p><b>Path mode is faster than immediate mode! We have now an average
time of 3.1ms</b></p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~ 135. image of the devtool console which shows time path vs immediate (191) ~~~~~~~~-->
<img class="displayed"
  src="./images/image135.webp"
  loading="lazy"
  title="Image of the devtool console which shows time values, path vs immediate mode"
  alt="Image of the devtool console which shows time values, path vs immediate mode."
  style="width:40%;" />

<h4>Reset the path mode buffer</h4>

<p>A call to ctx.beginPath() will reset the buffer (empty its contents).
We will see many more examples of using the path drawing mode in another
further section.</p>

<pre>// start a new buffer / path
ctx.beginPath();
// all these orders are in a buffer/path
ctx.moveTo(10, 10);
ctx.lineTo(100, 100);
ctx.lineTo(150, 70);
// Draw the buffer
ctx.stroke();</pre>

<p>Summary of path mode principles</p>

<ol type="1">
  <li>Call drawing methods that work in path mode, for example call ctx.rect(…) instead 
    of ctx.strokeRect(…) or ctx.fillRect(…),</li>
  <li>Call ctx.stroke() or ctx.fill() to draw the buffer’s contents,</li>
  <li>Beware that the buffer is never emptied, two consecutive calls to ctx.stroke() 
    will draw the buffer contents twice! Instead, use ctx.beginPath() to empty it if needed,</li>
  <li>It is possible to empty the buffer by calling ctx.beginPath(),</li>
  <li>Path drawing is faster than immediate drawing (parallelization is possible).</li>
</ol>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-4-2">3.4.2 A Warning</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p><b>Warning</b>: you do not need to spend too much time on each part of this 
sub-section.</p>
<p>You do not need to memorize or learn by heart all the examples in the following 
pages. They are given as references. There will be no quizzes about curves as they 
are not often done “by hand”, but are generated by tools such as Adobe Illustrator 
or online generators.</p>

<ul>
  <li>You need to draw arcs? Then, please use the corresponding section as a reference: 
    you know you will find one or more examples and a detailed explanation.</li>
  <li>You need to draw lines? Arrows? Curves? Same thing: go to the corresponding 
    pages and look at the examples!</li>
</ul>

<p>Also, do not forget to use your favorite HTML5 canvas cheatsheet
(provided before in the last section). You will find it very
helpful when you start playing with the canvas.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-4-3">3.4.3 Drawing Lines</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>We have been drawing rectangles so far.</p>

<p>Now let’s go a bit further by introducing the notion of “path drawing”. This approach 
uses the ctx.moveTo(x, y) method of the context, in conjunction with other drawing methods 
that end in “To”, such as ctx.lineTo(x, y).</p>

<p>This makes it easier to draw multiple connected lines. Consecutive calls to ctx.lineTo(x, y) 
will store in the path/buffer a set of connected lines that we will draw altogether by a single 
call to ctx.stroke() or ctx.fill().</p>

<h4>Here are the 5 different steps:</h4>

<ol type="1">
  <li>Put the “pencil” somewhere with a call to ctx.moveTo(x1, y1). This will be the origin 
    of the first line.</li>
  <li>Call the ctx.lineTo(x2, y2) method to draw a line from the previous position 
    (previous step) to the position passed as parameters to the lineTo(…) method. 
    This position will serve as the origin for the next line to be drawn.</li>
  <li>Call lineTo(x3, y3) again to draw a line that goes from (x2, y2) to (x3, y3). 
    This line will start at the end of the previous one.</li>
  <li>Repeat step 3 to draw more connected lines.</li>
  <li>Call the ctx.stroke() or the ctx.fill() methods to draw the path defined by the 
    different lines.</li>
</ol>

<p>Note the call to ctx.stroke() or ctx.fill() will use the current values of the strokeStyle 
or fillStyle properties. It is possible to call ctx.moveTo(x, y) in the middle of steps 1 
through 5 in order to move the pen somewhere else without connecting to the last drawn line.</p>

<h4>Drawing a grid</h4>

<h4>See the example below:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 136. draw grid using ctx.stroke (193) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image136.webp"
  loading="lazy"
  title="Draw blue grid using ctx.stroke command"
  alt="Draw blue grid using ctx.stroke command."
  style="width:40%;" />

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;title&gt;Drawing a grid&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;canvas id=&quot;myCanvas&quot;&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
  &lt;script type=&quot;text/javascript&quot;&gt;
    var canvas=document.getElementById(&#39;myCanvas&#39;);
    var ctx=canvas.getContext(&#39;2d&#39;);
    // Vertical lines
    for (var x = 0.5; x &lt; 500; x += 10) {
      ctx.moveTo(x, 0);
      ctx.lineTo(x, 375);
    }
    // Horizontal lines
    for (var y = 0.5; y &lt; 375; y += 10) {
      ctx.moveTo(0, y);
      ctx.lineTo(500, y);
    }
    // Draw in blue
    ctx.strokeStyle = &quot;#0000FF&quot;;
    // Before the execution of the next line nothing as been drawn yet !
    ctx.stroke();
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<br/>

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>var canvas=document.getElementById(&#39;myCanvas&#39;);
var ctx=canvas.getContext(&#39;2d&#39;);
// Vertical lines
for (var x = 0.5; x &lt; 500; x += 10) {
  ctx.moveTo(x, 0);
  ctx.lineTo(x, 375);
}
// Horizontal lines
for (var y = 0.5; y &lt; 375; y += 10) {
  ctx.moveTo(0, y);
  ctx.lineTo(500, y);
}
// Draw in blue
ctx.strokeStyle = &quot;#0000FF&quot;;
// Until the execution of the next line, nothing has been drawn!
ctx.stroke();</pre>

</details>

<p>In this example, the entire grid is drawn during the execution of the last line 
of code, with the single call to ctx.stroke().</p>

<h4>Mixing filled and wireframe shapes (and immediate and path modes)</h4>

<h4>Try this:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~ 137. mix filled & wireframe shapes using different methods (194) ~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image137.webp"
  loading="lazy"
  title="Mix filled and wireframe shapes using different methods"
  alt="Mix filled and wireframe shapes using different methods."
  style="width:40%;" />

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;title&gt;Canvas&lt;/title&gt;
&lt;/head&gt;
&lt;canvas id=&quot;myCanvas&quot;&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  var canvas=document.getElementById(&#39;myCanvas&#39;);
  var ctx=canvas.getContext(&#39;2d&#39;);
  ctx.fillStyle=&#39;#FF0000&#39;;
  ctx.fillRect(0,0,80,100);
  ctx.moveTo(0,0);
  ctx.lineTo(100, 100);
  ctx.lineTo(100,0);
  ctx.strokeStyle = &quot;#0000FF&quot;;
  ctx.stroke();
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<br/>

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>var canvas=document.getElementById(&#39;myCanvas&#39;);
var ctx=canvas.getContext(&#39;2d&#39;);
// a filled rectangle in immediate mode
ctx.fillStyle=&#39;#FF0000&#39;;
ctx.fillRect(0,0,80,100);
// two consecutive lines in path mode
ctx.moveTo(0,0);
ctx.lineTo(100, 100);
ctx.lineTo(100,0);
// draws only the two lines in wireframe mode
ctx.strokeStyle = &quot;#0000FF&quot;;
ctx.stroke();</pre>

</details>

<p>This example shows that filled and wireframe shapes should be drawn differently 
(here a filled rectangle is drawn using a call to the fillRect(…) method while a 
wireframe set of connected lines is drawn using the stroke() method of the context).</p>

<h4>Drawing a single path made with disconnected lines / parts</h4>

<p>Try this:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~ 138. drawing single path made with disconnected lines (195) ~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image138.webp"
  loading="lazy"
  title="Drawing single path made with disconnected lines"
  alt="Drawing single path made with disconnected lines."
  style="width:40%;" />

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>var canvas=document.getElementById(&#39;myCanvas&#39;);
var ctx=canvas.getContext(&#39;2d&#39;);
// first part of the path
ctx.moveTo(20,20);
ctx.lineTo(100, 100);
ctx.lineTo(100,0);
// second part of the path, moveTo(...) is used to &quot;jump&quot; to another place
ctx.moveTo(120,20);
ctx.lineTo(200, 100);
ctx.lineTo(200,0);
// indicate stroke color + draw the path
ctx.strokeStyle = &quot;#0000FF&quot;;
ctx.stroke();</pre>

</details>

<p>In this last example, we simply called the moveTo() method between
each part of the path (<i>lines 5 and 10</i>). And we
called stroke() (<i>line 16</i>) only once to draw the whole path.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-4-4">3.4.4 Drawing Lines with Different Styles</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Common mistake: drawing the same path twice</h4>
<p>Let’s look at the drawing from the last example of the previous section:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~ 139. example using moveto() and stroke() command functions (196) ~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image139.webp"
  loading="lazy"
  title="Same drawing as in previous section. Example using moveto() and stroke() command functions"
  alt="Same drawing as in previous section. Example using moveto() and stroke() command functions."
  style="width:40%;" />

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;title&gt;Drawing disconnected lines&lt;/title&gt;
&lt;/head&gt;
&lt;canvas id=&quot;myCanvas&quot;&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  var canvas=document.getElementById(&#39;myCanvas&#39;);
  var ctx=canvas.getContext(&#39;2d&#39;);
  // first part of the path
  ctx.moveTo(20,20);
  ctx.lineTo(100, 100);
  ctx.lineTo(100,0);
  // second part of the path, moveTo(...) is used to &quot;jump&quot; to another place
  ctx.moveTo(120,20);
  ctx.lineTo(200, 100);
  ctx.lineTo(200,0);
  // indicate stroke color + draw the path
  ctx.strokeStyle = &quot;#0000FF&quot;;
  ctx.stroke();
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>Imagine that we would like to draw them with different styles and
colors: the shape on the left will stay as it is now (blue, wireframe),
while the shape on the right will be filled, colored in pink. Let’s look
at how we can do this…</p>
<h4>Drawing two paths with different styles: the WRONG and the right way!</h4>
<h4>First, the <em>wrong</em> way!</h4>
<p>In this example, we will draw the two parts of the path with
different styles: the first part in wireframe mode, and the second part
in filled mode.</p>
<p>What we will try first is to call stroke() after the first half of
the path, then call fill() after the second half of the path:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~ 140. the wrong way to draw two paths with different styles (197) ~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image140.webp"
  loading="lazy"
  title="THE WRONG WAY! Drawing two paths with different styles"
  alt="THE WRONG WAY! Drawing two paths with different styles."
  style="width:40%;" />

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;title&gt;Drawing two paths with different styles: the wrong way!&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;canvas id=&quot;myCanvas&quot;&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  var canvas=document.getElementById(&#39;myCanvas&#39;);
  var ctx=canvas.getContext(&#39;2d&#39;);
  // first part of the path
  ctx.moveTo(20,20);
  ctx.lineTo(100, 100);
  ctx.lineTo(100,0);
  // indicate stroke color + draw first part of the path
  ctx.strokeStyle = &quot;#0000FF&quot;;
  ctx.stroke();
  // second part of the path
  ctx.moveTo(120,20);
  ctx.lineTo(200, 100);
  ctx.lineTo(200,0);
  // indicate stroke color + draw the path
  ctx.fillStyle = &quot;pink&quot;;
  ctx.fill();
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<br/>

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>var canvas=document.getElementById(&#39;myCanvas&#39;);
var ctx=canvas.getContext(&#39;2d&#39;);
// first part of the path
ctx.moveTo(20,20);
ctx.lineTo(100, 100);
ctx.lineTo(100,0);
// indicate stroke color + draw first part of the path
ctx.strokeStyle = &quot;#0000FF&quot;;
ctx.stroke();
// second part of the path
ctx.moveTo(120,20);
ctx.lineTo(200, 100);
ctx.lineTo(200,0);
// indicate stroke color + draw the path
ctx.fillStyle = &quot;pink&quot;;
ctx.fill();</pre>

</details>

<p>Hey - it does not work! Weirdly, the two parts of the path are filled
in pink! But we called stroke() after the first half of the path was
drawn (<i>lines 5-8</i>). Then we called fill() only after the second
part of the path was specified (<i>lines 14-19</i>)… so, what
happened?</p>
<p>Remember that fill() or stroke() <i>draws the whole path</i>, even if
it is disconnected, and even if it has already been drawn!</p>
<p>What happened is:</p>

<ol type="1">
  <li>The call to stroke() has drawn the path corresponding to the <i>lines 5-7</i>. 
    Indeed, the first part of the path (on the left) has actually been drawn once in 
    wireframe mode, and in blue.</li>
  <li>Then, the call to fill() at <i>line 20</i> has drawn the whole path again, but 
    in pink and in filled mode. But this time the path corresponds to <i>lines 5-7</i> 
    plus <i>lines 14-16</i> that make up the second shape on the right. <i>So the path 
    that has been drawn this time is made of both of the triangles.</i></li>
</ol>

<p><b>Important</b>: If you do not want to draw parts of the same path
several times, you need to draw two different paths, using
the ctx.beginPath() method, as shown in the next example.</p>

<h4>Now, the <em>right</em> way!</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~ 141. the right way to draw two paths with different styles (198) ~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image141.webp"
  loading="lazy"
  title="Draw two paths with different styles the RIGHT way"
  alt="Draw two paths with different styles the RIGHT way."
  style="width:40%;" />

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;title&gt;Drawing two paths with different styles: the right way!&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;canvas id=&quot;myCanvas&quot;&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  var canvas=document.getElementById(&#39;myCanvas&#39;);
  var ctx=canvas.getContext(&#39;2d&#39;);
  // first part of the path
  ctx.moveTo(20,20);
  ctx.lineTo(100, 100);
  ctx.lineTo(100,0);
  // indicate stroke color + draw first part of the path
  ctx.strokeStyle = &quot;#0000FF&quot;;
  ctx.stroke();
  // start a new path, empty the current buffer
  ctx.beginPath();
  // second part of the path
  ctx.moveTo(120,20);
  ctx.lineTo(200, 100);
  ctx.lineTo(200,0);
  // indicate stroke color + draw the path
  ctx.fillStyle = &quot;pink&quot;;
  ctx.fill();
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<br/>

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>var canvas=document.getElementById(&#39;myCanvas&#39;);
var ctx=canvas.getContext(&#39;2d&#39;);
// first part of the path
ctx.moveTo(20,20);
ctx.lineTo(100, 100);
ctx.lineTo(100,0);
// indicate stroke color + draw first part of the path
ctx.strokeStyle = &quot;#0000FF&quot;;
ctx.stroke();
// start a new path, empty the current buffer
ctx.beginPath();
// second part of the path
ctx.moveTo(120,20);
ctx.lineTo(200, 100);
ctx.lineTo(200,0);
// indicate stroke color + draw the path
ctx.fillStyle = &quot;pink&quot;;
ctx.fill();</pre>

</details>

<p>This time, in order to draw the two shapes differently, we defined
two separate paths. The way to do this is just to
call ctx.beginPath() to start a new path. In this example, the first
path has been drawn in wireframe mode, then a new path has been started
that is drawn in filled mode.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-4-5">3.4.5 Drawing Lines in Immediate Mode</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Sometimes, it might be useful to draw just one line.</p>
<p>It’s interesting to see how we can write a single “draw line”
function that takes the start and end coordinates, the color, the line
width, etc., and give the impression of being done in “immediate”
mode.</p>

<h4>Here is the code for this “utility” function that you may find useful:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>function drawLine(x1, y1, x2, y2, color, width) {
  ctx.save();
  // set color and lineWidth, if these parameters
  // are not defined, do nothing (default values)
  if(color)
    ctx.strokeStyle = color;
  if(width)
    ctx.lineWidth = width;
  // start a new path
  ctx.beginPath();
  ctx.moveTo(x1, y1);
  ctx.lineTo(x2, y2);
  ctx.stroke();
  ctx.restore();
}</pre>

</details>

<p>Notice the save/restore of the context at the beginning/end of the
function. This is REALLY a best practice to avoid affecting other
functions’ context.</p>

<ul>
  <li><i>Line 13</i> starts a new path so that the function will only draw what it is meant to draw: a single line.</li>
  <li><i>Lines 15-17</i> move the “pen” at (x1, y1) then draw a line to (x2, y2), and the stroke at <i>line 17</i> makes it appear on the screen.</li>
</ul>

<h4>Here is an example:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 142. drawing lines in immediate mode (200) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image142.webp"
  loading="lazy"
  title="Drawing lines in immediate mode to avoid affecting other functions' context"
  alt="Drawing lines in immediate mode to avoid affecting other functions' context."
  style="width:40%;" />

<h4>HTML source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
  &lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;/&gt;
    &lt;title&gt;Drawing lines in immediate mode&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
  &lt;canvas id=&quot;myCanvas&quot;&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
  &lt;script type=&quot;text/javascript&quot;&gt;
  var canvas=document.getElementById(&#39;myCanvas&#39;);
  var ctx=canvas.getContext(&#39;2d&#39;);
  drawLine(0, 0, 100, 100);
  drawLine(0, 50, 150, 200, &#39;red&#39;);
  drawLine(10, 100, 100, 10, &#39;green&#39;, 10);
  function drawLine(x1, y1, x2, y2, color, width) {
    ctx.save();
    // set color and lineWidth, if these parameters
    // are not defined, do nothing (default values)
    if(color)
      ctx.strokeStyle = color;
    if(width)
      ctx.lineWidth = width;
    // start a new path
    ctx.beginPath();
    ctx.moveTo(x1, y1);
    ctx.lineTo(x2, y2);
    ctx.stroke();
    ctx.restore();
  }
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Source code extract:</h4>

<pre>drawLine(0, 0, 100, 100);
drawLine(0, 50, 150, 200, &#39;red&#39;);
drawLine(10, 100, 100, 10, &#39;green&#39;, 10);</pre>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-4-6">3.4.6 Drawing Arrows</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>In this section, we present a function that draws arrows in a
canvas.</p>

<p>You may find multiple implementations on the Web for drawing arrows
in a canvas, but the one we are presenting has the advantage of being
rather simple and enables you to set the color and line width of the
arrows.</p>

<h3>Examples</h3>

<h4>Example #1:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>// Adapted from : https://stackoverflow.com/questions/808826/draw-arrow-on-canvas-tag
function drawArrow(ctx, fromx, fromy, tox, toy, arrowWidth, color){
  //variables to be used when creating the arrow
  var headlen = 10;
  var angle = Math.atan2(toy-fromy,tox-fromx);
  ctx.save();
  ctx.strokeStyle = color;
  //starting path of the arrow from the start square to the end square
  //and drawing the stroke
  ctx.beginPath();
  ctx.moveTo(fromx, fromy);
  ctx.lineTo(tox, toy);
  ctx.lineWidth = arrowWidth;
  ctx.stroke();
  //starting a new path from the head of the arrow to one of the sides of
  //the point
  ctx.beginPath();
  ctx.moveTo(tox, toy);
  ctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/7),
    toy-headlen*Math.sin(angle-Math.PI/7));
  //path from the side point of the arrow, to the other side point
  ctx.lineTo(tox-headlen*Math.cos(angle+Math.PI/7),
    toy-headlen*Math.sin(angle+Math.PI/7));
  //path from the side point back to the tip of the arrow, and then
  //again to the opposite side point
  ctx.lineTo(tox, toy);
  ctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/7),
    toy-headlen*Math.sin(angle-Math.PI/7));
  //draws the paths created above
  ctx.stroke();
  ctx.restore();
}</pre>

</details>

<h4>Explanations:</h4>

<ul>
  <li>An arrow is made of one line (the arrow body) and three connected lines (the arrow head).</li>
  <li>As we modify some context properties in this function, we call save() and restore() at the beginning and at the end of the function.</li>
  <li>This function can be improved in many ways: adding shadows, using fill() instead of stroke(), which gives strange results when the width is too big, etc.</li>
</ul>

<h4>Example #2</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 143. draw arrows (202) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image143.webp"
  loading="lazy"
  title="Function to draw arrows"
  alt="Function to draw arrows."
  style="width:40%;" />

<h4>HTML source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;title&gt;Drawing arrows&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;canvas id=&quot;myCanvas&quot;&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
  &lt;script type=&quot;text/javascript&quot;&gt;
    var canvas=document.getElementById(&#39;myCanvas&#39;);
    var ctx=canvas.getContext(&#39;2d&#39;);
    // Adapted from : http://stackoverflow.com/questions/808826/draw-arrow-on-canvas-tag
    function drawArrow(ctx, fromx, fromy, tox, toy, arrowWidth, color){
      //variables to be used when creating the arrow
      var headlen = 10;
      var angle = Math.atan2(toy-fromy,tox-fromx);
      ctx.save();
      ctx.strokeStyle = color;
      //starting path of the arrow from the start square to the end square
      //and drawing the stroke
      ctx.beginPath();
      ctx.moveTo(fromx, fromy);
      ctx.lineTo(tox, toy);
      ctx.lineWidth = arrowWidth;
      ctx.stroke();
      //starting a new path from the head of the arrow to one of the sides of
      //the point
      ctx.beginPath();
      ctx.moveTo(tox, toy);
      ctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/7),
      toy-headlen*Math.sin(angle-Math.PI/7));
      //path from the side point of the arrow, to the other side point
      ctx.lineTo(tox-headlen*Math.cos(angle+Math.PI/7),
      toy-headlen*Math.sin(angle+Math.PI/7));
      //path from the side point back to the tip of the arrow, and then
      //again to the opposite side point
      ctx.lineTo(tox, toy);
      ctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/7),
      toy-headlen*Math.sin(angle-Math.PI/7));
      //draws the paths created above
      ctx.stroke();
      ctx.restore();
    }
    drawArrow(ctx, 10, 10, 100, 100, 10, &#39;red&#39;);
    drawArrow(ctx, 100, 10, 140, 140, 3, &#39;black&#39;);
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Source code extract:</h4>

<pre>drawArrow(ctx, 10, 10, 100, 100, 10, &#39;red&#39;);
drawArrow(ctx, 100, 10, 140, 140, 3, &#39;black&#39;);</pre>

<h4>How to draw nicer arrows?</h4>

<p>On the Web, you will find many different ways to draw arrows.</p>

<p>This <a href="http://www.dbp-consulting.com/tutorials/canvas/CanvasArrow.html" 
target="_blank" rel="noopener noreferrer">article on drawing lines and arcs with 
arrow heads</a> is worth reading. It details how to draw arrows with curved heads 
and different styles for the head. Note, however, that you will need to modify 
some parts if you want it to support different line widths, etc.</p>

<p>Screenshot from a demo available on the above Web site:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~ 144. clock with nicer arrows (204) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image144.webp"
  loading="lazy"
  title="Round clock with nice arrows"
  alt="Round clock with nice arrows."
  style="width:20%;" />

<p>In a later part of the course dedicated to curve drawing in a canvas,
we will also show how to draw curved arrows, with very simple code (much
simpler than the one used for drawing the clock’s hands above).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-4-7">3.4.7 Closing a Path</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The ctx.closePath() method indicates that we would like a closed
path: draw from the last point to the first.</p>

<h4>Try this:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 145. example closing a path (204) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image145.webp"
  loading="lazy"
  title="Example on closing a path in a drawing"
  alt="Example on closing a path in a drawing."
  style="width:40%;" />

<h4>HTML source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;title&gt;Closing a path&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;canvas id=&quot;myCanvas&quot;&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
  &lt;script type=&quot;text/javascript&quot;&gt;
    var canvas=document.getElementById(&#39;myCanvas&#39;);
    var ctx=canvas.getContext(&#39;2d&#39;);
    // Path made of three points (defines two lines)
    ctx.moveTo(20,20);
    ctx.lineTo(100, 100);
    ctx.lineTo(100,0);
    // Close the path, try commenting this line
    ctx.closePath();
    // indicate stroke color + draw first part of the path
    ctx.strokeStyle = &quot;blue&quot;;
    ctx.stroke();
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>JavaScript source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas=document.getElementById(&#39;myCanvas&#39;);
var ctx=canvas.getContext(&#39;2d&#39;);
// Path made of three points (defines two lines)
ctx.moveTo(20,20);
ctx.lineTo(100, 100);
ctx.lineTo(100,0);
// Close the path, try commenting this line
ctx.closePath();
// indicate stroke color + draw first part of the path
ctx.strokeStyle = &quot;blue&quot;;
ctx.stroke();</pre>

</details>

<h4>Explanations:</h4>

<ul>
  <li><i>Lines 5-7</i> corresponds to a path made of two consecutive lines. If we 
    just call stroke() after that, two lines will be drawn on the canvas.</li>
  <li><i>Line 10</i> indicates that we would like <i>a closed path</i>.  In this 
    case, the call to stroke() at <i>line 14</i> will draw the two lines plus an 
    extra line that connects the last point of the path to the first one. It will 
    draw a closed triangle!</li>
</ul>

<p>Try commenting the <i>line 10</i> in the online example and see the results!</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-4-8">3.4.8 Drawing Circles and Arcs</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The ctx.arc(cx, cy, radius, startAngle, endAngle, drawInverse) method is useful 
for drawing arcs of circles. It takes the center of the circle/arc, its radius, the 
starting angle of the arc (turning clockwise), the ending angle of the arc, and an 
optional parameter we will talk about later.</p>

<p><i>Note</i>: the figures in this page have been borrowed from the 
<a href="https://www.html5canvastutorials.com/tutorials/html5-canvas-arcs/" 
target="_blank" rel="noopener noreferrer">HTML5 Canvas Tutorials</a> Web site.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~ 146. html5 canvas arc diagram: drawing circle coordinate system (205) ~~~~~~~~~~-->
<img class="displayed"
  src="./images/image146.webp"
  loading="lazy"
  title="HTML5 canvas arc diagram: drawing circle, coordinate system"
  alt="HTML5 canvas arc diagram: drawing circle, coordinate system."
  style="width:40%;" />

<h4>Typical usage</h4>

<h4>Typical usage for drawing an arc/circle/ellipse is:</h4>

<pre>ctx.arc(centerX, centerY, radius, startAngle, endAngle); // clockwise drawing
ctx.arc(centerX, centerY, radius, startAngle, endAngle, false);</pre>

<p>The angles are in radians (between 0 and 2*Math.PI). The arc is drawn
clockwise. Beware that this may not seem natural if you’re used to the
trigonometric order.</p>
<p>The last parameter is optional and has a value of false by default.
If true, instead of drawing an arc of circle that corresponds to the
parameters, <i>it will draw its complementary</i>. See the examples
below to see the difference.</p>

<h3>Examples</h3>

<h4>Example #1: drawing an arc with radius = 50, starting angle = 0, end angle = PI/2</h4>

<h4>Try this example:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~ 147. example drawing an arc with radius = 50 (206) ~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image147.webp"
  loading="lazy"
  title="Example on drawing an arc with radius = 50, start angle = 0, end angle = pi/2"
  alt="Example on drawing an arc with radius = 50, start angle = 0, end angle = pi/2."
  style="width:40%;" />

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;/&gt;
  &lt;title&gt;Drawing an arc&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;500&quot;&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
  &lt;script type=&quot;text/javascript&quot;&gt;
    var canvas=document.getElementById(&#39;myCanvas&#39;);
    var ctx=canvas.getContext(&#39;2d&#39;);
    ctx.beginPath();
    // try to set the last parameter to true or remove it
    ctx.arc(100,75,50,0,Math.PI/2);
    ctx.lineWidth=10;
    ctx.stroke();
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>JavaScript source code extract:</h4>

<pre>ctx.beginPath();
// we ommited the last parameter
ctx.arc(100, 75, 50, 0, Math.PI/2);
ctx.lineWidth = 10;
ctx.stroke();</pre>

<p>And if we change the last parameter of the arc function call (<i>line
3</i>) to true (we omitted it, so it took a value of false by default)
:</p>

<pre>ctx.beginPath();
// we omitted the last parameter
ctx.arc(100, 75, 50, 0, Math.PI/2, true);
ctx.lineWidth = 10;
ctx.stroke();</pre>

<p>Then, the result is the “complementary” of the previous arc:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~ 148. example arc complementary of the previous arc (207) ~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image148.webp"
  loading="lazy"
  title="Example complementary of the previous arc"
  alt="Example complementary of the previous arc."
  style="width:40%;" />
   
<h4>Example #2: drawing a Full circle (filled + outlined)</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 149. example draw a full circle (207) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image149.webp"
  loading="lazy"
  title="Example draw a full circle"
  alt="Example draw a full circle."
  style="width:40%;" />

<h4>JavaScript source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas = document.getElementById(&quot;myCanvas&quot;);
var ctx = canvas.getContext(&quot;2d&quot;);
var centerX = canvas.width / 2;
var centerY = canvas.height / 2;
var radius = 70;
ctx.beginPath();
// Add to the path a full circle (from 0 to 2PI)
ctx.arc(centerX, centerY, radius, 0, 2*Math.PI, false);
// With path drawing you can change the context
// properties until a call to stroke() or fill() is performed
ctx.fillStyle = &quot;lightBlue&quot;;
// Draws the filled circle in light blue
ctx.fill();
// Prepare for the outline
ctx.lineWidth = 5;
ctx.strokeStyle = &quot;black&quot;;
// draws the path (the circle) AGAIN, this
// time in wireframe
ctx.stroke();
// Notice we called ctx.arc() only once ! And drew it twice
// with different styles</pre>

</details>

<p>Notice that we called ctx.arc() only once! And drew it twice, with
different styles, with calls to ctx.stroke() and ctx.fill(). Each call
drew the defined path in wireframe and in filled mode!</p>

<h4>Proposed projects</h4>

<h4>Project #1: modify the <a href="https://codepen.io/w3devcampus/pen/YzZBxmO" 
target="_blank" rel="noopener noreferrer">previous example</a> in order to get:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 150. half circle (208) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image150.webp"
  loading="lazy"
  title="Example of half circle"
  alt="Example of half circle."
  style="width:25%;" />

<h4>Project #2: make a small program that draws a smiling head like this (or make something better!)</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 151. smiley face (208) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image151.webp"
  loading="lazy"
  title="Example of smiling head"
  alt="Example of smiling head."
  style="width:30%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-4-9">3.4.9 Drawing Rounded Rectangles</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>There is another method called ctx.arcTo(x1, y1, x2, y2,
radius), which is a bit complex to use, but very practical for drawing
rounded rectangles.</p>
<p>In fact, the arcTo(…) method draws an arc of a circle depending on
some tangents. Let’s look at these pictures for a better
understanding:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 152. three diagrams to explain arcto method (209) ~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image152.webp"
  loading="lazy"
  title="There are three (3) diagrams, all drawn on canvas dynamically. The arcTo really uses carTo() with reduced alpha, and the rest of the diagram is calculated in JavaScript and drawn with lineTo and arc"
  alt="There are three (3) diagrams, all drawn on canvas dynamically. The arcTo really uses carTo() with reduced alpha, and the rest of the diagram is calculated in JavaScript and drawn with lineTo and arc."
  style="width:40%;" />
  
<h4>Typical use:</h4>

<pre>ctx.moveTo(x0, y0);
ctx.arcTo(x1, y1, x2, y2, radius);</pre>

<p>This method can be confusing. It was defined mainly for drawing
rounded shapes like rounded rectangles. We used an excerpt here from the
excellent <a
href="http://www.dbp-consulting.com/tutorials/canvas/CanvasArcTo.html" target="_blank" rel="noopener noreferrer">tutorial on the arcTo(…) method</a>.</p>

<h4>It works like this:</h4>

<pre>Draw an imaginary line through (x0,y0) and (x1,y1), draw another imaginary line through (x1,y1) and (x2,y2),
Take an imaginary circle of radius r, and slide it up between the two lines until it just touches both lines. The two points at which the circle touches the lines are called the tangent points.
arcTo(x1, y1, x2, y2, r) will draw a line from the current point (x0,y0) to the first tangent point on the line from (x0,y0) to (x1,y1),
It will also draw an arc from that tangent point to the other tangent point on the line from (x1,y1) to (x2,y2) along the circumference of the circle.
Finally, it adds the tangent point where the arc ends up, on the line from (x1,y1) to (x2,y2) to the path as the new current point on the path.</pre>

<h4>Examples</h4>

<h4>Example #1: simple use</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 153. simple use arcto example 1 (209) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image153.webp"
  loading="lazy"
  title="Simple use arcTo example #1"
  alt="Simple use arcTo example #1."
  style="width:40%;" />

<h4>HTML source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;/&gt;
    &lt;title&gt;Simple use - arcTo - Example #1&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;canvas id=&quot;myCanvas&quot; height = 400 width=&quot;800&quot;&gt;Your browser does not 
      support the canvas tag.&lt;/canvas&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
      var canvas=document.getElementById(&#39;myCanvas&#39;);
      var context=canvas.getContext(&#39;2d&#39;);
      context.beginPath();
      context.moveTo(0, 20);
      context.arcTo(100, 100, 200, 20, 50);
      context.lineWidth = 5;
      context.strokeStyle = &quot;#0000ff&quot;;
      context.stroke();
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>JavaScript source code extract:</h4>

<pre>context.beginPath();
context.moveTo(0, 20);
context.arcTo(100, 100, 200, 20, 50);
context.lineWidth = 5;
context.strokeStyle = &quot;#0000ff&quot;;
context.stroke();</pre>

<h4>Example #2: draw A rounded rectangle</h4>

<h4>Try this:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 154. rounded rectange example 2 (210) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image154.webp"
  loading="lazy"
  title="Draw a rounded rectange, example #2"
  alt="Draw a rounded rectange, example #2."
  style="width:40%;" />

<h4>HTML source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;/&gt;
    &lt;title&gt;Canvas&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;canvas id=&quot;myCanvas&quot;&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
  &lt;script type=&quot;text/javascript&quot;&gt;
    var roundedRect=function(ctx,x,y,width,height,radius,fill,stroke)
    {
      ctx.beginPath();
      // draw top and top right corner
      ctx.moveTo(x+radius,y);
      ctx.arcTo(x+width,y,x+width,y+radius,radius);
      // draw right side and bottom right corner
      ctx.arcTo(x+width,y+height,x+width-radius,y+height,radius);
      // draw bottom and bottom left corner
      ctx.arcTo(x,y+height,x,y+height-radius,radius);
      // draw left and top left corner
      ctx.arcTo(x,y,x+radius,y,radius);
      if(fill){
        ctx.fill();
      }
      if(stroke){
        ctx.stroke();
        }
    }
    var canvas=document.getElementById(&#39;myCanvas&#39;);
    var ctx=canvas.getContext(&#39;2d&#39;);
    ctx.strokeStyle=&#39;rgb(150,0,0)&#39;;
    ctx.fillStyle=&#39;rgb(0,150,0)&#39;;
    ctx.lineWidth=7;
    roundedRect(ctx,15,15,160,120,20,true,true);
  &lt;/script&gt;
&lt;/body&gt;</pre>

</details>

<h4>JavaScript source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre> var roundedRect=function(ctx,x,y,width,height,radius,fill,stroke) {
  ctx.beginPath();
  // draw top and top right corner
  ctx.moveTo(x+radius,y);
  ctx.arcTo(x+width,y,x+width,y+radius,radius);
  // draw right side and bottom right corner
  ctx.arcTo(x+width,y+height,x+width-radius,y+height,radius);
  // draw bottom and bottom left corner
  ctx.arcTo(x,y+height,x,y+height-radius,radius);
  // draw left and top left corner
  ctx.arcTo(x,y,x+radius,y,radius);
  if(fill) {
    ctx.fill();
  }
  if(stroke){
    ctx.stroke();
  }
}
var canvas = document.getElementById(&#39;myCanvas&#39;);
var ctx    = canvas.getContext(&#39;2d&#39;);
ctx.strokeStyle = &#39;rgb(150,0,0)&#39;;
ctx.fillStyle   = &#39;rgb(0,150,0)&#39;;
ctx.lineWidth   = 7;
roundedRect(ctx, 15, 15, 160, 120, 20, true, true);</pre>

</details>

<p>In this example, each call to ctx.arcTo(…) draws a side plus a
corner. This makes us suspect that the arcTo() method has been designed
primarily for drawing rounded rectangles…</p>

<h4>Example #3: comparison between lineTo and arcTo</h4>
<p>This example at JS Bin is the same as the previous one, except that we
added at the end of the roundedRect function the same lines of code that
draw the rounded rectangle, but using lineTo instead of arcTo. Just take
a look!</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~ 155. comparison between arcto and lineto (212) ~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image155.webp"
  loading="lazy"
  title="Comparison between lineTo and arcTo"
  alt="Comparison between lineTo and arcTo."
  style="width:40%;" />

<h4>HTML source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;/&gt;
    &lt;title&gt;Comparison between lineTo and arcTo - Example #3&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;canvas id=&quot;myCanvas&quot;&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
      var roundedRect=function(ctx,x,y,width,height,radius,fill,stroke)
      {
      ctx.beginPath();
      // draw top and top right corner
      ctx.moveTo(x+radius,y);
      ctx.arcTo(x+width,y,x+width,y+radius,radius);
      // draw right side and bottom right corner
      ctx.arcTo(x+width,y+height,x+width-radius,y+height,radius);
      // draw bottom and bottom left corner
      ctx.arcTo(x,y+height,x,y+height-radius,radius);
      // draw left and top left corner
      ctx.arcTo(x,y,x+radius,y,radius);
      if(fill){
        ctx.fill();
      }
      if(stroke){
        ctx.stroke();
      }
      // Draws the square using lineTo instead of arcTo,
      // just to compare both methods
      ctx.save();
      ctx.strokeStyle=&quot;pink&quot;;
      ctx.lineWidth=3; // ou ce que tu veux
      ctx.beginPath();
      ctx.moveTo(x,y);
      ctx.lineTo(x+width, y);
      ctx.lineTo(x+width, y+height);
      ctx.lineTo(x, y+height);
      ctx.closePath();
      ctx.stroke();
      ctx.restore();
      }
      var canvas=document.getElementById(&#39;myCanvas&#39;);
      var ctx=canvas.getContext(&#39;2d&#39;);
      ctx.strokeStyle=&#39;rgb(150,0,0)&#39;;
      ctx.fillStyle=&#39;rgb(0,150,0)&#39;;
      ctx.lineWidth=7;
      roundedRect(ctx,15,15,160,120,20,true,true);
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<p>Red = arcTo and Pink = lineTo</p>

<h4>Example #4: use the unrounded vertices in arcTo</h4>
<p>For drawing a rounded square, this code also works:</p>

<pre>ctx.moveTo(x+radius, y);
ctx.arcTo(x+width, y,x+width, y+height, radius);
ctx.arcTo(x+width, y+height, x, y+height, radius); 
ctx.arcTo(x, y+height, x, y,radius);
ctx.arcTo(x, y, x+width, y,radius);</pre>

<p>Which might be easier than trying to figure out where the arc will end like this:</p>

<pre>ctx.moveTo(x+radius, y);
ctx.arcTo(x+width, y, x+width, y+radius, radius);
ctx.arcTo(x+width, y+height, x+width-radius, y+height,radius); 
ctx.arcTo(x, y+height, x, y+height-radius, radius);
ctx.arcTo(x, y, x+radius, y,radius);</pre>

<p>This could be particularly helpful if you are dealing with something other than a rectangle, like this rounded triangle:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 156. rounded triangle example (213) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image156.webp"
  loading="lazy"
  title="Example: rounded triangle"
  alt="Example: rounded triangle."
  style="width:40%;" />

<h4>HTML source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;/&gt;
    &lt;title&gt;Use the unrounded vertices in arcTo - Example #4&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;canvas id=&quot;myCanvas&quot;&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
      var roundedTriangle=function(ctx,x1,y1,x2,y2,x3,y3,radius,fill,stroke)
      {
        ctx.beginPath();
        // start at the middle of the side between x1,y1 and x2,y2
        ctx.moveTo((x1+x2)/2,(y1+y2)/2);
        // go around the x2,y2 vertex
        ctx.arcTo(x2,y2,x3,y3,radius);
        // go around the x3,y3 vertex
        ctx.arcTo(x3,y3,x1,y1,radius);
        // go around the x1,y1 vertex
        ctx.arcTo(x1,y1,x2,y2,radius);
        // and close the triangle with a line to the starting point
        ctx.lineTo((x1+x2)/2,(y1+y2)/2);
        if(fill){
          ctx.fill();
        }
        if(stroke){
          ctx.stroke();
        }
      }
      var canvas=document.getElementById(&#39;myCanvas&#39;);
      var ctx=canvas.getContext(&#39;2d&#39;);
      ctx.strokeStyle=&#39;rgb(150,0,0)&#39;;
      ctx.fillStyle=&#39;rgb(0,150,0)&#39;;
      ctx.lineWidth=7;
      roundedTriangle(ctx,200,15,300,150,15,100,20,true,true);
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-4-10">3.4.10 Quadratic Curves</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Introduction</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 157. html5 canvas quadratic curve diagram (214) ~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image157.webp"
  loading="lazy"
  style="width:40%;"
  title="HTML5 Canvas Quadratic Curve Diagram. Control, context & ending points"
  alt="HTML5 Canvas Quadratic Curve Diagram. Control, context & ending points." />

<p>(Picture taken from the <a
href="https://www.html5canvastutorials.com/tutorials/html5-canvas-quadratic-curves/" target="_blank" rel="noopener noreferrer">HTML5
Canvas Tutorials</a> Web site)</p>
<p>Quadratic curves are defined by a starting point (called a “context
point”), a control point, and an ending point. The curve fits the
tangents between the context and control points and between the control
and ending points.</p>
<p>The context point may be defined by a call to the moveTo(x, y) method
of the context, or it may be the ending point of a previous path, if
we’re drawing a path made of several shapes. For example, drawing a line
and a quadratic curve will make the endpoint of the line the context
point for the quadratic curve.</p>
<p>The control point controls the curvature - if we move the control
point farther we get a sharper curve.</p>

<h4>Typical use:</h4>

<pre>context.moveTo(contextX, contextY);
context.quadraticCurveTo(controlX, controlY, endX, endY);
// Optional : set lineWidth and stroke color
context.lineWidth = 5;
context.strokeStyle = &quot;#0000ff&quot;;
// Draw!
context.stroke();</pre>

<h4>Examples</h4>

<h4>Example #1: quadratic curve</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 158. quadratic curve (215) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image158.webp"
  loading="lazy"
  style="width:40%;"
  title="Quadratic curve example"
  alt="Quadratic curve example." />

<h4>JavaScript source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas=document.querySelector(&#39;#myCanvas1&#39;);
var context=canvas.getContext(&#39;2d&#39;);
context.beginPath();
context.moveTo(100, 20);
context.quadraticCurveTo(230, 200, 250, 20);
context.lineWidth = 5;
context.strokeStyle = &quot;#0000ff&quot;;
context.stroke();</pre>

</details>

<p>We set a starting point in <i>line 6</i>: moveTo(…), then set the
control and ending points with a call to quadraticCurve(…), at <i>line
7</i>, then set some properties for color, thickness, and finally we
call the stroke() method for drawing the curve.</p>

<h4>Example #2: lines connected with a quadratic curve</h4>

<p>Try this:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~ 159. example: lines connected with quadratic curve (216) ~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image159.webp"
  loading="lazy"
  style="width:40%;"
  title="Example: Lines connected with a quadratic curve"
  alt="Example: Lines connected with a quadratic curve." />

<h4>HTML source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;/&gt;
    &lt;title&gt;Lines connected with a quadratic curve - Example #2&lt;/title&gt;
   &lt;/head&gt;
 &lt;body&gt;
   &lt;canvas id=&quot;myCanvas1&quot; height = 400 width=&quot;800&quot;&gt;Your browser does not support the 
   canvas tag.&lt;/canvas&gt;
  &lt;script type=&quot;text/javascript&quot;&gt;
      var canvas=document.querySelector(&#39;#myCanvas1&#39;);
      var context=canvas.getContext(&#39;2d&#39;);
      context.beginPath();
      context.moveTo(100, 20);
      context.lineTo(200, 80);
      context.quadraticCurveTo(230, 200, 250, 20);
      context.lineTo(500, 90);
      context.lineWidth = 5;
      context.strokeStyle = &quot;#0000ff&quot;;
      context.stroke();
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>JavaScript source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>context.beginPath();
context.moveTo(100, 20);
context.lineTo(200, 80);
context.quadraticCurveTo(230, 200, 250, 20);
context.lineTo(500, 90);
context.lineWidth = 5;
context.strokeStyle = &quot;#0000ff&quot;;
context.stroke();</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-4-11">3.4.11 Curved Arrows</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>We propose a useful function for drawing curved arrows. See this example:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~ 160. example: useful function for drawing curved arrows (217) ~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image160.webp"
  loading="lazy"
  style="width:40%;"
  title="Example: useful function for drawing curved arrows"
  alt="Example: useful function for drawing curved arrows." />

<h4>JavaSscript source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas = document.querySelector(&#39;#myCanvas&#39;);
var ctx = canvas.getContext(&#39;2d&#39;);
var contextX = 100;
var contextY = 10;
var endPointX = 200;
var endPointY = 120;
var controlPointX = 35;
var controlPointY = 70;
drawCurvedArrow(contextX, contextY,
endPointX, endPointY,
controlPointX, controlPointY,
3, // arrowWidth, try 30 for example !
20, // width of the arrow head, try smaller values, 10...
&#39;blue&#39;);
function drawCurvedArrow(startPointX, startPointY,
endPointX, endPointY,
quadPointX, quadPointY,
lineWidth,
arrowWidth,
color) {
  // GOOD PRACTICE: the function changes color and lineWidth -&gt; save context!
  ctx.save();
  ctx.strokeStyle = color;
  ctx.lineWidth = lineWidth;
  // angle of the end tangeant, useful for drawing the arrow head
  var arrowAngle = Math.atan2(quadPointX - endPointX, quadPointY - endPointY) + Math.PI;
  // start a new path
  ctx.beginPath();
  ctx.moveTo(startPointX, startPointY);
  ctx.quadraticCurveTo(quadPointX, quadPointY, endPointX, endPointY);
  ctx.moveTo(endPointX - (arrowWidth * Math.sin(arrowAngle - Math.PI / 6)),
  endPointY - (arrowWidth * Math.cos(arrowAngle - Math.PI / 6)));
  ctx.lineTo(endPointX, endPointY);
  ctx.lineTo(endPointX - (arrowWidth * Math.sin(arrowAngle + Math.PI / 6)),
  endPointY - (arrowWidth * Math.cos(arrowAngle + Math.PI / 6)));
  ctx.stroke();
  ctx.closePath();
  // GOOD PRACTICE -&gt; restore the context as we saved it at the beginning
  // of the function
  ctx.restore();
}</pre>

</details>

<h4>CSS source code:</h4>

<pre>#myCanvas {
  border: 1px solid black;
}</pre>

<h4>HTML source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Curved arrows&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;250&quot; height=&quot;150&quot;&gt;&lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Source code of the function that draws a curved arrow:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>function drawCurvedArrow(startPointX, startPointY,
                         endPointX, endPointY,
                         quadPointX, quadPointY,
                         lineWidth,
                         arrowWidth,
                         color) {
    // BEST PRACTICE: the function changes color and lineWidth -&gt; save context!
    ctx.save();
    ctx.strokeStyle = color;
    ctx.lineWidth = lineWidth;
    // angle of the end tangeant, useful for drawing the arrow head
    var arrowAngle = Math.atan2(quadPointX - endPointX, quadPointY - endPointY) + Math.PI;
    // start a new path
    ctx.beginPath();
    // Body of the arrow
    ctx.moveTo(startPointX, startPointY);
    ctx.quadraticCurveTo(quadPointX, quadPointY, endPointX, endPointY);
    // Head of the arrow
    ctx.moveTo(endPointX - (arrowWidth * Math.sin(arrowAngle - Math.PI / 6)),
               endPointY - (arrowWidth * Math.cos(arrowAngle - Math.PI / 6)));
    ctx.lineTo(endPointX, endPointY);
    ctx.lineTo(endPointX - (arrowWidth * Math.sin(arrowAngle + Math.PI / 6)),
               endPointY - (arrowWidth * Math.cos(arrowAngle + Math.PI / 6)));
   ctx.stroke();
   ctx.closePath();
   // BEST PRACTICE -&gt; restore the context as we saved it at the beginning
   // of the function
   ctx.restore();
}</pre>

</details>

<p>This function takes as parameters the start and end points, the
control point of the curve, the arrow width, the width of the arrow
head.</p>
<p>It computes the angle of the arrow at its endpoint (<i>line 14</i>)
in order to compute the rotated endpoints of the two lines of the arrow
head (<i>lines 24</i> and <i>29</i>).</p>
<p>Notice that once again, as we modify the context properties (color,
lineWidth) in the body of the function, we save and restore the context
at the beginning / end of the function.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-4-12">3.4.12 Bézier curves</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Introduction</h4>

<p>Bézier curves are interesting. They are mostly used for drawing “S” shapes or asymmetric curves.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 161. bezier curve in 's' (219) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image161.webp"
  loading="lazy"
  style="width:35%;"
  title="Bezier curve in S"
  alt="Bezier curve in S." />

<p>(image taken from <a
href="https://blogs.sitepointstatic.com/examples/tech/canvas-curves/bezier-curve.html" target="_blank" rel="noopener noreferrer">SitePoint</a>)</p>
<p>Bézier curves are defined by a context point, like quadratic curves,
two control points that define two tangents, and an ending point.</p>
<p>The first part of the curve is tangential to the imaginary line
defined by the context point and the first control point. The second
part of the curve is tangential to the imaginary line defined by the
second control point and the ending point.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 162. bezier curve control points (219) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image162.webp"
  loading="lazy"
  style="width:40%;"
  title="Bezier curve control points"
  alt="Bezier curve control points." />

<p>(Picture taken from the <a
href="https://www.html5canvastutorials.com/tutorials/html5-canvas-bezier-curves/" 
target="_blank" rel="noopener noreferrer">HTML5 Canvas Tutorials</a> Web site)</p>

<p>The best way to understand how they work is to check out one of these
interactive applications:</p>

<ul>
  <li><a href="https://blogs.sitepointstatic.com/examples/tech/canvas-curves/bezier-curve.html" 
    target="_blank" rel="noopener noreferrer">Canvas Bézier Curve Example</a></li>
  <li><a href="http://lib.ivank.net/?p=demos&amp;d=bezier" target="_blank" rel="noopener noreferrer">
    IvanK Lib graphics demos</a></li>
  <li>Nice video tutorial: <a href="https://vimeo.com/106757336" target="_blank" rel="noopener noreferrer">
    Bézier curves under the hood</a></li>
</ul>

<h4>Typical usage of Bézier curves</h4>

<h4>JavaScript source code:</h4>

<pre>ctx.moveTo(contextX, contextY);
context.bezierCurveTo(controlX1, controlY1, controlX2, controlY2, endX, endY);
// Optional : set lineWidth and stroke color
context.lineWidth = 5;
context.strokeStyle = &quot;#0000ff&quot;;
// Draw!
ctx.stroke();</pre>

<h4>Examples</h4>

<h4>Example #1</h4>

<p>Try this:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 163. bezier curve: example 1 (220) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image163.webp"
  loading="lazy"
  style="width:40%;"
  title="Bezier curve: Example 1"
  alt="Bezier curve: Example 1." />

<h4>HTML source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;Bézier curve - Example #1&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;canvas id=&quot;myCanvas1&quot; height = 400 width=&quot;800&quot;&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
      var canvas=document.querySelector(&#39;#myCanvas1&#39;);
      var context=canvas.getContext(&#39;2d&#39;);
      context.beginPath();
      context.moveTo(100, 20);
      // TRY uncommenting these lines !
      //context.lineTo(200, 80);
      //context.quadraticCurveTo(230, 200, 250, 20);
      context.bezierCurveTo(290, -40, 200, 200, 400, 100);
      //context.lineTo(500, 90);
      // TRY TO UNCOMMENT THIS LINE
      //context.closePath();
      context.lineWidth = 5;
      context.strokeStyle = &quot;#0000ff&quot;;
      context.stroke();
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Code source:</h4>

<pre>context.beginPath();
context.moveTo(100, 20);
context.bezierCurveTo(290, -40, 200, 200, 400, 100);
context.lineWidth = 5;
context.strokeStyle = &quot;#0000ff&quot;;
context.stroke();</pre>

<h4>Example #2: path with bezier curve, quadratic curve and line in the same, closed path</h4>

<h4>Try this:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~ 164. path with bezier curve, quadratic curve & line in same, closed path  (221) ~~~~~-->
<img class="displayed"
  src="./images/image164.webp"
  loading="lazy"
  style="width:40%;"
  title="Path with Bezier and Quadratic curve and line in same, closed path"
  alt="Path with Bezier and Quadratic curve and line in same, closed path." />

<h4>HTML source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Path with Bézier curve, quadratic curve and line in the same, closed path - Example #2&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
 &lt;canvas id=&quot;myCanvas1 height = 400 width=&quot;800&quot;&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
 &lt;script type=&quot;text/javascript&quot;&gt;
    var canvas=document.querySelector(&#39;#myCanvas1&#39;);
    var context=canvas.getContext(&#39;2d&#39;);
    context.beginPath();
    context.moveTo(100, 20);
    context.lineTo(200, 160);
    context.quadraticCurveTo(230, 200, 250, 120);
    context.bezierCurveTo(290, -40, 300, 200, 400, 150);
    context.lineTo(500, 90);
    // TRY TO COMMENT THIS LINE
    context.closePath();
    context.lineWidth = 5;
    context.strokeStyle = &quot;#0000ff&quot;;
    context.stroke();
  &lt;/script&gt;
&lt;/body&gt;</pre>

</details>

<h4>Extract from JavaScript source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>context.beginPath();
context.moveTo(100, 20);
context.lineTo(200, 160);
context.quadraticCurveTo(230, 200, 250, 120);
context.bezierCurveTo(290, -40, 300, 200, 400, 150);
context.lineTo(500, 90);
// TRY COMMENTING THIS LINE OUT
context.closePath();
context.lineWidth = 5;
context.strokeStyle = &quot;#0000ff&quot;;
context.stroke();</pre>

</details>

<p>In this example we use the closePath() method to draw a line between
the last path point and the first path point (<i>line 11</i>), so that
the drawing looks like a pair of goggles.</p>
<p>Note how the different parts are linked together and make a “path”:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 165. bezier curve maker tool (222) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image165.webp"
  loading="lazy"
  title="Interactive code that draws Bezier curves"
  alt="Interactive code that draws Bezier curves."
  style="width:40%;" />

<h4>Interesting, interactive tool for generating code that draws Bézier curves</h4>

<p>This Bézier tool (“HTML5 &lt;canvas&gt; bezierCurveTo command generator”) is
available <a href="https://www.victoriakirst.com/beziertool/" target="_blank" rel="noopener noreferrer">online</a>: try it!</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-5-1">3.5.1 Canvas Context: Colors</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>In previous examples, we saw how to set the current color using
the strokeStyle and fillStyle properties of the canvas context
object.</p>
<p>Let’s look at color in a little more detail, and see how we can use
gradients or patterns/textures/images (in other words: fill shapes or
fill the outline of the shapes with some images that repeat
themselves).</p>

<h4>Colors and transparency</h4>

<p>You can use <a href="https://www.w3.org/TR/css3-color/" target="_blank" rel="noopener noreferrer">
the same syntax for colors that is supported by CSS3</a>. The next lines show possible values/syntaxes.</p>

<pre>ctx.strokeStyle = &#39;red&#39;;
ctx.fillStyle = &quot;#00ff00&quot;;
ctx.strokeStyle = &quot;rgb(0, 0, 255)&quot;;
ctx.fillStyle = &quot;rgba(0, 0, 255, 0.5)&quot;;</pre>

<p>Note that:</p>

<ul>
  <li>All values are strings;</li>
  <li><i>Line 4</i> defines a “transparent color”, the “a” of “rgba” means “alpha channel”. Its 
    value is between 0 and 1, where 0 means “completely transparent” and 1 means “opaque”.</li>
</ul>

<h4>Here is an example that shows how to draw different filled rectangles in blue, with different 
levels of transparency:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 166. colors and transparency example (223) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image166.webp"
  loading="lazy"
  style="width:40%;"
  title="Colors and transparency example"
  alt="Colors and transparency example." />

<h4>HTML source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Colors and transparency&lt;/title&gt;
  &lt;style&gt;
   #myCanvas {
      border: 1px solid black;
    }
  &lt;/style&gt;
&lt;script&gt;
  var canvas, ctx;
  function init() {
    // This function is called after the page is loaded
    // 1 - Get the canvas
    canvas = document.getElementById(&#39;myCanvas&#39;);
    // 2 - Get the context
    ctx=canvas.getContext(&#39;2d&#39;);
    // 3 - we can draw
    drawSomething();
  }
  function drawSomething() {
    // set the global context values
    ctx.fillStyle=&#39;rgba(0, 0, 255, 0.2)&#39;;
    // Draw the two filled red rectangles
    ctx.fillRect(150, 20, 200, 100);
    ctx.fillRect(100, 50, 200, 100);
    ctx.fillStyle = &quot;blue&quot;;
    ctx.fillRect(50, 100, 200, 100);
  }
&lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;400&quot; height=&quot;220&quot;&gt;
    Your browser does not support the canvas tag.
  &lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-5-2">3.5.2 Canvas Context: Linear Gradients</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>It is possible to define the stroke or the fill style as a “gradient”, a set 
of interpolated colors, like in this example below:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~ 167. define stroke fill style as 'gradient' (224) ~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image167.webp"
  loading="lazy"
  style="width:40%;"
  title="Define stroke fill style as 'gradient'"
  alt="Define stroke fill style as 'gradient'." />

<h4>JavaScript source code:</h4>

<details>
  <summary><b>JavaScript code extract!</b></summary>

<pre>var canvas, ctx, grdFrenchFlag;
function init() {
  // Good practice 1: set global vars canvas, ctx, gradients, etc here
  canvas = document.querySelector(&#39;#myCanvas1&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  // The gradient we create is also a global variable, we
  // will be able to reuse it for drawing different shapes
  // in different functions
  grdFrenchFlag = ctx.createLinearGradient(0, 0, 300, 0);
  // Try adding colors with first parameter between 0 and 1
  grdFrenchFlag.addColorStop(0, &quot;blue&quot;);
  grdFrenchFlag.addColorStop(0.5, &quot;white&quot;);
  grdFrenchFlag.addColorStop(1, &quot;red&quot;);
  draw();
}
function draw() {
  ctx.fillStyle = grdFrenchFlag;
  ctx.fillRect(0, 0, 300, 200);
}</pre>

</details>

<h4>HTML source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Linear gradients&lt;/title&gt;
  &lt;style&gt;
    #myCanvas1 {
      border: 1px solid black;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas1&quot; width=&quot;300&quot; height=200&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>A linear gradient is seen as an “invisible” rectangle in which a set of
colors are interpolated along a line.</h4>

<p>The gradient becomes visible when we draw shapes on top of the
invisible gradient, and when the fillStyle or strokeStyle property has
for value this gradient.</p>

<h4>How to create gradients</h4>

<p>There are 3 steps:</p>

<h4>Step #1: define a linear gradient</h4>

<h4>Syntax:</h4>

<pre>ctx.createLinearGradient(x0,y0,x1,y1);</pre>

<p>… where the (x0, y0) and (x1, y1) parameters define “the direction of
the gradient” (as a vector with a starting and an ending point). This
direction is an invisible line along which the colors that compose the
gradient will be interpolated.</p>

<h4>Let’s see an example:</h4>

<pre>grdFrenchFlag = ctx.createLinearGradient(0, 0, 300, 0);</pre>

<p>This line defines the direction of the gradient: a virtual, invisible
line that goes from the top left corner of the canvas (0, 0) to the
top right corner of the canvas (300, 0). The interpolated colors will
propagate along this line. </p>
<p>If this gradient is going to be reused by different functions, it is
good practice to create/initialize it in a function called when the page
is loaded and to store it in a global variable.</p>

<h4>Step #2: add a number of “color stops” to this gradient</h4>

<p>We will add a set of “colors” and “stops” to this gradient. The stops
go from 0 (beginning of the virtual line defined just above), to 1 (end
of the virtual line). A color associated with a value of 0.5 will be
right in the middle of the virtual line.</p>
<p>Here is an example that corresponds to an interpolated version of the
French flag, going from blue to white, then to red, with proportional
intervals. We define three colors, blue at position 0, white at position
0.5 and red at position 1:</p>

<pre>grdFrenchFlag.addColorStop(0, &quot;blue&quot;);
grdFrenchFlag.addColorStop(0.5, &quot;white&quot;);
grdFrenchFlag.addColorStop(1, &quot;red&quot;);</pre>

<h4>Step 3: draw some shapes</h4>

<p>First, let’s set the fillStyle or strokeStyle of the context with
this gradient, then let’s draw some shapes “on top of the gradient”.</p>
<p>In our example, the gradient corresponds to an invisible rectangle
that fills the canvas. If we draw a rectangle of the canvas size, it
should be filled with the entire gradient:</p>

<pre>ctx.fillStyle = grdFrenchFlag;
ctx.fillRect(0, 0, 300, 200);</pre>

<p>The result is shown in the <a href="https://codepen.io/w3devcampus/pen/WNpPZVO" 
target="_blank" rel="noopener noreferrer">above pen</a>: a big rectangle that fills 
the whole canvas, with colors going from blue (left) to white (middle) to red (right).</p>

<h4>Examples</h4>

<h4>Example #1: changing the direction of the gradient</h4>

<p>If you modify the source code that defines the direction of the gradient as follows…</p>

<pre>grdFrenchFlag = ctx.createLinearGradient(0, 0, 300, 200);</pre>

<p>… then you will define a gradient that goes from the top left corner of
the canvas to the bottom right of the canvas. Let’s see what it does:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~ 168. example 1 draw gradient top left to bottom right (226) ~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image168.webp"
  loading="lazy"
  style="width:40%;"
  title="Example 1 draw gradient from top left to bottom right"
  alt="Example 1 draw gradient from top left to bottom right." />

<h4>Example #2: drawing shapes that do not cover the whole gradient</h4>

<p>Instead of drawing a filled rectangle that covers the whole surface of
the canvas, let’s draw several smaller rectangles:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 169. example 2 draw smaller rectangles (226) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image169.webp"
  loading="lazy"
  style="width:40%;"
  title="Example 2 draw smaller rectangles - red & blue"
  alt="Example 2 draw smaller rectangles - red & blue." />

<p>Note that the canvas has its default background color where we did not
draw anything. And where we have drawn rectangles, we can see “through”
and the colors from the gradient are visible.</p>

<h4>Here is the code that draws the checkboard:</h4>

<pre>ctx.fillStyle = grdFrenchFlag;
ctx.fillRect(0, 0, 50, 50);
ctx.fillRect(100, 0, 50, 50);
ctx.fillRect(200, 0, 50, 50);
ctx.fillRect(50, 50, 50, 50);
ctx.fillRect(150, 50, 50, 50);
ctx.fillRect(250, 50, 50, 50);
ctx.fillRect(0, 100, 50, 50);
ctx.fillRect(100, 100, 50, 50);
ctx.fillRect(200, 100, 50, 50);
ctx.fillRect(50, 150, 50, 50);
ctx.fillRect(150, 150, 50, 50);
ctx.fillRect(250, 150, 50, 50);</pre>

<p>This code is rather ugly isn’t it? It would have been better to use a loop…</p>

<h4>Here is function that draws a chessboard:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>// n = number of cells per row/column
function drawCheckboard(n) {
  ctx.fillStyle = grdFrenchFlag;
  var l = canvas.width;
  var h = canvas.height;
  var cellWidth = l / n;
  var cellHeight = h / n;
  for(i = 0; i &lt; n; i++) {
    for(j = i % 2; j &lt; n; j++) {
      ctx.fillRect(cellWidth*i, cellHeight*j, cellWidth, cellHeight);
    }
  }
}</pre>

</details>

<p>The two loops (<i>lines 11-15</i>) draw only one cell out of two (see
the j = i % 2 at <i>line 12</i>). i is the column number and if the
column is odd or even, either we draw or we do not draw a rectangle.</p>

<p>This code is much more complex than the previous one, taking 16 lines
instead of 13, but is much more powerful. Try to call the function with
a value of 10, 20, or 2…</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 170. draw checkboard (227) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image170.webp"
  loading="lazy"
  style="width:40%;"
  title="Draw red and blue checkerboard"
  alt="Draw red and blue checkerboard." />

<h4>JavaScript:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas, ctx, grdFrenchFlag;
function init() {
  // Good practice 1: set global vars canvas, ctx, gradients, etc here
  canvas = document.querySelector(&#39;#myCanvas1&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  // The gradient we create is also a global variable, we
  // will be able to reuse it for drawing different shapes
  // in different functions
  grdFrenchFlag = ctx.createLinearGradient(0, 0, 300, 200);
  // Try adding colors with first parameter between 0 and 1
  grdFrenchFlag.addColorStop(0, &quot;blue&quot;);
  grdFrenchFlag.addColorStop(0.5, &quot;white&quot;);
  grdFrenchFlag.addColorStop(1, &quot;red&quot;);
  drawCheckboard(10);
}
// n = number of cells per row/column
function drawCheckboard(n) {
  ctx.fillStyle = grdFrenchFlag;
  ctx.lineWidth=10;
  var l = canvas.width;
  var h = canvas.height;
  var cellWidth = l / n;
  var cellHeight = h / n;
  for(i = 0; i &lt; n; i++) {
    for(j = i % 2; j &lt; n; j+=2) {
      ctx.fillRect(cellWidth*i, cellHeight*j, cellWidth, cellHeight);
    }
  }
}</pre>

</details>

<h4>HTML:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;Drawing shapes that do not cover the whole gradient - Example #2 bis&lt;/title&gt;
    &lt;style&gt;
      #myCanvas1 {
        border: 1px solid black;
      }
    &lt;/style&gt;
  &lt;/head&gt;
  &lt;body onload=&quot;init();&quot;&gt;
    &lt;canvas id=&quot;myCanvas1&quot; width=&quot;300&quot; height=200&gt;Your browser does not support the canvas tag.
    &lt;/canvas&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Example #3: drawing outlined shapes with gradients</h4>

<p>Just as we used fillStyle and fillRect for drawing rectangles filled
with a gradient, we can also use strokeStyle and strokeRect in order to
draw wireframed rectangles. In the next example, which is just a
variation of the previous one, we have used the lineWidth property to
set the outline of the rectangles at 5 pixels:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~ 171. example 3 using strokestyle and strokerect to draw rectangles (228) ~~~~~~~~~~-->
<img class="displayed"
  src="./images/image171.webp"
  loading="lazy"
  style="width:40%;"
  title="Example 3 draw rectangles using strokeStyle and strokeRect"
  alt="Example 3 draw rectangles using strokeStyle and strokeRect." />

<h4>JavaScript:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas, ctx, grdFrenchFlag;
function init() {
  // Good practice 1: set global vars canvas, ctx, gradients, etc here
  canvas = document.querySelector(&#39;#myCanvas1&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  // The gradient we create is also a global variable, we
  // will be able to reuse it for drawing different shapes
  // in different functions
  grdFrenchFlag = ctx.createLinearGradient(0, 0, 300, 200);
  // Try adding colors with first parameter between 0 and 1
  grdFrenchFlag.addColorStop(0, &quot;blue&quot;);
  grdFrenchFlag.addColorStop(0.5, &quot;white&quot;);
  grdFrenchFlag.addColorStop(1, &quot;red&quot;);
  drawCheckboard(5);
}
// n = number of cells per row/column
function drawCheckboard(n) {
  ctx.strokeStyle = grdFrenchFlag;
  ctx.lineWidth=10;
  var l = canvas.width;
  var h = canvas.height;
  var cellWidth = l / n;
  var cellHeight = h / n;
  for(i = 0; i &lt; n; i++) {
    for(j = i % 2; j &lt; n; j+=2) {
      ctx.strokeRect(cellWidth*(i), cellHeight*j, cellWidth, cellHeight);
    }
  }
}</pre>

</details>

<h4>HTML:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Drawing outlined shapes with gradients - Example #3&lt;/title&gt;
  &lt;style&gt;
    #myCanvas1 {
      border: 1px solid black;
    }
   &lt;/style&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas1&quot; width=&quot;300&quot; height=200&gt;Your browser does not support the canvas   tag.&lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Extract from source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>function drawCheckboard(n) {
  ctx.strokeStyle = grdFrenchFlag;
  ctx.lineWidth=10;
  ...
  for(i = 0; i &lt; n; i++) {
    for(j = i % 2; j &lt; n; j++) {
      ctx.strokeRect(cellWidth*i, cellHeight*j, cellWidth, cellHeight);
    }
  }
}</pre>

</details>

<h4>Example #4: what happens if we define a gradient smaller than the
canvas?</h4>

<p>Let’s go back to the very first example on this page - the one with
the blue-white-red interpolated French flag. This time we will define a
smaller gradient. Instead of going from (0, 0) to (300, 0), it will go
from (100, 0) to (200, 0), while the canvas remains the same
(width=300, height=200).</p>

<pre>grdFrenchFlag = ctx.createLinearGradient(100, 0, 200, 0);</pre>

<p>Like in the first example we will draw a filled rectangle that is the
same size as the canvas:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 172. example 4 draw filled rectangle (230) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image172.webp"
  loading="lazy"
  style="width:40%;"
  title="Example 4 draw filled rectangles"
  alt="Example 4 draw filled rectangles." />

<h4>JavaScript:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas, ctx, grdFrenchFlag;
function init() {
  // Good practice 1: set global vars canvas, ctx, gradients, etc here
  canvas = document.querySelector(&#39;#myCanvas1&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  // The gradient we create is also a global variable, we
  // will be able to reuse it for drawing different shapes
  // in different functions
  grdFrenchFlag = ctx.createLinearGradient(100, 0, 200, 0);
  // Try adding colors with first parameter between 0 and 1
  grdFrenchFlag.addColorStop(0, &quot;blue&quot;);
  grdFrenchFlag.addColorStop(0.5, &quot;white&quot;);
  grdFrenchFlag.addColorStop(1, &quot;red&quot;);
  draw();
}
function draw() {
  ctx.fillStyle = grdFrenchFlag;
  ctx.fillRect(0, 0, 300, 200);
}</pre>

</details>

<h4>HTML:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Defining a gradient smaller than the canvas - Example #4&lt;/title&gt;
  &lt;style&gt;
    #myCanvas1 {
      border: 1px solid black;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
   &lt;canvas id=&quot;myCanvas1&quot; width=&quot;300&quot; height=200&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>We notice that “before” the gradient starts, the first color of the
gradient is repeated without any interpolation (columns 0-100 are all
blue), then we “see through” and the gradient is drawn (columns
100-200), then the last color of the gradient is repeated without any
interpolation (columns 200-300 are red).</p>

<h4>Example #5: what happens if we define a gradient bigger than the canvas?</h4>

<p>Nothing special; we will “see through the drawn shapes”, and
the parts of the gradient that are located in the canvas area will be
shown. You can try this example that defines a gradient twice the size
of the canvas:</p>

<pre>grdFrenchFlag = ctx.createLinearGradient(0, 0, 600, 400);</pre>

<p>And if we draw the same rectangle with the canvas size, here is the
result:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 173. example 5 canvas size (231) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image173.webp"
  loading="lazy"
  style="width:40%;"
  title="Example 5 draw same rectangle with the canvas size"
  alt="Example 5 draw same rectangle with the canvas size." />

<h4>JavaScript:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas, ctx, grdFrenchFlag;
function init() {
  // Good practice 1: set global vars canvas, ctx, gradients, etc here
  canvas = document.querySelector(&#39;#myCanvas1&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  // The gradient we create is also a global variable, we
  // will be able to reuse it for drawing different shapes
  // in different functions
  grdFrenchFlag = ctx.createLinearGradient(0, 0, 600, 400);
  // Try adding colors with first parameter between 0 and 1
  grdFrenchFlag.addColorStop(0, &quot;blue&quot;);
  grdFrenchFlag.addColorStop(0.5, &quot;white&quot;);
  grdFrenchFlag.addColorStop(1, &quot;red&quot;);
  draw();
}
function draw() {
  ctx.fillStyle = grdFrenchFlag;
  ctx.fillRect(0, 0, 300, 200);
}</pre>

</details>

<h4>HTML:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Defining a gradient bigger than the canvas - Example #5&lt;/title&gt;
  &lt;style&gt;
    #myCanvas1 {
      border: 1px solid black;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas1&quot; width=&quot;300&quot; height=200&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>The red color is beyond the bottom right corner…. we see only the top
left quarter of the gradient.</p>

<h4>Example #6: drawing shapes that share the same gradient as a whole</h4>

<p>This time, we would like to draw the chessboard with the gradient in
each cell. How can we do this with one single gradient?</p>
<p>We can’t! At least we can’t without recreating it for each cell!</p>
<p>It suffices to create a new gradient before drawing each filled
rectangle, and set it with the starting and ending point of its
direction/virtual line accordingly to the rectangle coordinates. Try
this:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~ 174. example 6 draw shapes that share gradient (232) ~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image174.webp"
  loading="lazy"
  style="width:40%;"
  title="Example 6 draw shapes that share gradient"
  alt="Example 6 draw shapes that share gradient." />

<h4>JavaScript:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas, ctx, grdFrenchFlag;
function init() {
  // Good practice 1: set global vars canvas, ctx, gradients, etc here
  canvas = document.querySelector(#myCanvas1);
  ctx = canvas.getContext(&#39;2d&#39;);
  drawCheckboard(5);
}
function setGradient(x, y, width, height) {
  grdFrenchFlag = ctx.createLinearGradient(x, y, width, height);
  grdFrenchFlag.addColorStop(0, &quot;blue&quot;);
  grdFrenchFlag.addColorStop(0.5, &quot;white&quot;);
  grdFrenchFlag.addColorStop(1, &quot;red&quot;);
  ctx.fillStyle = grdFrenchFlag;
}
// n = number of cells per row/column
function drawCheckboard(n) {
  var l = canvas.width;
  var h = canvas.height;
  var cellWidth = l / n;
  var cellHeight = h / n;
  for(i = 0; i &lt; n; i+=2) {
    for(j = 0; j &lt; n; j++) {
      var x = cellWidth*(i+j%2);
      var y = cellHeight*j;
      setGradient(x, y, x+cellWidth, y+cellHeight);
      ctx.fillRect(x, y, cellWidth, cellHeight);</pre>

</details>

<h4>HTML:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Drawing shapes that share the same gradient as a whole - Example #6&lt;/title&gt;
  &lt;style&gt;
    #myCanvas1 {
      border: 1px solid black;
    }
  &lt;/style&gt;
&lt;/head&gt;
  &lt;body onload=&quot;init();&quot;&gt;
    &lt;canvas id=&quot;myCanvas1&quot; width=&quot;300&quot; height=200&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Extract from source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>function setGradient(x, y, width, height) {
  grdFrenchFlag = ctx.createLinearGradient(x, y, width, height);
  grdFrenchFlag.addColorStop(0, &quot;blue&quot;);
  grdFrenchFlag.addColorStop(0.5, &quot;white&quot;);
  grdFrenchFlag.addColorStop(1, &quot;red&quot;);
  // set the new gradient to the current fillStyle
  ctx.fillStyle = grdFrenchFlag;
}
// n = number of cells per row/column
function drawCheckboard(n) {
  var l = canvas.width;
  var h = canvas.height;
  var cellWidth = l / n;
  var cellHeight = h / n;
  for(i = 0; i &lt; n; i+=2) {
    for(j = 0; j &lt; n; j++) {
      var x = cellWidth*(i+j%2);
      var y = cellHeight*j;
      setGradient(x, y, x+cellWidth, y+cellHeight);
      ctx.fillRect(x, y, cellWidth, cellHeight);
    }
  }
}</pre>

</details>

<p>We wrote a function setGradient(startX, startY, endX, endY) that
creates a gradient and set the fillStyle context property so that any
filled shape drawn will have this gradient.</p>
<p>In the drawCheckBoard(…) function we call it just before drawing
rectangles. In this way, each rectangle is drawn using its own
gradient.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-5-3">3.5.3 Canvas Context: Radial Gradients</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Radial gradients are for creating gradients that propagate/interpolate colors along circles instead of
propagating/interpolating along a virtual line, like linear gradients.</p>

<h4>Here is an example of a radial gradient that interpolates the color of the rainbow:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~ 175. example radial gradient interpolates color of rainbow (234) ~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image175.webp"
  loading="lazy"
  style="width:40%;"
  title="Example radial gradient which interpolates the color of the rainbow"
  alt="Example radial gradient which interpolates the color of the rainbow." />

<h4>JavaScript:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas, ctx, grd;
function init() {
// Good practice 1: set global vars canvas, ctx, gradients, etc here
  canvas = document.querySelector(&#39;#myCanvas1&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  grd = ctx.createRadialGradient(150, 100, 30, 150, 100, 100);
  grd.addColorStop(0, &quot;red&quot;);
  grd.addColorStop(0.17, &quot;orange&quot;);
  grd.addColorStop(0.33, &quot;yellow&quot;);
  grd.addColorStop(0.5, &quot;green&quot;);
  grd.addColorStop(0.666, &quot;blue&quot;);
  grd.addColorStop(1, &quot;violet&quot;);
  draw();
}
function draw() {
  ctx.fillStyle = grd;
  ctx.fillRect(0, 0, 300, 200);
}</pre>

</details>

<h4>HTML:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;Radial gradients&lt;/title&gt;
    &lt;style&gt;
      #myCanvas1 {
        border: 1px solid black;
      }
    &lt;/style&gt;
  &lt;/head&gt;
  &lt;body onload=&quot;init();&quot;&gt;
      &lt;canvas id=&quot;myCanvas1&quot; width=&quot;300&quot; height=200&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>The gradient is defined as follows:</h4>

<pre>var grd = context.createRadialGradient(150, 100, 30, 150, 100, 100);
grd.addColorStop(0, &quot;red&quot;);
grd.addColorStop(0.17, &quot;orange&quot;);
grd.addColorStop(0.33, &quot;yellow&quot;);
grd.addColorStop(0.5, &quot;green&quot;);
grd.addColorStop(0.666, &quot;blue&quot;);
grd.addColorStop(1, &quot;violet&quot;);
context.fillStyle = grd;</pre>

<p>The method from the context object createRadialGradient(cx1, cy1,
radius1, cx2, cy2, radius2) takes as the first three parameters the
“starting” circle of the gradient, and as the three last parameters, the
“ending circle”.</p>

In the above example, the gradients starts at a circle located at (150,
100), with a radius of 30, and propagates to a circle with the same
center as the first (150, 100), but with a bigger radius of 100, as
shown below:
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 176. above example with color stops (235) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image176.webp"
  loading="lazy"
  style="width:40%;"
  title="Radial gradient"
  alt="Radial gradient." />

<p>We added color stops using a method similar to that used for linear gradients.</p>

<h4>What happens if the circles are not located at the same place?</h4>

<p>You get some nice effects; here we set the second circle’s center 60 pixels 
to the right of the first circle’s center (cx = 210 instead of 150):</p>

<pre>grd = ctx.createRadialGradient(150, 100, 30, 210, 100, 100);</pre>

<h4>Here is the result:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~ 177. 2nd circle center to the right of 1st circle (235) ~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image177.webp"
  loading="lazy"
  style="width:40%;"
  title="Effects from 2nd circle center to the right of the 1st circle center"
  alt="Effects from 2nd circle center to the right of the 1st circle center." />

<h4>JavaScript:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas, ctx, grd;
function init() {
  // Good practice 1: set global vars canvas, ctx, gradients, etc here
  canvas = document.querySelector(&#39;#myCanvas1&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  grd = ctx.createRadialGradient(150, 100, 30, 210, 100, 100);
  grd.addColorStop(0, &quot;red&quot;);
  grd.addColorStop(0.17, &quot;orange&quot;);
  grd.addColorStop(0.33, &quot;yellow&quot;);
  grd.addColorStop(0.5, &quot;green&quot;);
  grd.addColorStop(0.666, &quot;blue&quot;);
  grd.addColorStop(1, &quot;violet&quot;);
  draw();
}
function draw() {
  ctx.fillStyle = grd;
  ctx.fillRect(0, 0, 300, 200);
}</pre>

</details>

<h4>HTML:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Radial gradients with offset circles&lt;/title&gt;
  &lt;style&gt;
    #myCanvas1 {
      border: 1px solid black;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas1&quot; width=&quot;300&quot; height=200&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>What happens if the gradient is smaller or larger than the shapes we draw?</h4>

<p>A gradient is an invisible shape on the screen: the radial gradient
is made of two circles: an inner and an outer circle. Between these two
circles, colors are interpolated.</p>
<p>We call the “first color” the color defined for the inner circle, the
“last color” the last color of the gradient, that corresponds to the
outer circle:</p>

<ul>
  <li>The color inside the first circle will be the first color. In our example 
    above, the first color is red: and the small circle of the gradient in our 
    example is filled in red!</li>
  <li>The color outside the outer circle will be the last color of the gradient 
    - which is not interpolated. The last color in our example is purple, and 
    it fills the rest of the filled rectangle area “after” the external circle 
    of the gradient.</li>
  <li>The colors between the two circles will be interpolated.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-5-4">3.5.4 Canvas Context: Patterns/Textures</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Principle</h4>

<p>The principle of “pattern” drawing is based on repeating an image (if
the image is smaller than the surface of the shape you are going to
draw) for filling the surface of objects to be drawn (either filled or
stroked).</p>
<p>To illustrate this principle, in the next examples, we are going to
draw rectangles using a pattern.</p>
<p>There are a few steps we have to take before doing this:</p>

<ol type="1">
  <li><b>Create a JavaScript image object</b></li>
</ol>

<pre>var imageObj = new Image();</pre>

<ol start="2" type="1">
  <li><b>Define a callback function that will be called once the image has been 
    fully loaded</b> in memory; we cannot draw before the image has been loaded.</li>
</ol>

<pre>imageObj.onload = function(){
  ...
}</pre>

<ol start="3" type="1">
  <li><b>Set the source of this image to the URL of the pattern</b>:</li>
</ol>

<pre>imageObj.src = &quot;https://www.myserver.com/myRepeatablePattern.png&quot;;</pre>

<ol start="4" type="1">
  <li><b>Create a pattern object from the loaded image:</b></li>
</ol>

<p>As soon as step 3 is executed, an HTTP request is sent in background
by the browser, and when the image is loaded in memory, the callback
defined at step 2 is called. We create a pattern object inside, from the
loaded image:</p>

<pre>// callback called asynchronously, after the src attribute of imageObj is set
imageObj.onload = function(){ 
    // We enter here when the image is loaded, we create a pattern object.
    // It is good practice to set this as a global variable, easier to share
    pattern1 = ctx.createPattern(imageObj, &quot;repeat&quot;);
};</pre>

<ol start="5" type="1">
  <li><b>Inside the callback function (or inside a function called from inside 
    the callback), we can finally draw</b>:</li>
</ol>

<pre>// callback called asynchronously, after the src attribute of imageObj is set
imageObj.onload = function(){
  pattern1 = ctx.createPattern(imageObj, &quot;repeat&quot;);
  // Draw a textured rectangle
  ctx.fillStyle = pattern1;
  ctx.fillRect(10, 10, 500, 800);
};</pre>

<h4>Examples</h4>

<h4>Example #1: draw two rectangles with a pattern (one filled, one stroked)</h4>

<p>Here we have two rectangles drawn using a pattern (an image that can be 
repeated along the X and Y axis). The first is a filled rectangle while the 
second is “stroked” with a lineWidth of 20 pixels:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~ 178. filled rectange and stroked rectangle with linewidth 20 (238) ~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image178.webp"
  loading="lazy"
  style="width:40%;"
  title="Filled rectange and a stroked rectangle with lineWidth=20"
  alt="Filled rectange and a stroked rectangle with lineWidth=20." />

<h4>JavaScript:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas, ctx, pattern1;
function init() {
  canvas = document.querySelector(&#39;#myCanvas&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  // We need 1) to create an empty image object, 2) to set a callback function
  // that will be called when the image is fully loaded, 3) to create a
  // pattern object, 4) to set the fillStyle or the strokeStyle property of
  // the context with this pattern, 5) to draw something
  // WE CANNOT DRAW UNTIL THE IMAGE IS FULLY LOADED -&gt; draw from inside the
  // onload callback only !
  // Allocate an image
  var imageObj = new Image();
  // callback called asynchronously, after the src attribute of imageObj is set
  imageObj.onload = function(){
    // We enter here only when the image has been loaded by the browser
    // Pattern creation using the image object
    // Instead of &quot;repeat&quot;, try different values : repeat-x, repeat-y,
    // or no-repeat, You may draw larger shapes in order to see
    // different results
    // It is a good practice to leave this as a global variable if it
    // will be reused by other functions
    pattern1 = ctx.createPattern(imageObj, &quot;repeat&quot;);
    // Draw a textured rectangle
    ctx.fillStyle = pattern1;
    ctx.fillRect(10, 10, 200, 200);
    // And a wireframe one
    ctx.lineWidth=20;
    ctx.strokeStyle=pattern1;
    ctx.strokeRect(230, 20, 150, 100);
  };
  // This will tell the browser to send an asynchronous request.
  // When the browser will get an answer, the callback above will be called
  imageObj.src = &quot;https://mainline.i3s.unice.fr/mooc/pattern1.jpg&quot;;
}</pre>

</details>

<h4>HTML</h4>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Drawing two rectangles with a pattern - Example #1&lt;/title&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;500&quot; height=&quot;400&quot;&gt;
    Your browser does not support the canvas tag. &lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

<h4>JavaScript source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas, ctx, pattern1;
function init() {
  canvas = document.querySelector(&#39;#myCanvas&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  // We need 1) to create an empty image object, 2) to set a callback function
  // that will be called when the image is fully loaded, 3) to create a
  // pattern object, 4) to set the fillStyle or the strokeStyle property of
  // the context with this pattern, 5) to draw something
  // WE CANNOT DRAW UNTIL THE IMAGE IS FULLY LOADED -&gt; draw from inside the
  // onload callback only !
  // 1 - Allocate an image
var imageObj = new Image();
  // 2 - callback called asynchronously, after the src attribute of imageObj
  // is set
  imageObj.onload = function(){
      // We enter here only when the image has been loaded by the browser
      // 4 - Pattern creation using the image object
      // Instead of &quot;repeat&quot;, try different values : repeat-x, repeat-y,
      // or no-repeat, You may draw larger shapes in order to see
      // different results
      // It is good practice to leave this as a global variable if it
      // will be reused by other functions
      pattern1 = ctx.createPattern(imageObj, &quot;repeat&quot;);
      // 5 - Draw things. Here a textured rectangle
      ctx.fillStyle = pattern1;
      ctx.fillRect(10, 10, 200, 200);
      // ... And a wireframe one
      ctx.lineWidth=20;
      ctx.strokeStyle=pattern1;
      ctx.strokeRect(230, 20, 150, 100);
  };
  // 3 - Send the request to load the image
  // Setting the src attribute will tell the browser to send an asynchronous
  // request.
  // When the browser gets an answer, the callback above will be called
  imageObj.src = &quot;https://mainline.i3s.unice.fr/mooc/pattern1.jpg&quot;;
}</pre>

</details>

<h4>Example 2: the repeatability of a pattern</h4>

<p>To “better” see the repeatability of the pattern, here is the same example with a 1000x1000 pixel wide canvas:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 179. 1000 by 1000 pixel wide canvas (239) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image179.webp"
  loading="lazy"
  style="width:40%;"
  title="1000 by 1000 pixel wide canvas"
  alt="1000 by 1000 pixel wide canvas." />

<h4>JavaScript:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas, ctx, pattern1;
function init() {
  canvas = document.querySelector(&#39;#myCanvas&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  // We need 1) to create an empty image object, 2) to set a callback function
  // that will be called when the image is fully loaded, 3) to create a
  // pattern object, 4) to set the fillStyle or the strokeStyle property of
  // the context with this pattern, 5) to draw something
  // WE CANNOT DRAW UNTIL THE IMAGE IS FULLY LOADED -&gt; draw from inside the
  // onload callback only !
  // Allocate an image
  var imageObj = new Image();
  // callback called asynchronously, after the src attribute of imageObj is set
  imageObj.onload = function(){
    // We enter here only when the image has been loaded by the browser
    // Pattern creation using the image object
    // Instead of &quot;repeat&quot;, try different values : repeat-x, repeat-y,
    // or no-repeat, You may draw larger shapes in order to see
    // different results
    // It is a good practice to leave this as a global variable if it
    // will be reused by other functions
    pattern1 = ctx.createPattern(imageObj, &quot;repeat&quot;);
    // Draw a textured rectangle
    ctx.fillStyle = pattern1;
    ctx.fillRect(10, 10, 500, 800);
    // And a wireframe one
    ctx.lineWidth=50;
    ctx.strokeStyle=pattern1;
    ctx.strokeRect(650, 20, 300, 800);
  };
  // This will tell the browser to send an asynchronous request.
  // When the browser will get an answer, the callback above will be called
  imageObj.src = &quot;https://mainline.i3s.unice.fr/mooc/pattern1.jpg&quot;;
}</pre>

</details>

<h4>HTML:</h4>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Repeatability of a pattern - Example #2&lt;/title&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;1000&quot; height=&quot;1000&quot;&gt;
  Your browser does not support the canvas tag. &lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

<h4>You can change the way the pattern is repeated by modifying the second 
parameter of this method:</h4>

<pre>pattern1 = ctx.createPattern(imageObj, &quot;repeat&quot;);</pre>

<p>Please try: repeat-x, repeat-y or no-repeat as acceptable values. Just change 
this line in the online example and you will see live results.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-5-5">3.5.5 A Multiple Image Loader</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Draw with multiple patterns? We need to load all of them before drawing!</h4>

<p>Below are 4 rectangles drawn with 4 different patterns.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~ 180. four rectangles drawn with different patterns (241) ~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image180.webp"
  loading="lazy"
  style="width:35%;"
  title="Four rectangles drawn with different patterns"
  alt="Four rectangles drawn with different patterns." />

<p>We said earlier that we cannot draw before the image used by
a pattern is loaded. This can become rapidly complicated if we need to
draw using multiple patterns. We need a way to load all images and
then, <i>only when all images have been loaded, start drawing</i>.</p>

<p>JavaScript is an asynchronous language. When you set
the src attribute of an image, then an asynchronous request is sent by
the browser, and then after a while, the onload callback is called… The
difficult part to understand for those who are not familiar with
JavaScript is that these requests are done in parallel and we do not
know when, and in what order, the images will be loaded.</p>

<p>The solution is to use a multiple image loader that counts the loaded
images and calls a function you pass when done!</p>

<p>The trick is to have an array of URLs that will be used by our
multiple image loader, and have the onload callback called once per
image loaded, so we can count the number of images effectively
loaded.</p>

<p>When all images have been loaded, we call a callback function that
has been passed to our loader.</p>

<p>The complete example code that produces the result shown at the
beginning of this page is the following:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 181. multiple image loader (241) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image181.webp"
  loading="lazy"
  style="width:40%;"
  title="A multiple image loader"
  alt="A multiple image loader." />

<h4>HTML:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;A multiple image loader&lt;/title&gt;
  &lt;style&gt;
    #myCanvas {
      border: 1px solid black;
    }
  &lt;/style&gt;
  &lt;script&gt;
    var canvas, ctx;
    // List of images to load, we used a JavaScript object instead of
    // an array, so that named indexes (aka properties)
    // can be used -&gt; easier to manipulate
    var imagesToLoad = {
      flowers: https://i.ibb.co/4NN9Sgn/flowers.jpg,
      lion: https://i.ibb.co/3NyqKnY/lion.jpg,
      blackAndWhiteLys: https://i.ibb.co/VNLVpcL/final.jpg,
      tiledFloor:
      https://i.ibb.co/Dt6txmG/repeatable-Pattern.jpg{
    };
    function loadImages(imagesToBeLoaded, drawCallback) {
      var imagesLoaded = {};
      var loadedImages = 0;
      var numberOfImagesToLoad = 0;
      // get num of sources
      for(var name in imagesToBeLoaded) {
        numberOfImagesToLoad++;
      }
      for(var name in imagesToBeLoaded) {
        imagesLoaded[name] = new Image();
        imagesLoaded[name].onload = function() {
          if(++loadedImages &gt;= numberOfImagesToLoad) {
            drawCallback(imagesLoaded);
          } // if
        }; // function
        imagesLoaded[name].src = imagesToBeLoaded[name];
      } // for
    } // function
    function init() {
      // This function is called after the page is loaded
      // 1 - Get the canvas
      canvas = document.getElementById(&#39;myCanvas&#39;);
      // 2 - Get the context
      ctx=canvas.getContext(&#39;2d&#39;);
      loadImages(imagesToLoad, function(imagesLoaded) {
        patternFlowers = ctx.createPattern(imagesLoaded.flowers, repeat);
        patternLion = ctx.createPattern(imagesLoaded.lion, repeat);
        patternBW = ctx.createPattern(imagesLoaded.blackAndWhiteLys, repeat);
       patternFloor = ctx.createPattern(imagesLoaded.tiledFloor, repeat);
        drawRectanglesWithPatterns();
      });
    }
    function drawRectanglesWithPatterns() {
      ctx.fillStyle=patternFloor;
      ctx.fillRect(0,0,200,200);
      ctx.fillStyle=patternLion;
      ctx.fillRect(200,0,200,200);
      ctx.fillStyle=patternFlowers;
      ctx.fillRect(0,200,200,200);
      ctx.fillStyle=patternBW;
      ctx.fillRect(200,200,200,200);
    }
  &lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;400&quot; height=&quot;400&quot;&gt;
    Your browser does not support the canvas tag.
  &lt;/canvas&gt;
&lt;/body&gt;</pre>

</details>

<h4>Define the list of images to be loaded:</h4>

<pre>// List of images to load, we used a JavaScript object instead of
// an array, so that named indexes (aka properties)
// can be used -&gt; easier to read
var imagesToLoad = {
  flowers: https://i.ibb.co/4NN9Sgn/flowers.jpg,
  lion: https://i.ibb.co/3NyqKnY/lion.jpg,
  blackAndWhiteLys: https://i.ibb.co/VNLVpcL/final.jpg,
  tiledFloor:
  https://i.ibb.co/Dt6txmG/repeatable-Pattern.jpg
};</pre>

<p>Notice that instead of using a traditional array, we defined this list
as a JavaScript object, with properties whose names will be easier to
manipulate (flowers, lion, tiledFloor, etc.).</p>

<h4>The image loader function:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>function loadImages(imagesToBeLoaded, drawCallback) {
  var imagesLoaded = {};
  var loadedImages = 0;
  var numberOfImagesToLoad = 0;
  // get num of images to load
  for(var name in imagesToBeLoaded) {
    numberOfImagesToLoad++;
  }
  for(var name in imagesToBeLoaded) {
    imagesLoaded[name] = new Image();
    imagesLoaded[name].onload = function() {
      if(++loadedImages &gt;= numberOfImagesToLoad) {
        drawCallback(imagesLoaded);
      } // if
    }; // function
    imagesLoaded[name].src = imagesToBeLoaded[name];
  } // for
} // function</pre>

</details>

<h4>Explanations:</h4>

<ul>
  <li>This function takes as a parameter the list of images to be loaded, and a drawCallback function that will be called only once all images have been loaded. This callback takes as a parameter a new object that is the list of images that have been loaded (see <i>line 16</i>).</li>
  <li>We first count the number of images to load (<i>lines 7-9</i>), then for each image to be loaded we create a new JavaScript image object (<i>line 12</i>) and set its src attribute (<i>line 19</i>) - this will start to load the image.</li>
  <li>When an image comes in, the onload callback is called (<i>line 14</i>) and inside, we increment the number of images loaded (<i>line 15</i>) and test if this number is &gt;=  the total number of images that should be loaded. If this is the case, the callback function is called (<i>line 16</i>).</li>
</ul>

<h4>Example of use of this loader</h4>

<pre>loadImages(imagesToLoad, function(imagesLoaded) {
  patternFlowers = ctx.createPattern(imagesLoaded.flowers, &#39;repeat&#39;);
  patternLion = ctx.createPattern(imagesLoaded.lion, &#39;repeat&#39;);
  patternBW = ctx.createPattern(imagesLoaded.blackAndWhiteLys, &#39;repeat&#39;);
  patternFloor = ctx.createPattern(imagesLoaded.tiledFloor, &#39;repeat&#39;);
  drawRectanglesWithPatterns();
});</pre>

<h4>Explanations:</h4>

<ul>
  <li><i>Line 1</i> is the call to the image loader, the first parameter is the list of images to be loaded, while the second parameter is the callback function that will be called once all images have been loaded.</li>
  <li><i>Lines 2-5</i>: in this callback we create patterns from the loaded images (note the use of the property names imagesLoaded.flowers, etc. that makes the code easier to read).</li>
  <li><i>Line 7</i>: then we call a function that will draw the rectangles.</li>
</ul>

<h4>Here is the function:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>function drawRectanglesWithPatterns() {
  ctx.fillStyle=patternFloor;
  ctx.fillRect(0,0,200,200);
  ctx.fillStyle=patternLion;
  ctx.fillRect(200,0,200,200);
  ctx.fillStyle=patternFlowers;
  ctx.fillRect(0,200,200,200);
  ctx.fillStyle=patternBW;
  ctx.fillRect(200,200,200,200);
}</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-5-6">3.5.6 Drawing Shadows</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Context properties to draw with shadows</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 182. a green shadow rectangle (244) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image182.webp"
  loading="lazy"
  style="width:25%;"
  title="A green shadowed rectangle"
  alt="A green shadowed rectangle." />

<p>There are 4 properties of the canvas context that are useful for indicating that we want to draw shapes with shadows:</p>

<ol type="1">
  <li>shadowColor: color to use for shadows,</li>
  <li>shadowBlur: blur level for shadows,</li>
  <li>shadowOffsetX: horizontal distance of the shadow from the shape,</li>
  <li>shadowOffsetY: vertical distance of the shadow from the shape.</li>
</ol>

<h4>Examples</h4>

<h4>Example #1: simple shadows</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 183. example #1, simple shadows (245) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image183.webp"
  loading="lazy"
  style="width:40%;"
  title="Simple shadows, example #1"
  alt="Simple shadows, example #1." />

<h4>JavaScript:</h4>

<details>
  <summary><b>Click to expand!</b></summary>
  
<pre>var canvas, ctx;
function init() {
  canvas = document.getElementById(&#39;myCanvas&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  setShadow();
  // first green filled rectangle
  ctx.fillStyle = &quot;#22FFDD&quot;; // rectangle color
  ctx.fillRect(20, 20, 200, 100);
  // second stroked rectangle
  ctx.strokeStyle = &quot;purple&quot;; // rectangle color
  ctx.lineWidth=10;
  ctx.strokeRect(20, 150, 200, 100);
}
function setShadow() {
  ctx.shadowColor = &quot;Grey&quot;; // color
  ctx.shadowBlur = 20; // blur level
  ctx.shadowOffsetX = 15; // horizontal offset
  ctx.shadowOffsetY = 15; // vertical offset
}</pre>

</details>

<h4>HTML</h4>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Simple shadows - Example #1&lt;/title&gt;
&lt;/head&gt;
&lt;body onload = init();&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;400&quot; height =800&gt;
    Your browser does not support the canvas tag.&lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

<h4>JavaScript source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas, ctx;
function init() {
  canvas = document.getElementById(&#39;myCanvas&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  // call to a function that will set the 4 context properties for shadows
  setShadow();
  // all drawings that will occur will cast shadows
  // first green filled rectangle
  ctx.fillStyle = &quot;#22FFDD&quot;; 
  ctx.fillRect(20, 20, 200, 100);
  // second stroked rectangle
  ctx.strokeStyle = &quot;purple&quot;; 
  ctx.lineWidth=10;
  ctx.strokeRect(20, 150, 200, 100);
}
// We define the 4 properties in a dedicated function, for clarity
function setShadow() {
  ctx.shadowColor = &quot;Grey&quot;;    // color
  ctx.shadowBlur = 20;         // blur level
  ctx.shadowOffsetX = 15;      // horizontal offset
  ctx.shadowOffsetY = 15;      // vertical offset
}</pre>

</details>

<h4>Explanations:</h4>

<ul>
  <li><i>Lines 21-27</i>: we set the 4 properties that define shadows in a dedicated 
    function, for better clarity.</li>
  <li><i>Line 8</i>: we called this function once before drawing the rectangles.</li>
  <li><i>Lines 11-18</i>: we draw a filled and a stroked rectangle. Both rectangles 
    cast shadows.</li>
</ul>

<h4>Example #2: unwanted shadows!</h4>

<p>Let’s take a <a href="https://codepen.io/w3devcampus/pen/YzZBxmO" target="_blank" 
rel="noopener noreferrer">previous example</a>, the one that draws a filled circle 
with an outline. And, let’s add a shadow to it using the following code:</p>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>...
ctx.beginPath();
// Add to the path a full circle (from 0 to 2PI)
ctx.arc(centerX, centerY, radius, 0, 2*Math.PI, false);
// With path drawing you can change the context
// properties until a call to stroke() or fill() is performed
ctx.fillStyle = &quot;lightBlue&quot;;
// add shadows before drawing the filled circle
addShadows();
// Draws the filled circle in light blue
ctx.fill();
// Prepare for the outline
ctx.lineWidth = 5;
ctx.strokeStyle = &quot;black&quot;;
// draws the path AGAIN (the circle), this
// time in wireframe
ctx.stroke();
// Notice we only once called context.arc()! And drew it twice
// with different styles
...
function addShadows() {
  ctx.shadowColor = &quot;Grey&quot;; // color
  ctx.shadowBlur = 20;      // blur level
  ctx.shadowOffsetX = 15;   // horizontal offset
  ctx.shadowOffsetY = 15;   // vertical offset
}</pre>

</details>

<h4>And here is the result:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 184. setting shadow - not quite correct (247) ~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image184.webp"
  loading="lazy"
  style="width:40%;"
  title="Not quite correct, unwanted shadow"
  alt="Not quite correct, unwanted shadow." />

<h4>HTML, CSS and JS:</h4>

<details>
  <summary><b>Click to expand!</b></summary>
  
<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Unwanted shadows - Example #2&lt;/title&gt;
  &lt;style&gt;
    body {
      margin: 0px;
     padding: 0px;
    }
    #myCanvas {
      border: 1px solid #9C9898;
    }
  &lt;/style&gt;
&lt;script&gt;
  var canvas, ctx;
  window.onload = function(){
    canvas = document.getElementById(&quot;myCanvas&quot;);
    ctx = canvas.getContext(&quot;2d&quot;);
    var centerX = canvas.width / 2;
    var centerY = canvas.height / 2;
    var radius = 70;
    ctx.beginPath();
    // Add to the path a full circle (from 0 to 2PI)
    ctx.arc(centerX, centerY, radius, 0, 2*Math.PI, false);
    // With path drawing you can change the context
    // properties until a call to stroke() or fill() is performed
    ctx.fillStyle = &quot;lightBlue&quot;;
    // add shadows before drawing the filled circle
    addShadows();
    // Draws the filled circle in light blue
    ctx.fill();
    // Prepare for the outline
    ctx.lineWidth = 5;
    ctx.strokeStyle = &quot;black&quot;;
    // draws AGAIN the path (the circle), this
    // time in wireframe
    ctx.stroke();
    // Notice we called context.arc() only once ! And drew it twice
    // with different styles
  };
  function addShadows() {
    ctx.shadowColor = &quot;Grey&quot;; // color
    ctx.shadowBlur = 20; // blur level
    ctx.shadowOffsetX = 15; // horizontal offset
    ctx.shadowOffsetY = 15; // vertical offset
  }
&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;578&quot; height=&quot;200&quot;&gt;
  &lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>Ah, indeed, the call to ctx.fill() casts a shadow, but the call
to ctx.stroke(), that paints the whole path again, casts a shadow too,
and this time the outline produces an unwanted shadow… How can we avoid
this effect, while using the same technique for drawing the path?</p>
<p>The trick is to save the context before setting the shadow
properties, then draw the filled circle, then restore the context (to
its previous state: without shadows), then draw the outlined circle by
calling ctx.stroke().</p>

<h4>Correct version of the code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>...
// save the context before setting shadows and drawing the filled circle
ctx.save();
// With path drawing you can change the context
// properties until a call to stroke() or fill() is performed
ctx.fillStyle = &quot;lightBlue&quot;;
// add shadows before drawing the filled circle
addShadows();
// Draws the filled circle in light blue
ctx.fill();
// restore the context to its previous saved state
ctx.restore();
...</pre>

</details>

<h4>And here is the <em>FINAL</em> result:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 185. final result of setting shadow (248) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image185.webp"
  loading="lazy"
  style="width:40%;"
  title="Final result of setting shadow"
  alt="Final result of setting shadow." />

<h4>HTML, CSS and JS:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Unwanted shadows disappear- Example #2 bis&lt;/title&gt;
  &lt;style&gt;
     body {
   margin: 0px;
   padding: 0px;
    }
    #myCanvas {
    border: 1px solid #9C9898;
    }
  &lt;/style&gt;
  &lt;script&gt;
    var canvas, ctx;
    window.onload = function(){
    canvas = document.getElementById(&quot;myCanvas&quot;);
    ctx = canvas.getContext(&quot;2d&quot;);
    var centerX = canvas.width / 2;
    var centerY = canvas.height / 2;
    var radius = 70;
    ctx.beginPath();
    // Add to the path a full circle (from 0 to 2PI)
    ctx.arc(centerX, centerY, radius, 0, 2*Math.PI, false);
    // save the context before setting shadows and drawing the filled circle
    ctx.save();
    // With path drawing you can change the context
    // properties until a call to stroke() or fill() is performed
    ctx.fillStyle = &quot;lightBlue&quot;;
    // add shadows before drawing the filled circle
    addShadows();
    // Draws the filled circle in light blue
    ctx.fill();
    // restore the context to its previous saved state
    ctx.restore();
    // Prepare for the outline
    ctx.lineWidth = 5;
    ctx.strokeStyle = &quot;black&quot;;
    // draws AGAIN the path (the circle), this
    // time in wireframe
    ctx.stroke();
    // Notice we called context.arc() only once ! And drew it twice
    // with different styles
    };
    function addShadows() {
    ctx.shadowColor = &quot;Grey&quot;; // color
    ctx.shadowBlur = 20; // blur level
    ctx.shadowOffsetX = 15; // horizontal offset
    ctx.shadowOffsetY = 15; // vertical offset
  }
  &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;578&quot; height=&quot;200&quot;&gt;
  &lt;/canvas&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch3-5-7">3.5.7 Styling Lines</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Several context properties can be used to set the thickness of the
shape outlines, the way line end caps are drawn, etc.</p>
<p>They apply to all shapes that are drawn in path mode (lines, curves,
arcs) and some also apply to rectangles.</p>

<h4>Examples of line styles</h4>

<h4>Example #1: changing the line thickness</h4>

<p>We have seen this before. This is done by changing the value (in
pixels) of the lineWidth property of the context:</p>

<pre>ctx.lineWidth = 10; // set the thickness of every shape drawn in stroke/wireframe mode to 10 pixels</pre>

<p>Here is a complete example where we draw with a lineWidth of 20 pixels:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 186. changing the line thickness (250) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image186.webp"
  loading="lazy"
  style="width:40%;"
  title="Changing the line thickness"
  alt="Changing the line thickness." />

<h4>Source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;A simple example of lineWidth property use&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;canvas id=&quot;myCanvas&quot; width=&quot;500&quot;&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
    &lt;script&gt;
      var canvas = document.getElementById(&#39;myCanvas&#39;);
      var ctx = canvas.getContext(&#39;2d&#39;);
       // first path
      ctx.moveTo(20, 20);
      ctx.lineTo(100, 100);
      ctx.lineTo(100, 0);
      // second part of the path
      ctx.moveTo(120, 20);
      ctx.lineTo(200, 100);
      ctx.lineTo(200, 0);
      // indicate stroke color + draw first part of the path
      ctx.strokeStyle = &quot;#0000FF&quot;;
      // Current line thickness is 20 pixels
      ctx.lineWidth = 20;
      ctx.stroke();
      // Draws a rectangle
      ctx.strokeRect(230, 10, 100, 100);
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Example #2: changing the end caps of a line</h4>

<p>The lineCap property of the context indicates the way line end caps are
rendered. Possible values are butt (default), round, square (from top to
bottom in the next illustration). Note that a value of “round” or
“square” makes the lines slightly longer than the default value “butt”.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 187. line cap values (251) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image187.webp"
  loading="lazy"
  title="Line cap values"
  alt="Line cap values."
  style="width:20%;" />

<h4>Try this:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 188. changing the end caps of a lines (251) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image188.webp"
  loading="lazy"
  title="Changing the end caps of a line.  Example #2"
  alt="Changing the end caps of a line.  Example #2."
  style="width:40%;" />

<h4>HTML, CSS and JS:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Changing the end caps of a line - Example #2&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;500&quot;&gt;Your browser does not support the canvas tag.&lt;/canvas&gt;
  &lt;script&gt;
    var canvas = document.getElementById(&#39;myCanvas&#39;);
    var ctx = canvas.getContext(&#39;2d&#39;);
    // first path
    ctx.moveTo(20, 20);
    ctx.lineTo(100, 100);
    ctx.lineTo(100, 30);
    // second part of the path
    ctx.moveTo(120, 20);
    ctx.lineTo(200, 100);
    ctx.lineTo(200, 30);
    // indicate stroke color + draw first part of the path
    ctx.strokeStyle = &quot;#0000FF&quot;;
    // Current line thickness is 20 pixels
    ctx.lineWidth = 20;
    // Try different values : butt, square, round
    ctx.lineCap = &quot;round&quot;;
    ctx.stroke();
    // Draws a rectangle
    ctx.strokeRect(230, 10, 100, 100);
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>Note that in this example, the rectangle is not affected. It has no line ends visible - all its sides meet. However, the next property we’re going to look at will have an effect on rectangles!</p>

<h4>Example #3: setting the type of corner when two lines meet</h4>

<p>The lineJoin property of the context indicates the way corners are rendered, when two lines meet. Possible values are miter (the default) for creating sharp corners, round, or bevel for “cut corners”.</p>

<h4>Try this:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~ 189. setting type of corner when two lines meet (252) ~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image189.webp"
  loading="lazy"
  title="Setting type of corner when two lines meet"
  alt="Setting type of corner when two lines meet."
  style="width:40%;" />

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Setting the type of corner when two lines meet - Example #3&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;500&quot;&gt;Your browser does not support the   canvas tag.&lt;/canvas&gt;
  &lt;script&gt;
    var canvas = document.getElementById(&#39;myCanvas&#39;);
    var ctx = canvas.getContext(&#39;2d&#39;);
    // first path
    ctx.moveTo(20,20);
    ctx.lineTo(100, 100);
    ctx.lineTo(100,30);
    // second part of the path
    ctx.moveTo(120,20);
    ctx.lineTo(200, 100);
    ctx.lineTo(200,30);
    // indicate stroke color + draw first part of the path
    ctx.strokeStyle = &quot;#0000FF&quot;;
    // Current line thickness is 20 pixels
    ctx.lineWidth = 20;
    // Try different values : miter(default), bevel, round
    ctx.lineJoin=&quot;round&quot;;
    ctx.stroke();
    // Draws a rectangle
    ctx.strokeRect(230, 10, 100, 100);
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Example #4: specific case of lineJoin=“miter”, the miterLimit property, a way to avoid looooooong corners!</h4>

<p>The miterLimit property value corresponds to the maximum miter length: the distance between the inner corner and the outer corner where two lines meet. When the angle of a corner between two lines gets smaller, the miter length grows and can become too long.</p>
<p>In order to avoid this situation, we can set the miterLimit property of the context to a threshold value. If the miter length exceeds the miterLimit value, then the corner will be rendered as if the lineJoin property had been set to “bevel” and the corner will be “cut”.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~ 190. linejoin property - arrows fig 1, 2 and 3 (253) ~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image190.webp"
  loading="lazy"
  title="lineJoin property, figure 1, 2 and 3 showing arrows"
  alt="lineJoin property, figure 1, 2 and 3 showing arrows."
  style="width:20%;" />

<h4>You can try an interactive example here:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 191. miterlimit property explained (253) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image191.webp"
  loading="lazy"
  title="Example #4: miterLimit property shown with 3 different angles, we see 
    that the part that goes out of the angle becomes very long"
  alt="Example #4: miterLimit property shown with 3 different angles, we see 
    that the part that goes out of the angle becomes very long."
  style="width:40%;" />

<p>In the example, try different values for the miterLimit property.  You’ll see that the way the corners are rendered changes at values around 2 and 3.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch4-2">4.2 Animations - An Introduction – Module 4</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch4-2-1">4.2.1 Basic Animation Techniques</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>In order to perform an animation, we need to:</p>

<ol type="1">
  <li>Clear the content of the canvas: this can be done using the ctx.clearRect(0, 0, canvasWidth, canvasHeight) method;</li>
  <li>Draw some shapes: use any of the drawing methods we have seen so far;</li>
  <li>Move the shapes: modify the position and/or orientation, size and color of the shapes;</li>
  <li>Repeat (go to step 1).</li>
</ol>

<p>These are the basic steps for animating objects in a canvas. The order of the steps can be changed (i.e. you can move the shapes before drawing them), but, the principle is the same: clear-draw-move-repeat.</p>
<p>Step 1 could be avoided if you redraw the whole canvas content during step 2.</p>

<h4>Before HTML5</h4>

<p>Even before HTML5 and the introduction of the canvas element, people created HTML games. 
They used CSS backgrounds inside &lt;div&gt; elements, and used to change the CSS 
top, left, width and height properties of the divs to animate graphic images on the screen.</p>

<p>During the late 1990s and early 2000s, JavaScript became increasingly popular. 
The community created a first ‘umbrella term’ describing a collection of technologies 
used together to create interactive and animated Web sites - <a href="https://en.wikipedia.org/wiki/Dynamic_HTML" 
target="_blank" rel="noopener noreferrer">DHTML (Dynamic HTML)</a>. For example, check the 
<a href="https://def-logic.com/" target="_blank" rel="noopener noreferrer">
games developed at this time by Brent Silby</a> (they all use DHTML).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 192. mario-like dhtml game (254) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image192.webp"
  loading="lazy"
  title="A mario-like DHTML game"
  alt="A mario-like DHTML game."
  style="width:25%;" />

<p>For animation, the setInterval(function, ms) and setTimeout(function, ms) methods were the only solutions. Both methods take a function as the first parameter, and a number of milliseconds as the second parameter.</p>
<p>The only difference is that the code provided to setInterval will run every n milliseconds whereas the code in setTimeout will run only once after n milliseconds (meaning that we will have to repeat a call to setTimeout at step 4 above).</p>

<h4>After HTML5</h4>

<p>The methods described above are now completed by a new method that comes with multiple advantages: the requestAnimationFrame API.</p>
<p>We will compare the old methods with the new one, and implement the same  example with each of them to highlight the differences.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch4-2-2">4.2.2 Basic Animation Techniques</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Below is the example shown in the video, with source code:</p>

<h4>HTML, CSS and JS:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Animation&lt;/title&gt;
  &lt;style&gt;
    #myCanvas {
      border: 1px solid black;
    }
  &lt;/style&gt;
  &lt;script&gt;
    var canvas, ctx;
    var rectangleX = 0;
    var colors = [&#39;red&#39;, &#39;blue&#39;, &#39;green&#39;];
    var currentColor = 0;
    var speed = 3;
    function init() {
      // This function is called after the page is loaded
      // 1 - Get the canvas
      canvas = document.getElementById(&#39;myCanvas&#39;);
      // 2 - Get the context
     ctx=canvas.getContext(&#39;2d&#39;);
      // 3 - we can draw
      //setInterval(animate, 100);
      //setTimeout(animate, 100);
      requestAnimationFrame(animate);
      setInterval(changeColor, 1000);
    }
    function animate() {
      // - 1 clear canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      // 2 - draw a red rectangle
      ctx.fillRect(rectangleX,0,80,100);
      // 3 - move the shapes
      rectangleX = rectangleX +speed;
      if((rectangleX+80 &gt; 200) || (rectangleX &lt;= 0)){
        speed = -speed;
      }
      // Call again the anilate function after 100ms
      //setTimeout(animate, 100);
      requestAnimationFrame(animate);
    }
    function changeColor() {
      ctx.fillStyle= colors[currentColor%3];
      currentColor += 1;
      // Comment next line if you do not want to change the speed at
      // each bounce
      speed += Math.sign(speed)*1;
      console.log(&quot;speed = &quot; + speed)
    }
  &lt;/script&gt;
&lt;/head&gt;
  &lt;body onload=&quot;init();&quot;&gt;
    &lt;canvas id=&quot;myCanvas&quot; width=&quot;200&quot; height=&quot;200&quot;&gt;
      Your browser does not support the canvas tag.
    &lt;/canvas&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p><b>Errata</b>: in the video, we use speed +=1; in order to increment the speed of the rectangle each time it bounces (in the changeColor() function). This is not correct as speed can be negative. The online example fixes this by using speed += Math.sign(speed) * 1; instead this will add +1 or -1 depending on the sign of speed.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch4-2-3">4.2.3 Animating Using setInterval()</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The setInterval(…) function is still popular on the Web, and
even though this is not the recommended way to do 60 frames/second
canvas animation, it is worth understanding how it works.</p>
<p>Syntax: setInterval(function, ms);</p>
<p>The setInterval(…) function calls another function or evaluates an
expression at specified intervals of time (in milliseconds), and returns
the unique id of the action. You can always stop it by calling
the clearInterval(id) function with the interval identifier as an
argument.</p>

<h4>Basic example that shows how to animate a DIV using the DOM API</h4>
<p>This is how pre-HTML5 games were written. Before the introduction of the canvas element, developers made games using div elements. By changing their background color, top and left CSS positions, it was possible to animate characters in games. The animation was created by calling repeatedly a function that did the drawing, using the JavaScript setInterval or setTimeout functions.</p>
<p>Please try this example that moves/animates a div using setInterval:</p>

<h4>HTML, CSS and JS:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;setInterval for animation&lt;/title&gt;
  &lt;style&gt;
    #animatedDIV {
      position:absolute;
      background-color:red;
      color:white;
      height:100px;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;button onclick=&quot;start()&quot;&gt;Start animation&lt;/button&gt;
  &lt;button onclick=&quot;stop()&quot;&gt;Stop animation&lt;/button&gt;
  &lt;div&gt;
  &lt;div id=&quot;animatedDIV&quot;&gt;Animated DIV :-)&lt;/div&gt;
  &lt;/div&gt;
  &lt;script&gt;
    var elm = document.getElementById(&quot;animatedDIV&quot;);
    var requestId;
    var x = 0;
    function render(time) {
      elm.style.left = x++ + &quot;px&quot;;
    }
    function start() {
      requestId = setInterval(render, 10);
    }
    function stop() {
      if (requestId) {
        clearInterval(requestId);
      }
    }
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Extract from the source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;body&gt;
  &lt;div id=&quot;animatedDIV&quot;&gt;Animated DIV :-)&lt;/div&gt;
  &lt;button onclick=&quot;start()&quot;&gt;Start animation&lt;/button&gt;
  &lt;button onclick=&quot;stop()&quot;&gt;Stop animation&lt;/button&gt;
  &lt;script&gt;
    var elm = document.getElementById(&quot;animatedDIV&quot;);
    var requestId;
    var x = 0;
    function render(time) {
      elm.style.left = x++ + &quot;px&quot;;
    }
    function start() {
      r/equestId = setInterval(render, 10);
    }
    function stop() {
      if (requestId) {
        clearInterval(requestId);
      }
    }
  &lt;/script&gt;
&lt;/body&gt;</pre>

</details>

<p>Here, we define a &lt;div&gt; element, (see the online source code for the CSS properties involved), and we use the setInterval method (<i>line 17</i>) to call every 10ms the render() method that will just increment the position of this element. Notice that since we’re using the DOM, the horizontal position of the div is modified by changing its left CSS property.</p>
<p>The call to setInterval returns an id we can use to stop the animation, by calling clearInterval (<i>line 22</i>).</p>

<h4>Animate a monster in a canvas, using setInterval</h4>

<p>We use the drawMonster() function:</p>

<h4>HTML, CSS and JS:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;setInterval and monster animation&lt;/title&gt;
  &lt;style&gt;
    #myCanvas {
      border: 1px solid black;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;400&quot; height=&quot;400&quot;&gt;
    Your browser does not support the canvas tag.
  &lt;/canvas&gt;
  &lt;p&gt;
  &lt;button onclick=&quot;start()&quot;&gt;Start animation&lt;/button&gt;
  &lt;button onclick=&quot;stop()&quot;&gt;Stop animation&lt;/button&gt;
  &lt;script&gt;
    var canvas, ctx;
    var monsterX=100, monsterY=100, monsterAngle=0;
    function init() {
      // This function is called after the page is loaded
      // 1 - Get the canvas
      canvas = document.getElementById(&#39;myCanvas&#39;);
      // 2 - Get the context
      ctx=canvas.getContext(&#39;2d&#39;);
    }
    function animationLoop() {
      // 1 - Clear the canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      // 2 Draw the monster using variables for pos, angle, etc.
      drawMonster(monsterX, monsterY, monsterAngle, &#39;green&#39;, &#39;yellow&#39;);
      // 3 Move the monster (change pos, angle, size, etc.)
      monsterX += 10;
      monsterX %= canvas.width
      monsterAngle+= 0.01;
    }
    function drawMonster(x, y, angle, headColor, eyeColor) {
      // GOOD PRACTICE : SAVE CONTEXT AND RESTORE IT AT THE END
      ctx.save();
      // Moves the coordinate system so that the monster is drawn
      // at position (x, y)
      ctx.translate(x, y);
      ctx.rotate(angle)
      // head
      ctx.fillStyle=headColor;
      ctx.fillRect(0,0,200,200);
      // eyes
      ctx.fillStyle=&#39;red&#39;;
      ctx.fillRect(35,30,20,20);
      ctx.fillRect(140,30,20,20);
      // interior of eye
      ctx.fillStyle=eyeColor;
      ctx.fillRect(43,37,10,10);
      ctx.fillRect(143,37,10,10);
      // Nose
      ctx.fillStyle=&#39;black&#39;;
      ctx.fillRect(90,70,20,80);
      // Mouth
      ctx.fillStyle=&#39;purple&#39;;
      ctx.fillRect(60,165,80,20);
      // GOOD PRACTICE !
      ctx.restore();
    }
    function start() {
      // Start the animation loop, change 20 for bigger values
      requestId = setInterval(animationLoop, 20);
    }
    function stop() {
      if (requestId) {
        clearInterval(requestId);
      }
    }
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;400&quot; height=&quot;400&quot;&gt;
    Your browser does not support the canvas tag.
  &lt;/canvas&gt;
  &lt;p&gt;
  &lt;button onclick=&quot;start()&quot;&gt;Start animation&lt;/button&gt;
  &lt;button onclick=&quot;stop()&quot;&gt;Stop animation&lt;/button&gt;
  &lt;script&gt;
    var canvas, ctx;
    var monsterX=100, monsterY=100, monsterAngle=0;
    function init() {
      // This function is called after the page is loaded
      // 1 - Get the canvas
      canvas = document.getElementById(&#39;myCanvas&#39;);
      // 2 - Get the context
      ctx=canvas.getContext(&#39;2d&#39;);
    }
    function animationLoop() {
      // 1 - Clear the canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      // 2 Draw the monster using variables for pos, angle, etc.
      drawMonster(monsterX, monsterY, monsterAngle, &#39;green&#39;, &#39;yellow&#39;);
      // 3 Move the monster (change pos, angle, size, etc.)
      monsterX += 10;
      monsterX %= canvas.width
      monsterAngle+= 0.01;
    }
    function drawMonster(x, y, angle, headColor, eyeColor) {
      // BEST PRACTICE: SAVE CONTEXT AND RESTORE IT AT THE END
      ctx.save();
      // Moves the coordinate system so that the monster is drawn
      // at position (x, y)
      ctx.translate(x, y);
      ctx.rotate(angle)
      // head
      ctx.fillStyle=headColor;
      ctx.fillRect(0,0,200,200);
      ...
      // BEST PRACTICE!
      ctx.restore();
    }
    function start() {
      // Start the animation loop, change 20 for bigger values
      requestId = setInterval(animationLoop, 20);
    }
    function stop() {
      if (requestId) {
        clearInterval(requestId);
      }
    }
  &lt;/script&gt;
&lt;/body&gt;</pre>

</details>

<h4>Explanations:</h4>

<ul>
  <li><i>Lines 52-61</i>: The code for launching and stopping the animation is similar to 
    that from the previous example.</li>
  <li><i>Lines 34-50</i>: The code that draws the monster is that which we saw earlier when 
    we presented the 2D transformations. Best practice is to save and restore the context at 
    the beginning and end of each function that changes the context.</li>
  <li><i>Lines 21-32</i>: <b>The most interesting part is the animation loop</b> that implements 
    the basic animation steps: clear-draw-move. In order to make a shape “movable”, we use 
    some “state variables” for its position and angle, and we modify them at each iteration 
    (<i>lines 29-32</i>). We will see later on how to modify the value of these variables on 
    user interactions (keyboard, mouse, etc.).</li>
</ul>

<h4>Problems with setInterval</h4>

<p>While the above example works, there are several reasons not to
use setInterval for doing smooth animations.</p>

<h4>Running several animations simultaneously</h4>

<p>The setInterval function may become hard to debug, particularly if
you run several animations simultaneously. For example, if you have two
intervals, one running every 100 milliseconds, the other every second,
and if you want to debug the second one, the first one will constantly
be run at regular intervals, making step by step debugging really
difficult.</p>

<h4>A single animation may be interrupted by itself to become two simultaneous animations</h4>

<p>setInterval will execute the function passed as first parameter
every n milliseconds regardless of when the function was last called or
how long the function takes to execute. If the function takes longer
than the interval, then setInterval might queue too many function
executions back to back when the interval is too short, leading to
unpredictable results. </p>

<p><b>BEST PRACTICE</b>: AVOID using setInterval for animating in a
canvas, except for trivial cases (change a color every second).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch4-2-4">4.2.4 Animating Using setTimeout()</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>One thing you should always remember about using setInterval: if we
set number of milliseconds at - let’s say 20ms - it will call our game
loop function EACH 20ms, even if the previous one is not yet finished.
This may lead to many problems (incomplete rendering, etc.).</p>
<p>That’s where we can use another function: </p>

<ul>
  <li>setTimeout(function, ms);</li>
</ul>

<p>This function works like setInterval(…) with one difference: it calls
your function ONCE and <i>AFTER a given amount of time</i>.</p>

<h4>Example of the monster animated in a canvas with setTimeout</h4>
<p>Check the example below (click on start animation):</p>

<h4>HTML, CSS and JS:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=&quot;utf-8&quot;&gt;
&lt;title&gt;Monster animated in a canvas with setTimeout&lt;/title&gt;
&lt;style type=&quot;text/css&quot;&gt;
  canvas {
    border:1px solid black;
  }
&lt;/style&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;400&quot; height=&quot;400&quot;&gt;
    Your browser does not support the canvas tag.
  &lt;/canvas&gt;
  &lt;p&gt;
  &lt;button onclick=&quot;start()&quot;&gt;Start animation&lt;/button&gt;
  &lt;button onclick=&quot;stop()&quot;&gt;Stop animation&lt;/button&gt;
  &lt;script&gt;
    var canvas, ctx;
    var monsterX=100, monsterY=100, monsterAngle=0;
    function init() {
      // This function is called after the page is loaded
      // 1 - Get the canvas
      canvas = document.getElementById(&#39;myCanvas&#39;);
      // 2 - Get the context
      ctx=canvas.getContext(&#39;2d&#39;);
    }
    function animationLoop() {
      // 1 - Clear
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      // 2 Draw
      drawMonster(monsterX, monsterY, monsterAngle, &#39;green&#39;, &#39;yellow&#39;);
      // 3 Move
      monsterX += 10;
      monsterX %= canvas.width
      monsterAngle+= 0.01;
      // call again mainloop after 20ms
      requestId = setTimeout(animationLoop, 20);
    }
    function drawMonster(x, y, angle, headColor, eyeColor) {
      // GOOD PRACTICE : SAVE CONTEXT AND RESTORE IT AT THE END
      ctx.save();
      // Moves the coordinate system so that the monster is drawn
      // at position (x, y)
      ctx.translate(x, y);
      ctx.rotate(angle)
      // head
      ctx.fillStyle=headColor;
      ctx.fillRect(0,0,200,200);
      // eyes
      ctx.fillStyle=&#39;red&#39;;
      ctx.fillRect(35,30,20,20);
      ctx.fillRect(140,30,20,20);
      // interior of eye
      ctx.fillStyle=eyeColor;
      ctx.fillRect(43,37,10,10);
      ctx.fillRect(143,37,10,10);
      // Nose
      ctx.fillStyle=&#39;black&#39;;
      ctx.fillRect(90,70,20,80);
      // Mouth
      ctx.fillStyle=&#39;purple&#39;;
      ctx.fillRect(60,165,80,20);
      // GOOD PRACTICE !
      ctx.restore();
    }
    function start() {
      // Start the animation loop, change 20 for bigger
      // values
      requestId = setTimeout(animationLoop, 20);
    }
    function stop() {
      if (requestId) {
        clearTimeout(requestId);
      }
    }
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>This is similar to the previous example except that we called setTimeout(function, delay) instead of setInterval(function, period). As setTimeout runs the function passed as the first parameter only once, we also have to call it at the end of the loop.</p>

<h4>Extract from source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>function animationLoop() {
  // 1 - Clear
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  // 2 Draw
  drawMonster(monsterX, monsterY, monsterAngle, &#39;green&#39;, &#39;yellow&#39;);
  // 3 Move
  monsterX += 10;
  monsterX %= canvas.width
  monsterAngle+= 0.01;
  // call mainloop again after 20ms
  requestId = setTimeout(animationLoop, 20);
}
function start() {
  // Start the animation loop, change 20 for bigger
  // values
  requestId = setTimeout(animationLoop, 20);
}
function stop() {
  if (requestId) {
    clearTimeout(requestId);
  }
}</pre>

</details>

<p>This function is certainly more suitable for doing graphic animation, such as for 
writing an HTML5 game. It will never interrupt an ongoing animation, even if the 
instructions inside the animation loop take too long.</p>

<h4>Problems with setInterval() and setTimeout()</h4>

<p>setTimeout does not “wait”  during the timeout period. It lets the rest of the JavaScript code run. 
It schedules a new call to the function passed as first parameter with a timer running in the background. 
This might cause it to take slightly longer than the expected timeout period to start executing.</p>

<p>This problem also occurs with setInterval, the timing is not “very” reliable. If you plan to run a 
function every 20ms, and if you measure precisely the real timing, sometimes you will discover big 
differences between what is scheduled and what is performed. This is because these methods were 
designed a long time ago, when high precision timers and 60 frames per second animation were not an option.</p>

<p>Here comes the <a href="https://www.w3.org/TR/html51/webappapis.html#animation-frames" 
target="_blank" rel="noopener noreferrer">requestAnimationFrame API,</a> a very good companion to the canvas API!</p>

<p><b>BEST PRACTICE</b>: AVOID using setTimeout for animating in a canvas, except for trivial cases.</p>

<p>For 60 frames/second animation, use requestAnimationFrame!</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch4-2-5">4.2.5 The requestAnimationFrame API</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The best way to make animation at 60 frames per second: requestAnimationFrame!</p>
<p>The requestAnimationFrame(animationLoop) is very similar to setTimeout:</p>

<ul>
  <li>It targets 60 frames/s: requestAnimationFrame asks the browser to schedule a call to the 
    animationLoop function passed as parameter in 1/60th of a second (equivalent to 16.6ms). 
    Keep in mind that most monitors cannot display more than 60 frames per second (FPS). Note 
    that whether humans can tell the difference among high frame rates depends on the application, 
    most games are acceptable above 30 FPS, and virtual reality might require 75 FPS to achieve a 
    natural feel. Some gaming monitors go up to 144 FPS (pro players in e-sport train themselves 
    at Counter Strike with a 150 frames/s rate).</li>
  <li>It calls the function only ONCE, so if you want a continuous animation, like with setTimeout, 
    you need to call again requestAnimationFrame at the end of the animationLoop function.</li>
</ul>

<p>It has, however, several advantages over setInterval and setTimeout:</p>

<ul>
  <li>The scheduling is much more accurate: if the code inside the function can be executed in 
    less than 16.6ms, then the average error between the scheduled time and the real time will 
    be much smaller than with the old functions.</li>
  <li>High resolution timer: even if this difference is small, the function that is called after 
    16.6ms has an extra parameter that is a high resolution time, very useful for writing games 
    that do <a href="https://blog.sklambert.com/using-time-based-animation-implement/" 
    target="_blank" rel="noopener noreferrer"> time-based animation</a>. Time-based animation 
    will be studied in detail in the HTML5 Part 2 course at W3Cx. It is a technique that comprises 
    measuring the amount of time elapsed between two frames, then computing the distance in pixels 
    to move objects on screen so that the visible speed for a human eye remains constant, even if 
    the frame rate is not.</li>
  <li>Multiple animations are merged: browsers can bundle animations happening at the same time 
    into a single paint redraw (thus happening faster/with less CPU cycles), solving the problems 
    that can occur with simultaneous setInterval calls.</li>
  <li>CPU/GPU optimization, battery saved on mobiles:  if the JavaScript execution is occurring 
    in a tab/window which is not visible, it doesn’t have to be drawn. However the animation loop 
    is still executed (objects will be moved, not drawn). This is the same when a mobile phone or 
    tablet screen is black or if the application is put in background.</li>
</ul>

<h4>Typical use</h4>

<p>You will note that  requestAnimationFrame(function) is used like setTimeout(function, delay). 
A call to requestAnimationFrame just asks the browser to call the function passed as a parameter 
ONCE, and the target delay is fixed, and corresponds to a 60 frames/s frame rate (16.6ms). 
Notice that an id is used for stopping an animation with cancelAnimationFrame(id).</p>

<h4>Source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;body onload=&quot;init();&quot;&gt;
&lt;script&gt;
  var canvas, ctx;
  function init() {
    // This function is called after the page is loaded
    // 1 - Get the canvas
    canvas = document.getElementById(&#39;myCanvas&#39;);
    // 2 - Get the context
    ctx=canvas.getContext(&#39;2d&#39;);
    // 3 - start the animation
    startAnimation();
  }
  var id;
  function animationLoop(timeStamp) {
    // 1 - Clear
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    // 2 Draw
    drawShapes(...);
    // 3 Move
    moveShapes(...);
    // call mainloop  again after 16.6ms (corresponds to 60 frames/second)
    id = requestAnimationFrame(animationLoop);
  }
  function startAnimation() {
    id = requestAnimationFrame(animationLoop);
  }
  function stopAnimation() {
    if (id) {
      cancelAnimationFrame(id);
    }
  }
&lt;/script&gt;
&lt;/body&gt;</pre>

</details>

<h4>Example: animate the monster with requestAnimationFrame</h4>

<h4>Check the example below:</h4>

<h4>Source code extract - please compare with the previous example that used setInterval():</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>function animationLoop(timeStamp) {
  // 1 - Clear
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  // 2 - Draw
  drawMonster(monsterX, monsterY, monsterAngle, &#39;green&#39;, &#39;yellow&#39;);
  // 3 - Move
  monsterX += 10;
  monsterX %= canvas.width
  monsterAngle+= 0.01;
  // call mainloop again after 16.6 ms (60 frames/s)
  requestId = requestAnimationFrame(animationLoop);
}
function start() {
  // Start the animation loop, targets 60 frames/s, this
  // calls animationLoop only ONCE!
  requestId = requestAnimationFrame(animationLoop);
}
function stop() {
  if (requestId) {
    cancelAnimationFrame(requestId);
  }
}</pre>

</details>

<p>Notice that calling requestAnimationFrame(animationLoop) at <i>line 19</i>, and after 
that from within the loop at line 14, asks the browser to call the animationLoop function 
so that the delta between calls will be as close as possible to 16.6ms  (this corresponds 
to 1/60th of a second).</p>

<h4>Is the 16.6ms delay really accurate? Can we trust it?</h4>

<p>This target may be hard to reach if:</p>

<ul>
  <li>The animation loop content is too complex,</li>
  <li>The target device that runs the animation is a low end phone or an old computer,</li>
  <li>The scheduler may be a bit late or a bit in advance (even if this kind of error is much 
    smaller with requestAnimationFrame than with setInterval or setTimeout).</li>
</ul>

<p>Many HTML5 games perform what we call a “time-based animation”. For this, we 
need an accurate timer that will tell us the elapsed time between each animation 
frame.</p>

<p>Depending on this time, we can compute the distances that must be achieved by 
each object on the screen in order to move at a constant speed (for a human eye), 
independently of the CPU or GPU of the computer or mobile device that is running 
the game.</p>

<p>The timeStamp parameter of the animationLoop function (<i>line 1</i> in the 
above code) is useful for exactly that: it gives a high resolution time. By 
measuring deltas between two consecutive calls of the animationLoop, we will 
know exactly, with a sub-millisecond accuracy, the elapsed time between two 
frames.</p>

<p>Using time-based animation, and more generally, using the canvas element for 
writing HTML5 games, is part of the W3Cx HTML5 Apps and Games course.</p>

<p>Current <a href="https://caniuse.com/requestanimationframe" 
target="_blank" rel="noopener noreferrer">support</a> is really good and all 
modern browsers support this API.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch4-3-1">4.3.1 Canvas and User Interaction</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>In JavaScript, we treat events made by users as an input, and we
manipulate the DOM structure as an output. Most of the time in
games/animations, we will change state variables of moving objects, such
as position or speed of an alien ship, and the animation loop will take
care of these variables to move the objects.</p>

<p>The events are called <i>DOM events</i>, and we use the <i>DOM
JavaScript API</i> to create <i>event handlers</i>.</p>

<h4>There are three ways to manage events in the DOM structure</h4>

<h4>First method: declare event handlers in the HTML code</h4>

<p>You will often find this in examples on the Web:</p>

<pre>&lt;div id=&quot;someDiv&quot; onclick=&quot;alert(&#39;clicked!&#39;);&quot;&gt;
  content of the div
&lt;/div&gt;</pre>

<p>Note: this is not the recommended way to handle events, even if it’s
very easy to use. Mixing the ‘visual layer’ (HTML) and the ‘logic layer’
(JavaScript) in one place is ok for small examples (we have used this in
some examples in this course) but is not the recommended way for full
scale applications where a clean separation is best.</p>

<h4>Second method: add an event handler to an HTML element in JavaScript</h4>

<h4>Here is an example:</h4>

<pre>document.getElementById(&#39;someDiv&#39;).onclick = function(evt) {
  alert(&#39;clicked!&#39;);
}</pre>

<p>This method is fine, but  you will not be able to attach several
listener functions. If you need to do this, the preferred version is the
next one.</p>

<h4>Third method: register a callback to the event listener with
the addEventListener method</h4>

<h4>This is how we do it:</h4>

<pre>document.getElementById(&#39;someDiv&#39;).addEventListener(&#39;click&#39;, function(evt) {
  alert(&#39;clicked!&#39;);
}, false);</pre>

<p>The third parameter is not important for now, just set it to false,
or simply do not add a third parameter.</p>

<h4>The DOM event that is passed to the event listener function</h4>

<p>When you create an EventListener and attach it to an element,  an
event object will be passed as a parameter to your callback, just like
this:</p>

<pre>element.addEventListener(&#39;click&#39;, function(&lt;b&gt;event&lt;/b&gt;) {
  &lt;b&gt;// now you can use the event object inside the callback&lt;/b&gt;
}, false);</pre>

<p>Depending on the type of event you are listening to, we will use
different properties from the event object in order to get useful
information like: “what keys have been pressed down?”, “what is the
position of the mouse cursor?”, “which mouse button is down?”, etc.</p>

<p>Let’s see next how to deal with the keyboard and the mouse. In
the <a href="https://www.edx.org/course/html5-apps-and-games" target="_blank" rel="noopener noreferrer">W3Cx HTML5
Apps and Games</a>, we look at additional APIs such
as <a href="https://www.w3.org/TR/gamepad/" target="_blank" rel="noopener noreferrer">the gamePad API</a> for
using USB or wireless gamepads/joysticks/game controllers.</p>

<h4>Source code for the knowledge check 4.3.1</h4>

<p><a href="http://jsbin.com/korele/edit" target="_blank" rel="noopener noreferrer">Online example
on JS Bin</a></p>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Click on button&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;button id=&quot;myButton&quot;&gt;Click me!&lt;/button&gt;
  &lt;script&gt;
    var button = document.getElementById(&#39;myButton&#39;);
    // Define a click listener on the button
    button.addEventListener(&#39;click&#39;, processClick;
    // callback
    function processClick(event) {
      console.log(&quot;Button clicked&quot;);
      // What is the event parameter?
    }
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch4-3-2">4.3.2 Keyboard Interaction, Key Events</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>When you listen to keyboard related events (keydown, keyup or keypressed), the event parameter 
passed to the listener function will contain the code of the key that fired the event.  Then it 
is possible to test what key has been pressed or released, like this:</p>

<pre>window.addEventListener(&#39;keydown&#39;, function(event) {
  if (event.keyCode === 37) {
    //left arrow was pressed
  }
}, false);</pre>

<p>At <i>line 2</i>, the value “37” is the key code that corresponds to
the left arrow. It might be difficult to know the correspondences
between real keyboard keys and codes, so here are handy pointers:</p>

<ul>
  <li>Try key codes with this <a href="http://www.asquare.net/javascript/tests/KeyCode.html" target="_blank" rel="noopener noreferrer">interactive test page</a></li>
  <li>And find a list of keyCodes in this <a href="https://css-tricks.com/snippets/javascript/javascript-keycodes/#keycode-values" target="_blank" rel="noopener noreferrer">CSS Tricks article</a>).</li>
</ul>

<h4>Examples</h4>

<h4>Example #1: adding a key listener to the window object</h4>

<p>A lot of people think that the canvas element is not able to get key
events. Many examples on the Web handle key events on canvas by adding a
listener to the window object directly, like this:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 193. add key listener to window object (269) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image193.webp"
  loading="lazy"
  title="Add key listener to window object"
  alt="Add key listener to window object."
  style="width:25%;" />

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Adding a key listener to the window object - Example #1&lt;/title&gt;
  &lt;style&gt;
    #myCanvas {
      border: 1px solid black;
    }
  &lt;/style&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;p&gt;</pre>

<p>This example shows how to handle key events in a canvas by adding a key
listener to the window object. Like that, all key press in the document
will trigger the event listener function.</p>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;canvas id=&quot;myCanvas&quot; width=&quot;350&quot; height=&quot;200&quot;&gt;
&lt;/canvas&gt;
  &lt;script&gt;
    var canvas;
    function init() {
      // This will work when you press a key, anywhere on the document
      window.addEventListener(&#39;keydown&#39;, handleKeydown, false);
    }
    function handleKeydown(e){
      alert(&#39;keycode: &#39;+e.keyCode);
      return false;
    };
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>JS Code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;canvas id=&quot;myCanvas&quot; width=&quot;350&quot; height=&quot;200&quot;&gt;
&lt;/canvas&gt;
  &lt;script&gt;
    function init() {
      // This will work when you press a key, anywhere on the document
      window.addEventListener(&#39;keydown&#39;, handleKeydown, false);
    }
    function handleKeydown(e){
      alert(&#39;keycode: &#39;+e.keyCode);
      return false;
    };
&lt;/script&gt;</pre>

</details>

<p>Indeed this solution works well if you write a game, and want to
detect events wherever the mouse cursor is, and without worrying about
what HTML element has the focus, etc…</p>

<h4>Example #2: moving the monster with the keyboard</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 194. moving the monster with keyboard (270) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image194.webp"
  loading="lazy"
  title="Moving the monster with the keyboard"
  alt="Moving the monster with the keyboard."
  style="width:40%;" />

<h4>HTML, CSS and JS:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Moving the monster with the keyboard - Example #2&lt;/title&gt;
  &lt;style type=&quot;text/css&quot;&gt;
    canvas {
      border:1px solid black;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;400&quot; height=&quot;400&quot;&gt;
    Your browser does not support the canvas tag.
  &lt;/canvas&gt;
  &lt;p&gt;
  &lt;script&gt;
    var canvas, ctx;
    var monsterX=100, monsterY=100, monsterAngle=0;
    var incrementX = 0;
    function init() {
      // This function is called after the page is loaded
      // 1 - Get the canvas
      canvas = document.getElementById(&#39;myCanvas&#39;);
      // 2 - Get the context
      ctx=canvas.getContext(&#39;2d&#39;);
      // 3 add key listeners to the window element
      window.addEventListener(&#39;keydown&#39;, handleKeydown, false);
      window.addEventListener(&#39;keyup&#39;, handleKeyup, false);
       // 4 - start the animation
      requestId = requestAnimationFrame(animationLoop);
    }

    function handleKeydown(evt) {
      if (evt.keyCode === 37) {
        //left key
        incrementX = -1;
      } else if (evt.keyCode === 39) {
      // right key
        incrementX = 1;
      }
    }

    function handleKeyup(evt) {
      incrementX = 0;
    }

    function animationLoop() {
      // 1 - Clear
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      // 2 Draw
      drawMonster(monsterX, monsterY, monsterAngle, &#39;green&#39;, &#39;yellow&#39;);
      // 3 Move
      monsterX += incrementX;
      // call again mainloop after 16.6 ms (60 frames/s)
      requestId = requestAnimationFrame(animationLoop);
    }
    function drawMonster(x, y, angle, headColor, eyeColor) {
      // GOOD PRACTICE : SAVE CONTEXT AND RESTORE IT AT THE END
      ctx.save();
      // Moves the coordinate system so that the monster is drawn
      // at position (x, y)
      ctx.translate(x, y);
      ctx.rotate(angle)
      // head
      ctx.fillStyle=headColor;
      ctx.fillRect(0,0,200,200);
      // eyes
      ctx.fillStyle=&#39;red&#39;;
      ctx.fillRect(35,30,20,20);
      ctx.fillRect(140,30,20,20);
      // interior of eye
      ctx.fillStyle=eyeColor;
      ctx.fillRect(43,37,10,10);
      ctx.fillRect(143,37,10,10);
      // Nose
      ctx.fillStyle=&#39;black&#39;;
      ctx.fillRect(90,70,20,80);
      // Mouth
      ctx.fillStyle=&#39;purple&#39;;
      ctx.fillRect(60,165,80,20);
      // GOOD PRACTICE !
      ctx.restore();
    }
    function start() {
      // Start the animation loop, targets 60 frames/s
      requestId = requestAnimationFrame(animationLoop);
    }
    function stop() {
      if (requestId) {
        cancelAnimationFrame(requestId);
      }
    }
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>JavaScript Function Code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;script&gt;
  var canvas, ctx;
  var monsterX=100, monsterY=100, monsterAngle=0;
  var incrementX = 0;
  function init() {
    // This function is called after the page is loaded
    // 1 - Get the canvas
    canvas = document.getElementById(&#39;myCanvas&#39;);
    // 2 - Get the context
    ctx=canvas.getContext(&#39;2d&#39;);
    // 3 add key listeners to the window element
    window.addEventListener(&#39;keydown&#39;, handleKeydown, false);
    window.addEventListener(&#39;keyup&#39;, handleKeyup, false);
    // 4 - start the animation
    requestId = requestAnimationFrame(animationLoop);
  }
  function handleKeydown(evt) {
    if (evt.keyCode === 37) {
      //left key
         incrementX = -1;
    } else if (evt.keyCode === 39) {
      // right key
      incrementX = 1;
    }
  }
  function handleKeyup(evt) {
    incrementX = 0;
  }
  function animationLoop() {
    // 1 - Clear
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    // 2 Draw
    drawMonster(monsterX, monsterY, monsterAngle, &#39;green&#39;, &#39;yellow&#39;);
    // 3 Move
    monsterX += incrementX;
    // call again mainloop after 16.6 ms (60 frames/s)
    requestId = requestAnimationFrame(animationLoop);
  }
&lt;/script&gt;</pre>

</details>

<h4>Example #3: what if I want to listen to key events only in my canvas?</h4>

<p>If you add a key listener to a canvas element, the problem is that it
will get events only when it has the focus. And by default, it will
never have the focus!</p>

<p>The tabindex attribute of the canvas element makes it focusable.
Without it, it will never get the focus!</p>

<p>The trick is to declare the canvas like this:</p>

<pre>&lt;canvas id=&quot;myCanvas&quot; width=&quot;350&quot; tabindex=&quot;1&quot; height=&quot;200&quot;&gt;
&lt;/canvas&gt;</pre>

<h4>And we force the canvas to get the focus with:</h4>

<pre>canvas=document.getElementById(&#39;myCanvas&#39;);
...
canvas.focus();</pre>

<p>Now, if we try an example with the above canvas declaration, we
show when an HTML element has the focus: a border is added to it.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~ 195. example with focus and added border (273) ~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image195.webp"
  loading="lazy"
  style="width:25%"
  title="Example with focus & added border"
  alt="Example with focus & added border." />

<h4>HTML, CSS and JS:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Listening to key events only in the canvas - Example #3&lt;/title&gt;
  &lt;style type=&quot;text/css&quot;&gt;
    canvas {
      border:1px solid black;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body onload=&quot;init();&quot;&gt;
  This example shows how to handle key events in a canvas by adding a key listener to the canvas object 
  (see the blue border around the canvas... it shows that the canvas has the focus. Try to click outside 
  of the canvas: it will lose the focus).
  &lt;p&gt;
    If you don&#39;t want a border to appear when you click on the canvas, 
    set its style to outline: none
  &lt;/p&gt;
  &lt;p&gt;Press a key when the canvas has the focus: an alert will display the keycode of the key you pressed. 
    Problem: if the canvas looses the focus, key press are no more detected...&lt;/p&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;350&quot; 
    tabindex=&quot;1&quot; height=&quot;200&quot;&gt;
  &lt;/canvas&gt;
  &lt;script&gt;
    var canvas;
    function init() {
      canvas=document.getElementById(&#39;myCanvas&#39;);
      // This will work only if the canvas has the focus
      canvas.addEventListener(&#39;keydown&#39;, handleKeydown, false);
      // We can set the focus on the canvas like that:
      //canvas.focus();
      // ... but it will stop working if we click somewhere else
      // in the document
    }
    function handleKeydown(e){
      alert(&#39;keycode: &#39;+e.keyCode);
      return false;
    };
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>Note that the line that forces the focus to the canvas is commented by default. Try to 
click on the canvas, then press a key, then click out of the canvas, then press a key: 
this time nothing happens!</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~ 196. border appears when canvas has focus (274) ~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image196.webp"
  loading="lazy"
  style="width:40%"
  title="A border appears when the canvas has the focus"
  alt="A border appears when the canvas has the focus." />

<h4>Extract from the code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas;
function init() {
  canvas=document.getElementById(&#39;myCanvas&#39;);
  // This will work only if the canvas has the focus
  canvas.addEventListener(&#39;keydown&#39;, handleKeydown, false);
  // We can set the focus on the canvas like this:
  //canvas.focus();
  // ... but it will stop working if we click somewhere else
  // in the document
}
function handleKeydown(e){
  alert(&#39;keycode: &#39;+e.keyCode);
  return false;
};</pre>

</details>

<p><i>Line 10</i> is useful to initially set the focus on the canvas,
but this trick will not work if we click somewhere else in the HTML
page.</p>

<h4>Example #4: a better way: set the focus when the mouse cursor enters the canvas</h4>

<p>A better way to manage key events on a canvas is to set the focus
when the mouse is over the canvas, and to un-focus it otherwise.</p>

<p>Here is a modified version of the “move monster example” seen
earlier. This time, you move the monster with the left and right arrow
only when the mouse cursor is over the canvas. We added two mouse event
listeners on the canvas: one for the mouseenter event and the other for
the mouseout event.</p>

<p>When the mouse enters the canvas we call canvas.focus() to set the
focus to the canvas, and when the mouse cursor goes out of the canvas,
we call canvas.blur() to unset the focus.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~ 197. setting the focus when the mouse cursor enters the canvas (275) ~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image197.webp"
  loading="lazy"
  style="width:40%"
  title="Setting the focus when the mouse cursor enters the canvas"
  alt="Setting the focus when the mouse cursor enters the canvas." />

<h4>HTML, CSS and JavaScript:</h4>

<details>
  <summary><b>Click to expand!</b></summary>
  
<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Setting the focus when the mouse cursor enters the canvas - Example #4&lt;/title&gt;
  &lt;style type=&quot;text/css&quot;&gt;
    canvas {
      border:1px solid black;
    }
  &lt;/style&gt;
  &lt;/head&gt;
  &lt;body onload=&quot;init();&quot;&gt;
    &lt;canvas id=&quot;myCanvas&quot; tabindex=&quot;1&quot; width=&quot;400&quot; height=&quot;400&quot;&gt;
      Your browser does not support the canvas tag.
    &lt;/canvas&gt;
    &lt;p&gt;
    &lt;script&gt;
      var canvas, ctx;
      var monsterX=100, monsterY=100, monsterAngle=0;
      var incrementX = 0;
      function init() {
        // This function is called after the page is loaded
        // 1 - Get the canvas
        canvas = document.getElementById(&#39;myCanvas&#39;);
        // 2 - Get the context
        ctx=canvas.getContext(&#39;2d&#39;);
        // 3 add key listeners to the window element
        canvas.addEventListener(&#39;keydown&#39;, handleKeydown, false);
        canvas.addEventListener(&#39;keyup&#39;, handleKeyup, false);
        canvas.addEventListener(&#39;mouseenter&#39;, setFocus, false);
        canvas.addEventListener(&#39;mouseout&#39;, unsetFocus, false);
        // 4 - start the animation
        requestId = requestAnimationFrame(animationLoop);
      }
      function setFocus(evt) {
        canvas.focus();
      };
      function unsetFocus(evt) {
        canvas.blur();
        incrementX = 0; // I added this line
      };
      function handleKeydown(evt) {
        if (evt.keyCode === 37) {
          //left key
          incrementX = -1;
        } else if (evt.keyCode === 39) {
          // right key
          incrementX = 1;
        }
      }
      function handleKeyup(evt) {
        incrementX = 0;
      }
      function animationLoop() {
        // 1 - Clear
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        // 2 Draw
        drawMonster(monsterX, monsterY, monsterAngle, &#39;green&#39;, &#39;yellow&#39;);
        // 3 Move
        monsterX += incrementX;
        // call again mainloop after 16.6 ms (60 frames/s)
        requestId = requestAnimationFrame(animationLoop);
      }
      function drawMonster(x, y, angle, headColor, eyeColor) {
        // GOOD PRACTICE : SAVE CONTEXT AND RESTORE IT AT THE END
        ctx.save();
        // Moves the coordinate system so that the monster is drawn
        // at position (x, y)
        ctx.translate(x, y);
        ctx.rotate(angle)
        // head
        ctx.fillStyle=headColor;
        ctx.fillRect(0,0,200,200);
        // eyes
        ctx.fillStyle=&#39;red&#39;;
        ctx.fillRect(35,30,20,20);
        ctx.fillRect(140,30,20,20);
        // interior of eye
        ctx.fillStyle=eyeColor;
        ctx.fillRect(43,37,10,10);
        ctx.fillRect(143,37,10,10);
        // Nose
        ctx.fillStyle=&#39;black&#39;;
        ctx.fillRect(90,70,20,80);
        // Mouth
        ctx.fillStyle=&#39;purple&#39;;
        ctx.fillRect(60,165,80,20);
        // GOOD PRACTICE !
        ctx.restore();
      }
      function start() {
        // Start the animation loop, targets 60 frames/s
        requestId = requestAnimationFrame(animationLoop);
      }
      function stop() {
        if (requestId) {
          cancelAnimationFrame(requestId);
        }
      }
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>JavaScript Code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>function init() {
  // This function is called after the page is loaded
  // 1 - Get the canvas
  canvas = document.getElementById(&#39;myCanvas&#39;);
  // 2 - Get the context
  ctx=canvas.getContext(&#39;2d&#39;);
  // 3 - Add key listeners to the window element
  canvas.addEventListener(&#39;keydown&#39;, handleKeydown, false);
  canvas.addEventListener(&#39;keyup&#39;, handleKeyup, false);
  canvas.addEventListener(&#39;mouseenter&#39;, setFocus, false);
  canvas.addEventListener(&#39;mouseout&#39;, unsetFocus, false);
  // 4 - Start the animation
 requestId = requestAnimationFrame(animationLoop);
}
function setFocus(evt) {
  canvas.focus();
};
function unsetFocus(evt) {
  canvas.blur();
  incrementX = 0; // stop the monster if the mouse exists the canvas
};</pre>

</details>

<p>The third parameter (false) of <i>lines 12</i> and <i>13</i> means
“we do not want to propagate the event to the ancestors of the canvas in
the DOM.”</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch4-3-3">4.3.3 Mouse Interaction, Mouse Events</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Detecting mouse events in a canvas is quite straightforward: you add
an event listener to the canvas, and the browser invokes that listener
when the event occurs.</p>

<p>The example below is about listening to mouseup and mousedown events
(when a user presses or releases any mouse button):</p>

<pre>canvas.addEventListener(&#39;mousedown&#39;, function (evt) {
  // do something with to the mousedown event
});</pre>

<p>The event received by the listener function will be used for getting
the button number or the coordinates of the mouse cursor. Before looking
at different examples, let’s look at the different event types we can
listen to.</p>

<h4>The different mouse events</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 198. mouse events illustrated (278) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image198.webp"
  loading="lazy"
  title="Mouse events illustrated"
  alt="Mouse events illustrated."
  style="width:35%;" />

<p>We saw in the last example how to detect the mouseenter and mouseout events.</p>
<p>There are other events related to the mouse:</p>

<ul>
  <li>mouseleave: similar to mouseout, fired when the mouse leaves the surface 
    of the element. The difference between mouseleave and mouseout is that 
    mouseleave does not fire when the cursor moves over descendant elements, 
    and mouseout is fired when the element moved is outside of the bounds of 
    the original element or is a child of the original element.</li>
  <li>mouseover: the mouse cursor is moving over the element that listens to 
    that event. A mouseover event occurs on an element when you are over it - 
    coming from either its child OR parent element, but a mouseenter event 
    only occurs when the mouse moves from the parent element to the child element.</li>
  <li>mousedown: fired when a mouse button is pressed.</li>
  <li>mouseup: fired when a mouse button is released.</li>
  <li>mouseclick: fired after a mousedown and a mouseup have occured.</li>
  <li>mousemove: fired while the mouse moves over the element. Each time the 
    mouse moves, a new event is fired, unlike with mouseover or mouseenter, 
    where only one event is fired.</li>
</ul>

<h4>The tricky part: accurately getting the mouse position relative to the canvas</h4>

<p>When you listen to any of the above events, the event object (we call
it a “DOM event”), passed to the listener function, has properties that
correspond to the mouse coordinates: clientX and clientY.</p>

<p>However, these are what we call “window coordinates”. Instead of
being relative to the canvas itself, they are relative to the window
(the page).</p>

<p>Most of the time you need to work with the mouse position relative to
the canvas, not to the window, so you must convert the coordinates
between the window and the canvas. This will take into account the
position of the canvas, and the CSS properties that may affect the
canvas position (margin, etc.).</p>

<p>Fortunately, there exists a method for getting the position and size
of any element in the page: getBoundingClientRect().</p>

<p>Play with the example below that show the problem:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~ 199. display mouse cursors position on canvas (279) ~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image199.webp"
  loading="lazy"
  title="Display mouse cursors position on canvas"
  alt="Display mouse cursors position on canvas."
  style="width:25%;" />

<h4>JavaScript</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas, ctx, mousePos, mouseButton;
window.onload = function init() {
  canvas = document.getElementById(&#39;myCanvas&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  canvas.addEventListener(&#39;mousemove&#39;, function (evt) {
    mousePos = getMousePos(canvas, evt);
    var message = &#39;Mouse position: &#39; + mousePos.x + &#39;,&#39; + mousePos.y;
    writeMessage(canvas, message);
  }, false);
  canvas.addEventListener(&#39;mousedown&#39;, function (evt) {
    mouseButton = evt.button;
    var message = &quot;Mouse button &quot; + evt.button + &quot; down at position: &quot; 
    + mousePos.x + &#39;,&#39; + mousePos.y;
    writeMessage(canvas, message);
  }, false);
  canvas.addEventListener(&#39;mouseup&#39;, function (evt) {
    var message = &quot;Mouse up at position: &quot; + mousePos.x + &#39;,&#39; + mousePos.y;
    writeMessage(canvas, message);
  }, false);
};
function writeMessage(canvas, message) {
  ctx.save();
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.font = &#39;18pt Calibri&#39;;
  ctx.fillStyle = &#39;black&#39;;
  ctx.fillText(message, 10, 25);
  ctx.restore();
}
function getMousePos(canvas, evt) {
  // necessary to take into account CSS boudaries
  var rect = canvas.getBoundingClientRect();
  return {
    x: evt.clientX - rect.left,
    y: evt.clientY - rect.top
  };
}</pre>

</details>

<h4>CSS</h4>

<pre>canvas {
  border 1px solid black
}</pre>

<h4>HTML</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Mouse event - Good code&lt;/title&gt;
  &lt;style&gt;
    body {
      margin: 20px;
      padding: 0px;
    }
  &lt;/style&gt;
&lt;/head&gt;
  &lt;body&gt;
    This is a canvas:&lt;p&gt;&lt;/p&gt;
    &lt;canvas id=&quot;myCanvas&quot; width=&quot;578&quot; height=&quot;200&quot;&gt;&lt;/canvas&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>JavaScript</h4>

<pre>function getMousePos(canvas, evt) {
  // necessary to take into account CSS boundaries
  var rect = canvas.getBoundingClientRect();
  return {
    x: evt.clientX - rect.left,
    y: evt.clientY - rect.top
  };
}</pre>

<h4>WRONG code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>...
canvas.addEventListener(&#39;mousemove&#39;, function (evt) {
  mousePos = getMousePos(canvas, evt);
  var message = &#39;Mouse position: &#39; + mousePos.x + &#39;,&#39; + mousePos.y;
  writeMessage(canvas, message);
}, false);
...
function getMousePos(canvas, evt) {
  // WRONG!!!
  return {
    x: evt.clientX,
    y: evt.clientY
  };
}</pre>

</details>

<h4>Here is the result, when the mouse is approximately at the top left corner of the canvas:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~ 200. incorrect mouse position at top left corner of canvas (273) ~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image200.webp"
  loading="lazy"
  title="Bad mouse coordinates"
  alt="Bad mouse coordinates."
  style="width:40%;" />

<h4>GOOD version of the code:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~ 201. corrected code for top left canvas positioning (274) ~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image201.webp"
  loading="lazy"
  title="Corrected code for top left canvas mouse positioning"
  alt="Corrected code for top left canvas mouse positioning."
  style="width:40%;" />

<pre>function getMousePos(canvas, evt) {
  // necessary to take into account CSS boundaries
  var rect = canvas.getBoundingClientRect();
  return {
    x: evt.clientX - rect.left,
    y: evt.clientY - rect.top
  };
}</pre>

<h4>Result (the cursor is approximately at the top left corner):</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 202. now at 0,0 - top left of canvas (274) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image202.webp"
  loading="lazy"
  title="Mouse now at 0,0 - top left of canvas"
  alt="Mouse now at 0,0 - top left of canvas."
  style="width:30%;" />

<h4>How to display the mouse position, and the mouse button that has been pressed or released</h4>

<p>This example uses the previous function for computing the mouse position
correctly. It listens to mousemove, mousedown and mouseup events, and
shows how to get the mouse button number using the evt.button property.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 203. mouse position and pressed or released (274) ~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image203.webp"
  loading="lazy"
  title="Mouse position along with whether its pressed or released"
  alt="Mouse position along with whether its pressed or released."
  style="width:40%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~ 204. move mouse cursor, click and release, see what happens (275) ~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image204.webp"
  loading="lazy"
  title="Mouse event example.  Move, click, release.."
  alt="Mouse event example.  Move, click, release.."
  style="width:40%;" />

<h4>Extract from source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas, ctx, mousePos, mouseButton;
window.onload = function init() {
  canvas = document.getElementById(&#39;myCanvas&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  canvas.addEventListener(&#39;mousemove&#39;, function (evt) {
  mousePos = getMousePos(canvas, evt);
  var message = &#39;Mouse position: &#39; + mousePos.x + &#39;,&#39; + mousePos.y;
  writeMessage(canvas, message);
}, false);
  canvas.addEventListener(&#39;mousedown&#39;, function (evt) {
    mouseButton = evt.button;
    var message = &quot;Mouse button &quot; + evt.button + &quot; down at position: &quot; + mousePos.x + &#39;,&#39; + mousePos.y;
    writeMessage(canvas, message);
  }, false);
  canvas.addEventListener(&#39;mouseup&#39;, function (evt) {
    var message = &quot;Mouse up at position: &quot; + mousePos.x + &#39;,&#39; + mousePos.y;
    writeMessage(canvas, message);
  }, false);
};
function writeMessage(canvas, message) {
  ctx.save();
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.font = &#39;18pt Calibri&#39;;
  ctx.fillStyle = &#39;black&#39;;
  ctx.fillText(message, 10, 25);
  ctx.restore();
}
function getMousePos(canvas, evt) {
  // necessary to take into account CSS boudaries
  var rect = canvas.getBoundingClientRect();
  return {
    x: evt.clientX - rect.left,
    y: evt.clientY - rect.top
  };
}</pre>

</details>

<h4>More examples</h4>

<h4>Example #1: move the monster with the mouse, rotate it when a mouse button is pressed</h4>

<p>This example shows an animation at 60 frames/s using requestAnimationFrame, 
were the monster is drawn at the mouse position, and if a mouse button is pressed, 
the monster starts rotating around its center. If we release the mouse button, 
the rotation stops:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 205. move and rotate the monster with mouse (283) ~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image205.webp"
  loading="lazy"
  title="Move and rotate monster with mouse"
  alt="Move and rotate monster with mouse."
  style="width:40%;" />

<h4>JavaScript code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>var canvas, ctx;
var monsterX=100, monsterY=100, monsterAngle=0;
var incrementX = 0;
var incrementAngle =0;
var mousePos;
function init() {
...
  // 3bis - Add mouse listeners
  canvas.addEventListener(&#39;mousemove&#39;, handleMousemove, false);
  canvas.addEventListener(&#39;mousedown&#39;, handleMousedown, false);
  canvas.addEventListener(&#39;mouseup&#39;, handleMouseup, false);
  // 4 - Start the animation
  requestId = requestAnimationFrame(animationLoop);
}
function handleMousemove(evt) {
  // The mousePos will be taken into account in the animationLoop
  mousePos = getMousePos(canvas, evt);
}
function handleMousedown(evt) {
  // the increment on the angle will be
  // taken into account in the animationLoop
  incrementAngle = 0.1;
}
function handleMouseup(evt) {
  incrementAngle = 0;  // stops the rotation
}
function getMousePos(canvas, evt) {
  ... // same as before
}
...
function animationLoop() {
  // 1 - Clear
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  // 2 - Draw
  drawMonster(monsterX, monsterY, monsterAngle, &#39;green&#39;, &#39;yellow&#39;);
  // 3 - Move
  if(mousePos !== undefined) { // test necessary, maybe the mouse is not yet on canvas
    monsterX = mousePos.x;
    monsterY = mousePos.y;
    monsterAngle += incrementAngle;
  }
  ...
  // call again mainloop after 16.6 ms (60 frames/s)
  requestId = requestAnimationFrame(animationLoop);
}</pre>

</details>

<p>This example shows one very important good practice when doing animation
and interaction: if you want to achieve a smooth animation, set the
state variables 60 times/s inside the animation loop <i>(lines 45-49)</i>,
depending on increments you set in event listeners <i>(lines 23-31)</i>.</p>

<h4>Example #2: draw in a canvas as if you were using a pencil</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 206. draw in a canvas like a pencil (284) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image206.webp"
  loading="lazy"
  title="Draw in canvas like a pencil"
  alt="Draw in canvas like a pencil."
  style="width:40%;" />

<h4>Source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>...
&lt;script&gt;
  var canvas, ctx, previousMousePos;
  ...
  function drawLineImmediate(x1, y1, x2, y2) {
    // a line is a path with a single draw order
    // we need to do this in this example otherwise
    // at each mouse event we would draw the whole path
    // from the beginning. Remember that lines
    // normally are only usable in path mode
    ctx.beginPath();
    ctx.moveTo(x1, y1);
    ctx.lineTo(x2, y2);
    ctx.stroke();
  }
  function handleMouseMove(evt) {
    var mousePos = getMousePos(canvas, evt);
    // Let&#39;s draw some lines that follow the mouse pos
    if (!started) {
      previousMousePos = mousePos; // get the current mouse position
      started = true;
    } else {
      // We need to have two consecutive mouse positions before drawing a line
      drawLineImmediate(previousMousePos.x, previousMousePos.y,
                                mousePos.x,         mousePos.y);
      previousMousePos = mousePos;
    }
  }
  window.onload = function () {
    ...
    started = false;
    canvas.addEventListener(&#39;mousemove&#39;, handleMouseMove, false);
  };
&lt;/script&gt;</pre>

</details>

<p>We had to define a variable started=false; as we cannot draw any line before 
the mouse moved (we need at least two consecutive positions).This is done in the 
test at <i>line 21</i>.</p>

<h4>Example #3: same as example #2 but we draw only when a mouse button is pressed</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~ 207. same as example #1 but draw only when mouse button is depressed (285) ~~~~~~~~~-->
<img class="displayed"
  src="./images/image207.webp"
  loading="lazy"
  title="Same as example #1 but draw only when a mouse button is depressed"
  alt="Same as example #1 but draw only when a mouse button is depressed."
  style="width:45%;" />

<p>We just added mouseup and mousedown listeners, extract from the source code:</p>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>function handleMouseMove(evt) {
  var mousePos = getMousePos(canvas, evt);
  // Let&#39;s draw some lines that follow the mouse pos
  if (painting) {
    drawLineImmediate(previousMousePos.x, previousMousePos.y,
    mousePos.x,         mousePos.y);
    previousMousePos = mousePos;
  }
}
function clicked(evt) {
  previousMousePos = getMousePos(canvas, evt);
  painting = true;
}
function released(evt) {
  painting = false;
}
window.onload = function () {
  canvas = document.getElementById(&#39;myCanvas&#39;);
  ctx = canvas.getContext(&#39;2d&#39;);
  painting = false;
  canvas.addEventListener(&#39;mousemove&#39;, handleMouseMove, false);
  canvas.addEventListener(&#39;mousedown&#39;, clicked);
  canvas.addEventListener(&#39;mouseup&#39;, released);
};</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch4-3-4">4.3.4 Responsive Canvas</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Resizing a canvas can be tricky if we don’t know a few rules that
might not be easily guessed:</p>

<ul>
  <li>Changing the width or height property of a canvas in JavaScript erases its 
    content and resets its context,</li>
  <li>Using percentages (%) in the CSS width and height properties of a canvas 
    does not change its number of pixels/resolution[.] Instead, it scales the 
    existing pixels without erasing the content, giving a blurry effect when a 
    canvas becomes larger, for example.</li>
</ul>

<p>Before looking at how best to handle canvas resizing, let’s see some examples below:</p>

<h4>Examples</h4>

<h4>Example #1: changing the size of a canvas on the fly erases its content!</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 208. example 1 resize and erase (286) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image208.webp"
  loading="lazy"
  style="width:45%;"
  title="Example #1 Changing the size of a canvas on the fly will erase its content."
  alt="Example #1 Changing the size of a canvas on the fly will erase its content." />

<h4>JavaScript code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;script&gt;
  ...
  function resizeCanvas() {
    canvas.width = 300;
  }
&lt;/script&gt;
...
&lt;button onclick=&quot;resizeCanvas();&quot;&gt;
  Click this button to resize the canvas and erase it!
&lt;/button&gt;</pre>

</details>

<h4>Example #2 : resize a canvas using CSS width and height properties with percentages</h4>

<p>This time we are using a similar example as above, but we removed the
button for resizing it, and we set the size of the canvas to 100x100
pixels. Instead of drawing inside, we draw two lines that join the
diagonals.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~ 209. draw two lines that join diagonals on 100 x 100 px canvas (287) ~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image209.webp"
  loading="lazy"
  title="Draw two diagonal lines on 100 x 100 pixel canvas"
  alt="Draw two diagonal lines on 100 x 100 pixel canvas."
  style="width:40%;" />

<p>Then, we added this CSS rule:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~ 210. resize canvas with pixels, not percentages (287) ~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image210.webp"
  loading="lazy"
  title="Resize canvas using pixels, 100 by 100"
  alt="Resize canvas using pixels, 100 by 100."
  style="width:45%;" />

<h4>It’s the same example as before, just adding this CSS code:</h4>

<pre>&lt;style&gt;
  #myCanvas {
    border: 1px solid black;
      width:100%
  }
&lt;/style&gt;</pre>

<p>And the result shows clearly that the resolution is still the same,
only the pixels are bigger!</p>
<p><b><i>BEST PRACTICE: never use CSS percentages on a canvas width or
height!</i></b></p>

<h4>Example #3: a responsive canvas using a resize listener +  a parent element</h4>

<p>This is the trick to create a really responsive canvas:</p>

<ol type="1">
  <li>Embed it in a &lt;div&gt; or in any parent container,</li>
  <li>Use CSS with percentages on the width and the height CSS properties 
    <b>of the parent,</b></li>
  <li>Use a resize listener on the  parent of the canvas,</li>
  <li>Change the width and height properties of the canvas [from the JavaScript 
    resize listener function] (content will be erased),</li>
  <li>Redraw the content, scaled accordingly to the size of the parent.</li>
</ol>

<p>Yep, this is not a straightforward process…</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~ 211. div with canvas inside; div has css width=100% and height=50% (288) ~~~~~~~~~~-->
<img class="displayed"
  src="./images/image211.webp"
  loading="lazy"
  title="DIV and canvas inside: div has css width=100% and height=50%"
  alt="DIV and canvas inside: div has css width=100% and height=50%."
  style="width:40%;" />

<h4>HTML code:</h4>

<pre>&lt;div id=&quot;parentDiv&quot;&gt;
  &lt;canvas id=&quot;myCanvas&quot; width=&quot;100&quot; height=&quot;100&quot; &gt;&lt;/canvas&gt;
&lt;/div&gt;</pre>

<h4>CSS code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;style&gt;
  #parentDiv {
    width:100%;
    height:50%;
    margin-right: 10px;
    border: 1px solid red;
  }
  canvas {
    border: 2px solid black;
  }
&lt;/style&gt;</pre>

</details>

<h4>JavaScript code for the resize event listener:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>function init() {
  ...
  // IMPORTANT: there is NO WAY to listen to a DIV&#39;s resize
  // listen to the window instead.
  window.addEventListener(&#39;resize&#39;,     
    resizeCanvasAccordingToParentSize, false);
  ...
}
function resizeCanvasAccordingToParentSize() {
  // adjust canvas size, take parent&#39;s size, this erases content
  canvas.width = divcanvas.clientWidth;
  canvas.height = divcanvas.clientHeight;
  ...
  // draw something, taking into account the new canvas size
}</pre>

</details>

<h4>See the complete example that corresponds to the above code:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~ 212. try resizing the window, or change percentages in css (289) ~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image212.webp"
  loading="lazy"
  title="Example #4: the same example with the monster"
  alt="Example #4: the same example with the monster."
  style="width:40%;" />

<h4>Example #4: the same example with the monster</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 213. same example but with the monster (289) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image213.webp"
  loading="lazy"
  title="Same as last example with monster"
  alt="Same as last example with monster."
  style="width:40%;" />

<p>When the canvas is resized, its width became smaller than the
monster’s size. We scale down the monster (using ctx.scale!)
The code is very similar to the previous example, we just
replaced drawDiagonals() by drawMonster(…), and we added a test in
the drawMonster(…) function for scaling the monster if it’s bigger than
the canvas width (look at <i>lines 10-16</i>), this is a common
trick:</p>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>function drawMonster(x, y, angle, headColor, eyeColor) {
  // GOOD PRACTICE: SAVE CONTEXT AND RESTORE IT AT THE END
  ctx.save();
  // Moves the coordinate system so that the monster is drawn
  // at position (x, y)
  ctx.translate(x, y);
  ctx.rotate(angle);
  // Adjust the scale of the monster (200x200) if the canvas
  // is too small
  if(canvas.width &lt; 200) {
    var scaleX = canvas.width/200;
    var scaleY = scaleX;
  }
  ctx.scale(scaleX, scaleY);
  // head
  ctx.fillStyle=headColor;
  ctx.fillRect(0,0,200,200);
  ...
}</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch4-4-1">4.4.1 A Glimpse of Advanced Canvas Functionalities</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The canvas API is a “big beast”, and we have presented all the essential 
techniques for drawing and animating. However, we could not fit everything 
in this course. Exotic features that are rarely used by developers, or advanced 
techniques that require more than 20 lines of
JavaScript, have been put aside for 
<a href="https://www.edx.org/course/html5-apps-and-games" 
target="_blank" rel="noopener noreferrer">the W3Cx HTML5 Apps and Games course</a>.</p>

<p>In that course, you will learn:</p>

<ul>
  <li>Techniques useful for writing HTML5 games: time-based animation, advanced 
    user interactions (detecting multiple keys plus mouse plus gamepad plus touch 
    events all at the same time in a  single version of the code), sprite based 
    animation, collision detection, particle animation;<br></li>
  <li>Pixel-level operations: special FX like blue-screen videos and augmented 
    reality;<br></li>
  <li>And many other things, such as: masking/clipping, stacking canvases in layers, 
    composition modes, saving and restoring canvas contents, saving canvas content 
    to disk client-side, drawing a canvas into a canvas, etc.<br></li>
</ul>

<h4>Examples studied in the HTML5 Apps and Games course</h4>

<ul>
  <li>Small game framework / object oriented JavaScript / advanced event handling 
    / collision detection / time based animation - see 
    <a href="https://jsbin.com/jifutoj/1/edit?html,js,console,output" 
    target="_blank" rel="noopener noreferrer">example online</a>.<br></li>
  <li>Sprite based animation: like this 
    <a href="https://jsbin.com/libakum/1/edit?html,js,console,output" 
    target="_blank" rel="noopener noreferrer">one</a> (this is ugly code to 
    demonstrate the principle - in the course we develop a clean, sprite 
    animation framework). Use the arrow keys after clicking in the canvas. 
    It’s better to try in standalone mode (click on the small black arrow 
    in the top right of the JSBin window).</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 214. sprite sheet (290) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image214.webp"
  loading="lazy"
  title="Sprite sheet"
  alt="Sprite sheet."
  style="width:35%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-1-1">5.1.1 HTML5 Forms Introduction - Module 5</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Congratulations! You made it to module 5.
Welcome this time to the wonderful world of HTML5 forms.
There have been no improvements since 1997 to HTML forms.</p>

<p>HTML5 this time comes with a set of new input fields for entering
dates, colors, entering phone numbers, URLs, and so on.
New attributes related to form validation have also been introduced,
and they are related to a new build-in validation system that make
things easier than before without the need to use JavaScript.
However, JavaScript validation API is also available for people who
would like to write their own customized validation system.
These additions are very handy when used on mobile devices but raised
many critics from Web designers, mainly related to their desktop
implementations.</p>

<p>The course discusses all the cases and recommend solutions and good
practices. Of course, like usual, many examples will be provided that
you can run directly this time in the course pages, but also as
standalone examples hosted on the JS Bin Web site. If you try to modify
them or creates your own examples, please share in the discussion forums
as usual. Have fun!</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-2-1">5.2.1 Elements and Attributes</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>With HTML5, forms, which had shown little improvement since 1997,
evolved considerably.  To achieve this, Web developers relied on many
popular JavaScript frameworks for validating input formats, providing
various input GUIs, such as calendars for dates, sliders, etc.
Frameworks such as jQueryUI, Dojo, and Sencha, all provide a widget set
for improving forms. Furthermore, it was time to take into account the
specifics of mobile web applications, where the GUI of a date chooser
cannot be the same as a 400x400 pixel wide calendar on a desktop.
Contextual virtual keyboards provided the way forward on smartphones and
tablets thanks to Apple, Google and others.</p>

<h4>HTML5 took all this into account and thus provides:</h4>

<ul>
  <li>A set of input fields that include a validation API and visual feedback, 
    contextualized keyboards, etc. Of course the look and feel depends on the 
    web browser’s implementations, but  the HTML5 forms specification introduced 
    13 new &lt;input type=…/&gt; fields:  email, tel, color, url, date, datetime, 
    datetime-local, month, week, time, range, number and search.<br></li>
  <li>Built-in validation system: JavaScript API for custom validation, CSS 
    pseudo classes that are useful for changing an input field style depending 
    on the validity of the input.<br></li>
  <li>Other goodies, such as the option to set an input field out of a &lt;form&gt;, 
    new elements such as &lt;datalist&gt; for autocompletion, &lt;output&gt; for 
    feedback, etc.<br></li>
</ul>

<p>Examples of contextual keyboards are shown above; they differ
depending on the type of  &lt;input&gt; fields in the &lt;form&gt;. In
the examples, we can see: email, URL, and phone number. Look at the
different keyboard layouts. The last picture is a date picker from an
IOS phone.</p>

<h4>External resources:</h4>

<ul>
  <li>From the specification: <a href="https://html.spec.whatwg.org/multipage/forms.html" 
    target="_blank" rel="noopener noreferrer">Forms</a></li>
  <li>From MDN’s Web Docs: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form" 
    target="_blank" rel="noopener noreferrer">&lt;form&gt;</a></li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-2-2">5.2.2 Example</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>There is a lot of course content covered this week, and before we get
into all the details of the elements and attributes introduced by
HTML5, we suggest playing with running examples of full featured
forms.</p>

<p>This example was created by a learner (by Mels Le N.) from a previous
version of this course. It uses the geolocation API presented in Module
6 for auto-filling the address input fields.</p>

<p>Feel free to look at the source code in the <a href="https://jsbin.com/sivula/edit?online%20example/" 
target="_blank" rel="noopener noreferrer">JS Bin</a>:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~ 215. auto-fill address input (292) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/sivula/edit?online%20example/" 
target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image215.webp"
  loading="lazy"
  title="Geo-location API is used to auto-fill address input"
  alt="Geo-location API is used to auto-fill address input."
  style="width:45%;" /></a>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-2-3">5.2.3 Input Elements and Attributes</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Live coding video 1: using input elements as widgets to control a Web application</h4>

<h4>Live coding video 2: creating GUI elements dynamically</h4>

<p>Input elements, in particular the elements introduced by HTML5, can
be used as widgets to control the behavior of a Web application. In this
situation, they do not need to be inside a &lt;form&gt; element. We just
bind event listeners to them and we use them as client-side widgets.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 215b. gui: speed, color and size of rectangle (293) ~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image215b.webp"
  loading="lazy"
  title="GUI: to resize, change color and speed"
  alt="GUI: to resize, change color and speed."
  style="width:45%;" />

<h4>Examples</h4>

<p>GUI: Graphical User Interface</p>

<h4>Example #1: choose the color, line width and speed of an animation</h4>

<ul>
  <li><a href="https://jsbin.com/ciwefo/1/edit?html,css,output" target="_blank" rel="noopener noreferrer">Bouncing rectangle without GUI</a></li>
  <li><a href="https://jsbin.com/newojij/1/edit?html,css,output" target="_blank" rel="noopener noreferrer">Bouncing rectangle with GUI</a> (see screenshot at the top right of this page)</li>
</ul>

<h4>Example #2: data visualization control</h4>

<ul>
  <li><a href="https://jsbin.com/UxuCOPa/3/edit?html,js,output" target="_blank" rel="noopener noreferrer">Simple chart without a GUI</a></li>
  <li><a href="https://jsbin.com/gesive/edit?html,js,console,output" target="_blank" rel="noopener noreferrer">Simple chart with a GUI</a> (see screenshot on the right)</li>
  <li><a href="https://jsbin.com/ralonem/1/edit?html,js,output" target="_blank" rel="noopener noreferrer">Final version with different types of charts and a GUI</a> (see screenshot below)</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~ 215c. simple chart without gui (293) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/UxuCOPa/3/edit?html,js,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image215c.webp"
  loading="lazy"
  title="Simple chart without GUI"
  alt="Simple chart without GUI."
  style="width:45%;" /></a>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 215d. simple chart with gui (286) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/gesive/edit?html,js,console,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image215d.webp"
  loading="lazy"
  title="Simple chart with GUI"
  alt="Simple chart with GUI."
  style="width:45%;" /></a>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-2-4">5.2.4 Best Practices</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Live coding video 3: HTML5 forms - best practices</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~ 216a. example #1 html5 forms: personal information (287) ~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/jagodi/edit?html,css,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image216a.webp"
  loading="lazy"
  title="HTML5 forms and best practices, personal information"
  alt="HTML5 forms and best practices, personal information."
  style="width:45%;" /></a>

<p>The example used in the video is
available <a href="https://jsbin.com/jagodi/edit?html,css,output" target="_blank" rel="noopener noreferrer">online at JSBin</a>. A screenshot of the resulted form is shown on the right.</p>

<p>Forms are a way to get user input which is sent to a remote server.
This section of the course focuses on the HTML5 additions to forms, and
as such will only cover the client-side part.</p>

<p>On the server side, you may have PHP, Java, C#, Ruby, Python, etc.
components. There are several ways to collect server-side data from a
form in a Web page: REST Web services, servlets, Microsoft ASP pages,
etc.</p>

<p>On the client side, the forms indicate to which server and how the
data should be sent,  using the action and method attributes
respectively. A &lt;button type=“submit”&gt; or an &lt;input
type=submit&gt; field is used to submit the form content.</p>

<p>For example: &lt;form action=“myServerCode.php”
method=“POST”&gt;…&lt;/form&gt;. Here, we set the URL of the server side
code (myServerCode.php), and the HTTP method that will be used by the
browser for sending the form content (POST).</p>
<p>Another approach is to use JavaScript for sending the form content
with <a href="https://en.wikipedia.org/wiki/Ajax_(programming)" target="_blank" rel="noopener noreferrer">Ajax</a>. This is covered in W3Cx HTML5 Apps and Games course.</p>
<p>This week, let’s study the elements and attributes offered by HTML5,
as well the HTML5 form validation API. </p>
<p>The example shown in the video shows some best practices for writing
accessible forms and does some basic layout using CSS.</p>
<p>The following additional example shows the same best practices but
presents a more complete form with CSS rules to make a nice layout. See
it <a href="https://jsbin.com/zubitex/1/edit?html,output" target="_blank" rel="noopener noreferrer">online</a>,
and illustrated with the screenshot below. It is adapted
from <a href="https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Forms/How_to_structure_an_HTML_form" target="_blank" rel="noopener noreferrer">this
very good MDN’s article “How to structure a web form”</a>.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 216. payment form layout example (288) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/zubitex/1/edit?html,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image216.webp"
  loading="lazy"
  title="Payment form layout example"
  alt="Payment form layout example."
  style="width:35%;" /></a>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-3-1">5.3.1 Accessible Forms</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Forms are commonly used to enable user interaction in Web sites and
Web applications. For example, they are used for login, registering,
commenting, and purchasing.</p>
<p>Since HTML5 provides functionalities to assist with accessibility,
developers should make a concerted effort to mark up Web based forms.
The following two guidelines are to give you a good start to make your
forms accessible:</p>

<ol type="1">
  <li>For every form field, ensure that a descriptive label is provided and use the &lt;label&gt; element to identify each form control.</li>
  <li>For larger or complex forms, use the &lt;fieldset&gt; and &lt;legend&gt; elements to respectively group and associate related form controls.</li>
</ol>

<p>Examples for each of these two basic guidelines are given in the
following pages.</p>

<h4>Further reading</h4>

<p>The WAI Web site hosts
a <a href="https://www.w3.org/WAI/tutorials/forms/" target="_blank" rel="noopener noreferrer">Forms
tutorial</a> where to find all guidelines to follow in order to make
your forms truly accessible: labeling controls, grouping controls, form
instructions, validating input, user notifications, multi-page forms,
and custom controls.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-3-2">5.3.2 Why is this Important?</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Forms can be visually and cognitively complex and difficult to use.
Accessible forms are easier to use for everyone, including people with
disabilities.</p>

<ul>
  <li>People with cognitive disabilities can better understand the form and how to complete it, as making forms accessible improves the layout structure, instructions, and feedback.</li>
  <li>People using speech input can use the labels via voice commands to activate controls and move the focus to the fields that they need to complete.</li>
  <li>People with limited dexterity benefit from large clickable areas that include the labels, especially for smaller controls, such as radio buttons and checkboxes.</li>
  <li>People using screen readers can identify and understand form controls more easily because they are associated with labels, field sets, and other structural elements.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-3-3">5.3.3 Labeling Controls</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Labels need to describe the purpose of the form control</h4>

<p>Form fields and other form controls usually have visible labels, such as “E-mail Address:” as the label for a text field (see figure below).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 217. e-mail form label text (289) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image217.webp"
  loading="lazy"
  title="Email form label text"
  alt="Email form label text."
  style="width:25%;" />

<p>When these labels are marked up correctly, people can interact with
them using only the keyboard, using voice input, and using screen
readers. Also, the label itself becomes clickable, which enables a
person who has difficulty clicking on small radio buttons or checkboxes
to click anywhere on the label text.</p>

<h4>Associating labels explicitly</h4>

<p>Whenever possible, use the label element to explicitly associate text
with form elements. The for attribute of the label must exactly match
the id of the form control. </p>

<h4>Example #1</h4>

<p>Click on the label, not on the input field to see the effect.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 218. first name on form (289) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image218.webp"
  loading="lazy"
  title="First name label text"
  alt="First name label text."
  style="width:25%;" />

<h4>Source code:</h4>

<pre>&lt;label for=&quot;first_name&quot;&gt;Your First Name&lt;/label&gt;
&lt;input id=&quot;first_name&quot; type=&quot;text&quot; name=&quot;fname&quot;/&gt;</pre>

<h4>Example #2</h4>

<p>Note that you can also include the &lt;input&gt; element inside the &lt;label&gt;…&lt;label&gt; element, and also add a &lt;span lang=“en”&gt; for example, to indicate the language used in the label. Sometimes, <a href="https://developer.mozilla.org/en-US/docs/Learn/Forms/How_to_structure_a_web_form#The_%3Clabel%3E_element" target="_blank" rel="noopener noreferrer">nesting labels and inputs can also make CSS styling easier and produce better results with screen readers</a>.</p>

<h4>Source code (with &lt;input&gt; inside the &lt;label&gt;):</h4>

<pre>&lt;label for=first_name&quot;&gt;&lt;span lang=en&quot;&gt;Your First Name&lt;/span&gt;
  &lt;input id=&quot;first_name&quot; type=&quot;text&quot; name=&quot;fname&quot;/&gt;
&lt;/label&gt;</pre>

<h4>Example #3</h4>

<p>Click on the label “Subscribe to newsletter” to see what this does.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 219. first name with subscription check box (290) ~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image219.webp"
  loading="lazy"
  title="First name with subscription check box"
  alt="First name with subscription check box."
  style="width:25%;" />

<h4>Source code:</h4>

<pre>&lt;label for=&quot;firstname&quot;&gt;First name:&lt;/label&gt;
&lt;input type=&quot;text&quot; name=&quot;firstname&quot; id=&quot;firstname&quot;&gt;&lt;br&gt;
&lt;label for=&quot;subscribe&quot;&gt;Subscribe to newsletter&lt;/label&gt;
&lt;input type=&quot;checkbox&quot; name=&quot;subscribe&quot; id=&quot;subscribe&quot;&gt;</pre>

<h4>Labeling buttons</h4>

<p>The label of a &lt;button&gt; element is set inside the element and
can include markup. This allows advanced accessibility hints to be
included, such as marking up language change. Example: &lt;button&gt;Mon
&lt;span lang=“fr”&gt;bouton&lt;/span&gt;&lt;/button&gt;,for a button
with a label in French.</p>
<p>When using the &lt;input&gt; element to create buttons, the label is
set in the value attribute of the element. Example: &lt;input
type=“submit” value=“Please submit”&gt;, renders a text button.</p>

<h4>Source code for the “Submit” and “Cancel” buttons example:</h4>

<pre>&lt;button type=&quot;submit&quot;&gt;Submit&lt;/button&gt;
&lt;button type=&quot;button&quot;&gt;Cancel&lt;/button&gt;
&lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;
&lt;input type=&quot;button&quot; value=&quot;Cancel&quot;&gt;</pre>

<p>These give the same results:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~ 220. submit and cancel buttons (290) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image220.webp"
  loading="lazy"
  title="Example submit and cancel buttons"
  alt="Example submit and cancel buttons."
  style="width:25%;" />

<p><i>Lines 1 and 2</i> render as: <b>Submit Cancel</b></p>
<p>… while <i>lines 3 and 4</i> render as:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 221. label for address (290) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image220.webp"
  loading="lazy"
  title="Example submit and cancel buttons"
  alt="Example submit and cancel buttons."
  style="width:25%;" />

<h4>Source code:</h4>

<pre>&lt;label for=&quot;address&quot;&gt;Enter your address:&lt;/label&gt;&lt;br&gt; &lt;textarea id=&quot;address&quot; name=&quot;addresstext&quot;&gt;&lt;/textarea&gt;</pre>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-3-4">5.3.4 Grouping Controls</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Groupings of form controls, typically groups of related checkboxes
and radio buttons, sometimes require a higher level description.
Grouping related form controls makes forms more understandable for all
users, as related controls are easier to identify.</p>
<h4>Associating related controls with fieldset</h4>
<p>Grouping needs to be carried out visually and in the code, for
example, by using the &lt;fieldset&gt; and &lt;legend&gt; elements to
associate related form controls. The &lt;fieldset&gt; identifies the
entire grouping and &lt;legend&gt; identifies the grouping’s descriptive
text.</p>
<h4>Example #1: radio buttons</h4>
<p>In the example below, there are three radio buttons that allow the
user to choose an output format. Radio button groups should always be
grouped using &lt;fieldset&gt;.</p>

<p>Output format:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 222. label for radio button sample (299) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image222.webp"
  loading="lazy"
  title="Example label for button select"
  alt="Example label for button select."
  style="width:25%;" />

<h4>Source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;fieldset&gt;
  &lt;legend&gt;Output format&lt;/legend&gt;
  &lt;div&gt;
    &lt;input type=&quot;radio&quot; name=&quot;format&quot; id=&quot;txt&quot; value=&quot;txt&quot; checked&gt;
    &lt;label for=&quot;txt&quot;&gt;Text file&lt;/label&gt;
  &lt;/div&gt;
  &lt;div&gt;
    &lt;input type=&quot;radio&quot; name=&quot;format&quot; id=&quot;csv&quot; value=&quot;csv&quot;&gt;
    &lt;label for=&quot;csv&quot;&gt;CSV file&lt;/label&gt;
  &lt;/div&gt;
  [...]
&lt;/fieldset&gt;</pre>

</details>

<h4>Example #2: checkboxes</h4>

<p>In the example below, there are three checkboxes that are all part of
an opt-in function for receiving different types of information.</p>
<p>I want to receive</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 223. label for check box sample (299) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image223.webp"
  loading="lazy"
  title="Example label for check box select"
  alt="Example label for check box select."
  style="width:25%;" />

<h4>Source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;fieldset&gt;
  &lt;legend&gt;I want to receive&lt;/legend&gt;
    &lt;div&gt;
      &lt;input type=&quot;checkbox&quot; name=&quot;newsletter&quot; id=&quot;check_1&quot;&gt;
      &lt;label for=&quot;check_1&quot;&gt;The weekly newsletter&lt;/label&gt;
    &lt;/div&gt;
 [...]
&lt;/fieldset&gt;</pre>

</details>

<h4>Associating related controls with WAI-ARIA</h4>

<p>WAI-ARIA provides a grouping role that functions similarly
to fieldset and legend. For example, a div element can
have role=group to indicate that the contained elements are members of a
group.</p>

<p>WAI-ARIA roles are very important in the accessibility world, and we invite you to see 
an example provided in the 
<a href="https://www.w3.org/WAI/tutorials/forms/grouping/#associating-related-controls-with-wai-aria" 
target="_blank" rel="noopener noreferrer">associated WAI tutorial</a>. See also this MDN’s 
article about about 
<a href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles" target="_blank" 
rel="noopener noreferrer">WAI-ARIA roles</a>.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-4-1">5.4.1 Input Types</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>In this section, we briefly present the input types, attributes, and elements related 
to the forms that came with HTML5. Details are given later, illustrated by multiple 
interactive examples.</p>

<p>Compared to HTML4, HTML5 introduced 13 new input types, covering most of the needs of 
Web developers. HTML5 packages some of the “form best practices” in its specification. 
Web browsers providing native implementation give a boost in performance, and reduce the 
size of JavaScript embedded in complex Web pages.</p>

<p>MDN’s Web docs 
<a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#%3Cinput%3E_types" 
target="_blank" rel="noopener noreferrer">article on &lt;input&gt; types</a> lists all input 
types and highlights those that came with HTML5.</p>

<p>Now, let’s play with some of these input types and attributes.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 223. html4 to html5 time to update (299) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image223.webp"
  loading="lazy"
  style="width:20%;"
  title="HTML4 to HTML5"
  alt="HTML4 to HTML5." />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-4-2">5.4.2 "color"</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>For years, we used hundreds of lines of JavaScript for selecting colors. Now, it’s 
bundled in the browser!</p>

<p>Here is how it looks on some mobile devices:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 224. html input type color - android (299) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image224.webp"
  loading="lazy"
  style="width:40%;"
  title="HTML5 input type=color on an android phone"
  alt="HTML5 input type=color on an android phone." />

<h4>Typical use</h4>
<h4>Inserting a color chooser is as simple as:</h4>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;...&lt;/head&gt;
  &lt;body&gt;
    Choose a color : &lt;b&gt;&lt;input type=&quot;color&quot; value=&quot;#FF00F&quot;/&gt;&lt;/b&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

<p><i>Note</i>: In this chapter we are simplifying the examples, as we usually embed input 
elements in a &lt;form&gt;…&lt;/form&gt;.</p>

<p>Try &lt;input type=“color”&gt; online with this
<a href="https://jsbin.com/cajuzob/1/edit?html,output" target="_blank" rel="noopener noreferrer">
JSBin example</a>. Or do it here in your browser: just click on the purple square below:</p>

<p>Here is the result on Google Chrome (works with other browsers too, though the <i>look 
and feel</i> may differ):</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~ 225. select input type=color (300) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/cajuzob/1/edit?html,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image225.webp"
  loading="lazy"
  style="width:40%;"
  title="Select a color, input type=color"
  alt="Select a color, input type=color." /></a>

<h4>Example: changing the background color of the page</h4>

<p>The &lt;input type=“color”&gt; can fire change or input events. Here is an example that 
changes the background color of the page when a color is chosen. 
<a href="https://jsbin.com/jozuter/1/edit?html,css,js,console,output" 
target="_blank" rel="noopener noreferrer">Try it online at JSBin</a>.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 226. change backgound color of the body (300) ~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/jozuter/1/edit?html,css,js,console,output" target="_blank" 
  rel="noopener noreferrer">
<img class="displayed"
  src="./images/image226.webp"
  loading="lazy"
  style="width:40%;"
  title="Change background color of the page body"
  alt="Change background color of the page body." /></a>

<h4>Source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;&lt;/head&gt;
  &lt;body&gt;
    Select a color : &lt;input type=&quot;color&quot; id=&quot;colorChooser&quot;/&gt;
    &lt;script&gt;
      var colorInputField = document.querySelector(&quot;#colorChooser&quot;);
      colorInputField.addEventListener(&#39;input&#39;, function(evt) {
          document.body.style.backgroundColor = this.value;
      }, false);
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Offer a limited choice of colors</h4>

<p>By default, the color selector offers many options that may either frighten some users 
or just not be appropriate for the purpose of the application. </p>

<p><i>Good news</i>: it is possible to restrict the choices, and also simplify the user 
interface, by using a &lt;datalist&gt; with some &lt;option&gt; elements inside.</p>

<p>Example: click the black rectangle on the right. The following should be displayed:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 227. restricted choice of colors (301) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image227.webp"
  loading="lazy"
  style="width:40%;"
  title="Restricted choice of colors"
  alt="Restricted choice of colors." />
<!-- {width="3.0in" height="1.872483595800525in"} -->

<p><a href="https://jsbin.com/lahapu/edit?html,output" target="_blank" rel="noopener noreferrer">
Online example at JSBin</a></p>

<h4>Source code extract:</h4>

<pre>&lt;input type=&quot;color&quot; value=&quot;#333333&quot; list=&quot;colors&quot;&gt;
&lt;datalist id=&quot;colors&quot;&gt;
  &lt;option&gt;#0000FF&lt;/option&gt;
  &lt;option&gt;#00FF00&lt;/option&gt;
  &lt;option&gt;#FF0000&lt;/option&gt;
&lt;/datalist&gt;</pre>

<p>Note that the id of the &lt;datalist&gt; element should be the same as the value of 
the list attribute of the input field.</p>

<h4>What are the main problems with this element?</h4>

<p>The main criticism that Web designers make about this element is related to its default 
appearance being strongly dependent on the browser and its underlying operating system. 
Changing the <i>look and feel</i> is not possible, except with the use of the options we 
saw in the previous sections of this page. This problem is also true for other input 
elements that renders as complex widgets, like &lt;input type=“date”&gt; and its variants.</p>

<p>Another problem is that there is no way to control where the dialog that contains the 
color chooser will appear - no positioning via CSS or JavaScript is possible. The 
specification does not say anything about how to position it over the page, thus the 
result is vendor specific.</p>

<p>The solution proposed by the W3C and its contributors is called <i>Web Components</i>, 
a new approach for designing HTML5 widgets, that is covered in the W3Cx HTML5 Apps and 
Games course.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-4-3">5.4.3 “date”</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>For years, date and time pickers in HTML forms made Web developers rely heavily on 
JavaScript based widgets. The process is simpler in HTML5, which provides a special 
control to handle this specific kind of data natively.</p>
 
<p>Below are a few screenshots of the HTML5 date picker on several mobile devices. Note 
that the native date pickers of the operating systems are used:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~ 228. december 22, 2011 sample custom reusable widget (302) ~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image228.webp"
  loading="lazy"
  style="width:20%;"
  title="Date picker 1"
  alt="Date picker 1." />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~ 229. 03 oct 2013 sample custom reusable widget (302) ~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image229.webp"
  loading="lazy"
  style="width:10%;"
  title="Date picker 2 on mobile"
  alt="Date picker 2 on mobile." />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~ 230. 2012-09-11 sample custom reusable widget (302) ~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image230.webp"
  loading="lazy"
  style="width:30%;"
  title="Date picker 3 on mobile"
  alt="Date picker 3 on mobile." />

<p>The problem is different on a desktop. While it’s great to have native support for a 
date picker, Web developers would sometimes prefer 100% control over the <i>look and feel</i> 
of the date picker widget. For this purpose, the solution undoubtedly lies with the new 
<a href="https://webcomponents.org/" target="_blank" rel="noopener noreferrer">
Web Components</a> (a way to make custom reusable widgets in HTML/CSS/JS), to be detailed 
in the W3Cx HTML5 Apps and Games course</p>

<p>Why don’t you try it yourself? Just click on this input field: (not in github)</p>
<p>With Firefox, it shows this date picker widget:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 231. firefox date picker widget (302) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image231.webp"
  loading="lazy"
  style="width:20%;"
  title="Firefox desktop date picker widget"
  alt="Firefox desktop date picker widget." />

<p>On non-supported browsers, it defaults to an &lt;input type=“text”&gt; input field.</p>

<h4>Typical use of &lt;input type=“date”&gt;</h4>

<h4>Default use</h4>

<p>The default usage is something like:</p>

<pre>&lt;label for=&quot;birthday&quot;&gt;Choose birthday party date: &lt;/label&gt;
&lt;input type=&quot;date&quot; id=&quot;birthday&quot;&gt;</pre>

<p>Result:             Choose birthday party date:      </p>
<p>Most of the time you will add other attributes to give some
restrictions (choose a date in the past, in the future, only on a
Saturday, etc.).</p>

<h4>Restrict choice to an interval of dates: attributes min, max and value</h4>

<p>The &lt;input type=“date”&gt; comes with several useful attributes.
In particular the value, min and max attributes are used to propose a
default date, a min and a max date, or for defining an interval of
acceptable values.</p>
<p>Try this example: just click the next input
field or <a href="https://jsbin.com/faluta/1/edit?html,output" target="_blank" rel="noopener noreferrer">try it online on JSBin</a> if you want to tweak the source code:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~ 232. only dates between min and max are selectable (303) ~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/faluta/1/edit?html,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image232.webp"
  loading="lazy"
  style="width:40%;"
  title="Only dates between min and max are selectable"
  alt="Only dates between min and max are selectable." /></a>

<!--
![input type = date with min and max attributes. This will render two non selectable areas (dates before min and dates after max). Only the dates between min and max are selectable in the displayed calendar.](./images/image232.webp){width="4.0in" height="2.2641021434820647in"}
-->
<h4>Source code:</h4>

<pre>...
&lt;input type=&quot;date&quot;
  id=&quot;birthdayParty&quot;
  value=&quot;2015-06-20&quot;
  min=&quot;2015-06-20&quot;
  max=&quot;2015-06-30&quot;&gt;
...</pre>

<h4>Choosing one day in a given week, etc. with the step: attribute</h4>

<p>Using the value attribute for setting a date, and using step=7 for
example, will make acceptable only the day of the week that corresponds
to the value’s day (e.g.: only Mondays). Using step=2 will make
acceptable only every other day, etc.</p>
<p>Example: we want to celebrate birthday parties only on Saturdays, <a
href="https://jsbin.com/hudafo/1/edit?html,output" target="_blank" rel="noopener noreferrer">check this on
JSBin</a>! (screenshot from Chrome).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 233. using step to allow only saturdays (304) ~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/hudafo/1/edit?html,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image233.webp"
  loading="lazy"
  style="width:40%;"
  title="Use of the step attribute, allow only Saturdays"
  alt="Use of the step attribute, allow only Saturdays." /></a>

<h4>Extract from source code:</h4>

<pre>&lt;input type=&quot;date&quot;
  id=&quot;birthdayParty&quot;
  value=&quot;2015-06-20&quot;
  min=&quot;2015-06-20&quot;
  max=&quot;2015-06-30&quot;
  step=&quot;7&quot;&gt;</pre>

<h4>Combining with the &lt;datalist&gt; element to restrict the choice of possible values</h4>

<p><a href="https://jsbin.com/gezawe/1/edit?html,output" target="_blank" rel="noopener noreferrer">Online example at JSBin</a> (screenshot from Chrome).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~ 234. only values from datalist are proposed (304) ~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/gezawe/1/edit?html,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image234.webp"
  loading="lazy"
  style="width:40%;"
  title="Restrict choices using a datalist element"
  alt="Restrict choices using a datalist element." /></a>

<h4>Extract from source code:</h4>

<pre>&lt;input type=&quot;date&quot;
  id=&quot;birthdayParty&quot;
  list=&quot;birthdayPartyPossibleDates&quot;
  value=&quot;2015-06-20&quot;&gt;
&lt;datalist id=&quot;birthdayPartyPossibleDates&quot;&gt;
  &lt;option label=&quot;Best for me&quot;&gt;2015-06-20&lt;/option&gt;
  &lt;option label=&quot;Ok for me too &quot;&gt;2015-06-27&lt;/option&gt;
  &lt;option label=&quot;This one is a sunday, hmmm&quot;&gt;2015-06-28&lt;/option&gt;
&lt;/datalist&gt;</pre>

<p><b>The list attribute of the input element must match
the id attribute of the datalist element.</b></p>
<p><b>If you use the min, max, or step attributes with a list attribute,
it may filter the restricted list even
more.</b> Check <a href="https://jsbin.com/gucuxon/1/edit?html,output" target="_blank" rel="noopener noreferrer">this
example on JSBin</a> (tested with Google Chrome), that has a restricted
list of three elements, one of which is filtered because it is not in in
the min/max range.</p>

<h4>Responding to date changes, trying date/time and other variants</h4>

<h4>Listening to the input event</h4>

<p>Here is <a href="https://jsbin.com/ganipuv/edit?html,output" target="_blank" rel="noopener noreferrer">an
interactive example at JSBin</a> where you can change the type of
date/time chooser. It also shows how to listen to the input event when a
date/time is chosen.</p>

<h4>Source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;...&lt;/head&gt;
&lt;body&gt;
  Testing the new date input field.&lt;p&gt;
  Choose a date/time : &lt;input type=&quot;date&quot; id=&quot;date&quot; /&gt;&lt;/p&gt;
  &lt;p&gt;
    You picked: &lt;span id=&quot;pickedDate&quot;&gt;&lt;/span&gt;
  &lt;/p&gt;
  After you have tried the first example, change the value of the &quot;type&quot; attribute to:
  &lt;ul&gt;
    &lt;li&gt;datetime&lt;/li&gt;
    &lt;li&gt;datetime-local&lt;/li&gt;
    &lt;li&gt;time&lt;/li&gt;
    &lt;li&gt;week&lt;/li&gt;
    &lt;li&gt;month&lt;/li&gt;
  &lt;/ul&gt;
    And see the result.
  &lt;script&gt;
    var field = document.querySelector(&quot;#date&quot;);
    var result = document.querySelector(&quot;#pickedDate&quot;);
    field.oninput = function(evt) {
      var date = this.value;
      pickedDate.innerHTML = &quot;&lt;b&gt;&quot;+date+&quot;&lt;/b&gt;&quot;;
    }
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p><i>Lines 20-26</i> show how we can detect a date change using
JavaScript.</p>

<h4>Checking if the chosen date is in the past or in the future using the valueAsDate property</h4>

<p>The object returned to the input event handler has a useful property
named valueAsDate. This is a JavaScript date object that can be compared
to other JavaScript date objects, in particular to the date of the day
we can get with var date = new Date();</p>
<p><a href="https://jsbin.com/renevaf/edit?html,output" target="_blank" rel="noopener noreferrer">The following example at JSBin</a> shows how to ascertain whether a date is in the past or in the future: </p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 235. is date in past or future? (306) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/renevaf/edit?html,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image235.webp"
  loading="lazy"
  style="width:40%;"
  title="Check if date is in the past or future"
  alt="Check if date is in the past or future." /></a>

<p>While if we enter a date in the future:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 236. enter your birth date (306) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image236.webp"
  loading="lazy"
  style="width:30%;"
  title="Enter your Birthdate in the future: bad"
  alt="Enter your Birthdate in the future: bad." />

<h4>Extract from source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;body&gt;
  &lt;label for=&quot;birthDate&quot;&gt;Enter your birth date: &lt;/label&gt;&lt;p&gt;
  &lt;input type=&quot;date&quot; id=&quot;birthDate&quot; &gt;
  &lt;p&gt;
    You picked: &lt;span id=&quot;pickedDate&quot;&gt;&lt;/span&gt;&lt;p&gt;
    &lt;span id=&quot;pastFuture&quot;&gt;&lt;/span&gt;
  &lt;/p&gt;
  &lt;script&gt;
    var field = document.querySelector(&quot;#birthDate&quot;);
    var result = document.querySelector(&quot;#pickedDate&quot;);
    var pastFuture = document.querySelector(&quot;#pastFuture&quot;);
    field.oninput = function(evt) {
      var date = this.value;
      pickedDate.innerHTML = &quot;&lt;b&gt;&quot;+date+&quot;&lt;/b&gt;&quot;;
      if(date.valueAsDate &lt;= new Date()) {
        pastFuture.style.color = &#39;green&#39;;
        pastFuture.innerHTML = &quot;&lt;b&gt;Date in the past, ok!&lt;/b&gt;&quot;
      } else {
        pastFuture.style.color = &#39;red&#39;;
        pastFuture.innerHTML = &quot;&lt;b&gt;Date in the future, you&#39;re not even born!&lt;/b&gt;&quot;
      }
    }
  &lt;/script&gt;
&lt;/body&gt;</pre>

</details>

<p><i>Lines 17-23</i> show how we can compare the date picked in the
calendar widget with the current date. Note that we can compare any
given dates using JavaScript. To check that the chosen date is before
2000 we would do this:</p>

<pre>if(this.valueAsDate &lt;= new Date(2000,1,1)) {
  ...
}
&lt;input type=&quot;datetime&quot;&gt;, &quot;week&quot;, &quot;month&quot;, &quot;datetime-local&quot;, etc.</pre>

<p>The HTML5 specification indicates that we can use &lt;input
type=“date”&gt; and &lt;input type=“time”&gt; while for some years
(before the specification became a frozen standard in October 2014),
other variants were also present, such
as type=datetime, datetime-local, month and week.</p>
<p><a href="https://jsbin.com/supope/1/edit" target="_blank" rel="noopener noreferrer">Here is an interactive example at JSBin</a> where you can change the type of date chooser and
try all the different possible values for the type attribute of date pickers.</p>

<h4>Some screenshots from Opera desktops and Safari IOS:</h4>

<p>&lt;input type=“time”&gt;</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 237. select a time (307) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image237.webp"
  loading="lazy"
  style="width:30%;"
  title="Input type=time, select a time"
  alt="Input type=time, select a time." />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 238. select a date and time (307) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image238.webp"
  loading="lazy"
  style="width:20%;"
  title="Input type=time safari IOS"
  alt="Input type=time safari IOS." />

<p>&lt;input type=“datetime”&gt;</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 239. select a time (307) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image239.webp"
  loading="lazy"
  style="width:20%;"
  title="Screenshot showing on the left the webcam video stream, and on the right the same stream recorded and playable in a HTML video element"
  alt="Screenshot showing on the left the webcam video stream, and on the right the same stream recorded and playable in a HTML video element." />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 240. jun 7, 2011 select date/time (308) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image240.webp"
  loading="lazy"
  style="width:20%;"
  title="Select date/time. Wed 7:29pm, June 7, 2011. Input type=datetime on Safari IOS"
  alt="Select date/time. Wed 7:29pm, June 7, 2011. Input type=datetime on Safari IOS." />

<p>&lt;input type=“datetime-local”&gt;</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~ 241. 2012-02-18 00:08 select date/time (308) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image241.webp"
  loading="lazy"
  style="width:20%;"
  title="Select date and time using datetime-local"
  alt="Select date and time using datetime-local." />

<p>&lt;input type=“week”&gt;:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 242. 2012w07 select a week (308) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image242.webp"
  loading="lazy"
  style="width:40%;"
  title="Select a Week"
  alt="Select a Week." />

<p>&lt;input type=“month”&gt;:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 243. 2012-02 select birthdate month & year (308) ~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image243.webp"
  loading="lazy"
  style="width:40%;"
  title="2012-02 Select month and year of birthdate"
  alt="2012-02 Select month and year of birthdate." />
<!-- width="4.0in" height="1.4222222222222223in"} -->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 244. june 2011 select month & year (309) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image244.webp"
  loading="lazy"
  style="width:20%;"
  title="June, 2011 select input type=month safari"
  alt="June, 2011 select input type=month safari." />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-4-4">5.4.4 “e-mail”, “tel”, “URL”, and “search”</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Let’s study 4 input types: email”, “tel”, “URL” and “search”.</p>

<p>&lt;input type=“email”&gt;</p>

<p>This input type is relatively straightforward to use. In mobile
applications, this new input type pops up a keyboard layout adapted to
email input. Note the “@” key, the “.” key, etc.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 245. mobile email address (309) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image245.webp"
  loading="lazy"
  style="width:20%;"
  title="Contextual mobile keyboard for entering an email address"
  alt="Contextual mobile keyboard for entering an email address." />

<p>This input type is very interesting as it provides default validation
behaviors:</p>

<p>If the value entered looks like an email address (contains a “@”…),
the field is <i>valid</i>, and gets the pseudo CSS class  :valid</p>

<p>If the value entered does not contain an “@”, and does not look like
an email address, the field is <i>invalid</i> and gets the pseudo CSS
class :invalid</p>

<p>See the next example to see this in action. More details will be
presented in a later section dedicated to form validation.</p>

<p>Typical use:
<a href="https://codepen.io/w3devcampus/pen/aWXKWR" target="_blank" rel="noopener noreferrer">
Online example at CodePen</a></p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 246. enter your email (310) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image246.webp"
  loading="lazy"
  style="width:30%;"
  title="Enter your email"
  alt="Enter your email." />
<h6 style="text-align:center;"><a href="https://codepen.io/w3devcampus/pen/aWXKWR"  
target="_blank" rel="noopener noreferrer">CodePen example; enter your email</a>.</h6>

<p>Try it on your browser:</p>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Example of input type=email&lt;/title&gt;
  &lt;style&gt;
    input:invalid {
      background-color:pink;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;label for=&quot;email&quot;&gt;Enter your email &lt;/label&gt;
  &lt;input type=&quot;email&quot; id=&quot;email&quot;&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>Note the CSS rule that turns the background color of the email input
field to pink if a user enters an invalid address (<i>lines 7-8</i>).
Also note that the validation is based only on matching a regular
expression (the address should contain a “@”,  a “.”, etc.). It does not
check if the address is an existing one.</p>

<h4>&lt;input type=“tel”&gt;</h4>

<p>This input field is really useful on smartphones and tablets, as it
makes the browser pop up a keyboard layout suitable for entering phone
numbers:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 247. enter your telephone number (311) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image247.webp"
  loading="lazy"
  style="width:20%;"
  title="Mobile keyboard 1 for input type=tel"
  alt="Mobile keyboard 1 for input type=tel." />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~ 248. other mobile keyboard for input type=tel (311) ~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image248.webp"
  loading="lazy"
  style="width:20%;"
  title="Other mobile keyboard 1 for input type=tel"
  alt="Other mobile keyboard 1 for input type=tel." />

<p>This input type is often used with the new placeholder and pattern attributes that 
are detailed in another section of this course. It is supported by all recent major 
Web browsers, on mobile devices and desktops.</p>

<p><a href="https://codepen.io/w3devcampus/pen/Njozvd" target="_blank" 
rel="noopener noreferrer">Online example on CodePen</a></p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 249. enter a telephone number prompt (312) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image249.webp"
  loading="lazy"
  style="width:30%;"
  title="Enter a telephone number"
  alt="Enter a telephone number." />

<p>Try it in your browser (we used the same CSS for changing the background-
color when the input value is invalid):</p>

<h4>Enter a telephone number:</h4>

<h4>Source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Example of input type=tel&lt;/title&gt;
  &lt;style&gt;
    input:invalid {
      background-color:pink;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;label for=&quot;tel&quot;&gt;Enter a telephone number:&lt;/label&gt;
  &lt;input type=&quot;tel&quot; id=&quot;tel&quot;
  placeholder=&quot;(555) 555-5555&quot;
  pattern=&quot;(?d{3})?[-s]d{3}[-s]d{4}.*?)&quot;/&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>&lt;input type=“URL”&gt;</h4>

<p>This input field is really useful on smartphones and tablets, as it
makes the browser pop up a keyboard layout suitable for entering
URLs:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 250. mobile keyboard for entering urls (313) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image250.webp"
  loading="lazy"
  style="width:20%;"
  title="Mobile keyboard for entering URLs"
  alt="Mobile keyboard for entering URLs." />

<p>This field is also compatible with <i>the validation API</i> (more on this in another section).</p>

<p>Here is an online example that shows the use of the placeholder and pattern attributes 
for entering only URLs that start with ftp:// or https://<br/>
Or try it here in your browser:<br/>
Enter a URL (default validation):<br/>
Enter a URL (custom validation, must start with http, https or ftp):</p>

<h4>Source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head &gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Example of input type=url&lt;/title&gt;
  &lt;style&gt;
    input:invalid {
      background-color: lightPink;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;label for=&quot;url1&quot;&gt;Enter a URL (default validation):&lt;/label&gt;
  &lt;input type=&quot;url&quot; id=&quot;url1&quot;/&gt;
  &lt;p&gt;
  &lt;label for=&quot;url2&quot;&gt;Enter a URL (custom validation, must start with http, https or ftp):&lt;/label&gt;
  &lt;input id=&quot;url2&quot; type=&quot;url&quot; placeholder=&quot;https://www.domain.com&quot;
  pattern=&quot;(http|https|ftp)://[a-zA-Z0-9-./]*&quot;/&gt;&lt;p&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p><i>Lines 16-17</i> show the use of a pattern attribute with a
JavaScript regexp that accepts only URLs starting with http, https or
ftp. More details on the pattern attribute are given in the section that
presents the new HTML5 form attributes.</p>

<h4>&lt;input type=“search”&gt;</h4>

<p>The search type is used for search fields (i.e., for a search
engine). A search field behaves like a regular text field, except that
it may provide some feedback GUI for stopping the current request and
emptying the search field, or it may provide a drop-down list of recent
search results.<br>
<br>The specification does not state what the GUI should look like, so
current implementations show variations in the look and feel.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~ 251. input type=search rendered on a smartphone (314) ~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image251.webp"
  loading="lazy"
  style="width:40%;"
  title="Input type=search rendered on a smartphone"
  alt="Input type=search rendered on a smartphone." />

<h4>Typical use:</h4>

<pre>&lt;label for=&quot;search1&quot;&gt;Simple search: &lt;/label&gt;
  &lt;input type=search id=&quot;search1&quot;&gt;
  &lt;p&gt;
    &lt;label for=&quot;search2&quot;&gt;Search with attribute &lt;code&gt;results=5&lt;/code&gt; (try with Safari): &lt;/label&gt;
    &lt;input type=search id=&quot;search2&quot; results=5&gt;</pre>

<p>Results on Chrome and Opera desktop - notice the small cross on the
right when one enters a value:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 252. simple search chrome & opera (314) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image252.webp"
  loading="lazy"
  style="width:40%;"
  title="Input type=search in google chrome and opera"
  alt="Input type=search in google chrome and opera." />

<p>Same example with Safari desktop, this time the second line with an
attribute results=5 shows a small icon on the left:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 253. simple search safari desktop (314) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image253.webp"
  loading="lazy"
  style="width:40%;"
  title="Input type=search on Safari"
  alt="Input type=search on Safari." />

<p>Example that shows a drop down list of recent searches (Safari screenshot borrowed from <a href="https://www.wufoo.com/html5/types/5-search.html" target="_blank" rel="noopener noreferrer">this excellent site about HTML5 forms that is worth reading</a>):</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 254. drop down list of recent searches (315) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image254.webp"
  loading="lazy"
  style="width:20%;"
  title="Example 2 of input type=search on safari, shows recent results"
  alt="Example 2 of input type=search on safari, shows recent results." />

<h4>Source code for the knowledge check below</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;Example of input type=email&lt;/title&gt;
    &lt;style&gt;
      input:? {
        background-color:pink;
      }
      input:?? {
        background-color:lightGreen;
      }
    &lt;/style&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;label for=&quot;email&quot;&gt;Enter your email:&lt;/label&gt;
    &lt;input type=&quot;email&quot; id=&quot;email&quot;&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-4-5">5.4.5 “number”</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>This input field is useful for entering numerical values (integer or
float), but not for entering zip codes. On desktop implementations and
on some mobile implementations, it provides a user interface with small
vertical arrows for incrementing/decrementing the current value, while
on mobiles it will display a numeric keyboard.</p>

<p>For zip codes, a &lt;input type=“text” pattern=“……”&gt; is
preferable. See examples given in the pattern attribute section of this
course.</p>

<p>Example: <b>&lt;input type=“number” value=“25” min=“0” step=“5” max=“500”/&gt;</b></p>

<h4>Screenshot example taken with a mobile device:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~ 255. input type number display mobile device (332) ~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image255.webp"
  loading="lazy"
  style="width:20%;"
  title="Numeric keyboard on Safari IOS"
  alt="Numeric keyboard on Safari IOS." />

<p>Examples on desktop (the width will be adjusted depending on the min and max 
attributes):</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~ 256. quantity between 1 and 5 (333) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image256.webp"
  loading="lazy"
  style="width:35%;"
  title="Input type=number example. Quantity between 1 and 5"
  alt="Input type=number example. Quantity between 1 and 5." />

<h4>Typical usage</h4>

<pre>&lt;input type=&quot;number&quot; value=&quot;25&quot; min=&quot;0&quot; step=&quot;5&quot; max=&quot;500&quot;/&gt;</pre>

<p>This field accepts specific attributes max, min, step, value (default
displayed value).</p>

<p>This input type is very interesting as it provides default validation
behaviors:</p>

<p>If the value entered using a keyboard is not a valid number, or is
not in the range defined by the min and max attributes, the field
is <i>invalid</i> and gets the pseudo CSS class :invalid.</p>

<p>If the difference between the value you enter and min is a multiple
of step, then it gets the CSS pseudo class :valid , otherwise it will
be <i>invalid</i>. Example: if min=1 and step=5, the field will be valid
with value=1, 6, 11, 16 etc. if min=0, with value=0, 5, 10, 15 etc.</p>

<p><b>WARNING 1</b>: <b>Using a step attribute with an integer value
will make the arrows increment/decrement the current value with
the step value, and [make the input field valid only when ]the
difference between the value you enter and min is a multiple
of step.</b></p>

<p><b>WARNING 2: by default, omitting the step attribute is equivalent
to step=“1”, [so for entering float values, it is necessary to
use step=“any” or step equal to a floating point value such
as step=“0.1”].</b></p>

<p><b>With step=“any”, floating point values are valid, but vertical
arrows will increment/decrement the value by one. If step=“0.1”, arrows
will increment/decrement by 0.1, etc.</b></p>

<p><a href="https://codepen.io/w3devcampus/pen/GJrQzP):" target="_blank" 
rel="noopener noreferrer">Online example in CodePen</a> try changing the 
attribute values, use step=“any” and try float values, etc).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~ 257. change attribute values (333) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image257.webp"
  loading="lazy"
  style="width:40%;"
  title="Change attribute values.  Use step=any and try float values"
  alt="Change attribute values.  Use step=any and try float values." />

<p>Or, do it here in your browser (Manually enter a value that is not in
the range, or not a multiple of 5, try the up and down arrows,
etc.):</p>

<p>Quantity (between 0 and 500, should be a multiple of 5 otherwise it’s
invalid):</p>

<h4>Source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
  ....
  &lt;style&gt;
    #number:invalid {
      background-color:pink;
    }
    #number:valid {
      background-color:lightGreen;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  Example of &lt;code&gt;&lt;input type=number&gt;&lt;/code&gt;:&lt;p&gt;
  &lt;label for=&quot;number&quot;&gt;Quantity (between 0 and 500, should be a multiple of 5 
  otherwise it&#39;s invalid): &lt;/label&gt;
    &lt;input type=&quot;number&quot; id=&quot;number&quot; value=&quot;25&quot; 
      min=&quot;0&quot; step=&quot;5&quot; max=&quot;500&quot;/&gt;
  &lt;p&gt;
    Change the different values for attributes step, max, min, value. Don&#39;t forget to try step=&quot;any&quot; 
      for float values...
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-4-6">5.4.6 “range”</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 258. using zipper as range setting (334) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image258.webp"
  loading="lazy"
  style="width:40%;"
  title="zipper with funny label input type=range"
  alt="zipper with funny label input type=range." />

<p>This input type renders as a slider. It accepts the same attributes
as the &lt;input type=“number”&gt; : min, max, step and value.</p>

<h4>Example of rendering on a desktop:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 259. play with attributes on desktop (334) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image259.webp"
  loading="lazy"
  style="width:30%;"
  title="Example rendering on desktop"
  alt="Example rendering on desktop." />

<h4>And on mobile devices:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 260. on left range, default, vertical (335) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image260.webp"
  loading="lazy"
  style="width:20%;"
  title="Left image, ios range input"
  alt="Left image, ios range input." />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 261. on right range android (335) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image261.webp"
  loading="lazy"
  style="width:20%;"
  title="Right image, android range input"
  alt="Right image, android range input." />

<h4>Typical use</h4>

<p>The basic use is to specify at least the value, min and max attributes, and eventually the step attribute, too:</p>

<pre>&lt;input id=&quot;slider6&quot; type=&quot;range&quot; min=&quot;0&quot; max=&quot;10&quot; step=&quot;2&quot; value=&quot;5&quot;&gt;</pre>

<p>But most of the time, you will need a visual feedback that shows the current value selected by the slider.</p>

<h4><a href="https://codepen.io/w3devcampus/pen/BRMVGW" target="_blank" rel="noopener noreferrer">
This online example on CodePen</a> shows how to add a visual feedback using a very short JavaScript 
function and an &lt;output&gt; element. Just click and drag the small cursor of the slider (or use 
up and down arrow keys when the field has the focus):</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~ 262. add visual feedback with short function (335) ~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image262.webp"
  loading="lazy"
  style="width:40%;"
  title="Add visual feedback with short function"
  alt="Add visual feedback with short function." />

<h4>Source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Example of input type=tel&lt;/title&gt;
  &lt;style&gt;
    #rangeValue1 {
      border:1px solid black;
      padding:2px;
    }
  &lt;/style&gt;
  &lt;script&gt;
    window.onload = function() {
      // Called when the page is loaded, for displaying initial value in the output
      printValue(&#39;slider1&#39;,&#39;rangeValue1&#39;);
    }
    function printValue(sliderId, outputId) {
      var x = document.getElementById(outputId);
      var y = document.getElementById(sliderId);
      x.value = y.value;
    }
  &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;form &gt;
    &lt;label for=&quot;slider1&quot;&gt;Select a value:&lt;/label&gt;
    &lt;input id=&quot;slider1&quot; type=&quot;range&quot;
    min=&quot;100&quot; max=&quot;500&quot; step=&quot;10&quot; value=&quot;150&quot;
    oninput=&quot;printValue(&#39;slider1&#39;,&#39;rangeValue1&#39;)&quot;/&gt;
    &lt;output id=&quot;rangeValue1&quot;&gt;&lt;/output&gt;
  &lt;/form&gt;
  &lt;br/&gt;
  Play with attributes: value, min, max, step...
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Snapping behavior and the step attribute</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 263. example six steps in process (336) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image263.webp"
  loading="lazy"
  style="width:30%;"
  title="Jumps + steps"
  alt="Jumps + steps." />

<p>When you click and drag the slider, it “jumps” to some snap points
corresponding to the integer values of the range defined by
the min and max attributes. The “size of the jumps” depends on the value
of the step attribute.</p>
<p>Try these examples in your browser and look at their behavior:</p>

<pre>value=5 min=0, max=10 step=1:  
value=12 min=10, max=50 step=4:</pre>

<p>Note that in the previous example, the default value displayed is 14,
not 12 (the value just above min plus an integer step value). 12 is not
possible so it’s been “snapped” to 14.</p>

<pre>value=5 min=0, max=10 step=&quot;0.5&quot;:</pre>

<p>In the previous example, it’s necessary to add quotes for
setting step=“0.5” (while HTML5 authorizes not using quotes for setting
integer values to attributes).</p>

<pre>value=5 min=0, max=10 step=&quot;any&quot;:</pre>

<p><b>WARNING</b>: Using a step attribute with an integer value will
make the slider jump corresponding to the step value. By default,
omitting the step attribute is equivalent to step=“1”.</p>
<p>For accepting float values, it is necessary to use step=“any”, or
step equal to a floating point value, such as step=“0.5”.</p>
<p>Adding “ticks” to the range slider using
a &lt;datalist&gt; element</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~ 264. display ticks on a rule at given positions (337) ~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image264.webp"
  loading="lazy"
  style="width:45%;"
  title="Display ticks on a rule at given positions"
  alt="Display ticks on a rule at given positions." />

<h4>Using the &lt;datalist&gt; element, it’s possible to display “ticks” above 
the range slider, at given positions.</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;label for=&quot;slider2&quot;&gt;value=5 min=0, max=10 step=1, ticks at 2, 4, 6, 8 and 10:&lt;/label&gt;
&lt;input id=&quot;slider2&quot; type=&quot;range&quot;
  list=&quot;ticks2&quot;
  min=&quot;0&quot; max=&quot;10&quot; step=&quot;1&quot; value=&quot;5&quot;/&gt;
&lt;datalist id=ticks2&gt;
  &lt;option&gt;0&lt;/option&gt;
  &lt;option&gt;2&lt;/option&gt;
  &lt;option&gt;4&lt;/option&gt;
  &lt;option&gt;6&lt;/option&gt;
  &lt;option&gt;8&lt;/option&gt;
  &lt;option&gt;10&lt;/option&gt;
&lt;/datalist&gt;</pre>

</details>

<h4>Try the sliders below:</h4>

<pre>value=5 min=0, max=10 step=1, ticks at 2, 4, 6, 8 and 10:  
value=20 min=10, max=50 step=5, ticks at 0, 10, 20, 30, 40 and 50:  
value=5 min=0, max=10 step=&quot;0.5&quot;, ticks at 0, 0.5, 1, 2, 4, 8:  
value=5 min=0, max=10 step=&quot;any&quot;, ticks at 0, 5 and 10:</pre>

<h4>External resources</h4>

<ul>
  <li>You can use CSS for “standard” styling (size, color, background color, etc.). 
    However, some custom attributes are available. Check 
    <a href="https://css-tricks.com/styling-cross-browser-compatible-range-inputs-css/" 
    target="_blank" rel="noopener noreferrer">this article from CSS tricks</a>.</li>
  <li>A script that automatically generates ticks, depending on the min, max and step 
    attributes (Codepen from Dudley Storey): <a href="https://codepen.io/dudleystorey/pen/Klnzy" 
    target="_blank" rel="noopener noreferrer">Auto-Generated HTML5 range input Ticks</a></li>
  <li>From CSS{Portal}, a CSS generator help you style the html input range tag, very easy to 
    use: <a href="https://www.cssportal.com/style-input-range/" target="_blank" 
    rel="noopener noreferrer">Style Input Range</a></li>
</ul>

<div style="width: 100%; text-align: center;">
<table>
  <colgroup>
    <col style="width: 67%" />
    <col style="width: 32%" />
  </colgroup>
  <tbody>
    <tr class="odd">
      <td>- <b>name</b></td>
      <td>- <b>form</b></td>
    </tr>
    <tr class="even">
      <td>- <b><i>disabled</i></b>*</td>
      <td>- <b>readonly</b></td>
    </tr>
    <tr class="odd">
      <td>- <b>type</b></td>
      <td>- <b>autocomplete</b></td>
    </tr>
    <tr class="even">
      <td>- <b>maxlength</b></td>
      <td>- <b>autofocus</b></td>
    </tr>
    <tr class="odd">
      <td>- <b>readonly</b></td>
      <td>- <b>list</b></td>
    </tr>
    <tr class="even">
      <td>- <b>size</b></td>
      <td>- <b>pattern</b></td>
    </tr>
    <tr class="odd">
      <td>- <b>value</b></td>
      <td>- <b><i>required</i></b>*</td>
    </tr>
    <tr class="even">
      <td>- <b>alt</b></td>
      <td>- <b>placeholder</b></td>
    </tr>
    <tr class="odd">
      <td>- <b>src</b></td>
      <td>- <b>multiple</b></td>
    </tr>
    <tr class="even">
      <td>- <b>height</b></td>
      <td>- <b>list</b></td>
    </tr>
    <tr class="odd">
      <td>- <b>width</b></td>
      <td>- <b>min</b></td>
    </tr>
    <tr class="even">
      <td>- <b><i>checked</i></b>*</td>
      <td>- <b>max</b></td>
    </tr>
    <tr class="odd">
      <td>- <b><i>align</i></b></td>
      <td>- <b>step</b></td>
    </tr>
    <tr class="even">
      <td></td>
      <td>- <b>formaction</b></td>
    </tr>
    <tr class="odd">
      <td></td>
      <td>- <b>formenctype</b></td>
    </tr>
    <tr class="even">
      <td></td>
      <td>- <b>formmethod</b></td>
    </tr>
    <tr class="odd">
      <td></td>
      <td>- <b>formtarget</b></td>
    </tr>
    <tr class="even">
      <td></td>
      <td>- <b>formnovalidate</b></td>
    </tr>
    <tr class="odd">
      <td>*  pseudoclasses CSS target with :disabled and :checked or :required selectors</td>
      <td></td>
    </tr>
    <tr class="even">
      <td>** <i>align</i> is deprecated, CSS rules should be used instead</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>

<ul>
  <li>MDN’s Web Docs: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/range" target="_blank" rel="noopener noreferrer">&lt;input type=range&gt;</a></li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-5-1">5.5.1 Form Attributes</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>In this chapter, we go over the form attributes that have been introduced by HTML5.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 265. html5 form attributes (338) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image265.webp"
  loading="lazy"
  style="width:25%;"
  title="HTML5 form attributes"
  alt="HTML5 form attributes." />

<p>We have already seen the use of pseudo CSS classes used together with
the input field and form validation
(pattern attribute, input:invalid CSS rule). We also briefly looked at
the use of the placeholder attributes for displaying a helper message in
the input field.</p>

<p>In this section, we cover the rest of the form attributes and provide
further examples of using the previously discussed attributes.</p>

<p>In another part of the course, about form validation and visual
feedback using CSS, we examine some of the most useful attributes in
even greater detail.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-5-2">5.5.2 form</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>This attribute is useful for putting input fields outside the form
itself. The form attribute of an external input field must share the
same value as the id of the form the field belongs to. This is useful
when using &lt;fieldset&gt; elements for making the page/form layout
easier.</p>

<h4>Typical use</h4>

<p><a href="http://codepen.io/w3devcampus/pen/jmdpyv)" target="_blank" rel="noopener noreferrer">
Try this interactive example in CodePen</a>, or try it directly in your browser:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 266. html5 form attributes (339) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image266.webp"
  loading="lazy"
  style="width:40%;"
  title="HTML5 sample form attributes"
  alt="HTML5 sample form attributes." />
<h6 style="text-align:center;"><a href="http://codepen.io/w3devcampus/pen/jmdpyv)" 
target="_blank" rel="noopener noreferrer">CodePen example; HTML5 form attributes</a>.</h6>

<h4>Source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;Example of input type=tel&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;label for=&quot;yourName&quot;&gt;Enter your name:&lt;/label&gt;
    &lt;input type=&quot;text&quot; id=&quot;yourName&quot; name=&quot;yourName&quot; form=&quot;form1&quot;/&gt;
    &lt;p&gt;
    &lt;form id=&quot;form1&quot; action=&quot;sumit.php&quot; method=&quot;post&quot;&gt;
      &lt;fieldset&gt;
        &lt;legend&gt;Choose option&lt;/legend&gt;
        &lt;label for=&quot;free&quot;&gt;Free registering&lt;/label&gt;
        &lt;input type=&quot;checkbox&quot; id=&quot;free&quot;/&gt;
        &lt;label for=&quot;premium&quot;&gt;Premium&lt;/label&gt;
        &lt;input type=&quot;checkbox&quot; id=&quot;premium&quot;/&gt;
        &lt;button type=&quot;submit&quot;&gt;Send form&lt;/button&gt;
      &lt;/fieldset&gt;
    &lt;/form&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p><i>Lines 12</i> and <i>22</i> shows the form attribute. Make sure that its 
value matches the id of the form!</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="5-5-3">5.5.3 autocomplete</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>This attribute applies either to the &lt;form&gt; element or on individual 
&lt;input&gt; elements. It specifies when input fields must autocomplete the 
user’s input based on the user’s typing history.</p>

<p>Possible values of this attribute: on/off.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 267. bright red on off picture (340) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image267.webp"
  loading="lazy"
  style="width:16%;"
  title="On/off funny picture"
  alt="On/off funny picture." />

<p>If applied to the &lt;form&gt; element, all input fields attached to the form 
(inside or linked to it using the form attribute), will have auto-completion set 
by default to the value of the autocomplete attribute of the form.</p>

<p>This default behavior can be overridden by setting it individually to any 
input field inside. In other words: it is possible to have autocomplete “on” 
for the form, and “off” for specific input fields, or vice-versa.</p>

<p>Sometimes this autocomplete behavior is disabled by default in some Web 
browsers, and will need to be adjusted in the preferences/settings.</p>

<p>This attribute targets most input types (those that allow typing in them).</p>

<h4>Typical use</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~ 268. example of use of autocomplete attribute (340) ~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image268.webp"
  loading="lazy"
  style="width:40%;"
  title="Example of use of autocomplete attribute, #1 of 2"
  alt="Example of use of autocomplete attribute, #1 of 2." />

<p>Try it in your browser here:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~ 268b. example of use of autocomplete attribute (323) ~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image268b.webp"
  loading="lazy"
  style="width:40%;"
  title="Example of use of autocomplete attribute, #2 of 2"
  alt="Example of use of autocomplete attribute, #2 of 2." />

<h4>Source code extract:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;form submit=&quot;test.php&quot; method=&quot;post&quot; autocomplete=&quot;on&quot;&gt;
  ...
  &lt;label for=&quot;address&quot;&gt;Enter your address (autocomplete off, overrides the
    form&#39;s autocomplete=on attribute):&lt;/label&gt;
  &lt;input type=&quot;text&quot; id=&quot;address&quot; autocomplete=&quot;off&quot;&gt;
  &lt;p&gt;
  &lt;label for=&quot;address1&quot;&gt;Enter your address (autocomplete on by inheritance of
    the form&#39;s autocomplete=on attribute):&lt;/label&gt;
  &lt;input type=&quot;text&quot; id=&quot;address1&quot;&gt;
  &lt;p&gt;
  &lt;button type=&quot;submit&quot;&gt;Submit&lt;/button&gt;
  ...
&lt;/form&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-5-4">5.5.4 autofocus</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>This attribute is useful for transferring the focus to a field other
than the first field in a page/form (by default the first input field
has the focus).</p>

<p><i>Attention</i>: there must not be more than one element in the
document with the autofocus attribute specified!</p>

<p>This example below illustrates the use of the autofocus attribute:
the focus is put on the second input field of the page. It also shows
the use of  required, placeholder and pattern attributes.</p>

<p>The required attribute makes the input field invalid if kept empty. </p>

<h4>Here is the result in your browser:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 269. example use of autofocus attribute (323) ~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image269.webp"
  loading="lazy"
  style="width:40%;"
  title="Example use of autofocus attribute"
  alt="Example use of autofocus attribute." />

<h4>Extract from source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;form&gt;
  ...
  &lt;input type=&quot;text&quot; id=&quot;test&quot;/&gt;&lt;p&gt;
  ...
  &lt;input id=&quot;name&quot; name=&quot;inputName&quot;
    placeholder=&quot;6 to 9 chars please...&quot;
    pattern=&quot;w{6,9}&quot;
    required
    autofocus
    type=&quot;text&quot;/&gt;
  ...
&lt;/form&gt;</pre>

</details>

<h4>Note about Boolean attributes syntax</h4>

<p>Important: : For “Boolean” attributes, such as autofocus, required, optional, etc., you are able to either write autofocus=“autofocus”, or just use the attribute name “autofocus” without setting a value.</p>

<p>Read <a href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#boolean-attributes" target="_blank" rel="noopener noreferrer">these explanations</a> for a complete description of the syntax of Boolean attributes.</p>

<h4>Source code for the knowledge check 5.5.4</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Example for a knowledge check&lt;/title&gt;
  &lt;/head&gt;
&lt;body&gt;
  &lt;form&gt;
    &lt;label for=&quot;studentID&quot;&gt;Student ID (disabled field, cannot type in it): &lt;/label&gt;
    &lt;input type=&quot;text&quot; value=&quot;S134356&quot; id=&quot;studentID&quot; disabled/&gt;&lt;p&gt;
    &lt;label for=&quot;name&quot;&gt;First name: &lt;/label&gt;
      &lt;input type=&quot;text&quot; id=&quot;firstName&quot;
      placeholder=&quot;John&quot;
      autofocus
    /&gt;
    &lt;label for=&quot;lastName&quot;&gt;Last name: &lt;/label&gt;
    &lt;input type=&quot;text&quot; id=&quot;lastName&quot;
      placeholder=&quot;Smith&quot;
      autofocus
    /&gt;
  &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-5-5">5.5.5 list</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>This attribute works together with the new &lt;datalist&gt; element we already 
studied when we saw the color and date input fields.</p>

<p>This attribute’s value must match the id of a &lt;datalist&gt; element. It is 
useful for providing local auto-completion to some input fields, or for restricting 
the possible values on some others like &lt;input type=date&gt; or &lt;input type=color&gt;.</p>

<p>Here is a small code extract from a more complete example shown in the section 
about the new &lt;datalist&gt; element (see next unit).</p>

<p>Please try it in your  browser (Type “F”, “E”, “O”, C” etc., or just click 
inside the field and use the drop down menu). Note that you can also enter any 
value; if it does not start with one of these letters it will be accepted but 
will not trigger auto-completion.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 270. preferred browser and submit query (325) ~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image270.webp"
  loading="lazy"
  style="width:40%;"
  title="Preferred browser prompt and submit query"
  alt="Preferred browser prompt and submit query." />

<h4>Source code extract:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;form&gt;
  ...
  &lt;input list=&quot;browsers&quot; id=&quot;mybrowser&quot; /&gt;
  &lt;datalist id=&quot;browsers&quot;&gt;
    &lt;option value=&quot;Internet Explorer&quot;&gt;
    &lt;option value=&quot;Firefox&quot;&gt;
    &lt;option value=&quot;Chrome&quot;&gt;
    &lt;option value=&quot;Opera&quot;&gt;
    &lt;option value=&quot;Safari&quot;&gt;
  &lt;/datalist&gt;
  ...
&lt;/form&gt;</pre>

</details>

<p>At <i>lines 3</i> and <i>5</i>, the value of the list attribute of
the input field must match the one of the id of
the &lt;datalist&gt; element.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-5-6">5.5.6 pattern</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The pattern attribute enables the validation of the user’s input on
the fly (also at submission time), based on <b>regular expressions</b>.
It applies to the text, search, url, tel, email, and password input
types.</p>

<p>The pattern attribute follows the syntax of <a
href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions" target="_blank" rel="noopener noreferrer">JavaScript
regular expressions</a>.</p>

<p>A <b>must read</b>: a good catalog of ready-to-go patterns is
available at html5pattern.com, an excellent Web site that proposes
plenty of JavaScript patterns for the pattern attribute of HTML5 forms.
The left hand menu proposes categorized patterns for <a
href="http://html5pattern.com/Postal_Codes" target="_blank" rel="noopener noreferrer">postal codes</a>, <a
href="http://html5pattern.com/Dates" target="_blank" rel="noopener noreferrer">dates</a>, <a
href="http://html5pattern.com/Phones" target="_blank" rel="noopener noreferrer">phones</a>, etc.</p>

<p>You can also try <a href="https://regex101.com/#javascript" target="_blank" rel="noopener noreferrer">this
online JavaScript RegExps tester</a>, and follow <a
href="https://regexone.com/" target="_blank" rel="noopener noreferrer">this tutorial about “using JavaScript RegExps”</a> that has step by step exercises and explanations.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~ 271. html5patterns.com: menu left, categories & patterns right (319) ~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image271.webp"
  loading="lazy"
  style="width:40%;"
  title="Menu on the left, categories and patterns on the right. html5patterns.com"
  alt="Menu on the left, categories and patterns on the right. html5patterns.com." />

<h4>Typical use:</h4>

<p>Just add a pattern attribute with a value that is the JavaScript regular
expression that must match the entire string entered in the field. Note
that the empty string is valid by default (except if
the required attribute is used - this makes empty fields invalid).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 271c. typical use of form validation (319) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image271c.webp"
  loading="lazy"
  style="width:40%;"
  title="Typical use of form validation"
  alt="Typical use of form validation." />

<p>It’s best practice to systematically add a title attribute with a
value that indicates what constitutes a valid entry. More on this in the
section of this course dedicated to form validation.</p>

<pre>&lt;input type=&quot;text&quot; name=&quot;country_code&quot;
  pattern=&quot;[A-Za-z]{3}&quot;
  title=&quot;3 letter country code&quot;
/&gt;</pre>

<h3>Examples</h3>

<h4>Example #1</h4>

<p>Try this <a href="https://jsbin.com/xeyuqux/1/edit?html,output" 
target="_blank" rel="noopener noreferrer">
online example at JSBin</a> or directly in your browser below:</p>

<!--
Please enter a 3 letter country code (green = valid, pink = invalid): ![](./images/image266.wmf)
-->

<p>With the previous example, until the value of the input field is
equal to 3 alphabetic characters, the field is invalid.</p>

<p>As seen in the previous examples, we used some CSS pseudo classes for
automatically setting the background-color of the input field as we
type.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 271b. type multiple email addresses (329) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image271b.webp"
  loading="lazy"
  style="width:40%;"
  title="Green valid, pink invalid.  Type email, name myemail"
  alt="Green valid, pink invalid.  Type email, name myemail." />

<h4>Complete source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Example of the pattern attribute&lt;/title&gt;
  &lt;style&gt;
    input:invalid {
      background-color: lightPink;
    }
    input:valid {
      background-color: lightGreen;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;label for=&quot;code&quot;&gt;Please enter a 3 letter country code:&lt;/label&gt;
  &lt;input type=&quot;text&quot; name=&quot;country_code&quot;
    pattern=&quot;[A-Za-z]{3}&quot;
    title=&quot;3 letter country code&quot;
    id=&quot;code&quot;/&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Example #2: mixing several other attributes with the pattern attribute</h4>

<p>Try this <a href="https://jsbin.com/bozudeg/1/edit?html,output" 
target="_blank" rel="noopener noreferrer">example online</a> or in your browser below:</p>

<p>Attributes used: placeholder (for displaying a ghost example value), pattern, 
required (empty field = invalid)…</p>

<h4>Complete source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Example of use of new HTML5 input field attributes&lt;/title&gt;
  &lt;style&gt;
    input:focus:invalid { background-color: lightPink;}
    input:valid { background-color:lightGreen; }
    input:required {border: 2px solid red; }
    input:optional {border: 2px solid green; }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;p&gt;Attributes used: placeholder (for displaying a ghost example value), pattern, required (empty = invalid)...
  &lt;p&gt;
  &lt;label for=&quot;inputID&quot;&gt;Enter a pseudo (6-12 characters): &lt;/label&gt;
  &lt;input id=&quot;inputID&quot; name=&quot;Name&quot;
    placeholder=&quot;Name&quot;
    pattern=&quot;w{6,12}&quot;
    required
    title=&quot;6-12 characters allowed please&quot;
    type=&quot;text&quot; /&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Example #3: an &lt;input type=“url”&gt; element with a pattern attribute allowing only certain 
protocols</h4>

<p><a href="https://jsbin.com/nulahey/1/edit?html,output)or" 
target="_blank" rel="noopener noreferrer">Online example at JSBin</a> try it in your browser:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~ 271b. input type enter url of your repository (328) ~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/nulahey/1/edit?html,output)or" 
target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image271b.webp"
  loading="lazy"
  style="width:40%;"
  title="Green valid, pink invalid.  Type email, name myemail"
  alt="Green valid, pink invalid.  Type email, name myemail." /></a>

<h4>Source code extract:</h4>

<pre>&lt;input
  id=&quot;website&quot;
  name=&quot;url&quot;
  type=&quot;url&quot;
  placeholder=&quot;http://www.domain.com&quot;
  title=&quot;http, https or ftp allowed&quot;
  pattern=&quot;(http|https|ftp)://[a-zA-Z0-9-./]&quot;
/&gt;</pre>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-5-7">5.5.7 min, max and step</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>These attributes are useful for several input types such
as number, range, date and  time (and other variants).</p>

<p>The min and max attributes are used to set ranges to input fields
that accept numerical values or a date/time.</p>

<p>Their detailed use with these input fields have already been
explained in section 5.4 of this course dedicated to these particular
input field types.</p>

<h4>Typical use:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;input id=&quot;mydate&quot; name=&quot;mydate&quot;
  type=&quot;date&quot;
  min=&quot;2012-01-01&quot;
  max=&quot;2013-01-01&quot;
  value=&quot;2012-01-01&quot;
/&gt;
&lt;input name=&quot;time&quot; id=&quot;time&quot; type=&quot;time&quot;
  min=&quot;09:00&quot;
  max=&quot;17:00&quot;
  value=&quot;12:00&quot;
/&gt;
&lt;input id=&quot;range&quot; name=&quot;range&quot; type=&quot;range&quot; 
      min=&quot;0&quot; 
    max=&quot;100&quot; 
    step=&quot;5&quot;/&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-5-8">5.5.8 multiple</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The multiple attribute is used with email and file input types. It’s
a Boolean attribute, so here are the different syntax possibilities:</p>

<ul>
  <li>&lt;input type=“email|file” multiple&gt;</li>
  <li>&lt;input type=“email|file” multiple=“multiple”&gt;</li>
  <li>&lt;input type=“email|file” multiple=““&gt;</li>
</ul>

<p>With &lt;input type=“email”&gt;</p>

<p>With the &lt;input type=“email”&gt;, this attribute enables the
user to enter <i>a set of addresses, separated by a comma</i> instead of
a single address. Entering several addresses will keep the input
field <i>valid</i>.</p>

<p><a href="https://jsbin.com/mexirif/1/edit?html,output" target="_blank" rel="noopener noreferrer">Online example
at JSBin</a></p>

<p>Or try it below in your browser: type in a list of email addresses
separated by a comma, then look at the input field background color
(pink = invalid, green = valid), and then submit:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~ 271b. input type email - single or multiple (329) ~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image271b.webp"
  loading="lazy"
  style="width:40%;"
  title="Enter one or more email addresses"
  alt="Enter one or more email addresses." />

<h4>Complete source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Jsbin&lt;/title&gt;
  &lt;style&gt;
    input:invalid {
    background-color: lightPink;
  }
    input:valid {
    background-color: lightGreen;
  }
    fieldset {
    border:1px solid;
    padding:20px;
  }
  &lt;/style&gt;
&lt;/head&gt;
 
&lt;body&gt;
  &lt;p&gt;This form uses: &lt;code&gt;&lt;input type=&quot;email&quot;
    name=&quot;myemail&quot; &lt;b&gt;multiple&lt;/b&gt;&gt;&lt;/code&gt;&lt;/p&gt;
 
    &lt;form&gt;
    &lt;fieldset&gt;
      &lt;legend&gt;With the multiple attribute &lt;/legend&gt;
      &lt;label&gt;Enter several email addresses: &lt;/label&gt;
      &lt;input type=&quot;email&quot; name=&quot;myemail&quot; title=&quot;you can enter 
        multiple emails addresses, separated by a comma&quot; multiple/&gt;
      &lt;button&gt;Submit&lt;/button&gt;
    &lt;/fieldset&gt;
  &lt;/form&gt;
  &lt;p&gt;
  &lt;p&gt;This form does not use the multiple attribute:&lt;/p&gt;
 
    &lt;form&gt;
      &lt;fieldset&gt;
          &lt;legend&gt;Without the multiple attribute &lt;/legend&gt;
        &lt;label&gt;Enter several email addresses: &lt;/label&gt;
        &lt;input type=&quot;email&quot; name=&quot;myemail&quot; title=&quot;only one address please!&quot;/&gt;
        &lt;button&gt;Submit&lt;/button&gt;
      &lt;/fieldset&gt;
    &lt;/form&gt;
  &lt;p&gt;
  Type in a list of email addresses separated by a comma. Look at the input field 
    background color (pink = invalid, green = valid), try to submit. &lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p><b>Best practice:  add a title attribute indicating what you expect
as a valid entry</b> (<i>lines 25</i> and <i>38</i>). If you enter bad
values and submit, you will see in the error message the string value of
the title attribute.</p>

<p>With &lt;input type=“file”&gt;</p>

<p>With this type of input field, multiple files can be chosen (whereas
before HTML5, only a single file could be chosen).</p>

<p>Typical use: &lt;input type=file multiple&gt;</p>

<p>Try these in your browser, look at the small variations (text in the
buttons, messages):</p>
<p>Example with &lt;input type=file multiple&gt;</p>

<p>                    Select one or more files: </p>

<p>Example without the multiple attribute:</p>

<p>                    Select only one file: </p>

<p>Use the standard key modifiers (shift, control, command) for
selecting multiple files when the file chooser dialog popup.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-5-9">5.5.9 a warning</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>In the following pages, we present a set of rarely used attributes
introduced by HTML5.</p>

<p>You might just glance at them and/or try the examples. The next pages
cover their usage and you are welcome to use them for future reference
(for those of you who like to cover the topics completely).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-5-10">5.5.10 formaction and formmethod</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>These attributes are targeted to the &lt;input type=“submit”&gt; input fields. They are rarely used.</p>

<pre>&lt;input type=&quot;submit&quot;
formaction=&quot;preview.php&quot; formmethod=&quot;get&quot; value=&quot;Preview&quot;&gt;</pre>

<p>When you use an &lt;input type=“submit”&gt; field with
the formaction attribute, the action attribute value of the form is
overridden. The form will be submitted to the URL / value of
the formaction attribute of the  &lt;input type=“submit”&gt; field.</p>

<p>The formmethod attribute does the same with the
POST/GET method attribute of the form. If an &lt;input
type=“submit”&gt; has a formmethod attribute, it overrides the value of
the method attribute of the form.</p>

<h4>Typical use</h4>

<pre>&lt;form action=&quot;post.php&quot; method=&quot;post&quot;&gt;
  &lt;input type=&quot;submit&quot;
    formaction=&quot;preview.php&quot; formmethod=&quot;get&quot;
    value=&quot;Preview&quot;&gt;
  &lt;input type=&quot;submit&quot; value=&quot;Send&quot;&gt;
&lt;/form&gt;</pre>

<p><i>Line 3</i> overrides the values set in <i>line 1</i>.</p>

<h4>Examples</h4>

<p>Here are two online examples at JSBin:</p>

<ul>
  <li><a href="https://jsbin.com/tequkak/2/edit?html,output" target="_blank" rel="noopener noreferrer">Example 1</a></li>
  <li><a href="https://jsbin.com/tequkak/2/edit?html,output" target="_blank" rel="noopener noreferrer">Example 2</a></li>
</ul>

<p>The first shows a form with two submit buttons: </p>

<ul>
  <li>The first button submits to the default URL specified by the action attribute of the form,</li>
  <li>The second button submits to another action specified by its formaction attribute.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 272. formaction attribute (325) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image272.webp"
  loading="lazy"
  style="width:40%;"
  title="Example of formaction attribute"
  alt="Example of formaction attribute." />

<p>The second example shows a form with two submit buttons:</p>

<ul>
  <li>the first button submits using a GET,</li>
  <li>the second button using a POST:</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 273. formmethod attribute (325) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image273.webp"
  loading="lazy"
  style="width:40%;"
  title="Example of formmethod attribute"
  alt="Example of formmethod attribute." />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-5-11">5.5.11 formnovalidate</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The formnovalidate attribute is targeted to the &lt;input
type=“submit”&gt; input fields. This attribute is rarely used.</p>

<p>This atrribute allows the submission of a form even if it
contains  <i>invalid</i> fields. For example:  a form that has
an &lt;input type=“email”&gt; field or a field required and which are
not filled.</p>

<p>In general, such forms have two submit buttons, one with
the formnovalidate attribute set to a non null value and one
without.</p>

<p>Typical use (<a
href="https://jsbin.com/doceje/1/edit?html,output" target="_blank" rel="noopener noreferrer">online example at
JSBin</a>):</p>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;form action=&quot;form.php&quot;&gt;
  &lt;fieldset&gt;
    &lt;legend&gt;Example of formnovalidate attribute&lt;/legend&gt;
    &lt;label for=&quot;email&quot;&gt;E-mail:&lt;/label&gt;
    &lt;input type=&quot;email&quot; name=&quot;email&quot; id=&quot;email&quot;/&gt;&lt;br&gt;
    &lt;input type=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;br&gt;
    &lt;input type=&quot;submit&quot;
      formnovalidate
      value=&quot;Submit without validation&quot; /&gt;
  &lt;/fieldset&gt;
&lt;/form&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 275a. formnovalidate attribute (326) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image275a.webp"
  loading="lazy"
  title="Example of formnovalidate attribute"
  alt="Example of formnovalidate attribute."
  style="width:40%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-5-12">5.5.12 formtarget</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The formtarget attribute is targeted to the &lt;input
type=“submit”&gt; input fields. This attribute is rarely used.</p>

<p>This attribute’s value indicates where the response from the form
submission should be displayed.</p>

<h4>Typical use</h4>

<pre>&lt;input type=&quot;submit&quot;
  formtarget=&quot;_blank&quot;
  value=&quot;Submit but show results in a new window/tab&quot;&gt;</pre>

<h4>Possible values for the formtarget attributes are:</h4>
<ul>
  <li>_blank: the response is displayed in a new window or tab,</li>
  <li>_self: the response is displayed in the same frame (this is default),</li>
  <li>_parent: the response is displayed in the parent frame,</li>
  <li>_top: the response is displayed in the full body of the window,</li>
  <li>framename: the response is displayed in a named iframe.</li>
</ul>

<h4>Complete example:</h4>

<p><a href="https://jsbin.com/godice/2/edit?html,output" target="_blank" rel="noopener noreferrer">Online example at JSBin </a>or try it in your browser below:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 276a. formtarget attribute (326) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/godice/2/edit?html,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image276a.webp"
  loading="lazy"
  title="Example of formtarget attribute"
  alt="Example of formtarget attribute."
  style="width:40%;" /></a>

<h4>Source code:</h4>

<pre>&lt;form action=&quot;defaultAction.php&quot;&gt;
  &lt;label for=&quot;givenName&quot;&gt;Given name:&lt;/label&gt;
  &lt;input type=&quot;text&quot; name=&quot;givenName&quot; id=&quot;givenName&quot;&gt;&lt;br&gt;
  &lt;label for=&quot;familyName&quot;&gt;Family name:&lt;/label&gt;
  &lt;input type=&quot;text&quot; name=&quot;familyName&quot; id=&quot;familyName&quot;&gt;&lt;br&gt;
  &lt;input type=&quot;submit&quot; value=&quot;Submit as usual&quot;&gt;
  &lt;input type=&quot;submit&quot;
    formtarget=&quot;_blank&quot;
    value=&quot;Submit but show results in a new window/tab&quot;&gt;
&lt;/form&gt;</pre>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-5-13">5.5.13 formenctype</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>A word about the enctype attribute of the &lt;form&gt; element</p>

<p>The enctype attribute existed before HTML5. It is often used together
with forms that contain file input fields. For sending files to a remote
server, we use <b>“<i>multipart</i>” forms</b>. This special encoding of
forms needs to be specified using the enctype attribute, as shown in the
example below:</p>

<p><a href="https://jsbin.com/magexat/3/edit?html,output" target="_blank" rel="noopener noreferrer">Online example at JSBin</a>:</p>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;Jsbin&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;form action=&quot;default.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
      Given name: &lt;input type=&quot;text&quot; name=&quot;gname&quot;&gt;&lt;br&gt;
      Family name: &lt;input type=&quot;text&quot; name=&quot;fname&quot;&gt;&lt;br&gt;
      &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;
    &lt;/form&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

<p>Note that when you send form content using Ajax, this attribute is
not needed, as you will specify the type of data sent to the remote
server in JavaScript, using the <a
href="https://developer.mozilla.org/en-US/docs/Web/API/FormData/Using_FormData_Objects" target="_blank" rel="noopener noreferrer">FormData
object</a>.</p>

<h4>As an attribute of the &lt;input type=“submit” enctype=…&gt; element</h4>

<p>Since HTML5, this attribute can also be used in &lt;input
type=“submit”&gt; input fields.</p>

<p>If an &lt;input type=“submit”&gt; field has this attribute,
then, <b>when submitted using method=POST</b>, the browser will send the
form content encoded with the method specified by
the formenctype attribute. And this overrides the value of
the enctype attribute specified in the &lt;form enctype=…&gt; element
(or its default value, if not present).</p>

<h4>Typical use:</h4>

<pre>&lt;form action=&quot;defaultAction.php&quot;&gt;
  ...
  &lt;input type=&quot;submit&quot; formenctype=&quot;multipart/form-data&quot;
           value=&quot;Submit as Multipart/form-data&quot;&gt;
&lt;/form&gt;</pre>

<h4>The possible values for this field are:</h4>

<ul>
  <li>application/x-www-form-urlencoded: all characters are escaped/encoded before submission, for example, spaces become “+”, accentuated characters are transformed into hexadecimal, etc.</li>
  <li>multipart/form-data: encoding is not done. Usually we use this value for submitting binary data such as images, files, etc.</li>
  <li>text/plain: some encoding is done on standard characters like space (that becomes a “+”), nothing is done for special characters.</li>
</ul>

<h4>Example</h4>

<p><a href="https://jsbin.com/lokukam/4/edit?html,output" target="_blank" rel="noopener noreferrer">Try this
online example at JSBin</a></p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 276. formenctype attribute (335) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/lokukam/4/edit?html,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image276.webp"
  loading="lazy"
  title="Example of use of the formenctype attribute"
  alt="Example of use of the formenctype attribute."
  style="width:40%;" /></a>

<p>Source code:</p>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;Jsbin&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;form action=&quot;defaultAction.php&quot; method=&quot;post&quot;
      enctype=&quot;application/x-www-form-urlencoded&quot;&gt;
      &lt;label for=&quot;givenName&quot;&gt;Given name:&lt;/label&gt;
      &lt;input type=&quot;text&quot; name=&quot;givenName&quot; id=&quot;givenName&quot;&gt;&lt;br&gt;
      &lt;label for=&quot;familyName&quot;&gt;Family name:&lt;/label&gt;
      &lt;input type=&quot;text&quot; name=&quot;familyName&quot; id=&quot;familyName&quot;&gt;&lt;br&gt;
      &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;
      &lt;input type=&quot;submit&quot;
        formenctype=&quot;multipart/form-data&quot;
        value=&quot;Submit as Multipart/form-data&quot;&gt;
    &lt;/form&gt;
    &lt;p&gt;&lt;b&gt;Note:&lt;/b&gt; The formenctype attribute is not supported by all browsers.&lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Explanations and how to see the difference between the two kinds of formenctype values</h4>

<p>If you run <a href="https://jsbin.com/lokukam/4/edit?html,output" target="_blank" rel="noopener noreferrer">this example in the
JSBin</a> standalone mode (click the black arrow on the top right of the
output tab, in JSBin), you should see this:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 277. formenctype example in jsbin (328) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/lokukam/4/edit?html,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image277.webp"
  loading="lazy"
  title="JS Bin in standalone mode"
  alt="JS Bin in standalone mode."
  style="width:40%;" /></a>

<p>Then, open the devtools and go to the “Network” tab, click on the
POST request. Once done, click on the right on the “Header” tab to see
the HTTP headers, and scroll down, you should see the form-data entries
in the header, like in this screenshot:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 278. something went wrong (329) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image278.webp"
  loading="lazy"
  title="blank blank"
  alt="blank blank."
  style="width:40%;" />

<p>And if you start again and click on the left submit button, the one
without the formenctype attribute, you should see that the form content
has been submitted “normally” (default value is “urlencoded”, spaces are
replaced by “+”, etc.). Here is a screenshot of what you should see:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-6-1">5.6.1 HTML5 Forms Elements</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Let’s look at the HTML5 elements related to forms
(specifically: &lt;datalist&gt;, &lt;output&gt;, &lt;meter&gt; 
and &lt;progress&gt; elements).</p>

<div style="width: 100%; text-align: center;">
<table>
  <thead>
    <tr class="header">
      <th>HTML4</th>
      <th>HTML5</th>
    </tr>
  </thead>
  <tbody>
    <tr class="odd">
      <td>- &lt;form&gt;</td>
      <td>- &lt;datalist&gt;</td>
    </tr>
    <tr class="even">
      <td>- &lt;fieldset&gt;</td>
      <td>- &lt;output&gt;</td>
    </tr>
    <tr class="odd">
      <td>- &lt;legend&gt;</td>
      <td>- &lt;meter&gt;</td>
    </tr>
    <tr class="even">
      <td>- &lt;textarea&gt;</td>
      <td>- &lt;progress&gt;</td>
    </tr>
    <tr class="odd">
      <td>- &lt;label&gt;</td>
      <td>- &lt;keygen&gt; *</td>
    </tr>
    <tr class="even">
      <td>- &lt;select&gt;</td>
      <td></td>
    </tr>
    <tr class="odd">
      <td>- &lt;option&gt;</td>
      <td></td>
    </tr>
    <tr class="even">
      <td>- &lt;optgroup&gt;</td>
      <td></td>
    </tr>
    <tr class="odd">
      <td>- &lt;input&gt;</td>
      <td></td>
    </tr>
    <tr class="even">
      <td>- &lt;button&gt;</td>
      <td></td>
    </tr>
    <tr class="odd">
      <td></td>
      <td></td>
    </tr>
    <tr class="even">
      <td>* Not really useful for most developers.</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-6-2">5.6.2 &lt;output&gt;</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The output element represents the result of a computation or user
action. You can see it as a “specialized &lt;div&gt; or &lt;span&gt;”
for displaying interactive results.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 279. output field (330) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image279.webp"
  loading="lazy"
  title="Example of output element use"
  alt="Example of output element use."
  style="width:35%;" />

<h4>Typical use / interactive examples</h4>

<p><a href="https://jsbin.com/yuvani/1/edit?html,output" 
target="_blank" rel="noopener noreferrer">Do not hesitate
to play with the source code of these examples online at JSBin</a>.</p>

<h4>Example #1</h4>

<pre>&lt;form oninput=&quot;o.value=a.valueb.value&quot;&gt;
  &lt;input type=&quot;number&quot; name=&quot;a&quot; id=&quot;a&quot; value=&quot;2&quot;&gt; x
  &lt;input type=&quot;number&quot; name=&quot;b&quot; id=&quot;b&quot; value=&quot;3&quot;&gt; =
  &lt;output for=&quot;a b&quot; name=&quot;o&quot;&gt;6&lt;/output&gt;
&lt;/form&gt;</pre>

<p>The oninput event handler directly uses the &lt;output&gt; element
using the value of its name attribute.</p>

<p>Result (do change the input field values):</p>

<h4>Explanations about the attributes specific to the &lt;output&gt; element:</h4>

<ul>
  <li>for: a space-separated list containing the elements ids whose values went into the calculation.</li>
  <li>name: the name of the element.</li>
  <li>form:  associates the &lt;output&gt; element with its form owner. The value must be the id of a form in the same document. This allows you to place an &lt;output&gt; element outside of the &lt;form&gt; with which it is associated.</li>
</ul>

<h4>Example #2</h4>

<p>Top of Form</p>

<p>50 + =</p>

<p>Bottom of Form</p>

<h4>Source code:</h4>

<pre>&lt;form &gt;
  &lt;input name=&quot;a&quot; value=&quot;50&quot; type=&quot;range&quot;
    oninput=&quot;x.value = a.valueAsNumber + b.valueAsNumber;
    y.value = this.value;&quot;/&gt;
  &lt;output id=&quot;y&quot;&gt;50&lt;/output&gt; +
  &lt;input name=&quot;b&quot; value=&quot;50&quot; type=&quot;number&quot; /&gt; =
  &lt;output name=&quot;x&quot; id=&quot;x&quot; for=&quot;a b&quot;&gt;&lt;/output&gt;
&lt;/form&gt;</pre>

<p>HTML5 has introduced new input field
properties: valueAsNumber and valueAsDate.The last example is similar to
the previous one except that we use an addition instead of a
multiplication.</p>

<p>As input field values are considered as strings by JavaScript,
using x.value = a.value + b.value would result in a string concatenation
instead of an addition. That’s why we use
the valueAsNumber property.</p>

<p>This is why we used the valueAsNumber property also introduced by
HTML5 for some input fields such as &lt;input
type=“range”&gt; and &lt;input type=“number”&gt;, we also encountered
the valueAsDate properties when we studied &lt;input
type=“date”&gt;.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-6-3">5.6.3 &lt;meter&gt;</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The &lt;meter&gt; element displays colored bars to represent numeric
values.</p>

<p>It can be useful to display a colored gauge to show disk usage, to
highlight the relevance of a query result, or the fraction of a voting
population that favours a particular candidate, etc. This element is
often used with the &lt;input type=“range”&gt; field as an instant
feedback indicator.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 280. blood pressure (331) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image280.webp"
  loading="lazy"
  title="Blood pressure meter gauge"
  alt="Blood pressure meter gauge."
  style="width:40%;" />

<p>The &lt;meter&gt; element should not be used to indicate progress.
You should instead use a &lt;progress&gt; element.</p>

<h4>Typical use</h4>

<pre>Storage space used: &lt;meter value=75 min=0 low=20 high=80 max=100 optimum=50&gt;&lt;/meter&gt;</pre>

<p>The &lt;meter&gt; element uses the easy-to-understand value, min, max, 
low, high and optimum attributes.<br>
The optimum attribute, along with min, low, high and max attributes will
affect the color of the bar, and of course the constraint min &lt; low &lt; 
high &lt; max should be respected.</p>

<p>More explanations about the colors and the meaning of
the optimum attribute will come further in this lesson.</p>

<h4>Interactive example</h4>

<p><a href="https://jsbin.com/jumahox/1/edit?html,output" target="_blank" rel="noopener noreferrer">Try the next
example online at JSBin</a> or just play with it in your browser by
dragging the slider below:</p>

<pre>&lt;meter value=75 min=0 low=20 high=80 max=100 optimum=19&gt;&lt;/meter&gt;</pre>

<h4>Grades:</h4>

<h4>Source code of the example:</h4>

<pre>&lt;p&gt;Grades: &lt;meter id=&quot;meter2&quot; value=&quot;75&quot; min=&quot;0&quot; low=&quot;20&quot; high=&quot;80&quot; max=&quot;100&quot;&gt;&lt;/meter&gt;
&lt;input min=&quot;0&quot; max=&quot;100&quot; value=&quot;75&quot; id=&quot;meter2range&quot;
  oninput=&quot;effect(&#39;meter2&#39;, &#39;meter2range&#39;)&quot; type=&quot;range&quot;&gt;
&lt;output id=&quot;meter2val&quot; for=&quot;meter2range&quot;&gt;&lt;/output&gt;&lt;/p&gt;
&lt;script&gt;
  function effect(meter, meterrange) {
    var currVal = document.getElementById(meterrange).value;
    document.getElementById(meter).value = currVal;
    document.getElementById(meter+ &quot;val&quot;).innerHTML = currVal;
  }
&lt;/script&gt;</pre>

<h4>Explanations:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 281. slider example javascript code (332) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image281.webp"
  loading="lazy"
  title="The link between the slider (an &lt;input type=range&gt;) and the meter 
    element is done using an input event handler"
  alt="The link between the slider (an &lt;input type=range&gt;) and the meter element is done using an input event handler."
  style="width:40%;" />

<!-- {width="6.5in" height="2.1131944444444444in"} -->

<p>The link between the slider (an &lt;input type=range&gt;) and the
meter element is done using an input event handler (oninput=“effect(…)”)
at <i>line 4</i>.</p>

<p>The effect JavaScript function will change the current value of the
&lt;meter&gt; element (<i>line 9</i>) and update the displayed html
content of the &lt;output&gt; element (<i>line 10</i>).</p>

<p>The color of the gauge changes depending on the attribute’s
values</p>

<p>The optimum attribute indicates the optimal numeric value and gives
an indication where along the range is considered preferable. Just think
of the &lt;meter&gt; ranges as follows:</p>

<ul>
  <li>Range 1: between min and low</li>
  <li>Range 2: between low and high</li>
  <li>Range 3: between high and max</li>
</ul>

<p>… and depending on the value you set to optimum attribute, one of the
ranges above becomes the “good (optimum)” range.</p>

<p>In the previous example, with the value of the optimum attribute set
to 19, a number between min and low (not inclusive), the Range 1
(between min=0 and low=20) becomes the “good (optimum)” range (displayed
in green), the Range 3 (between high=80 and max=100) becomes the “bad”
(displayed in red color) range, and the Range 2, in the middle, will be
displayed in yellow (not optimum, not bad).</p>

<p>A &lt;meter&gt; element used for displaying blood pressure might be a
good candidate for setting the optimum value to “Range 2”, and
a &lt;meter&gt; element used for displaying memory usage might be a good
candidate for setting the optimum value to “Range 1”, meaning that a low
memory usage is “good”.</p>

<h4>External resources</h4>

<ul>
  <li>From MDN’s Web  Docs: <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meter" target="_blank" rel="noopener noreferrer">The HTML Meter element</a></li>
  <li>Good blog post: <a href="https://www.hongkiat.com/blog/style-html5-meter/" target="_blank" rel="noopener noreferrer">How to use and style the meter element</a></li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-6-4">5.6.4 &lt;progress&gt;</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The &lt;progress&gt; element is similar to &lt;meter&gt; but it is used for
progress bars (i.e., the percentage of a file being uploaded, etc.):</p>

<pre>&lt;progress id=pr value=50 min=0 max=100&gt;</pre>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 282. every mistake you make is progress (333) ~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image282.webp"
  loading="lazy"
  title="Picture of the funny progress meme saying Every mistake you make is progress"
  alt="Picture of the funny progress meme saying Every mistake you make is progress."
  style="width:10%;" />

<h4>Gives:</h4>

<p>The browser calculates the percentage corresponding to the value, min and 
max attributes and adjusts the length of the progress bar accordingly.</p>

<p>If no value attribute is set, the progress bar will display an
“indeterminate look”, that may slightly vary among different browser
implementations.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~ 283. progress with integers (333) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image283.webp"
  loading="lazy"
  title="Indetermined progress bar screenshot"
  alt="Indetermined progress bar screenshot."
  style="width:40%;" />

<h4>Typical use:</h4>

<p><a href="https://jsbin.com/hebiju/edit?html,output" target="_blank" rel="noopener noreferrer">
Here is an online example at JSBin</a>, or try it below in your browser:</p>

<p>This example uses some JavaScript to simulate a download progress by
changing in real time the value attribute.</p>

<p>The progress below is defined like this:</p>

<pre>&lt;progress id=pr value=100 max=1000&gt;</pre>

<h4>Download progress:</h4>

<h4>Source code:</h4>

<pre>Download progress: &lt;progress id=pr value=100 min=0 max=1000&gt;&lt;/progress&gt;
&lt;script&gt;
  var i=0;
  setInterval(function () {
    i = (i+1) %1000;
    document.getElementById(pr).value = i;
  },1);
&lt;/script&gt;</pre>

<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-6-5">5.6.5 &lt;datalist&gt;</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The &lt;datalist&gt; form element is useful for linking a list of
choices to an input element.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 284. input options; web browsers (342) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image284.webp"
  loading="lazy"
  title="Input field choices; web browsers"
  alt="Input field choices; web browsers."
  style="width:30%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~ 285. input options; lookahead (342) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image285.webp"
  loading="lazy"
  title="Another example input field choices with lookahead"
  alt="Another example input field choices with lookahead."
  style="width:30%;" />

<p>We have already seen this element in action with different &lt;input&gt; 
elements, such as &lt;input type=“color”&gt;, &lt;input type=“date”&gt;, 
or &lt;input type=“range”&gt;.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~ 227. color pallette with blue, green, red (342) ~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image227.webp"
  loading="lazy"
  title="Restricted choice of color"
  alt="Restricted choice of color."
  style="width:15%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 286. restricted data list choices (342) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image286.webp"
  loading="lazy"
  title="Restrict choices using a datalist element"
  alt="Restrict choices using a datalist element."
  style="width:35%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 287. slider with min, max, step & ticks (342) ~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image287.webp"
  loading="lazy"
  title="Example of datalist for sliders ticks"
  alt="Example of datalist for sliders ticks."
  style="width:35%;" />
   
<p>It is often “linked” to input fields either for restricting the value
set that can be proposed  (i.e., restricted set of colors or possible
dates, or for displaying slider ticks, as shown above), but it may also
be used in a more general way, for providing client-side auto-completion
without the need to use JavaScript.</p>

<p>It works with the new list attribute of input fields introduced by
HTML5. The id of the &lt;datalist&gt; must match the value of
the list attribute in the input field. A datalist can be shared by
several input fields. It suffices that their list attribute matches the
id of the datalist element.</p>

<p>The input field is related to the datalist that will propose
auto-completion based on &lt;datalist&gt; values.</p>

<h4>Typical use for auto-completion</h4>

<p>Here is an <a href="https://jsbin.com/tiqexel/1/edit?html,output" target="_blank" rel="noopener noreferrer">online example at
JSBin</a>, or try it here in your browser (type the name of your
favorite browser):</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~ 288. what is your favorite browser submit query (343) ~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/tiqexel/1/edit?html,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image288.webp"
  loading="lazy"
  title="What is your favorite browser submit query"
  alt="What is your favorite browser submit query."
  style="width:35%;" /></a>
  
<h4>Source code of this example:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;form action=&quot;demo_form.asp&quot; method=&quot;get&quot;&gt;
  &lt;input list=&quot;browsers&quot; name=&quot;browser&quot; /&gt;
    &lt;datalist id=&quot;browsers&quot;&gt;
      &lt;option value=&quot;Internet Explorer&quot;&gt;
      &lt;option value=&quot;Firefox&quot;&gt;
      &lt;option value=&quot;Chrome&quot;&gt;
      &lt;option value=&quot;Opera&quot;&gt;
      &lt;option value=&quot;Safari&quot;&gt;
    &lt;/datalist&gt;
  &lt;input type=&quot;submit&quot; /&gt;
&lt;/form&gt;</pre>

</details>

<p>As you can see at <i>lines 2 and 4</i>, the id and list attributes
match. The &lt;datalist&gt; element is wrapped around a
set of &lt;option&gt; that are available for selection by another form
control (in this example the input field from <i>line 2</i>).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-7-1">5.7.1 Form Validation API</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>In this section of the course, we will look at CSS pseudo classes
that are useful for giving instant feedback when the user’s input is not
valid. We will also look at the new JavaScript API introduced by HTML5
for validating forms and form elements.</p>

<p>In the following pages, we will first illustrate the concept of form
validation with the &lt;input type=“email”/&gt; field. It can be
generalized to all kind of input types, such as url, number, etc. Some
form attributes, such as pattern,  will also affect input field
validity!</p>

<p>Form validation is <a
href="https://caniuse.com/#feat=form-validation" target="_blank" rel="noopener noreferrer">supported</a> by
all modern browsers.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-7-2">5.7.2 Automate Visual Feedback While Typing</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Most modern browsers propose default behavior for validating input
fields and forms.</p>

<p>The built-in validation system that comes with HTML5 automatically
adds a CSS pseudo class to all input fields. Invalid fields (i.e. a
badly worded email address in an &lt;input type=“email”&gt; input
field), will inherit the :invalid pseudo class, valid fields will
inherit the :valid pseudo class.</p>

<p>A first step to improve your HTML form is to add some CSS rules to
your input fields. This adds visual feedback to the validity of input
fields values - while the user is typing - such as changing the color of
the border of input fields, or green/red icons on the right of the
field, as shown in the small picture at the top right of this page.</p>
<p>Also, at the time of submitting the form, some extra messages may be
displayed as pop up text bubbles.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~ 289. bubble message example (344) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image289.webp"
  loading="lazy"
  title="Bubble message example"
  alt="Bubble message example."
  style="width:35%;" />

<p>The default bubble message and visual feedback differ from one implementation 
to another, but they may be customized, with some limitations that will be 
explained later.</p>

<p>For example, browsers may provides default feedback on the input field’s border 
(red = invalid, green = ok). This default behavior can be overridden by CSS rules 
as illustrated in the section about new input type attributes.</p>

<h4>Examples</h4>

<h4>Example #1: styling “required”, “valid” and” invalid” fields using CSS3 pseudo-classes</h4>

<p>Here is
an <a href="https://jsbin.com/palifuy/edit?html,output" target="_blank" rel="noopener noreferrer">online example
at JSBin</a>, or try it below in your browser:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 288b. form with custom error messages (344) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/palifuy/edit?html,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image288b.webp"
  loading="lazy"
  title="Custom error messages on form"
  alt="Custom error messages on form."
  style="width:35%;" /></a>

<h4>Source code extract:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;CSS3 pseudo-classes for form validation visual feedback&lt;/title&gt;
    &lt;style&gt;
      input:invalid { background-color: lightPink;}
      input:valid { background-color:lightGreen; }
      input:required {border: 2px solid red;}
      input:optional {border: 2px solid green;}
      fieldset {
        border:1px solid;
        padding:20px;
        }
      .formLabel { display: inline-block; width: 140px; text-align: right; }
    &lt;/style&gt;
  &lt;/head&gt;
  &lt;body&gt;
  
    &lt;form&gt;
      &lt;fieldset&gt;
        &lt;legend&gt;Type invalid values and see the result&lt;/legend&gt;
            &lt;label for=&quot;myEmail&quot; class=&quot;formLabel&quot;&gt;E-mail:&lt;/label&gt; 
              &lt;input type=&quot;email&quot; id=&quot;myEmail&quot; required/&gt;&lt;br&gt;
            &lt;label for=&quot;myURL&quot; class=&quot;formLabel&quot;&gt;
            Homepage (URL):&lt;/label&gt; &lt;input type=&quot;url&quot; id=&quot;myURL&quot; 
            required/&gt;&lt;br&gt; &lt;label for=&quot;myPhone&quot; class=&quot;formLabel&quot;&gt; Phone 
            number:&lt;/label&gt; &lt;input type=&quot;tel&quot; id=&quot;myPhone&quot; 
            pattern=&quot;[0-9]{3}-?[0-9]{3}-?[0-9]{4}&quot; placeholder=&quot;e.g.
            416-555-1234&quot; required/&gt;&lt;br&gt;
        &lt;button&gt;Submit form&lt;/button&gt;&lt;br /&gt;
      &lt;/fieldset&gt;
    &lt;/form&gt;
    &lt;p&gt;
  
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>Try the online example with different Web browsers, both with and
without the CSS rules. See the differences between FireFox/Chrome/Opera
in the default visual feedback behavior. Don’t worry: all default
behavior can be overridden if you provide your own CSS rules.</p>

<p>Best practice:  We recommend that you ALWAYS provide default CSS
rules that give visual feedback to the user’s input.</p>

<h4>Example #2: add CSS transitions + an icon/marker to the right of the
input fields</h4>

<p>Try this <a href="https://jsbin.com/zaxije/2/edit" target="_blank" rel="noopener noreferrer">online example at
JSBin</a> or try it here in your browser. This example adds a small icon that changes depending on the validity of the input field:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~ 289b. last example + css transitions  + icon/marker (345) ~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/zaxije/2/edit" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image289b.webp"
  loading="lazy"
  title="Custom error messages on form + css"
  alt="Custom error messages on form + css."
  style="width:35%;" /></a>

<h4>Source code extract:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>.myForm input:focus {
  padding-right:70px;
}
.myForm input {
  transition: padding .25s;
}
.myForm input:required:valid {
  background:url(https://i.imgur.com/BJolppS.png) no-repeat right top;
}
.myForm input:required {
  background:url(https://i.imgur.com/7pIN7wz.png) no-repeat right top;
}</pre>

</details>

<p>This time, we just added an attribute class=“myForm” to our form, in
order to avoid interfering with the other examples on this page, and we
tweaked the CSS rules a little.</p>

<p>The rule at <i>line 1</i> says that any time we click on an input
field, it will enlarge itself to the right, while the rule at <i>line
4</i> will make it animated.</p>

<p>The rules at <i>lines 8</i> and <i>11</i> target the input fields
with a required attribute. They will change the background by displaying
a small green or red icon, corresponding to the valid/invalid status of
the input field.</p>

<h4>Use the title attribute for specifying a custom message</h4>

<p>You can simply use the input’s title attribute to provide a message
for pattern-mismatches, and more generally for all validation errors.
This solution is really neat and doesn’t require JavaScript!</p>

<p>Try the <a href="https://jsbin.com/locedoy/1/edit?html,output" 
target="_blank" rel="noopener noreferrer">online example at JSBin</a>, 
or try it here in your browser (type invalid values and look at the custom 
messages):</p>

<h4>Top of Form</h4>

<p>Type invalid values and see the result, this time with custom
messages! E-mail:  Homepage (URL):  Phone number:  Submit form</p>

<h4>Bottom of Form</h4>

<h4>Extract from source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;form class=&quot;myForm&quot;&gt;
  &lt;fieldset&gt;
    &lt;legend&gt;Type invalid values and see the result&lt;/legend&gt;
    &lt;label for=&quot;myEmail&quot; class=&quot;formLabel&quot;&gt;E-mail:&lt;/label&gt;
    &lt;input type=&quot;email&quot; id=&quot;myEmail&quot;
      title=&quot;You don&#39;t know what an email address looks like, do you?&quot;
      required/&gt;&lt;br&gt;
    ...
    &lt;button&gt;Submit form&lt;/button&gt;&lt;br /&gt;
  &lt;/fieldset&gt;
&lt;/form&gt;</pre>

</details>

<p><i>Beware</i> that browser implementations may differ. Chrome, Opera
will display the title attribute value in error message bubbles when the
form is submitted, while Safari and FireFox (desktop and mobile) will
simply ignore it.</p>

<p>You must also take care of the different languages, otherwise you
will get error message bubbles that show some parts in the local
language, and the message from the title attribute “as is”.</p>

<h4>Google Chrome on a French desktop computer:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~ 290. chrome shows native error msg and localized (347) ~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image290.webp"
  loading="lazy"
  title="Chrome shows native error message localized and the title attribute content as is"
  alt="Chrome shows native error message localized and the title attribute content as is."
  style="width:35%;" />

<h4>Same example on FireFox, the title attribute is ignored:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~ 291. firefox title attribute (347) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image291.webp"
  loading="lazy"
  title="Same example on Firefox, the title attribute is ignored"
  alt="Same example on Firefox, the title attribute is ignored."
  style="width:35%;" />
  
<h4>The built-in validation system is an improvement on what existed before
HTML5 (i.e., nothing), but additional work is required if you want fully
localized, hand-made validation feedback.</h4>

<h4>We will show solutions in the last section of this week’s course.</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-7-3">5.7.3 JavaScript Form Validation API</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>There is a JavaScript API for form validation. This API will let you
use your own validation algorithm (i.e. check that you have entered the
same password in two different input fields), and customize error
messages. Also, together with some HTML/CSS/JavaScript you will be able
to make your own message bubbles.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 292b. javascript form validation api (347) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image292b.webp"
  loading="lazy"
  title="JavaScript form validation API"
  alt="JavaScript form validation API."
  style="width:35%;" />

<h4>Typical use</h4>

<p>Be careful when you try this example in JS Bin standalone mode (click the small black arrow on 
the top right of the output tab).</p>

<p>Or, you may try it <a href="https://jsbin.com/nalaxeg/1/edit?html,output" 
target="_blank" rel="noopener noreferrer">here in your browser</a>.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 292c. example use of validation api (347) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/nalaxeg/1/edit?html,output" 
target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image292c.webp"
  loading="lazy"
  title="Example use of validation API"
  alt="Example use of validation API."
  style="width:35%;" /></a>

<h4>Extract from source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Example of using the validation API&lt;/title&gt;
  &lt;style&gt;
    .myForm input:invalid { background-color: lightPink;}
    .myForm input:valid { background-color:lightGreen; }
    .myForm input:required {border: 2px solid red;}
    .myForm input:optional {border: 2px solid green;}
    .myForm label { display: inline-block; width: 140px; text-align: right; }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;form class=&quot;myForm&quot;&gt;
   &lt;fieldset&gt;
      &lt;legend&gt;Example use of the validation API&lt;/legend&gt;
      &lt;label for=&quot;password1&quot; &gt;Password:&lt;/label&gt; &lt;input type=&quot;password&quot; 
            id=&quot;password1&quot; oninput=&quot;checkPasswords()&quot; required&gt;
      &lt;p&gt;
      &lt;label for=&quot;password2&quot;&gt;
            Repeat password:&lt;/label&gt; &lt;input type=&quot;password&quot; id=&quot;password2&quot; 
            oninput=&quot;checkPasswords()&quot; required&gt;
      &lt;p&gt;
      &lt;button&gt;Submit&lt;/button&gt;
    &lt;/fieldset&gt;
  &lt;/form&gt;
  
  &lt;script&gt;
    function checkPasswords() {
      var password1 = document.getElementById(&#39;password1&#39;);
      var password2 = document.getElementById(&#39;password2&#39;);
      if (password1.value != password2.value) {
        password2.setCustomValidity(&#39;Passwords non identiques&#39;);
      } else {
        password2.setCustomValidity(&#39;&#39;);
      }
    }  <!-- function checkpasswords -->
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Explanations:</h4>

<p>The validity API proposes a setCustomValidity() method available on
input DOM objects. This method allows you to customize error messages.
It takes a string parameter. When this string is empty, the element is
considered <i>valid</i>, when the string is not empty, the field
is <i>invalid</i> and the validation error message displayed in the
bubble will be equal to that string.</p>

<p>At <i>lines 18</i> and <i>20</i> we added an input event listener:
each time a key is typed, the checkPasswords() function is called.</p>

<p><i>Lines 28</i> and <i>29</i> get the input fields’ values, and
<i>lines 30-35</i> check if the passwords are the same and set the
validity of the field using the validation API’s
method setCustomValidity(error_message).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-7-4">5.7.4 The validity property of input fields</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The validity property of input fields helps to get error details when
the field is <i>invalid</i>. This property tests the different types of
validation error.</p>

<h4>Here is how to get the validity property of an input field:</h4>

<pre>var input = document.getElementById(&#39;IdOfField&#39;);
 
var validityState_object = &lt;b&gt;input.validity;&lt;/b&gt;</pre>

<h4>The possible values for the validity property are:</h4>

<ul>
  <li>valueMissing<br></li>
  <li>typeMismatch<br></li>
  <li>patternMismatch<br></li>
  <li>tooLong<br></li>
  <li>rangeUnderflow<br></li>
  <li>rangeOverflow<br></li>
  <li>stepMismatch<br></li>
  <li>valid<br></li>
  <li>customError</li>
</ul>

<p>Here is <a href="https://jsbin.com/nalaxeg/1/edit?html,output" target="_blank" rel="noopener noreferrer">
an example at JSBin that shows how to test the different types of validation errors</a>, or you may try it here in your browser (enter bad
values, too big, too small, enter invalid characters, etc.):</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 292. enter value between 10 and 20 (349) ~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/nalaxeg/1/edit?html,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image292.webp"
  loading="lazy"
  title="JSBin example which shows how to test the different types of validation errors"
  alt="JSBin example which shows how to test the different types of validation errors."
  style="width:35%;" /></a>

<h4>Source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
...
&lt;body&gt;
 
  &lt;script&gt;
    function validate() {
      var input = document.getElementById(&#39;b&#39;);
      var validityState_object = input.validity;

      if(validityState_object.valueMissing) {
        input.setCustomValidity(&#39;Please set an age (required)&#39;);
      } else if (validityState_object.rangeUnderflow) {
        input.setCustomValidity(&#39;Your value is too low&#39;);
      } else if (validityState_object.rangeOverflow) {
        input.setCustomValidity(&#39;Your value is too high&#39;);
      } else if (validityState_object.typeMismatch) {
        input.setCustomValidity(&#39;Type mismatch&#39;);
      } else if (validityState_object.tooLong) {
        input.setCustomValidity(&#39;Too long&#39;);
      } else if (validityState_object.stepMismatch) {
         input.setCustomValidity(&#39;stepMismatch&#39;);
      } else if (validityState_object.patternMismatch) {
        input.setCustomValidity(&#39;patternMismatch&#39;);
      } else {
        input.setCustomValidity(&#39;&#39;);
      }
    }  <!-- function validate -->
  &lt;/script&gt;
  &lt;form class=&quot;myForm&quot;&gt;
    &lt;label for=&quot;b&quot;&gt;Enter a value between 10 and 20: &lt;/label&gt;
    &lt;input type=&quot;number&quot; name=&quot;text&quot; id=&quot;b&quot; min=&quot;10&quot; 
          max=&quot;20&quot;
          required oninput=&#39;validate();&#39;/&gt;
    &lt;button&gt;Submit&lt;/button&gt;
  &lt;/form&gt;
 
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>The validationMessage property</h4>

<p>It is also possible to get the validation error message, using
the validationMessage property of input fields.</p>

<pre>var input = document.getElementById(b);
console.log(&quot;Validation message = &quot; + input.validationMessage);</pre>

<p>This is useful for making custom error messages. More about this
topic in the next section of the course.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch5-7-5">5.7.5 Changing the default behavior</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Custom validation: changing the default behavior, aggregating error
messages, removing bubbles, etc.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~ 293. in french, submit with one or two invalid fields (350) ~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image293.webp"
  loading="lazy"
  title="Custom validation"
  alt="Custom validation."
  style="width:35%;" />
  
<h4>Criticism of the default behavior of HTML5 built-in validation</h4>

<p>The techniques we have seen so far for enhancing HTML forms are
powerful and provide interesting features, but are also criticized by
Web developers:</p>

<ul>
  <li>Browser support is still not 100% complete (Safari and Internet Explorer still lack several important features),</li>
  <li>It is not possible to aggregate error messages.  On submission, browsers show an error bubble next to the first invalid field, and there is no built-in way to <i>display all error messages for all invalid fields at the same time</i>,</li>
  <li>You cannot style the bubbles.</li>
</ul>

<p>However, the validation API gives enough power to make your own
validation behavior, overriding the default when necessary.</p>

<p>Here is <a
href="https://www.telerik.com/blogs/building-html5-form-validation-bubble-replacements" target="_blank" rel="noopener noreferrer">
an adaptation of work presented at the developer.telerik.com Web site</a>.
 This link is really worth reading, as it presents different approaches
and gives external references for those who would like to go
further.</p>

<h4>Example that shows aggregation of error messages + overriding default behavior</h4>

<p>Try the <a href="https://jsbin.com/povekur/1/edit?html,output" target="_blank" rel="noopener noreferrer">online
example at JSBin,</a> or try it here in your browser: enter invalid
values and submit with one or two invalid fields.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 294. name and e-mail fields (351) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image294.webp"
  loading="lazy"
  title="Prompt for name and e-mail address fields"
  alt="Prompt for name and e-mail address fields."
  style="width:35%;" />
 
<h4>Complete source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Aggregating error messages&lt;/title&gt;
    &lt;style&gt;
    input:invalid { background-color: lightPink;}
    input:valid { background-color:lightGreen; }
    input:required {border: 2px solid red;}
    input:optional {border: 2px solid green;}
  
    .error-messages {
      display: none;
      margin: 0 10px 15px 10px;
      padding: 8px 35px 8px 30px;
      color: #B94A48;
      background-color: #F2DEDE;
      border: 2px solid #EED3D7;
      border-radius: 4px;
    }
    fieldset {
      border:1px solid;
      padding:20px;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;form&gt;
  &lt;fieldset&gt;
    &lt;legend&gt;Submit with one or two invalid fields&lt;/legend&gt;
 
    &lt;ul class=&quot;error-messages&quot;&gt;&lt;/ul&gt;
 
    &lt;label for=&quot;name&quot;&gt;Name:&lt;/label&gt;
    &lt;input id=&quot;name&quot; name=&quot;name&quot; required&gt;
    &lt;p&gt;
    &lt;label for=&quot;email&quot;&gt;Email:&lt;/label&gt;
    &lt;input id=&quot;email&quot; name=&quot;email&quot; type=&quot;email&quot; required&gt;
    &lt;p&gt;
    &lt;button&gt;Submit&lt;/button&gt;
  &lt;/fieldset&gt;
&lt;/form&gt;
  
&lt;script&gt;
  function replaceValidationUI(form) {
    // Suppress the default bubbles

    form.addEventListener(&quot;invalid&quot;, function (event) {
      event.preventDefault();
    }, true);
  
    // Support Safari, iOS Safari, and the Android browser -- each of which
    // do not prevent form submissions by default
    form.addEventListener(&quot;submit&quot;, function (event) {
      if (!this.checkValidity()) {
        event.preventDefault();
       }
    });
  
    // Container that holds error messages. By default it has a CSS
    // display:none property
    var errorMessages = form.querySelector(&quot;.error-messages&quot;);
  
    var submitButton = form.querySelector(&quot;button:not([type=button]),
      input[type=submit]&quot;);
  
    submitButton.addEventListener(&quot;click&quot;, function (event) {
      var invalidFields = form.querySelectorAll(&quot;input:invalid&quot;);
      var listHtml = &quot;&quot;;
      var errorMessagesContainer = form.querySelector(&quot;.error-messages&quot;);
      var label;
  
      // Get the labels&#39; values of their name attributes + the validation error
      // message of the corresponding input field using the validationMessage
      // property of input fields
      // We build a list of &lt;li&gt;...&lt;/li&gt; that we add to the error message container
      for (var i = 0; i &lt; invalidFields.length; i++) {
        label = form.querySelector(&quot;label[for=&quot; + invalidFields[ i ].id + &quot;]&quot;);
        listHtml += &quot;&lt;li&gt;&quot; +
        label.innerHTML +
        &quot; &quot; +
        invalidFields[ i ].validationMessage +
        &quot;&lt;/li&gt;&quot;;
      }
  
      // Update the list with the new error messages
      errorMessagesContainer.innerHTML = listHtml;
  
      // If there are errors, give focus to the first invalid field and show
      // the error messages container by setting its CSS property display=block
      if (invalidFields.length &gt; 0) {
        invalidFields[ 0 ].focus();
        errorMessagesContainer.style.display = &quot;block&quot;;
      }
    });
  }
  
  // Replace the validation UI for all forms
  var forms = document.querySelectorAll(&quot;form&quot;);

  for (var i = 0; i &lt; forms.length; i++) {
    replaceValidationUI(forms[ i ]);
  }
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Explanations:</h4>

<ul>
  <li><i>Line 32</i>: we added an empty unnumbered list (&lt;ul&gt;…&lt;/ul&gt;) to the form, 
    with the CSS class=“error-messages”. We will use this class attribute for styling, and 
    hiding by default, the error messages using CSS (see lines <i>12-20</i>, <i>line 13</i> 
    hides the messages by default),</li>
  <li><i>Lines 97-102</i> look at all forms in the document and call a function that will 
    replace the default validation behavior for all of them: the replaceValidationUI(form) function,</li>
  <li>This function first disables all default behavior (no more display of bubbles during 
    form submission), this is done at <i>lines 45-57</i>,</li>
  <li><i>Line 66</i>: we add a click listener to the submit button of the current form,</li>
  <li><i>Line 67</i> gets all invalid input fields for that form,</li>
  <li><i>Lines 76-83</i>: For each invalid field, we get the value of the name attribute of 
    the corresponding label, we also get the validation error message, and we build a list 
    item(&lt;li&gt;…&lt;/li&gt;),</li>
  <li><i>Line 86</i>: Then we add this list element (a formatted error message corresponding 
    to an invalid input field) to the error message container,</li>
  <li><i>Lines 90-93</i>: The focus is given to the first invalid field that shows an error message.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-1-1">6.1.1 Introduction Basic APIs – Module 6</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Final week!</h4>

<p>Congratulations to all of you. Here, it’s summer and it’s hot, it’s
time to get holidays, but before that we need to finish the course. I’m
talking from the very nice park of the University of Nice in the south
of France where I work. And I want you to be as happy as I am today to
teach you this final week. We will look this time at the HTML5
persistence, notably at the HTML5 cache that is useful for creating Web
sites and Web applications that work offline. We will also study the web
storage API that is useful for saving and restoring data on the client
side directly in browser.</p>

<p>It can be useful for setting some preferences for Web application, or
for remembering what you typed in a form, for example. We will also look
at another form of persistence using the file API. This JavaScript API
is quite simple and can be used together with file choosers.</p>

<p>For example, you choose some pictures, some images you want to send
to a server and using this API you can visualize them directly in the
page before sending them to the server.</p>

<p>Finally, we will look at the geolocation API that is useful for
locating the person that is using the browser.</p>

<p>You can provide a customized service that take into account the
geolocation, or you can also display the position of the person in a
map, we will see example that work with Google Map and with
OpenStreetMap. Another classic use is automatic filling of the address
input fields in a form.</p>

<p>Instead of typing the zip code, entering the city, entering the
country, you can guess that automatically and propose the form that is
already filled with the address. I really enjoyed teaching you this
HTML5 basic course and I’m looking forward to meeting you the next HTML5
part-2 course that would address more advanced topics</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="6-1-2">6.1.2 HTML5 JavaScript APIs</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>We have already studied some of the HTML5 JavaScript APIs,
including:</p>

<ul>
  <li>The canvas API,<br></li>
  <li>The form validation API,<br></li>
  <li>The audio and video elements API, the getUserMedia API (also related to audio and video elements).</li>
</ul>

<p>However, HTML5 also comes with several APIs that are not directly
related to HTML elements, namely: the Orientation API; the Geolocation
API; most APIs related to client-side persistence; the Web Storage API;
the Web Workers API; and some other APIs that are not in the HTML5
specification, but are related to it, such as the GamePad API, the Web
Audio API, etc.<br>
This week, we will look at some of the most useful APIs. Others will be
covered in the <a href="https://www.edx.org/course/html5-apps-and-games" 
target="_blank" rel="noopener noreferrer">W3C HTML5 Apps and Games course</a>:</p>

<ul>
  <li><b>The “Web Storage” API, sort of “super cookies”, for storing pairs of key/values 
    client side.</b> This API is useful for enabling Web sites to save/restore their state, 
    or for writing <i>serverless</i> applications. You will see a small contact manager that 
    stores its data locally, without the need for a remote Web server.<br></li>
  <li><b>The File API, that enables Web applications to work with local files</b>. For example, 
    a picture editor, or ./images player that can work with your music and video files - the 
    ones on your phone or your hard disk! With this API you will also be able to preview image 
    files directly in your page - there is no need to send them to a remote server.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 295. 'you are here' sign (354) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image295.webp"
  loading="lazy"
  title="You are here sign"
  alt="You are here sign."
  style="width:35%;" />

<ul>
  <li><b>The Geolocation API for obtaining data such as longitude, latitude, altitude 
    (when available), and speed</b>. You will learn how to write applications in 
    combination with interactive maps. You will also learn how to guess the address 
    of a user, for example for pre-filling a registration form with the city, country, 
    and zip code that corresponds with the current location.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-2-1">6.2.1 The Web storage API</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The Web storage API introduces “two related mechanisms, similar to
HTTP session cookies, for storing structured data on the client
side”.</p>

<p>Indeed, Web Storage provides two
interfaces - sessionStorage and localStorage - whose main difference is
data longevity. This specification defines an API for persistent data
storage of key-value pair data in Web clients.</p>

<p><b>With localStorage the data will remain until it is deleted,
whereas with sessionStorage the data is erased when the tab/browser is
closed.</b></p>

<p>For convenience, we will mainly illustrate the localStorage object. Just
change “local” to “session” and it should work (this time with a session
lifetime).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 296. key value pairs (354) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image296.webp"
  loading="lazy"
  title="Key value pairs"
  alt="Key value pairs."
  style="width:17%;" />
  
<h4>Simple key-value stores, one per domain (following the same origin policy)!</h4>

<p>localStorage is a simple key-value store, in which the keys and
values are strings. There is only one store per domain. This
functionality is exposed through the globally
available localStorage object. The same applies to sessionStorage.</p>

<h4>Example:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>// using localStorage
// store data
localStorage.lastName = &quot;Bunny&quot;;
localStorage.firstName = &quot;Bugs&quot;;
localStorage.location = &quot;Earth&quot;;
// retrieve data
var lastName = localStorage.lastName;
var firstName = localStorage.firstName;
var location = localStorage.location;</pre>

</details>

<p>This data is located in a store attached to the origin of the page.
We created <a href="https://jsbin.com/povuqa/1/edit" target="_blank" rel="noopener noreferrer">
a JSBin example in which we included the above code</a>.</p>

<p>Once opened in your browser, the JavaScript code is executed. With the
browser dev. tools, we can check what has been stored in
the localStorage for this domain:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~ 297. example of localStorage (355) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image297.webp"
  loading="lazy"
  title="Example of read/write localStorage"
  alt="Example of read/write localStorage."
  style="width:35%;" />

<p>Here is a view of the devtools. In more recent versions of Google
Chrome, the “Resources” tab is named “Applications”:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 298. view of the devtools (355) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image298.webp"
  loading="lazy"
  title="View of the devtools. Used to show what is in local Storage"
  alt="View of the devtools. Used to show what is in local Storage."
  style="width:35%;" />

<h4>Differences with cookies?</h4>

<p>Cookies are also a popular way to store key-value pairs. Web Storage,
however, is a more powerful technique than cookies. The main difference
is in size limits: cookies are limited to a few KBytes whereas Web
Storage may extend to several MBytes. Also cookies generate additional
HTTP request traffic (whether to request a Web page, an image, a
stylesheet, a JavaScript file, etc.).</p>

<p>Objects managed by Web Storage are no longer carried on the network and
HTTP, and are easily accessible (read, change and delete) from
JavaScript, using the Web Storage API.</p>

<h4>External resources</h4>

<ul>
  <li>From W3C’s specification: <a href="https://www.w3.org/TR/webstorage/" 
    target="_blank" rel="noopener noreferrer">The W3C Web Storage API recommendation</a><br></li>
  <li>An Interesting article on Web.dev: <a href="https://web.dev/storage-for-the-web/" 
    target="_blank" rel="noopener noreferrer">Storage for the Web</a><br></li>
  <li>From MDN’s Web Docs: <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API" 
    target="_blank" rel="noopener noreferrer">Web Storage API</a></li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-2-2">6.2.2 Example 1</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>You can start filling this form and come back another day and
complete it. It doesn’t matter if you closed your browser before coming
back. The form never loses what you entered, even if you reload the
page, or press “backspace” by mistake. <b>This form auto saves/restores
its content</b>.</p>
<p>In this example, we use the most simple way to use localStorage:</p>

<ul>
  <li><b>Save with the localStorage.key = value syntax.</b> For example, 
    localStorage.firstName = ‘Michel’ will save the value “Michel” with the access key being ‘firstName’<br></li>
  <li><b>Restore with the var value = localStorage.key syntax</b>. For example, 
    var fn = localStorage.firstName; will set fn with the value ‘Michel’ if this 
    value has been previously saved as in the example from the line above.</li>
</ul>

<h4>Saving the form content on the fly</h4>

<p>Open this <a href="https://jsbin.com/pulurir/edit?html,js,output" target="_blank" rel="noopener noreferrer">
online example at JSBin</a>, and use F12 or cmd-alt-i (Mac OS) to look at the dev. tools. As you type in the 
different input fields, their content is updated in the localStorage.<br>
We just added input event listeners to each input field. For example, in order to save the first name input 
field’s content, we just added:</p>

<pre>oninput=&quot;localStorage.&lt;font color="red"&gt;firstName&lt;/font&gt;=this.value;&quot;</pre>

<p>Where firstName in red is the key and this.value the current value of the input field.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 299. example localstorage and html code (355) ~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image229.webp"
  loading="lazy"
  title="Example of Localstorage and its HTML code"
  alt="Example of Localstorage and its HTML code."
  style="width:35%;" />

<p>In the same way, we added an input listener to all the input fields
in this example’s form.</p>

<h4>Restoring the form content on page load/reload</h4>

<p>This time, we want the form content to be restored on page load/reload. We will add a 
restoreFormContent() function in the JavaScript code that will be called each time the 
page is loaded. In this function, we will read the saved data and set the input fields’
values.</p>

<p><a href="https://jsbin.com/yivocuz/edit?html,js,output" target="_blank" rel="noopener noreferrer">Complete
example on JSBin</a>: enter data and press reload at any time. The form content is restored!</p>

<h4>Source code extract (only addition to the previous example):</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>// Called when the page is loaded
window.onload = restoreFormContent;
function restoreFormContent() {
   console.log(&quot;restoring form content from localStorage&quot;);
   if(localStorage.firstName !== undefined)
     document.getElementById(&quot;firstName&quot;).value = localStorage.firstName;
   if(localStorage.lastName !== undefined)
     document.getElementById(&quot;lastName&quot;).value = localStorage.lastName;
   if(localStorage.email !== undefined)
     document.getElementById(&quot;email&quot;).value = localStorage.email;
   if(localStorage.age !== undefined)
     document.getElementById(&quot;age&quot;).value = localStorage.age;
   if(localStorage.date !== undefined)
     document.getElementById(&quot;date&quot;).value = localStorage.date;
}</pre>

</details>

<p>The tests at <i>lines 7, 10, 13</i>, etc., verify that data has been
saved, before trying to restore it. Without these tests, it would put
the “undefined” string as the value of input fields with no
corresponding data to restore.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-2-3">6.2.3 localStorage and sessionStorage</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>This time we will look at another example that uses new methods from the API:</p>

<ul>
  <li>localStorage.setItem(…),</li>
  <li>localStorage.getItem(…),</li>
  <li>localStorage.removeItem(…),</li>
  <li>localStorage.clear().</li>
</ul>

<h4>Getting/setting values using the getItem(key) and setItem(key, value) methods</h4>

<p>If you want to keep a simple counter of the number of times a given
user has loaded your application, you can use the following code (just
to show how to use setItem/removeItem methods):</p>

<pre>var counter = localStorage.getItem(&quot;count&quot;) || 0;
counter++;
localStorage.setItem(&quot;count&quot;, counter);</pre>

<p>As you can easily guess from the above, we use var value = getItem(key) to retrieve a 
key’s value and setItem(key, value) to set it. This is similar to what we saw in the 
examples of the page above, except that this time:</p>

<ul>
  <li>The key can contain spaces, for example we can write: localStorage.setItem(“Instructor’s name”, “Michel”); 
    and var name =  localStorage.getItem(“Instructor’s name”);, while var name = localStorage.Instructor’s name; 
    will not work!</li>
  <li>In a loop or in an iterator, sometimes we need to set/get localStorage values using this syntax, for example:</li>
</ul>

<pre>var inputField = document.getElementById(&quot;firstName&quot;);
saveInputFieldValue(inputField);
... 
function saveInputFieldValue(field) {
  localStorage.setItem(field.id, field.value);
}</pre>

<h4>Deleting a key with removeItem(key), or all keys with clear()</h4>

<p>Deleting a key can be performed through removeItem(). And if you wish
to reset the entire store, simply call localStorage.clear().</p>

<p>Note that it will probably only be the rare occasion that you will
want the entire store to be cleared by the user in production software
(since that effectively deletes their entire data). However, it is a
rather a common operation needed during development, since bugs may
store faulty data the persistence of which can break your application,
since the way you store data may evolve over time, or simply because you
also need to test the experience of the user when first using the
application.</p>

<p>One way of handling this is to add a user interface button that
calls clear() when clicked, but you must then remember to remove it when
you ship! The recommended approach  to use (whenever possible) is to
simply open the dev. tool’s console and type localStorage.clear() there
— it’s safer and works just as well.</p>

<h4>Iterating local stores</h4>

<p>Local stores (localStorage or sessionStorage) can also be iterated
through in order to list all the content that they contain. The order is
not guaranteed, but this may be useful at times (if only for debugging
purposes!). The following code lists everything in the current store:</p>

<pre>for (var i = 0, n = localStorage.length; i &lt; n; i++) {
  var k = localStorage.key(i);
  console.log(k + &quot;: &quot; + localStorage[k]); // get the ith value, the one with a key that is in the variable k.
}</pre>

<p>Students may note that something seems a bit off in the example
above: instead of calling localStorage.getItem(k), we simply
access localStorage[k]. Why? Because keys in the local store can also be
accessed as if the store were a simple JavaScript object.</p>

<p>Instead of localStorage.getItem(“foo”) and localStorage.setItem(“foo”,
“bar”), one can write localStorage.foo and localStorage.foo = “bar”. Of
course there are limitations to this mapping: any string can serve as a
key, so that localStorage.getItem(“one two three”) works, whereas that
string would not be a valid identifier after the dot (but it could still
work as localStorage[“one two three”]).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~ 300. number of times this page has shown on browser (359) ~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image300.webp"
  loading="lazy"
  title="Example with buttons that show how to iterate on localStorage, clear it etc"
  alt="Example with buttons that show how to iterate on localStorage, clear it etc."
  style="width:35%;" />
  
<h4>Example that shows all the methods of the local storage API in action</h4>

<p><a href="https://jsbin.com/nedigi/edit?html,css,output" target="_blank" rel="noopener noreferrer">Online
example at JSBin</a>, run it, then click on the first button to show all
key/values in the localStorage. Open the URL in another tab, and see
that the data is shared between tabs, as local stores are attached to an
origin.</p>

<p>Then click on the second button to add data to the store, click on
the third to remove data. Finally, the last one clears the whole data
store.</p>

<details>
  <summary><b>Click to expand!</b></summary>

<h4>Source code:</h4>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
&lt;meta charset=utf-8 /&gt;
&lt;title&gt;Example of localStorare API use&lt;/title&gt;
  &lt;script&gt;
    // Using localStorage
    var counter = localStorage.getItem(&quot;count&quot;) || 0;
    counter++;
  localStorage.setItem(&quot;count&quot;, counter);
 
    function getCountValue() {
       // retrieve data
       document.querySelector(&quot;#counter&quot;).innerHTML = localStorage.count;
     }
 
     function seeAllKeyValuePairsStored() {
       // clear list first
       document.querySelector(&#39;#list&#39;).innerHTML=&quot;&quot;;
 
       for (var i = 0, n = localStorage.length; i &lt; n; i++) {
         var key = localStorage.key(i);
         var value = localStorage[key];
         console.log(key + &quot;: &quot; + value);

         var li = document.createElement(&#39;li&#39;);
         li.innerHTML = key + &quot;: &quot; + value;
         document.querySelector(&#39;#list&#39;).insertBefore(li, null);
      }
    }
 
    function resetStore() {
      // erase all key values from store
        localStorage.clear();
      // reset displayed list too
        document.querySelector(&#39;#list&#39;).innerHTML=&quot;&quot;;
    }

    function addSomeData() {
      // store data
      localStorage.lastName = &quot;Buffa&quot;;
      localStorage.firstName = &quot;Michel&quot;;
      // refresh display
      seeAllKeyValuePairsStored();
    }

    function removeSomeData() {
      // store data
      localStorage.removeItem(&quot;lastName&quot;);
      localStorage.removeItem(&quot;firstName&quot;);
      // refresh display
      seeAllKeyValuePairsStored();
    }
  &lt;/script&gt;
&lt;/head&gt;
 &lt;body onload=&quot;getCountValue()&quot;&gt;
   &lt;h1&gt;Number of times this page has been seen on this browser: &lt;span id=&quot;counter&quot;&gt;&lt;/span&gt;&lt;/h1&gt;

   &lt;button onclick=&quot;seeAllKeyValuePairsStored()&quot;&gt;Show all key value pairs stored in localStorage&lt;/button&gt;&lt;br/&gt;
   &lt;output id=&quot;list&quot;&gt;&lt;/output&gt;
 
   &lt;button onclick=&quot;addSomeData()&quot;&gt;Add some data to the store&lt;/button&gt;&lt;br/&gt;
   &lt;button onclick=&quot;removeSomeData()&quot;&gt;Remove some data&lt;/button&gt;&lt;br/&gt;
   &lt;button onclick=&quot;resetStore()&quot;&gt;reset store (erase all key/value pairs)&lt;/button&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<p>You can check in the Chrome dev. tools user interface that the
content of the localStorage changes as you click on the buttons.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-2-4">6.2.4 Example 2</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Local stores are also useful for<b> saving/restoring user
preferences</b> of Web Applications. For example, the JS Bin tool you
have been using since the beginning of this course uses localStorage to
store the list of tabs you open, and their width:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~ 301. example user preferences of web applications (361) ~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image301.webp"
  loading="lazy"
  title="Example of preferences"
  alt="Example of preferences."
  style="width:35%;" />

<p>This way, the next time you come back to JSBin, “it will remember
your last settings”.</p>

<p>Another example is a guitar FX processor / amp simulator your
instructor is writing with some of his students. It uses localStorage to
save/restore presets values:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~ 302. another example of localstorage of preset values (362) ~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image302.webp"
  loading="lazy"
  title="Guitar fx processor uses localStorage"
  alt="Guitar fx processor uses localStorage."
  style="width:35%;" />
  
<h4>Save/restore preferences</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~ 303. change color, size, speed of animate rectangle with gui (362) ~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image303.webp"
  loading="lazy"
  title="Change color, size and speed of animated rectangle with GUI"
  alt="Change color, size and speed of animated rectangle with GUI."
  style="width:35%;" />

<p>Original example on JSBin:</p>

<p>We can change the color, size and speed of the animated rectangle.
However, each time we come back to the page, default values are
restored.</p>

<p>We would like to save the current values and find them back as they
were when we come back to the page.</p>

<p><a href="https://jsbin.com/cebavo/edit?html,js,console,output" target="_blank" rel="noopener noreferrer">
Here is a modified example that saves/restores its state, you can try it
at JSBin</a>. In this modified version of the animated rectangle
example, you can set the color, size, speed, etc. And if you reload the
page, the state of the different input field is restored, but also the
internal variables. Check the source code in the JS Bin example and read
the following explanations.</p>

<p>We used the same generic code for saving/restoring input fields’
values we saw in the first example that used localStorage. The only
difference is that we renamed the two generic functions so that they
correspond better to their role here (instead of saveFormContent we
called the function restorePreferences).</p>

<p>The function initPreferences is executed when the page is loaded.</p>

<h4>Source code extract:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>function initPreferences() {
  console.log(&quot;Adding input listener to all input fields&quot;);
  // add an input listener to all input fields
  var listOfInputsInForm = document.querySelectorAll(&quot;input&quot;);
  for(var i= 0; i &lt; listOfInputsInForm.length; i++) {
    addInputListener(listOfInputsInForm[i]);
  }
    // restore preferences
    restorePreferences();
    applyGUIvalues(); // Use the input fields&#39; values we just restored to set internal 
                      // size, incX, color, lineWidth variables
}
function addInputListener(inputField) {
  // same as before
}
function restorePreferences() {
  // same as old restoreFormContent
}
function applyGUIvalues() {
  // Check restored input field content to set the size of the rectangle
  var sizeWidget = document.getElementById(&quot;size&quot;);
  size = Math.sign(incX)*parseInt(sizeWidget.value);
  // also update the outline element&#39;s value
  document.getElementById(&quot;sizeValue&quot;).innerHTML = size;
  // Check restored input field content to set the color of the rectangle
  var colorWidget = document.getElementById(&quot;color&quot;);
  ctx.fillStyle = colorWidget.value;
  // Check restored input field content to set the speed of the rectangle
  var speedWidget = document.getElementById(&quot;speed&quot;);
  incX = Math.sign(incX)*parseInt(speedWidget.value);
  // also update the outline element&#39;s value
  document.getElementById(&quot;speedValue&quot;).innerHTML = Math.abs(incX);
  // Check restored input field content to set the lineWidth of the rectangle
  var lineWidthWidget = document.getElementById(&quot;lineWidth&quot;);
  ctx.lineWidth = parseInt(lineWidthWidget.value);
}</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-2-5">6.2.5 Example 3</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p><a href="https://jsbin.com/zowise/edit?html,js,output" 
target="_blank" rel="noopener noreferrer">Online example at JSBin</a></p>

<p>This time, using the setItem and getItem method we saw earlier in the
course, we could write some generic functions for saving/restoring input
fields’ content, without having advance knowledge about the number of
fields in the form, their types, their ids, etc.</p>

<p>Furthermore, we removed all input listeners in the HTML, making it
cleaner (no more oninput=“localStorage.firstName = this.value;’…)</p>
<p>Define listeners + restore old values after the page is loaded, use
generic functions</p>

<p>We start writing an init() function that is called when the page is
loaded. This function will:</p>

<ol type="1">
  <li>Define input listeners for all input fields</li>
  <li>Restore the last saved value for each input field, if present.</li>
</ol>

<h4>Source code:</h4>

<pre>// Called when the page is loaded
window.onload = init;
function init() {
  console.log(&quot;Adding input listener to all input fields&quot;);
  // add an input listener to all input fields
  var listOfInputsInForm = document.querySelectorAll(&quot;input&quot;);
  for(var i= 0; i &lt; listOfInputsInForm.length; i++) {
     addInputListener(listOfInputsInForm[i]);
   }
   // restore form content with previously saved values
   restoreFormContent();
}</pre>

<p>And here is the addInputListener(inputField) function. It takes an
input field as parameter and attaches an oninput listener to it, that
will save the field’s content each time a value is entered. The key will
be the id of the input field (<i>line 3</i>):</p>

<pre>function addInputListener(inputField) {
  inputField.addEventListener(&#39;input&#39;, function(event) {
    localStorage.setItem(inputField.id, inputField.value);
  }, false);
}</pre>

<p>Note that at <i>line 2</i>, we use addEventListener (that is not
using the oninput property here). adddEventListener doesnot replace
existing oninput definitions and keep all existing listeners
unchanged.</p>

<h4>Restore all input fields’ content using a generic function</h4>

<p>We have seen how to save all input fields’ content on the fly.
Now, let’s see how we can restore saved values and update the form. This
is done using the function restoreFormContent():</p>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>function restoreFormContent() {
  console.log(&quot;restoring form content from localStorage&quot;);
  // get the list of all input elements in the form
  var listOfInputsInForm = document.querySelectorAll(&quot;input&quot;);
  // For each input element,
  // - get its id (that is also the key for it&#39;s saved content
  // in the localStorage)
  // - get the value associated with the id/key in the local
  // storage
  // - If the value is not undefined, restore the value
  // of the input field
  for(var i= 0; i &lt; listOfInputsInForm.length; i++) {
    var fieldToRestore = listOfInputsInForm[i];
    var id = fieldToRestore.id;
    var savedValue = localStorage.getItem(id);
    if(savedValue !== undefined) {
       fieldToRestore.value = savedValue;
    }
  }
}</pre>

</details>

<p>In this function, we first get the list of input fields (<i>line
5</i>), then iterate on it (<i>line 14</i>). For each input field, we
get its id, which value is the key in localStorage for the previous data
saved for this field (<i>lines 15-16</i>). Then if the value is not
undefined, we restore it by setting the value of the input field
(<i>lines 19-20</i>).</p>

<p>These generic functions can be used in many different projects</p>

<p>Indeed, if you look carefully, you will see that these functions are
really useful. You may easily embed them in your own projects, or
perhaps adapt them for a particular need (i.e. for saving input
type=“checkboxes” that work a bit differently), etc.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-2-6">6.2.6 Size limitations, etc.</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Few things to remember, from the Web storage specification:</p>

<ul>
  <li>User agents (browsers) should limit the total amount of space allowed for storage areas.</li>
  <li>User agents may prompt the user when quotas are reached, allowing the user to grant more space to a site. This enables sites to store many user-created documents on the user’s computer, for instance.</li>
  <li>User agents should allow users to see how much space each domain is using.</li>
  <li>A mostly arbitrary limit of five megabytes per origin is recommended (translation: give at least 5Mb per origin).</li>
</ul>

<p><b>In many cases, local storage is all that your application will
need for saving/loading data on demand</b>. More complex ways to do it
exist, such as IndexedDB, a No SQL database, that proposes transactions
and usually comes with far more available space than local storage.
IndexedDB usage is for advanced users and will be covered in the W3Cx
HTML5 Apps and Games.</p>

<p>Additionally, there will be a limit on the amount of data that you
can store there. Browsers enforce quotas that will prevent you from
cluttering your users’ drives excessively. These quotas can vary from
platform to platform, but are usually reasonably generous for simple
cases (around 5MB), so <b>if you are careful not to store anything huge
there, you should be fine.</b></p>

<p><b>Finally, keep in mind that this storage is not necessarily
permanent.</b> Browsers are inconsistent in how they allow for it to be
wiped, but in several cases it gets deleted with cookies — which is
logical when you think of how it can be used for tracking in a similar
fashion.</p>

<p>For serious applications, you might want to synchronize
existing data with the server on a regular basis, in order to avoid data
loss (and in general, because users enjoy using the same service from
multiple devices at once). This is a rather complex feat, and frameworks
such as Firebase can help. Such techniques are beyond the scope of this
course and will not be covered.</p>

<p>sessionStorage key/values instead of cookies?</p>

<p>Note that if all you need is to store session-based data in a manner
that is more powerful than cookies, you can use
the sessionStorage object which works in exactly the same way as
localStorage, but the lifetime is limited to a single browser session
(lifetime of your tab/window).</p>

<p><b>Also note that in addition to being more convenient and capable of
storing more data than cookies, it has the advantage of being scoped to
a given browser tab (or similar execution context).</b></p>

<p><b>Cookies’ security drawback: </b>if a user has two tabs open to the
same site, they will share the same cookies. Which is to say that if you
are storing information about a given operation using cookies in one
tab, that information will leak to the other side — this can be
confusing if the user is performing different tasks in each.</p>

<p><b>By using sessionStorage, the data you store will be scoped and
therefore not leak across tabs!</b></p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-2-7">6.2.7 Storing more than strings? Use JSON!</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Storing strings is all well and good, but it quickly
becomes limiting: you may want to store more complex data with at least
a modicum of structure.</p>

<p>There are some simple approaches, such as creating your own minimal
record format (e.g. a string with fields separated with a given
character, using join() on store and split() upon retrieval) or using
multiple keys (e.g. post_17_title, post_17_content, post_17_author,
etc.). But these are really hacks. Thankfully, there’s a better way,
 JSON.stringify() and JSON.parse() methods.</p>

<p><a href="https://www.json.org/" target="_blank" rel="noopener noreferrer">JSON</a> provides a great way of
encoding and decoding data that is a really good match for JavaScript.
You have to be careful not to use circular data structures or
non-serializable objects, but in the vast majority of cases, plugging
JSON support into your local store is straightforward.</p>

<h4>Typical usage</h4>

<pre>locaStorage.key = JSON.stringify(object); // or...
localStorage.setItem(key, JSON.stringify(object));</pre>

<p>Let’s try a simple toy example
(<a href="https://jsbin.com/ciricis/2/edit?html,console,output" target="_blank" rel="noopener noreferrer">online
at JSBin</a>).  The example below saves a JavaScript object in JSON,
then restores it and checks that the object properties are still
there!</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 304. json save/load in local storage (367) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image304.webp"
  loading="lazy"
  title="JSON save/load in local storage"
  alt="JSON save/load in local storage."
  style="width:35%;" />

<h4>Source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=utf-8 /&gt;
  &lt;title&gt;Storing JSON Objects with Local Storage&lt;/title&gt;
  &lt;script&gt;
    var personObject= {&#39;givenName&#39;: &#39;Michel&#39;, &#39;familyName&#39;: &#39;Buffa&#39;};
    // Store the object as a JSON String
    localStorage.setItem(&#39;testObject&#39;, JSON.stringify(personObject));
    // Retrieve the object from storage
    var retrievedObject = JSON.parse(localStorage.getItem(&#39;testObject&#39;));
    console.log(retrievedObject.firstName + &quot; &quot; + retrievedObject.lastName);
   // then you can use retrievedObject.givenName, retrievedObject.familyName...
  &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Explanations:</h4>

<ul>
  <li><i>Line 7</i>: we built a JavaScript object that contains a person.</li>
  <li><i>Line 9</i>: we store it in localStorage as a JSON string object, with a key equal to testObject.</li>
  <li><i>Line 11</i>: we restore it from localStorage as a string, and the JSON.parse methods turns it back into a JavaScript object.</li>
  <li><i>Line 12</i>: we print the values of the object properties.</li>
</ul>

<h4>Examples</h4>

<h4>Example #1: showing how we can save a form’s content in JSON</h4>

<p><a href="https://jsbin.com/nejewiw/2/edit?html,js,console,output" target="_blank" rel="noopener noreferrer">Online
example on JSBin that saves in localStorage an array of contacts in
JSON</a></p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 305. save local storage in json (368) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image305.webp"
  loading="lazy"
  title="How to save a form's content in localStorage using JSON"
  alt="How to save a form's content in localStorage using JSON."
  style="width:35%;" />

<h4>Example #2: a form and a table that displays the contacts stored in localStorage</h4>

<p><a href="https://jsbin.com/karoboj/3/edit?html,css,console,output" target="_blank" rel="noopener noreferrer">Example on JSBin</a></p>

<p>Add contacts using the form, see how the HTML table is updated. Try
to reload the page: data are persisted in localStorage. </p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 306. serverless contact manager (369) ~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image306.webp"
  loading="lazy"
  title="Serverless contact manager"
  alt="Serverless contact manager."
  style="width:35%;" />

<p>Examine the localStorage:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~ 307. localStorage view in devtools shows the data (369) ~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image307.webp"
  loading="lazy"
  title="localStorage view in devtools shows the data"
  alt="localStorage view in devtools shows the data."
  style="width:35%;" />

<p>The source code for this example is a bit long, and we suggest that you examine 
it in the JS Bin tool. We extensively commented it. It uses:</p>

<p>Well structured pages with the new elements seen during Module 1
(section, article, nav, aside, etc.)</p>

<p>HTML5 form elements with builtin and custom validation (the date
cannot be in the past, the firstName and lastName fields do not accept
&amp;, #, ! or $ characters), localStorage for saving / restoring an
array of contacts in JSON.</p>

<p>It shows how to use the DOM API for dynamically updating the page
content (build the HTML table from the array of contacts, add a new line
when a new contact is submitted, etc.)</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-3-1">6.3.1 File API Introduction</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The objective of this chapter is to provide an overview of the File API.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~ 308. sound sample editor serverless (370) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image308.webp"
  loading="lazy"
  title="Sound sample editor serverless"
  alt="Sound sample editor serverless."
  style="width:35%;" />

<p>Before HTML5, file management was limited to multipart forms and to
Ajax for sending/requesting files to/from a remote Web server.</p>

<p>Possible actions were limited, both for the developer and the user.
However, HTML5 now comes with an API called “File” that holds features
for accessing file metadata (name, size, type) from client-side
JavaScript. The API also has methods for reading file contents directly
in the browser. This is particularly interesting for displaying preview
of images before uploading them, or - and this is much more interesting
- for developing Web applications that work with local files without the
need for a server.</p>

<p>Imagine a multimedia player that accesses (in read-only) your file
system, reads your audio and video files, etc., such as the <a
href="https://chrome.google.com/webstore/detail/remo-music-player/ajilpdcmebalpffmjjopcingplogifhb" 
target="_blank" rel="noopener noreferrer">Remo Music player</a> below, or an application 
that edits the audio content of local mp3 files, for example, the 
<a href="https://wav.hya.io/#/fx" target="_blank" rel="noopener noreferrer">
HYA-WAVE sound editor</a> (screenshot above).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~ 309. audio player that plays local files (370) ~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image309.webp"
  loading="lazy"
  title="Audio player that plays local files"
  alt="Audio player that plays local files."
  style="width:35%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 310. polarr photo editor uses the File API (371) ~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image310.webp"
  loading="lazy"
  title="polarr photo editor uses the File API"
  alt="polarr photo editor uses the File API."
  style="width:35%;" />

<h4>External resources</h4>

<ul>
  <li>From W3C’s specification: <a
    href="https://www.w3.org/TR/FileAPI/" target="_blank" rel="noopener noreferrer">File API</a></li>
  <li>An article from Web.dev: <a
    href="https://web.dev/read-files/" target="_blank" rel="noopener noreferrer">Read files in JavaScript</a></li>
  <li>MDN’s Web Docs: <a
    href="https://developer.mozilla.org/en-US/docs/Web/API/File/Using_files_from_web_applications" target="_blank" 
      rel="noopener noreferrer">Using files from web applications</a></li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-3-2">6.3.2 Working with local files</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Hi! Welcome for this second video of module 6, in which we will talk
about the file Javascript API.</p>

<p>This is an API that has been designed for working with files on the
client side in Javascript.</p>

<p>Before HTML5, there was no mean to know the the size, the name, the
modification date of a file without sending it to a remote server. It
was not possible also to read the content of a file, for example for
previewing an image before uploading it into a remote server, or if you
wanted to play a local audio file, or a video file without streaming and
downloading it from a remote server. It was not possible.</p>

<p>I’m going first to show you some example of server less applications.</p>

<p>I mean applications written using HTML, CSS and Javascript that do
not rely on data located on a remote server.</p>

<p>For example, I can show you this. This is a wave. This is an audio
file editor that works with local files. I open the page, and from here
I can drop a music file directly. Let’s go to get some music somewhere.
Some AC/DC song! I can just drop the song and I can edit the song. I can
play the song. I can cut, I can save locally, etc.</p>

<p>Another example is an application, a Chrome application that is also
written using Web technologies but doesn’t run using HTTP.</p>

<p>It’s quite easy to write such applications, because there are regular
Web applications using HTML, CSS and Javascript except that you’ve got
to package them for putting them on the Chrome store.</p>

<p>I’m going first to show you a local audio file player that is called
Remo.</p>

<p>I can just open files, choose one or several, open the files, I’ve
got a playlist and I can play the songs. Normally it works… yes, OK.</p>

<p>Finally, I’m going to show you an image editor that has been written
by one of the students from this course. This is an example of
Instagram-like filters that have been written by <span class="citation"
data-cites="GeorgianaB">@GeorgianaB</span> from the discussion forum.
It’s a regular Web application except that you can upload an image, a
local image. Ok, no, this one is too small maybe. You can upload an
image… it’s me with a strange head ;) Then you can apply Instagram
filters or add borders. You can even download the result to your local
disk.</p>

<p>We saw how to do this when we look at the download attributes in
Module 1.</p>

<p>All these examples work with local files. Let’s go back to the course
and now I’m going to show you how we can, for example, read images using
an input type=file like this.</p>

<p>Select several files, open, and look at the preview directly in the
page.</p>

<p>Here, I just read the files using the File API, I read them as what
we call data URL and I created some img elements we added in the
page.</p>

<p>First, before writing the application, I want to talk a little bit
about data URLs.</p>

<p>Data URLs are strange set of characters like that ,and if you select
them and paste them in the address bar you can see a small red icon. And
you can use this everywhere where you would have use an http://URL.</p>

<p>If I use this image here, I can using it in JSBin for example, and if
I add the image here I can see that the content of the image, the
pixels, are encoded in the URL itself. How can you make such URLs?
You’ve got plenty of Web sites, look for data URL with a search engine
and you’ve got plenty of them.</p>

<p>The first one here is called DATAURL.net and it included ‘Data URL
Maker’ so you can just open a file, any sort of file, here I take a JPG
file and it will produce the data URL that corresponds. But you can also
use with mp3 file, or mp4 file video or any sort of file encoding.</p>

<p>This was to introduce this new sort of URL that maybe you’ve never
heard about before. Now, how can we write this?</p>

<p>I’m going to explain with the source code here because it’s simpler.</p>

<p>After that I will code it live. What we do is that we use an input
type=file for reading the files. We define an event listener that will
call this function ‘read files and display preview’ once the user has
chosen some files.</p>

<p>In this callback, we iterate, we’ve got a ‘for’ loop, about the
files. For each file, we build a file reader, that is a special object,
that has a function called ‘readAsDataURL’, that will take a file
descriptor as a parameter here.</p>

<p>When the file is read, because that can take some time if the file is
big, then each file is read, the onload callback is executed. It’s
exactly the same principle we saw with images as reading an image can
take some time. You can only work with that image in an onload callback.
So, when we enter this function that means that one file has been read
and we can get the content of the file through the event using the
‘e.target.result’ property. Each time I read a file I can get its
content here and it’s a data URL that contains all the pixels.</p>

<p>What we do in that example, is that we create a &lt;span&gt;. In the span with the 
innerHTML, we add an image that has for src attribute the content of the image we read 
as a data URL.</p>

<p>And finally, we just insert this image in the document and this is when we see it.</p>

<p>I’m going to live code this one, maybe a simpler version so that you can see the 
different steps in real time. First, I add an ‘input type=file multiple’ for 
selecting multiple files. This is what’s happening and here I can select several 
images. I’m going to add an ‘onchange’ listener:</p>

<pre>&#39;onchange=readImagesAndPreview()&#39;.</pre>

<p>And I’m going to pass the set of file descriptors that have been selected; 
‘this.files’ is the correct way to send the selected files to a Javascript function.</p>
<p>Now, I’m going to start writing some script. But before, I will add a space, 
let’s say ‘div id=thumbnails’.</p>

<p>This is an empty container that will be used for inserting the preview of the images.</p>

<p>Now I’m going in the script part. In the script part, we’re going to write this 
function ‘readImagesAndPreview()’ and it takes as parameter the files that will be sent.</p>

<p>And here if I want just to read the first file I will just show you how it works. 
I create a reader object, like that, and I ask the reader to ‘readAsDataURL’ the first 
file.</p>

<p>What is happening is that this may take some time and I need to declare, before 
reading the files, a callback that will be code only once the file would have been read 
- ‘reader.onload’</p>

<p>And here, what can I do with the file that has been read, I will create an image 
element.</p>

<p>So i created an image element, I set the source of this element with the file content 
that is in the ‘e.target.value’. So I created an image.  Then, I will add the image to 
the container here. I’m going to declare the container here. How can I add an element: 
‘container.appendChild’ and I add the image I created.</p>

<p>Let’s try it, maybe I made some mistakes. I select several files, I open them and 
here, apparently, I make a small mistake.</p>

<p>Let’s open an image and now read the image and I can see the preview.</p>

<p>If you look carefully, it’s just a few lines of code.</p>

<p>So now I’m going to show you how we could work with not only one single image, 
but several images. The trick consists in adding a ‘for’ loop.</p>

<p>We will iterate on the length of the file’s variable here. If we got 3 files, 
we do 3 loops. I’m going to define a variable called ‘f’ that will correspond 
to the current file.</p>

<p>What we are going to read this time is the current file ‘f’.</p>

<p>So this loop here, will first read files, for each one we do read as data URL, 
when the file is read we enter the onload callback, we create an image with the 
result.</p>

<p>I’m going just to add some constraints on the size, because when I tried earlier 
I had big images that could not fit on the screen.</p>

<p>I constraint the width to 100px and the height will just follow.</p>

<p>Like this, let’s try. If I select several pictures, two of them,</p>

<p>I can see the two pictures. If I select more, then I can see the whole set of 
pictures that are coming as previews.</p>

<p>You can see that the number of lines of code is really small and this is quiet 
powerful.</p>

<p>If you want to write, for example, a Web site that will upload
pictures, you can preview them, select them and then upload them.</p>

<p>I show you earlier the application by one of the students that can do
Instagram like filters, but you can also find some new on the Chrome
store.</p>

<p>I installed one that is called Polarr that is using HTML for all the functionalities. 
So you can just import a picture, let’s say this one.  Then you can select filters, 
you can do some corrections on it and so on, and finally you can export it and that’s 
all.</p>

<p>All this here is HTML5, this is canvas, these are form elements we saw the last 
week, some canvas here, or image elements and so on.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 311. image previews (374) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image311.webp"
  loading="lazy"
  title="Image preview"
  alt="Image preview."
  style="width:35%;" />

<h4>Source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Example of using readAsDataURL&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;input type=&quot;file&quot; multiple onchange=&quot;readImagesAndPreview(this.files);&quot;&gt;
  &lt;p&gt;
    &lt;div id=&quot;thumbnails&quot;&gt;&lt;/div&gt;
    &lt;script&gt;
      var container = document.getElementById(&quot;thumbnails&quot;);
      function readImagesAndPreview(files) {
        for(var i=0; i &lt; files.length; i++) {
           var f = files[i];
           var reader = new FileReader();
           reader.onload = function(e) {
              var img = document.createElement(&quot;img&quot;);
              img.src = e.target.result;
              img.width = 100;
              container.appendChild(img);
           }
           reader.readAsDataURL(f);
        }
      }
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-3-3">6.3.3 Reading File Metadata</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Imagine you have an input field like this:</p>

<ol type="1">
  <li>Select one or more files: &lt;input type=“file” id=“input”/&gt;</li>
</ol>

<p>This renders as a “select files” or “browse files” button. If you
select one file in the file chooser dialog that has popped up, before
HTML5 you couldn’t do anything with it in the client-side: no access
from JavaScript. With the File API, you can read what we call “file
metadata”: name, size, type and last modification date.</p>

<p>Look at the code below: the file API defines a files property on the
DOM node corresponding to the &lt;input type=“file”…/&gt; input field.
This property is an array.</p>

<p>In the example below, we get in the selectedFile variable, the
metadata related to the first selected file:</p>

<pre>var selectedFile = document.getElementById(&#39;input&#39;).files[0];
// do something with selectedFile.name, selectedFile.size, selectedFile.type
// selectedFile.lastModifiedDate
...</pre>

<h4>Examples</h4>

<h4>Example #1: read metadata of the first selected file</h4>

<p><a href="https://jsbin.com/terocu/edit?html,output" target="_blank" rel="noopener noreferrer">
Here is a complete example on JSBin</a> that uses the code above to get details
about the first selected file. Please try it below on your browser
(click on the button and choose one file):</p>

<h4>Select one or more files:</h4>

<ul>
  <li>File name:</li>
  <li>File size:</li>
  <li>File type:</li>
  <li>File last modification date:</li>
</ul>

<h4>Complete source code:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=utf-8 /&gt;
  &lt;title&gt;Reading file metadata&lt;/title&gt;
&lt;script&gt;
  function displayFirstSelectedFileMetadata() {
    var selectedFile = document.getElementById(&#39;input&#39;).files[0];
      document.querySelector(&quot;#singleName&quot;).innerHTML = selectedFile.name;
      document.querySelector(&quot;#singleSize&quot;).innerHTML = selectedFile.size + &quot; bytes&quot;;
      document.querySelector(&quot;#singleType&quot;).innerHTML = selectedFile.type;
      document.querySelector(&quot;#singleDate&quot;).innerHTML = selectedFile.lastModifiedDate;
    }
  &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  Select one or more files: &lt;input type=&quot;file&quot; id=&quot;input&quot;
    onchange=&quot;displayFirstSelectedFileMetadata();&quot;/&gt;
  &lt;p&gt;
  &lt;ul&gt;
    &lt;li&gt;File name: &lt;span id=&quot;singleName&quot;&gt;&lt;/span&gt;&lt;/li&gt;
    &lt;li&gt;File size: &lt;span id=&quot;singleSize&quot;&gt;&lt;/span&gt;&lt;/li&gt;
    &lt;li&gt;File type: &lt;span id=&quot;singleType&quot;&gt;&lt;/span&gt;&lt;/li&gt;
    &lt;li&gt;File last modification date: &lt;span id=&quot;singleDate&quot;&gt;&lt;/span&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<h4>Example #2: display metadata of multiple files, use a filter on the file type</h4>

<p>This example is a bit more complicated, as it will display details
about all files selected (not only the first) and allows only images to
be selected, using the accept attribute of the input field: &lt;input
type=“file” accept=“image/*“…/&gt;.</p>

<p><a href="https://jsbin.com/deboja/edit?html,output" target="_blank" rel="noopener noreferrer">Example on
JSBin</a>, or try it in your browser: click on the button, and select
multiple image files. Notice that in the file selector, files that are
not images will be greyed and non selectable.</p>

<h4>Select several images:</h4>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;p&gt;Select several images: &lt;input
      type=“file” accept=“image/*“ multiple onchange=”filesProcess(this.files)“ 
      name=”selection”/&gt;&lt;/p&gt;
&lt;div id=&quot;result&quot;&gt;...&lt;/div&gt;
&lt;script&gt;
  function filesProcess(files) {
    var selection = &quot;&lt;table&gt;&lt;tr&gt;&lt;th&gt;Name&lt;
    /th&gt;&lt;th&gt;Bytes&lt;/th&gt;&lt;th&gt;MIME Type&lt;/th&gt;
    &lt;th&gt;Last modified date&lt;/th&gt;&lt;/tr&gt;&quot;;
    for(i=0; i&lt;files.length ;i++){
     file = files[i];
     selection += &quot;&lt;tr&gt;&lt;td&gt;&quot;+file.name+&quot;&lt;/td&gt;&lt;td
       style=&quot;text-align:right&quot;&gt;&quot;
       +file.size+&quot;&lt;/td&gt;&lt;td&gt;&quot;
       +file.type+&quot;&lt;/td&gt;&lt;td&gt;
     &quot;+file.lastModifiedDate+&quot;&lt;/td&gt;&lt;/tr&gt;&quot;;
  }
    selection += &quot;&lt;/table&gt;&quot;;
    document.getElementById(&quot;result&quot;).innerHTML = selection;
  }
&lt;/script&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Explanations:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<ul>
  <li><i>Line 1:</i> we used the multiple attribute to allow the selection of 
    multiple files in the file chooser (using shift or control keys). 
    The accept=“image/” attribute is a filter that restricts selection to images only. 
    Finally, the onchange listener will call the filesProcess(…) function, passing as 
    parameter the list of selected files for the current element (this.files).<br></li>
  <li><i>Lines 9 and 13:</i> we prepare the HTML code for building a &lt;table&gt; 
    with the results.<br></li>
  <li><i>Line 7:</i> this for loop builds all the rows that compose the table, adding 
    HTML code to  the selection string variable. At the end of the loop, this variable 
    contains all the HTML code that corresponds to the table of results.<br></li>
  <li><i>Line 14:</i> the table is added to the page. We use the innerHTML attribute of 
    the DOM element corresponding to the &lt;div id=“result”&gt; in order to insert the 
    table as its child in the DOM tree. As such, the table appears on the page dynamically.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-3-4">6.3.4 Blob and File</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The <a href="https://www.w3.org/TR/FileAPI/" target="_blank" 
rel="noopener noreferrer">HTML5 File API specification</a> introduces several interfaces:</p>

<ul>
  <li>the <a href="https://www.w3.org/TR/FileAPI/#filelist-section" target="_blank" 
    rel="noopener noreferrer">FileList</a>interface (we already met it) the files 
    property is a FileList,</li>
  <li>the <a href="https://www.w3.org/TR/FileAPI/#file-section" target="_blank" 
    rel="noopener noreferrer">File</a> interface that is useful for getting details 
    about a file (the file variable in the for loop of the last example illustrates this),</li>
  <li>the <a href="https://www.w3.org/TR/FileAPI/#blob-section" target="_blank" 
    rel="noopener noreferrer">Blob</a> interface helps read binary data (only) 
    that is accessed slice by slice (as chunks of data, each one being a “Blob”),</li>
  <li>and the <a href="https://www.w3.org/TR/FileAPI/#APIASynch" target="_blank" 
    rel="noopener noreferrer">FileReader</a> interface for reading file content 
    (we will see how to use it in the next section of the course).</li>
</ul>

<p>We will not use all of these interfaces, but let’s explain the difference between 
Blob and File, as most of the methods exposed by the FileReader interface take 
indiscriminately a Blob or a File as parameter.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 312. the blob movie poster (377) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image312.webp"
  loading="lazy"
  title="The Blob movie poster"
  alt="The Blob movie poster."
  style="width:25%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>The Blob object</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p><b>An object of type Blob is a structure that represents binary data
available as read-only.</b> Most of the time, you will only encounter
these objects when you handle files.</p>

<p>Blob objects have two properties, namely:size and type, which
respectively retrieve the size in bytes of the data handled by the Blob
and their MIME type.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>The File object</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p><b>File objects are useful for manipulating… files!</b> They inherit
the properties and methods of Blob objects, and have two additional
properties that are name, for the file name, and lastModifiedDate to get
the date of the last modification of the file (in the form of a
JavaScript Date object, obviously) .</p>

<p>Most of the time, we will work with File objects. Blob objects will
have real interest when you download binary files using Ajax (see
example below).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>[Advanced]</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>If you are interested in seeing how Blob objects can be used, <a
href="https://jsbin.com/jefitop/1/edit?html,output" target="_blank" 
rel="noopener noreferrer">here is an example “as is” that shows how to download an image using Xhr2</a> (Xml Http
Request version 2). The examples uses a &lt;progress&gt; element to show the
download progress, and uses xhr.responseType = ‘blob’; to indicate that
the file we are going to download is a binary file (a blob). Try the
example, then comment the line with responseType=‘blob’. In this case,
you will notice that the image file is not properly decoded by the
browser and is not displayed in the page. We explain Xhr2 in the <a
href="https://www.edx.org/course/html5-apps-and-games" target="_blank" 
rel="noopener noreferrer">W3C HTML5 Apps and Games</a> course.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-3-5">6.3.5 Reading file content</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>In order to read the content of a file, different steps required.
Let’s see how to do it.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Typical use is made of three steps</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Step #1: create a FileReader object</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The file API proposes several methods for reading file content, each
taken from the FileReader interface. Here is how you create a FileReader object:</p>

<ol type="1">
  <li>var reader = new FileReader();</li>
</ol>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Steps #2 and #3: first call a method of the FileReader object for reading 
the file content, then get the file content in an onload callback</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>There are three different methods available for reading a file’s
content: readAsText, readAsArrayBuffer for binary data and also
as readAsDataURL (the content will be a URL you will use to set
the src field of an &lt;img src=...&gt;, &lt;audio&gt;, &lt;video&gt;, and
also with all existing methods/properties that accept a URL).</p>

<p>All these methods take as a unique parameter a File object (for
example, a file chosen by a user after clicking on a &lt;input
type=file&gt; input field). Below, we use, as an example,
the readAsText method:</p>

<details>
  <summary><b>Click to expand!</b></summary>

<pre>function readFileContent(f) {
  // Executed last: called only when the file content is loaded, e.target.result is
  // The content
  reader.onload = function(e) {
    var content = e.target.result;
    // do something with the file content
    console.log(&quot;File &quot; + f.name + &quot; content is: &quot; + content);
  };
  // Executed first: start reading the file asynchronously, will call the
  // reader.onload callback only when the file is read entirely
  reader.readAsText(f);
}</pre>

</details>

<p>The above code shows how a file can be read as text. The function is
called, for example by clicking on the button corresponding to
a &lt;input type=“file” id=“file” onchange=“readFileContent(this.files)”/&gt;, and 
by choosing a file.</p>

<ul>
  <li><i>Line 11</i> is executed first, and asks the Reader object to read the file f as text. 
    As this takes some time, it’s an asynchronous operation that will be executed by the 
    browser in the background.  When the file is read, the reader.onload callback function 
    is called.</li>
  <li><i>Line 4</i> is executed after <i>line 11</i>, and is called only when the file 
    content is available.  This callback takes an event e as a unique parameter, and 
    e.target.result is the file content.</li>
</ul>

<p>Try a variation of the above code in your browser, that displays the
file content in a text area. This example is detailed further in the
course. Click and select a text file below:</p>
<p>Choose a text file:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 313. select a text file (379) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image313.webp"
  loading="lazy"
  title="Select a text file"
  alt="Select a text file."
  style="width:25%;" />

<p>In the following pages, we look at different examples that read file
contents as text, dataURL and binary.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-3-6">6.3.6 Read file content as text</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Let’s start by reading a pure text file</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3>Examples</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Example #1: read a single file’s content</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p><a href="https://jsbin.com/xewemi/edit?html,output" target="_blank" rel="noopener noreferrer">
Example at JSBin</a>, or try it below in your browser:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~ 314. read single files content (379) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image314.webp"
  loading="lazy"
  title="Read a single file's content"
  alt="Read a single file's content."
  style="width:25%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Complete source code:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Example of use of FileReader with a text file&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;label for=&quot;files&quot;&gt;Choose a text file:&lt;/label&gt;&lt;input type=&quot;file&quot; id=&quot;file&quot;
  onchange=&quot;readFileContent(this.files)&quot;/&gt;&lt;br/&gt;
&lt;p&gt;
&lt;textarea rows=15 cols=50 id=&quot;fileContent&quot;&gt;&lt;/textarea&gt;

&lt;script&gt;
  function readFileContent(files) {
    console.log(&quot;In readFileContent&quot;);
    var reader = new FileReader();

    // Executed last: called when the file content is loaded, e.target.result is
    // The content
    reader.onload = function(e) {
      // display content in the textarea with id=&quot;fileContent&quot;
      document.getElementById(&quot;fileContent&quot;).value= e.target.result;
    };

    console.log(&quot;Reading file:&quot; + files[0].name);

    // Executed first: start reading the file asynchronously , will call the onload
    // callback when the file is read
    reader.readAsText(files[0]);
  }
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>This example is the one at the end of the previous page. This time,
we show the complete source code above. Remember that the instruction
at <i>line 29</i> is executed first, then when the file is read, the
browser will call asynchronously the onload callback at <i>line 20</i>.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Example #2: a variation of the previous one, using multiple files</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p><a href="https://jsbin.com/zaheyu/edit?html,output" target="_blank" rel="noopener noreferrer">
Example on JSBin</a>, or try it below in your browser. This time, please select multiple text 
files (using shift for multiple selection):</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 315. choose multiple text files (380) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image315.webp"
  loading="lazy"
  title="Choose multiple text files"
  alt="Choose multiple text files."
  style="width:25%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Source code:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Example of use of FileReader with a text file&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;label for=&quot;files&quot;&gt;Choose multiple text files:&lt;/label&gt;
&lt;input type=&quot;file&quot; id=&quot;files&quot;
  multiple onchange=&quot;readFilesAndDisplayAsText(this.files);&quot;/&gt;&lt;br/&gt;
&lt;p&gt;
&lt;textarea rows=30 cols=50 id=&quot;filesContent&quot;&gt;&lt;/textarea&gt;

&lt;script&gt;
  var filesContent = document.getElementById(&quot;filesContent&quot;);

  function readFilesAndDisplayAsText(files) {
    console.log(&quot;dans read files&quot;);
    // Loop through the FileList
    for (var i = 0, f; f = files[i]; i++) {

      var reader = new FileReader();

      // Add an onload listener to the reader
      addOnLoadListener(reader, f.name);
      // start reading, will call the listener later, when the file f is read
      reader.readAsText(f);

    }
  }

  function addOnLoadListener(reader, name) {
    // Add an onload listener that will be able to print the name of the
    // file...
    reader.onload = function(e) {
      filesContent.value += &quot;###### READING FILE &quot; + name + &quot; ######&quot;;
      filesContent.value += e.target.result;
    };
  }
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Explanations</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>This example is similar to the previous one, except that this time we
read multiple files.</p>
<p><i>Line 20:</i> this is the for loop that will iterate on
the files object passed as parameter by the onchange listener
declaration at <i>line 10.</i></p>
<p><i>Line 25:</i> instead of declaring the onload listener with
a reader.onload =… directly in the loop, this time we preferred to write
a separate function that will do this. This technique is useful when you
want the listener to work with extra variables computed in the loop (in
our case, the name of the file).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>About charter encoding</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Note that you can optionally indicate the encoding of the file you
are going to read (default is UTF-8):</p>

<pre>reader.readAsText(file, &#39;UTF-8&#39;);
reader.readAsText(file, &#39;ISO-8859-1&#39;);
...</pre>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-3-7">6.3.7 Read file content as binary</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>This method is rarely used, except for loading “raw” binary data. For
images you would like to see in your HTML page using the &lt;img src=
tag&gt; or for drawing in a canvas, or for audio and video files that
you would like to play using
the &lt;audio&gt; or &lt;video&gt; elements, it would be preferable
to use the readAsDataURL method presented on the next page of the
course.</p>
<p>readAsArrayBuffer is often used for purposes such as reading audio
samples that should be loaded in memory and played using the WebAudio
API, or for loading textures that you will use with WebGL for 3D
animations.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Example: read a local audio file and play it with the WebAudio API</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>The WebAudio API is useful for reading audio sound samples from
memory (no streaming), and has been designed for music application and
games. This example shows how a local audio file can be read and played
directly in the browser, without the need for a server!</p>
<p><a href="https://jsbin.com/xepexuy/1/edit?html,output" target="_blank" 
rel="noopener noreferrer">Example on JSBin</a> (does not work on IE, as it does 
not support the WebAudio API). We could not embed it here on the edX platform as 
it prevents code that uses Ajax to run in its pages.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~ 316. webaudio api - does not work with microsoft shit (382) ~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image316.webp"
  loading="lazy"
  title="Local audio player"
  alt="Local audio player."
  style="width:35%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Source code extract:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<details>
  <summary><b>Webaudio API:</b></summary>

<pre>// User selects file. Read it as an ArrayBuffer and pass to the API.
var fileInput = document.querySelector(&#39;input[type=&quot;file&quot;]&#39;);
fileInput.addEventListener(&#39;change&#39;, function(e) {
  var reader = new FileReader();
  reader.onload = function(e) {
    initSound(e.target.result);
  };
  // THIS IS THE INTERESTING PART!
  reader.readAsArrayBuffer(this.files[0]);
}, false);</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Explanations:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<ul>
  <li><i>Line 2:</i> we get a pointer to the file selector, the variable fileInput.</li>
  <li><i>Line 5:</i> we define a change listener. In this example, we use an anonymous function directly 
    included in the listener definition (the listener is the function(e) {…}).</li>
  <li><i>Line 9:</i> when a user chooses a file, the listener will be executed. 
    Line 9 will start the reading of the file content, as a binary file (this is 
    what readAsArrayBuffer means: read as binary!). Once the file will be entirely read, 
    the onload callback will be asynchronously called by the browser.</li>
  <li><i>Line 5:</i> is the onload callback, executed when the file content is loaded in memory. 
    We pass the file content to the initSound function (see JSBin example for complete source code) 
    that uses WebAudio to decode it (it may be a compressed file - an mp3 for example - and WebAudio 
    works only with uncompressed audio formats in memory), and to play it.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-3-8">6.3.8 Read file content as dataURL</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>What is a data URL?</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>A data URL is a URL that includes type and content at the same time.
It is useful, for example,  for in-lining images or videos in the HTML
of a Web page (on mobile devices, this may speed up the loading of the
page by reducing the number of HTTP requests).</p>

<p>Here is an example of a red square, as a data URL. Copy and paste it
in the address bar of your browser, and you should see the red
square:</p>

<pre>data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==</pre>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>This data URL in a browser address bar should look like this:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~ 317. data url in address bar shows a red cirle (383) ~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image317.webp"
  loading="lazy"
  title="Data url in address bar shows a red circle"
  alt="Data url in address bar shows a red circle."
  style="width:35%;" />

<p>If we set the src attribute of an image element
&lt;img src=&quot;data:image/png....&quot;&gt; with the data URL of the above
screenshot, it will work exactly as if you used a URL that started
with https://</p>

<p>In your browser, you will see a small red circle rendered by this source code:</p>

<pre>&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUA
AAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO

9TXL0Y4OHwAAAABJRU5ErkJggg==&quot; alt=&quot;Red square&quot; width=50 height=50/&gt;</pre>

<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>And here is the result:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 318. red splotch (383) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image318.webp"
  loading="lazy"
  title="Red splotch"
  alt="Red splotch."
  style="width:15%;" />

<p>This dataURL format enables file content to be stored in a base64
format (as a string), and adds the MIME type specification of the
content. The dataURL can therefore store a file as a URL readable with
modern browsers. It is becoming more commonly used on the Web,
especially for mobile applications, as inlining images reduces the
number of HTTP requests and makes the Web page load faster.</p>

<p>You will find lots of Web sites and tools for generating dataURL from
files, such as <a href="https://ezgif.com/image-to-datauri" target="_blank" 
rel="noopener noreferrer">Image to Data URI converter</a> (screenshot below):</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~ 319. Online service that converts uploaded images to data uris... ~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~ we see an image and its ascii encoded data uri version (384) ~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image319.webp"
  loading="lazy"
  title="Online service that converts uploaded images to data uris...we see an image and 
    its ascii encoded data uri version"
  alt="Online service that converts uploaded images to data uris...we see an image and 
    its ascii encoded data uri version."
  style="width:35%;" >

<p>With the above example, you can copy and paste the characters on the
left and use them with an &lt;img src="..."&gt;. Just set the src attribute
with it!</p>

<p>Notice that you can encode any type of file as dataURL, but this
format is most frequently used with ./images files (images, audio,
video).</p>

<p>Example of HTML5 logo embedded in a document without any real image,
just a dataURL and CSS:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~ 320. screenshot jsbin example shows the html5 logo inserted before a div using css (385) ~-->
<img class="displayed"
  src="./images/image317.webp"
  loading="lazy"
  title="Data URL in address bar shows a red circle"
  alt="Data URL in address bar shows a red circle."
  style="width:35%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Examples</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Example #1: read images as data URL and display previews in the page</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>This first example is useful for forms that allow the user to select one or more pictures. 
Before sending the form, you might want to get a preview of the pictures in the HTML page.
The reader.readAsDataUrl method is used for that.</p>

<p><a href="https://jsbin.com/laseye/edit?html,output" target="_blank" rel="noopener noreferrer">
Example on JSBin</a> or try it below in your browser:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~ 332. preview of selected images (385) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/laseye/edit?html,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image332.webp"
  loading="lazy"
  title="Preview of selected images"
  alt="Preview of selected images."
  style="width:35%;" /></a>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Preview of selected images:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Source code extract:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<details>
  <summary><b>Click to expand!</b></summary>

<pre>&lt;label for=&quot;files&quot;&gt;Choose multiple files:&lt;/label&gt;
&lt;input type=&quot;file&quot; id=&quot;files&quot; multiple
  onchange=&quot;readFilesAndDisplayPreview(this.files);&quot;/&gt;&lt;br/&gt;
&lt;p&gt;Preview of selected images:&lt;/p&gt;
&lt;output id=&quot;list&quot;&gt;&lt;/output&gt;
&lt;script&gt;
function readFilesAndDisplayPreview(files) {
  // Loop through the FileList and render image files as thumbnails.
  for (var i = 0, f; f = files[i]; i++) {
    // Only process image files.
    if (!f.type.match(&#39;image.*&#39;)) {
      continue;
    }
      var reader = new FileReader();

    //capture the file information.
    reader.onload = function(e) {
      // Render thumbnail. e.target.result = the image content
      // as a data URL
      // create a span with CSS class=&quot;thumb&quot;, for nicer layout
      var span = document.createElement(&#39;span&#39;);
      // Add an img src=... in the span, with src= the dataURL of
      // the image
      span.innerHTML = &quot;&lt;img class=&#39;thumb&#39; src=&#39;&quot; +
        e.target.result + &quot;&#39; alt=&#39;a picture&#39;/&gt;&quot;;
      // Insert the span in the output id=list
      document.getElementById(&#39;list&#39;).insertBefore(span, null);
    };
    // Read in the image file as a data URL.
    reader.readAsDataURL(f);
  }
}</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Explanations:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<ul>
  <li><i>Line 30:</i> starts the reading of the file f. When f is read, the onload 
    callback will be called.</li>
  <li><i>Lines 24-30:</i> we build, using the DOM API, a &lt;span class="thumb"&gt;…
    &lt;/span&gt; and inside we add an &lt;img src=the data url&gt; element with its 
    src attribute equal to the url of the image that has been read (the image content 
    as dataURL is in e.target.result). Finally, at <i>line 27</i>, we insert the span 
    in the document before the current children of the &lt;output id="list"&gt;  element 
    (declared at <i>line 5</i>).</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Example #2: read a single local image file and use it with drawImage ina canvas</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p><a href="https://jsbin.com/miciqu/edit?html,output" target="_blank" rel="noopener noreferrer">Try it on JSBin</a></p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 322. example 2 kitty cat (386) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/miciqu/edit?html,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image322.webp"
  loading="lazy"
  title="Example #2 read image as dataURL and draw inside a canvas"
  alt="Example #2 read image as dataURL and draw inside a canvas."
  style="width:35%;" /></a>

<p><i>Errata</i>: the above screenshot says "choose multiple files", but the 
example only works with a single file.</p>

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>function drawImage(imageFile) {
  var reader = new FileReader();
  //capture the file information.
  reader.onload = function(e) {
    // For drawing an image on a canvas we
    // need an image object
    var img = new Image();
    // Even if the file has been read, decoding
    // the dataURL format may take some time
    // so we need to use the regular way of
    // working with images: onload callback    
    // that will be called after setting the src attribute
    img.onload = function(e) {
      // draw the image!
      ctx.drawImage(img, 0, 0, 400, 400);
    }
    // e.target.result is the dataURL, so we set the
    // src if the image with it. This will call
    // asynchonously the onload callback
    img.src= e.target.result;
  };
  // Read in the image file as a data URL.
  reader.readAsDataURL(imageFile);
}
function readFileAndDraw(files) {
  drawImage(files[0]);
}</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Explanations:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Remember how we worked with images on a canvas. We had to create an
empty image object (<i>line 8</i>), set the src attribute of the image
object (<i>line 23</i>), then use an image.onload callback (<i>line
15</i>), and we could only draw from inside the callback (<i>line
17</i>). This time, it’s exactly the same, except that the URL comes
from e.target.result in the reader.onload callback (<i>line 23</i>).</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Example #3 (advanced): an instagram-like photo filter application</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Another very impressive example, has been developed by <span
class="citation" data-cites="GeorgianaB">@GeorgianaB</span>, a student
of the first iteration of this course (see her <a
href="https://codepen.io/giana/" target="_blank" rel="noopener noreferrer">other creations/examples</a>). This Web
application reads local image files, draws them into a canvas element
and proposes different filters. This example is given “as is” for those
of you who would like to go further. Just click on the link (or on the
image below) and look at the source code.</p>

<p><a href="https://gianablantin.github.io/CanvasFilters/" target="_blank" 
rel="noopener noreferrer">Try this example online on gitHub</a>.</p>

<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-4-1">6.4.1 Geolocation API Introduction</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>This chapter presents the new Geolocation API and illustrates its use with several examples.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 323. w3c geolocation logo (388) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image323.webp"
  loading="lazy"
  title="W3C Geolocation logo/icon"
  alt="W3C Geolocation logo/icon."
  style="width:25%;" />

<p>The Geolocation HTML5 JavaScript API is implemented by most modern
Web browsers, and uses different means to get the current location: GPS,
GSM/3G triangulation, Wifi, IP address, etc.</p>

<p>It is possible to prompt the user to activate the GPS (this is what
most GPS navigation software does on mobile phones), or ask for a
particular mean among those available. It is also possible to track the
current position when it changes. This is useful for writing a
navigation application or for tracking in real time the position of
different participants in the case of an application that involves
several persons at the same time (using WebSockets, for example).<br>
<a href="https://caniuse.com/#feat=geolocation" target="_blank" rel="noopener noreferrer">
Browser support for the Geolocation API</a> is excellent, both on mobile and on desktop devices.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Typical use</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>navigator.geolocation.getCurrentPosition(showPosition, onError);
function showPosition(position) {
  console.log(&quot;latitude is: &quot; + position.coords.latitude);
  console.log(&quot;longitude is: &quot; + position.coords.longitude);
}
function onError(err) {
  console.log(&quot;Could not get the position&quot;);
}</pre>

</details>

<p><a href="https://jsbin.com/toyeley/1/edit?html,output" target="_blank" rel="noopener noreferrer">
This online example at JSBin</a> shows how to get the current longitude and latitude and display 
them in an HTML page. Try it below in your browser:</p>

<p>Click the button to get your coordinates: Where am I ?
Note that the first time you execute this example, for privacy reasons,
the browser will ask if you agree to share your position with the application.</p>

<br/>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;Basic example of use of the geolocation API&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;p id=&quot;msg&quot;&gt;Click the button to get your coordinates:&lt;/p&gt;
    &lt;button onclick=&quot;getLocation()&quot;&gt;Where am I ?&lt;/button&gt;
    &lt;script&gt;
      var displayCoords=document.getElementById(&quot;msg&quot;);
      function getLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
      } else {
        displayCoords.innerHTML=&quot;Geolocation API not supported by your browser.&quot;;
      }
      }
      function showPosition(position) {
        displayCoords.innerHTML=&quot;Latitude: &quot; + position.coords.latitude +
          &quot;&lt;br /&gt;Longitude: &quot; + position.coords.longitude;
      }
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 324. function getLocation in geolocation (389) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image324.webp"
  loading="lazy"
  title="Geolocation callback illustration"
  alt="Geolocation callback illustration."
  style="width:35%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Explanations:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<ul>
  <li><i>Line 13</i> checks if the Web browser supports the geolocation API by testing the 
    variable navigator.geolocation. If not null, then the geolocation API is supported.</li>
  <li><i>Line 14</i> calls navigator.geolocation.getCurrentPosition(showPosition) passing 
    a callback function as a parameter (in this example we did not specify a callback in 
    case of error). When a current position is available, the callback function will be 
    called asynchronously, and the input parameter of this callback function will be the 
    current position, like in the function showPosition(position) of the example.</li>
  <li><i>Line 20</i> the position objects has a coords property that is the object that 
    holds the longitude and the latitude.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>External resources:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<ul>
  <li>The W3C specification: <a href="https://www.w3.org/TR/geolocation-API/" target="_blank" 
    rel="noopener noreferrer">Geolocation API</a></li>
  <li>MDN’s Web Docs: <a href="https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API" 
    target="_blank" rel="noopener noreferrer">Geolocation API</a></li>
  <li>Browser support tables:<br>
  <ul>
    <li>on CanIuse: <a href="https://caniuse.com/#feat=geolocation" target="_blank" 
      rel="noopener noreferrer">Geolocation</a></li>
    <li>on MDN: <a href="https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API#Browser_compatibility" 
      target="_blank" rel="noopener noreferrer">Geolocation API</a></li>
  </ul>
  </li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-4-2">6.4.2 The coords object properties</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>In the previous example, we used the coords property of the position
passed as an input parameter to the callback function. This coords
object has many properties:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~ 325. properties of the coords object (390) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image325.webp"
  loading="lazy"
  title="Properties of the coords object"
  alt="Properties of the coords object."
  style="width:35%;" />

<p>Not all these values may be available in all Web browsers. When one of
these properties is null, it means that it is not available (often the
case of the altitudeAccuracy)</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-4-3">6.4.3 Geolocation error codes</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>In the last example, we used the navigator.geolocation.
getCurrentPosition(showPosition) with only one callback function (in the
case of success), but it is also possible to pass a second parameter
that is another callback function called in the case of error.</p>

<p>A slightly different version of the previous example 
<a href="https://jsbin.com/bafusik/edit?html,output" target="_blank" rel="noopener noreferrer">
shows how to properly check against the different possible errors</a>. Try it,
then turn your WiFi off or unplug your Ethernet cable (or turn off
GPS and 3G/4G on a mobile phone). You should see an error message Error
during geolocation: Location could not be obtained though the available
means”:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 326. geolocation error (390) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://jsbin.com/bafusik/edit?html,output" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image326.webp"
  loading="lazy"
  title="Geolocation error"
  alt="Geolocation error."
  style="width:35%;" /></a>

<br/>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
  &lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;Basic example of use of the geolocation API&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;p id=&quot;msg&quot;&gt;Click the button to get your coordinates:&lt;/p&gt;
    &lt;button onclick=&quot;getLocation()&quot;&gt;Where am I ?&lt;/button&gt;
    &lt;script&gt;
      var displayCoords=document.getElementById(&quot;msg&quot;);
      function getLocation() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(showPosition, errorPosition);
        } else {
          displayCoords.innerHTML=&quot;Geolocation API not supported by your browser.&quot;;
        }
      }
      function showPosition(position) {
        displayCoords.innerHTML=&quot;Latitude: &quot; + position.coords.latitude +
                                &quot;&lt;br /&gt;Longitude: &quot; + position.coords.longitude;
      }
      function errorPosition(error) {
        var info = &quot;Error during geolocation: &quot;;
        switch(error.code) {
          case error.TIMEOUT:
            info += &quot;Timeout !&quot;;
            break;
          case error.PERMISSION_DENIED:
            info += &quot;Permission denied, geolocation could not be obtained...&quot;;
            break;
          case error.POSITION_UNAVAILABLE:
            info += &quot;Location could not be obtained though the available means...&quot;;
            break;
          case error.UNKNOWN_ERROR:
            info += &quot;Unknown error&quot;;
            break;
          }
        displayCoords.innerHTML = info;
      }
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-4-4">6.4.4 Tracking a position</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>In order to track the current position, the geolocation API provides a method 
similar to the getCurrentPosition(onSuccess, onError) named watchPosition(onSuccess, onError).</p>
<p>When getCurrentPosition gives a position when called, watchPosition does the following:</p>

<ul>
  <li>It gets the callback function only when the current position changes. If you 
    stay in the same location, the callback function won’t be called regularly.</li>
  <li>It returns an id so that you can use the clearWatch(id) method to stop the 
    current tracking.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3>Typical use</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<pre>// get an id of the current tracking, the showPosition callback is like the one we saw in earlier examples.
var watchPosId = navigator.geolocation.watchPosition(showPosition);
...
// stop the tracking
navigator.geolocation.clearWatch(watchPosId);</pre>

<p>As a test, you may just try to
change getCurrentPosition to watchPosition in the previous examples, and
try this code using a mobile phone or tablet, walk for 20 meters and see
the position changing.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Options available when using the geolocation API, in particular real time tracking</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Several options are available when using HTML5 geolocation. We can pass
a third parameter to the getCurrentPosition and watchPosition methods,
that will hold one or several of the following options:</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~ 327. more properties of the coords object (392) ~~~~~~~~~~~~~~~~~~~~~~~-->
<img class="displayed"
  src="./images/image327.webp"
  loading="lazy"
  title="More properties of the coords object"
  alt="More properties of the coords object."
  style="width:35%;" />
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Example of use</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>// Just ask to turn GPS on, if available
navigator.geolocation.getCurrentPosition(onSuccess, onError,
  {enableHighAccuracy:true});
// maximumAge = 10 mins, the position can be cached for 10 mins,
// useful when in tunnels...When the device tries to get
// a position, if it does not succeed, then go on error
// immediately
navigator.geolocation.getCurrentPosition(onSuccess, onError,
  {maximumAge:600000, timeout:0});
// Position will never come from the cache (maximumAge: 0), and
// if after 0.1s the position could not be computed, then go on
// error
navigator.geolocation.getCurrentPosition(onSuccess, onError,
  {maximumAge:0, timeout:100});
// Ask for GPS, cache for 30s, 27s before going on error...
watchId=navigator.geolocation.watchPosition(onSuccess, onError,
  {enableHighAccuracy:true, maximumAge:30000, timeout:27000});</pre>

</details>

<p>Look for the explanations in the lines of comment.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-4-5">6.4.5 Geolocation and maps</h3>https://leafletjs.com/index.html
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>This section presents an example of how to get an interactive map, using 
<a href="https://leafletjs.com/reference-1.6.0.html" target="_blank" rel="noopener noreferrer">
the Leaflet API for OpenStreetMap</a>, and gives links to more resources. 
Did you know that you can even get an estimation of a physical address from the 
longitude and latitude, using online Web services?</p>
<p>How to get a map centered on your longitude and latitude.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 328. openstreetmap test (393) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://leafletjs.com/reference-1.6.0.html" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image328.webp"
  loading="lazy"
  title="Example/Test OpenStreetMap"
  alt="Example/Test OpenStreetMap."
  style="width:35%;" /></a>

<p>This example is just given "as is", as there are so many possibilities for rendering 
a map with <a href="/leafletjs.com/reference-1.6.0.html" target="_blank" rel="noopener noreferrer">
the Leaflet API for OpenStreetMaps</a>https:/. However, we think having such a basic example might be useful.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 329. openstreetmap test (393) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="/leafletjs.com/reference-1.6.0.html" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image329.webp"
  loading="lazy"
  title="Example/Test OpenStreetMap"
  alt="Example/Test OpenStreetMap."
  style="width:35%;" /></a>

<br/>

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>function getLocation(e) {
  e.preventDefault();
  if (!navigator.geolocation) {
    alert(&quot;Browser doesn&#39;t support geolocation&quot;);
  } else {
    navigator.geolocation.getCurrentPosition(success, error);
  }
}
// Get current position successfully
function success(position) {
  var map, marker,
    latitude = position.coords.latitude,
    longitude = position.coords.longitude;
  // Instance map using leaflet
  map = L.map(&#39;map&#39;).setView([latitude, longitude], 13);
  // Tile layer using key api at cloudmade.com
  L.tileLayer(&#39;https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&#39;, {
    key: &#39;760506895e284217a7442ce2efe97797&#39;,
    styleId: 103288,
    maxZoom: 16
  }).addTo(map);
  // Marker using leaflet
  marker = L.marker([latitude, longitude]).addTo(map);
  // Popup in leaflet
  marker.bindPopup(&#39;&lt;p&gt;Your location&lt;/p&gt;&#39;).openPopup();
}
// Get current position fail
function error() {
  alert(&#39;Get current position fail. Please access codepen to get geolocation.&#39;);
}
</pre>

</details>

<br/>

<details>
  <summary><b>CSS source code:</b></summary>

<pre>html, body {
  height: 100%
}
.map {
  height: 300px;
}
.btn {
  background-color: rgba(10, 10, 230, .5);
  border: 0;
  color: #fff;
  padding: 10px;
  text-shadow: 0 0 1px rgba(0, 0, 0, .3);
  text-decoration: none;
  margin: 0.5rem 0 1rem;
  display: inline-block;
}</pre>

</details>

<br/>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;html&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;OpenStreetMap Example&lt;/title&gt;
  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/leaflet@1.0.3/dist/leaflet.css&quot;&gt;
  &lt;script src=&quot;https://unpkg.com/leaflet@1.0.3/dist/leaflet.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;button class=&quot;btn&quot; onclick=&quot;getLocation(event)&quot;&gt;Click to show your location with OpenStreetMap&lt;/button&gt;
  &lt;div id=&quot;map&quot; class=&quot;map&quot;&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Source code extract:</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;html&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;OpenStreetMap Example&lt;/title&gt;
  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/leaflet@1.0.3/dist/leaflet.css&quot;&gt;
  &lt;script src=&quot;https://unpkg.com/leaflet@1.0.3/dist/leaflet.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;button class=&quot;btn&quot; onclick=&quot;getLocation(event)&quot;&gt;Click to show your location with OpenStreetMap&lt;/button&gt;
  &lt;div id=&quot;map&quot; class=&quot;map&quot;&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<ul>
  <li><i>Lines 5 and 6</i> are the required files to use the Leaflet API (this
    is the official name of the OpenStreetMaps API),</li>
  <li><i>Line 10</i> is the &lt;div&gt; container that will be used to display
    the interactive map.</li>
</ul>

<br/>

<details>
  <summary><b>JavaScript source code:</b></summary>

<pre>function getLocation(e) {
  e.preventDefault();
  if (!navigator.geolocation) {
    alert(&quot;Browser doesn&#39;t support geolocation&quot;);
  } else {
    navigator.geolocation.getCurrentPosition(success, error);
  }
}
// Get current position successfully
function success(position) {
  var map, marker,
  latitude = position.coords.latitude,
  longitude = position.coords.longitude;
  // Instance map using leaflet
  map = L.map(&#39;map&#39;).setView([latitude, longitude], 13);
  // Tile layer using key api at cloudmade.com
  L.tileLayer(&#39;https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&#39;, {
    key: &#39;760506895e284217a7442ce2efe97797&#39;,
    styleId: 103288,
    maxZoom: 16
  }).addTo(map);
  // Marker using leaflet
  marker = L.marker([latitude, longitude]).addTo(map);
  // Popup in leaflet
  marker.bindPopup(&#39;&lt;p&gt;Your location&lt;/p&gt;&#39;).openPopup();
}
// Get current position fail
function error() {
  alert(&#39;Get current position fail. Please access codepen to get geolocation.&#39;);
}</pre>

</details>

<ul>
  <li><i>Line 6</i> uses the <a href="https://www.w3.org/TR/geolocation-API/" 
    target="_blank" rel="noopener noreferrer">Geolocation API</a> to get the 
    current position, in case of success it calls the success function, passing 
    the location as parameter,</li>
  <li><i>Lines 12 and 13&gt;</i> show how to get the longitude and latitude properties 
    from the location,</li>
  <li>The rest is a basic use of the Leaflet API. Notice at <i>line 15</i> that ‘map’ 
    is the id of the &lt;div&gt; from the HTML part of the code.</li>
</ul>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-4-6">6.4.6 Reverse geocoding</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Different Web services can be used to get an address from longitude and latitude. 
Most are free of charge, but they will ask you to register an API key and enter your 
credit card number. If you send too many requests, you will be charged. Such a service 
is the <a href="https://developers.google.com/maps/documentation/javascript/examples/geocoding-reverse" 
target="_blank" rel="noopener noreferrer">Google Reverse Geocoding JavaScript API</a>. For those 
of you who are really interested to know how this API works, please read the Google documentation 
and tutorials.</p>

<p>There is also an interesting Leaflet plugin (an extension to Leaflet) based on the 
<a href="https://www.gisgraphy.com/" target="_blank" rel="noopener noreferrer">
Gisgraphy</a> (free open source framework) service, that comes with a 
<a href="https://services.gisgraphy.com/static/leaflet/index.html" 
target="_blank" rel="noopener noreferrer">nice demo of reverse geocoding</a>.</p>

<p>Let’s see some examples of use.</p>

<p>Example #1: how to get a physical address from the longitude and latitude.</p>

<p>Google reverse geocoding example (screenshot only):</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 330. google reverse geocoding example (396) ~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://services.gisgraphy.com/static/leaflet/index.html" 
target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image330.webp"
  loading="lazy"
  title="Example #1 How to get a physical address from the longitude and latitude"
  alt="Example #1 How to get a physical address from the longitude and latitude."
  style="width:35%;" /></a>

<p>Source code of this example (in order to run it, you need a Google API
key, used at <i>line 6</i>.</p>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;utf-8&quot;&gt;
  &lt;title&gt;Js bin &lt;/title&gt;
  &lt;script src=&quot;https://maps.googleapis.com/maps/api/js?key=
    PUT_HERE_YOUR_API_KEY&amp;v=3.exp&amp;sensor=false&quot;&gt;
    &lt;/script&gt;&lt;script&gt;
    // p elements for displaying lat / long and address
    var displayCoords, myAddress;
    // used with the google apis
    var geocoder;
    var map;
    var infowindow = new google.maps.InfoWindow();
    var marker;

    // Called when the page is loaded
    function init() {
      displayCoords=document.getElementById(&quot;msg&quot;);
      myAddress = document.getElementById(&quot;address&quot;);
      geocoder = new google.maps.Geocoder();
      // In order to show something even before a user clicks on the button
      var latlng = new google.maps.LatLng(34.0144, -6.83);
      var mapOptions = {
        zoom: 8,
        center: latlng,
        mapTypeId: &#39;roadmap&#39;
      }
      map = new google.maps.Map(document.getElementById(&#39;map_canvas&#39;), mapOptions);
    } // end of init()
    // Called when the button is clicked

    function getLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
      } else {
        displayCoords.innerHTML=&quot;Geolocation API not supported by your browser.&quot;;
      }
     }
    // Called when a position is available
 
    function showPosition(position) {
      displayCoords.innerHTML=&quot;Latitude: &quot; + position.coords.latitude +
        &quot;&lt;br /&gt;Longitude: &quot; + position.coords.longitude;
      // Display the map
      showOnGoogleMap(new google.maps.LatLng(position.coords.latitude,       
        position.coords.longitude));
    }

    function showOnGoogleMap(latlng) {
      // Ask google geocoder for an address once we get a longitude and
      // a latitude. In fact, the reverse geocoder sends back an array of &quot;guesses&quot;
      // i.e. not just one address object, but several. Each entry in this array
      // has several properties such as street, city, etc. We use the
      &quot;formatted_address&quot;
      // one here, but it might be interesting to get the detailed properties in other
      // applications like a form with street, city, zip code etc.
      geocoder.geocode({&#39;latLng&#39;: latlng},reverseGeocoderSuccess);

        function reverseGeocoderSuccess(results, status) {
          if (status == google.maps.GeocoderStatus.OK) {
            if (results[1]) {
              map.setZoom(11);
              marker = new google.maps.Marker({
                position: latlng,
                map: map
              });
              infowindow.setContent(results[1].formatted_address);
              infowindow.open(map, marker);
              // Display address as text in the page
              myAddress.innerHTML=&quot;Adress: &quot; + results[0].formatted_address; 
            } else {
              alert(&#39;No surface address found&#39;);
            }
          } else {
            alert(&#39;Geocoder failed due to: &#39; + status);
          }
        } // end of reverseGeocoderSuccess
      } // end of showOnGoogleMap
  &lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;init()&quot;&gt;
  &lt;title&gt;HTML5 + Geolocalisation + Google Maps API Reverse Geocoding&lt;/title&gt;
  &lt;p id=&quot;msg&quot;&gt;Click the button to get your coordinates:&lt;/p&gt;
  &lt;p id=&quot;address&quot;&gt;&lt;/p&gt;
  &lt;button onclick=&quot;getLocation()&quot;&gt;Where am I ?&lt;/button&gt;
  &lt;div id=&quot;map_canvas&quot; style=&quot;width: 500px; height: 300px&quot;&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>

<p>Gisgraphy (free service) reverse geocoding example (screenshot 
only, click on it to see <a href="https://services.gisgraphy.com/static/leaflet/index.html" 
target="_blank" rel="noopener noreferrer"> the demo on the Gisgraphy website</a>):</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 331. gisgraphy screenshot (398) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://services.gisgraphy.com/static/leaflet/index.html" 
target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image331.webp"
  loading="lazy"
  title="Gisgraphy screenshot"
  alt="Gisgraphy screenshot."
  style="width:35%;" /></a>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4><b>Example #2:</b> reverse geocoding + OpenStreetMap</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p><b>Important note:</b> these examples below rely on an external 
<a href="https://github.com/perliedman/leaflet-control-geocoder" 
target="_blank" rel="noopener noreferrer">GitHub resource</a>.</p>

<p>Please, pan and zoom on the map and click.</p>

<p>The longitude and latitude are computed from your click and a free reverse geocoding service is 
used to convert to a physical address.</p>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!--~~~~~~~~~~~~~~~~~~~~~~ 332. reverse geocoding - openstreetmap (398) ~~~~~~~~~~~~~~~~~~~~~~~~-->
<a href="https://codepen.io/w3devcampus/pen/MWKEJqM" target="_blank" rel="noopener noreferrer">
<img class="displayed"
  src="./images/image332.webp"
  loading="lazy"
  title="Reverse Geocoding - OpenStreetMap"
  alt="Reverse Geocoding - OpenStreetMap."
  style="width:35%;" /></a>

<br/>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;Leaflet Control Geocoder&lt;/title&gt;
  &lt;meta charset=&quot;utf-8&quot; /&gt;
  &lt;meta
    name=&quot;viewport&quot;
    content=&quot;width=device-width, user-scalable=no initial-scale=1, maximum-scale=1&quot;
    /&gt;
  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/leaflet@latest/dist/leaflet.css
    &quot; /&gt;
  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css&quot; /&gt;
  &lt;script src=&quot;https://unpkg.com/leaflet@latest/dist/leaflet-src.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js&quot;&gt;&lt;/script&gt;
  &lt;style type=&quot;text/css&quot;&gt;
    body {
      margin: 0;
    }
    #map {
      position: absolute;
      width: 100%;
      height: 100%;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id=&quot;map&quot;&gt;&lt;/div&gt;
  &lt;script type=&quot;text/javascript&quot;&gt;
  var map = L.map(&#39;map&#39;).setView([0, 0], 2);
  var geocoder = L.Control.Geocoder.nominatim();
  if (URLSearchParams &amp;&amp; location.search) {
    // parse /?geocoder=nominatim from URL
    var params = new URLSearchParams(location.search);
    var geocoderString = params.get(&#39;geocoder&#39;);
    if (geocoderString &amp;&amp; L.Control.Geocoder[geocoderString]) {
      console.log(&#39;Using geocoder&#39;, geocoderString);
      geocoder = L.Control.Geocoder[geocoderString]();
    } else if (geocoderString) {
      console.warn(&#39;Unsupported geocoder&#39;, geocoderString);
    }
  }
  var control = L.Control.geocoder({
    query: &#39;Moon&#39;,
    placeholder: &#39;Search here...&#39;,
    geocoder: geocoder
  }).addTo(map);
  var marker;
  setTimeout(function() {
    control.setQuery(&#39;Earth&#39;);
  }, 12000);
  L.tileLayer(&#39;https://{s}.tile.osm.org/{z}/{x}/{y}.png&#39;, {
    attribution: &#39;&amp;copy; &lt;a href=&quot;https://osm.org/copyright&quot;&gt;OpenStreetMap&lt;/a&gt; contributors&#39;
  }).addTo(map);
  map.on(&#39;click&#39;, function(e) {
    console.log(e.latlng)
    geocoder.reverse(e.latlng, map.options.crs.scale(map.getZoom()), function(results) {
      var r = results[0];
     if (r) {
        if (marker) {
          marker
         .setLatLng(r.center)
          .setPopupContent(r.html || r.name)
          .openPopup();
        } else {
          marker = L.marker(r.center)
          .bindPopup(r.name)
          .addTo(map)
          .openPopup();
        }
      }
    });
  });
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Example #3: shows the address on the map, from your current longitude and latitude</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<br/>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;Leaflet Control Geocoder&lt;/title&gt;
  &lt;meta charset=&quot;utf-8&quot; /&gt;
  &lt;meta
    name=&quot;viewport&quot;
    content=&quot;width=device-width, user-scalable=no initial-scale=1, maximum-scale=1&quot;
    /&gt;
  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/leaflet@latest/dist/leaflet.css&quot; /&gt;
  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css&quot; /&gt;
  &lt;script src=&quot;https://unpkg.com/leaflet@latest/dist/leaflet-src.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js&quot;&gt;&lt;/script&gt;
  &lt;style type=&quot;text/css&quot;&gt;
    body {
      margin: 0;
    }
    #map {
      position: absolute;
      width: 100%;
      height: 100%;
    }
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id=&quot;map&quot;&gt;&lt;/div&gt;
  &lt;script type=&quot;text/javascript&quot;&gt;
    var geocoder = L.Control.Geocoder.nominatim();
    var map, marker, latitude, longitude;
    function getLocation() {
      if (!navigator.geolocation) {
        alert(&quot;Browser doesn&#39;t support geolocation&quot;);
      } else {
        navigator.geolocation.getCurrentPosition(success, error);
      }
    }
    // Get current position successfully
    function success(position) {
      latitude = position.coords.latitude;
      longitude = position.coords.longitude;
      // Instance map using leaflet
      map = L.map(&#39;map&#39;).setView([latitude, longitude], 13);
      // Tile layer using key api at cloudmade.com
      L.tileLayer(&#39;https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&#39;, {
      key: &#39;760506895e284217a7442ce2efe97797&#39;,
      styleId: 103288,
      maxZoom: 16
      }).addTo(map);
      // Marker using leaflet
      marker = L.marker([latitude, longitude]).addTo(map);
      // Popup in leaflet
      marker.bindPopup(&#39;&lt;p&gt;&lt;/p&gt;&#39;).openPopup();
      getPhysicalAddress({lat:latitude, lng:longitude});
    }
    // Get current position fail
    function error() {
      alert(&#39;Get current position fail. Please access codepen to get geolocation.&#39;);
    }
    var marker;
    function getPhysicalAddress(latlong) {
      geocoder.reverse(latlong, map.options.crs.scale(map.getZoom()), function(results) {
      var r = results[0];
        if (r) {
          if (marker) {
            marker
             .setLatLng(r.center)
             .setPopupContent(r.html || r.name)
             .openPopup();
          } else {
              marker = L.marker(r.center)
             .bindPopup(r.name)
             .addTo(map)
             .openPopup();
          }
        }
      });
    }
    getLocation();
  &lt;/script&gt;
 &lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Example #4: use of geolocation, map and reverse geocoder in a HTML form</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>This is just a variation of the previous examples. We embedded the interactive map 
in a form, and we display the results of the reverse geocoder in a form field. This 
example might be useful if you want to pre-fill the address of a registration form, 
depending on the current location of the person who is registering.</p>

<p>Click on the Codepen logo (on the top right) so to run the 
<a href="https://codepen.io/w3devcampus/pen/MWKEJqM" target="_blank" rel="noopener noreferrer">
online example</a> (for security reasons the embedded version cannot run in this page):</p>

<br/>

<details>
  <summary><b>HTML source code:</b></summary>

<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;Gimmee My Location&lt;/title&gt;
  &lt;meta charset=&quot;utf-8&quot; /&gt;
  &lt;meta name=&quot;viewport&quot;
  content=&quot;width=device-width, user-scalable=no initial-scale=1, maximum-scale=1&quot; /&gt;
  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/leaflet@latest/dist/leaflet.css&quot; /&gt;
  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css&quot; /&gt;
  &lt;script src=&quot;https://unpkg.com/leaflet@latest/dist/leaflet-src.js&quot;&gt;&lt;/script&gt;
  &lt;script src=&quot;https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body onload=&quot;getLocation();&quot;&gt;
  &lt;h1&gt;Example of the use of reverse geocoder in a form&lt;/h1&gt;
  &lt;form&gt;
  &lt;fieldset&gt;
    &lt;legend&gt;Form example with map and address...&lt;/legend&gt;
    &lt;div id=&quot;map&quot; style=&quot;width: 500px; height: 300px&quot;&gt;&lt;/div&gt;
  &lt;/fieldset&gt;
  &lt;fieldset&gt;
  &lt;legend&gt;Surface address&lt;/legend&gt;
  &lt;input id=&quot;surfaceAddress&quot; size=110 type=&quot;text&quot;&gt;
  &lt;fieldset&gt;
  &lt;form&gt;
  &lt;div id=&quot;map&quot;&gt;&lt;/div&gt;
  &lt;script type=&quot;text/javascript&quot;&gt;
    var geocoder = L.Control.Geocoder.nominatim();
    var map, marker, latitude, longitude;
    function getLocation() {
      if (!navigator.geolocation) {
        alert(&quot;Browser doesn&#39;t support geolocation&quot;);
      } else {
        navigator.geolocation.getCurrentPosition(success, error);
      }
    }
    // Get current position successfully
    function success(position) {
      latitude = position.coords.latitude;
      longitude = position.coords.longitude;
      // Instance map using leaflet
      map = L.map(&#39;map&#39;).setView([latitude, longitude], 13);
      // Tile layer using key api at cloudmade.com
      L.tileLayer(&#39;https://{s}.tile.openstreetmap.org/{z}{x}{y}.png&#39;, {
        key: &#39;760506895e284217a7442ce2efe97797&#39;,
          styleId: 103288,
          maxZoom: 16
      }).addTo(map);
      // Marker using leaflet
        marker = L.marker([latitude, longitude]).addTo(map);
        // Popup in leaflet
        marker.bindPopup(&#39;&lt;p&gt;&lt;/p&gt;&#39;).openPopup();
        getPhysicalAddress({lat:latitude, lng:longitude});
    }
    // Get current position fail
    function error() {
      alert(&#39;Get current position fail. Please access codepen to get geolocation.&#39;);
    }
      var marker;
      function getPhysicalAddress(latlong) {
        geocoder.reverse(latlong, 500000, function(results) {
          var r = results[0];
          console.log(r.name);
          document.querySelector(&quot;#surfaceAddress&quot;).value = r.name;
          if (r) {
            if (marker) {
              marker
                .setLatLng(r.center)
                .setPopupContent(r.html || r.name)
                .openPopup();
            } else {
              marker = L.marker(r.center)
                .bindPopup(r.name)
                .addTo(map)
                .openPopup();
            }
          }
        });
      }
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

</details>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h3 id="ch6-4-7">6.4.7 Discussion and projects</h3>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<h4>Optional projects</h4>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<p>Here are a few project ideas. Your classmates and the team who prepared
the course will be glad to try them and offer feedback. Please post URLs
in this discussion forum. These projects are optional, meaning that they
won’t be graded. However, it is important to complete them to ensure
good understanding of the material.</p>

<ul>
  <li>Project 1 (easy): Add a map showing your location to one of your Web
    pages. Start with a simple, static map, then try with an interactive
    map. Reuse the examples from the course.</li>
  <li>Project 2 (a bit harder): The examples provided in the course used
    OpenStreetMap, but why don’t you try to do the same with GoogleMaps?
    Some services are free of charge, but will ask you to get an API key
    (see this YouTube tutorial about how to get such a key).</li>
</ul>

  <!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
  <h5>. . .The end.</h5>
  <!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->

  <h6>Prior updated 11-20-23 Mon 11:58pm<br/>
  Last updated 4-12-23 Fri 1:21am<br/>
  Last updated 7-21-24 Sun 1:20am<br/>
  Last updated 8-15-24 Thu 3:28pm<br/>
  Last updated 8-23-24 Fri 4:32pm<br/>
  Last updated 9-25-24 Wed 8:00am<br/>
  Last updated 10-30-24 Wed 4:46am<br/>
  Last updated 5-24-25 Sat 5:50pm<br/>
  Last updated 6-30-25 Mon 12:53pm<br/>
  Last updated 7-03-25 Thu 5:15pm</h6>
  <script src="/js/scripts.js"></script>

  </body>
</html>
